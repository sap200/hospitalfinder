(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors"],{"00ee":function(t,e,r){var i=r("b622"),n=i("toStringTag"),o={};o[n]="z",t.exports="[object z]"===String(o)},"0366":function(t,e,r){var i=r("1c0b");t.exports=function(t,e,r){if(i(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,i){return t.call(e,r,i)};case 3:return function(r,i,n){return t.call(e,r,i,n)}}return function(){return t.apply(e,arguments)}}},"06cf":function(t,e,r){var i=r("83ab"),n=r("d1e7"),o=r("5c6c"),a=r("fc6a"),s=r("c04e"),l=r("5135"),c=r("0cfb"),u=Object.getOwnPropertyDescriptor;e.f=i?u:function(t,e){if(t=a(t),e=s(e,!0),c)try{return u(t,e)}catch(r){}if(l(t,e))return o(!n.f.call(t,e),t[e])}},"0cfb":function(t,e,r){var i=r("83ab"),n=r("d039"),o=r("cc12");t.exports=!i&&!n((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},"107c":function(t,e,r){var i=r("d039");t.exports=i((function(){var t=RegExp("(?<a>b)","string".charAt(5));return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},1276:function(t,e,r){"use strict";var i=r("d784"),n=r("44e7"),o=r("825a"),a=r("1d80"),s=r("4840"),l=r("8aa5"),c=r("50c4"),u=r("14c3"),p=r("9263"),h=r("9f7f"),d=r("d039"),f=h.UNSUPPORTED_Y,m=[].push,g=Math.min,y=4294967295,v=!d((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));i("split",(function(t,e,r){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var i=String(a(this)),o=void 0===r?y:r>>>0;if(0===o)return[];if(void 0===t)return[i];if(!n(t))return e.call(i,t,o);var s,l,c,u=[],h=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,f=new RegExp(t.source,h+"g");while(s=p.call(f,i)){if(l=f.lastIndex,l>d&&(u.push(i.slice(d,s.index)),s.length>1&&s.index<i.length&&m.apply(u,s.slice(1)),c=s[0].length,d=l,u.length>=o))break;f.lastIndex===s.index&&f.lastIndex++}return d===i.length?!c&&f.test("")||u.push(""):u.push(i.slice(d)),u.length>o?u.slice(0,o):u}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:e.call(this,t,r)}:e,[function(e,r){var n=a(this),o=void 0==e?void 0:e[t];return void 0!==o?o.call(e,n,r):i.call(String(n),e,r)},function(t,n){var a=r(i,this,t,n,i!==e);if(a.done)return a.value;var p=o(this),h=String(t),d=s(p,RegExp),m=p.unicode,v=(p.ignoreCase?"i":"")+(p.multiline?"m":"")+(p.unicode?"u":"")+(f?"g":"y"),_=new d(f?"^(?:"+p.source+")":p,v),x=void 0===n?y:n>>>0;if(0===x)return[];if(0===h.length)return null===u(_,h)?[h]:[];var b=0,w=0,S=[];while(w<h.length){_.lastIndex=f?0:w;var T,E=u(_,f?h.slice(w):h);if(null===E||(T=g(c(_.lastIndex+(f?w:0)),h.length))===b)w=l(h,w,m);else{if(S.push(h.slice(b,w)),S.length===x)return S;for(var I=1;I<=E.length-1;I++)if(S.push(E[I]),S.length===x)return S;w=b=T}}return S.push(h.slice(b)),S}]}),!v,f)},"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"14c3":function(t,e,r){var i=r("c6b6"),n=r("9263");t.exports=function(t,e){var r=t.exec;if("function"===typeof r){var o=r.call(t,e);if("object"!==typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(t))throw TypeError("RegExp#exec called on incompatible receiver");return n.call(t,e)}},"19aa":function(t,e){t.exports=function(t,e,r){if(!(t instanceof e))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return t}},"1be4":function(t,e,r){var i=r("d066");t.exports=i("document","documentElement")},"1c0b":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},"1c7e":function(t,e,r){var i=r("b622"),n=i("iterator"),o=!1;try{var a=0,s={next:function(){return{done:!!a++}},return:function(){o=!0}};s[n]=function(){return this},Array.from(s,(function(){throw 2}))}catch(l){}t.exports=function(t,e){if(!e&&!o)return!1;var r=!1;try{var i={};i[n]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch(l){}return r}},"1cdc":function(t,e,r){var i=r("342f");t.exports=/(?:iphone|ipod|ipad).*applewebkit/i.test(i)},"1d80":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},"1da1":function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));r("d3b7");function i(t,e,r,i,n,o,a){try{var s=t[o](a),l=s.value}catch(c){return void r(c)}s.done?e(l):Promise.resolve(l).then(i,n)}function n(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,l,"next",t)}function l(t){i(a,n,o,s,l,"throw",t)}s(void 0)}))}}},"1dde":function(t,e,r){var i=r("d039"),n=r("b622"),o=r("2d00"),a=n("species");t.exports=function(t){return o>=51||!i((function(){var e=[],r=e.constructor={};return r[a]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},2266:function(t,e,r){var i=r("825a"),n=r("e95a"),o=r("50c4"),a=r("0366"),s=r("35a1"),l=r("2a62"),c=function(t,e){this.stopped=t,this.result=e};t.exports=function(t,e,r){var u,p,h,d,f,m,g,y=r&&r.that,v=!(!r||!r.AS_ENTRIES),_=!(!r||!r.IS_ITERATOR),x=!(!r||!r.INTERRUPTED),b=a(e,y,1+v+x),w=function(t){return u&&l(u),new c(!0,t)},S=function(t){return v?(i(t),x?b(t[0],t[1],w):b(t[0],t[1])):x?b(t,w):b(t)};if(_)u=t;else{if(p=s(t),"function"!=typeof p)throw TypeError("Target is not iterable");if(n(p)){for(h=0,d=o(t.length);d>h;h++)if(f=S(t[h]),f&&f instanceof c)return f;return new c(!1)}u=p.call(t)}m=u.next;while(!(g=m.call(u)).done){try{f=S(g.value)}catch(T){throw l(u),T}if("object"==typeof f&&f&&f instanceof c)return f}return new c(!1)}},"23cb":function(t,e,r){var i=r("a691"),n=Math.max,o=Math.min;t.exports=function(t,e){var r=i(t);return r<0?n(r+e,0):o(r,e)}},"23e7":function(t,e,r){var i=r("da84"),n=r("06cf").f,o=r("9112"),a=r("6eeb"),s=r("ce4e"),l=r("e893"),c=r("94ca");t.exports=function(t,e){var r,u,p,h,d,f,m=t.target,g=t.global,y=t.stat;if(u=g?i:y?i[m]||s(m,{}):(i[m]||{}).prototype,u)for(p in e){if(d=e[p],t.noTargetGet?(f=n(u,p),h=f&&f.value):h=u[p],r=c(g?p:m+(y?".":"#")+p,t.forced),!r&&void 0!==h){if(typeof d===typeof h)continue;l(d,h)}(t.sham||h&&h.sham)&&o(d,"sham",!0),a(u,p,d,t)}}},"241c":function(t,e,r){var i=r("ca84"),n=r("7839"),o=n.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,o)}},2626:function(t,e,r){"use strict";var i=r("d066"),n=r("9bf2"),o=r("b622"),a=r("83ab"),s=o("species");t.exports=function(t){var e=i(t),r=n.f;a&&e&&!e[s]&&r(e,s,{configurable:!0,get:function(){return this}})}},"2a62":function(t,e,r){var i=r("825a");t.exports=function(t){var e=t["return"];if(void 0!==e)return i(e.call(t)).value}},"2cf4":function(t,e,r){var i,n,o,a=r("da84"),s=r("d039"),l=r("0366"),c=r("1be4"),u=r("cc12"),p=r("1cdc"),h=r("605d"),d=a.location,f=a.setImmediate,m=a.clearImmediate,g=a.process,y=a.MessageChannel,v=a.Dispatch,_=0,x={},b="onreadystatechange",w=function(t){if(x.hasOwnProperty(t)){var e=x[t];delete x[t],e()}},S=function(t){return function(){w(t)}},T=function(t){w(t.data)},E=function(t){a.postMessage(t+"",d.protocol+"//"+d.host)};f&&m||(f=function(t){var e=[],r=1;while(arguments.length>r)e.push(arguments[r++]);return x[++_]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},i(_),_},m=function(t){delete x[t]},h?i=function(t){g.nextTick(S(t))}:v&&v.now?i=function(t){v.now(S(t))}:y&&!p?(n=new y,o=n.port2,n.port1.onmessage=T,i=l(o.postMessage,o,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts&&d&&"file:"!==d.protocol&&!s(E)?(i=E,a.addEventListener("message",T,!1)):i=b in u("script")?function(t){c.appendChild(u("script"))[b]=function(){c.removeChild(this),w(t)}}:function(t){setTimeout(S(t),0)}),t.exports={set:f,clear:m}},"2d00":function(t,e,r){var i,n,o=r("da84"),a=r("342f"),s=o.process,l=s&&s.versions,c=l&&l.v8;c?(i=c.split("."),n=i[0]<4?1:i[0]+i[1]):a&&(i=a.match(/Edge\/(\d+)/),(!i||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/),i&&(n=i[1]))),t.exports=n&&+n},"342f":function(t,e,r){var i=r("d066");t.exports=i("navigator","userAgent")||""},"35a1":function(t,e,r){var i=r("f5df"),n=r("3f8c"),o=r("b622"),a=o("iterator");t.exports=function(t){if(void 0!=t)return t[a]||t["@@iterator"]||n[i(t)]}},"37e8":function(t,e,r){var i=r("83ab"),n=r("9bf2"),o=r("825a"),a=r("df75");t.exports=i?Object.defineProperties:function(t,e){o(t);var r,i=a(e),s=i.length,l=0;while(s>l)n.f(t,r=i[l++],e[r]);return t}},"3bbe":function(t,e,r){var i=r("861d");t.exports=function(t){if(!i(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},"3ca3":function(t,e,r){"use strict";var i=r("6547").charAt,n=r("69f3"),o=r("7dd0"),a="String Iterator",s=n.set,l=n.getterFor(a);o(String,"String",(function(t){s(this,{type:a,string:String(t),index:0})}),(function(){var t,e=l(this),r=e.string,n=e.index;return n>=r.length?{value:void 0,done:!0}:(t=i(r,n),e.index+=t.length,{value:t,done:!1})}))},"3f4e":function(t,e,r){"use strict";r.d(e,"setupDevtoolsPlugin",(function(){return o}));var i=r("abc5"),n=r("b774");function o(t,e){const r=Object(i["a"])();if(r)r.emit(n["a"],t,e);else{const r=Object(i["b"])(),n=r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[];n.push({pluginDescriptor:t,setupFn:e})}}},"3f8c":function(t,e){t.exports={}},"428f":function(t,e,r){var i=r("da84");t.exports=i},"44ad":function(t,e,r){var i=r("d039"),n=r("c6b6"),o="".split;t.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==n(t)?o.call(t,""):Object(t)}:Object},"44d2":function(t,e,r){var i=r("b622"),n=r("7c73"),o=r("9bf2"),a=i("unscopables"),s=Array.prototype;void 0==s[a]&&o.f(s,a,{configurable:!0,value:n(null)}),t.exports=function(t){s[a][t]=!0}},"44de":function(t,e,r){var i=r("da84");t.exports=function(t,e){var r=i.console;r&&r.error&&(1===arguments.length?r.error(t):r.error(t,e))}},"44e7":function(t,e,r){var i=r("861d"),n=r("c6b6"),o=r("b622"),a=o("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==n(t))}},4840:function(t,e,r){var i=r("825a"),n=r("1c0b"),o=r("b622"),a=o("species");t.exports=function(t,e){var r,o=i(t).constructor;return void 0===o||void 0==(r=i(o)[a])?e:n(r)}},4930:function(t,e,r){var i=r("2d00"),n=r("d039");t.exports=!!Object.getOwnPropertySymbols&&!n((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},"4d64":function(t,e,r){var i=r("fc6a"),n=r("50c4"),o=r("23cb"),a=function(t){return function(e,r,a){var s,l=i(e),c=n(l.length),u=o(a,c);if(t&&r!=r){while(c>u)if(s=l[u++],s!=s)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===r)return t||u||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},"4de4":function(t,e,r){"use strict";var i=r("23e7"),n=r("b727").filter,o=r("1dde"),a=o("filter");i({target:"Array",proto:!0,forced:!a},{filter:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},"50c4":function(t,e,r){var i=r("a691"),n=Math.min;t.exports=function(t){return t>0?n(i(t),9007199254740991):0}},5135:function(t,e,r){var i=r("7b0b"),n={}.hasOwnProperty;t.exports=Object.hasOwn||function(t,e){return n.call(i(t),e)}},5692:function(t,e,r){var i=r("c430"),n=r("c6cd");(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.15.0",mode:i?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},"56ef":function(t,e,r){var i=r("d066"),n=r("241c"),o=r("7418"),a=r("825a");t.exports=i("Reflect","ownKeys")||function(t){var e=n.f(a(t)),r=o.f;return r?e.concat(r(t)):e}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,r){var i=r("1d80"),n=r("5899"),o="["+n+"]",a=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),l=function(t){return function(e){var r=String(i(e));return 1&t&&(r=r.replace(a,"")),2&t&&(r=r.replace(s,"")),r}};t.exports={start:l(1),end:l(2),trim:l(3)}},"5c6c":function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"605d":function(t,e,r){var i=r("c6b6"),n=r("da84");t.exports="process"==i(n.process)},6069:function(t,e){t.exports="object"==typeof window},"60da":function(t,e,r){"use strict";var i=r("83ab"),n=r("d039"),o=r("df75"),a=r("7418"),s=r("d1e7"),l=r("7b0b"),c=r("44ad"),u=Object.assign,p=Object.defineProperty;t.exports=!u||n((function(){if(i&&1!==u({b:1},u(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach((function(t){e[t]=t})),7!=u({},t)[r]||o(u({},e)).join("")!=n}))?function(t,e){var r=l(t),n=arguments.length,u=1,p=a.f,h=s.f;while(n>u){var d,f=c(arguments[u++]),m=p?o(f).concat(p(f)):o(f),g=m.length,y=0;while(g>y)d=m[y++],i&&!h.call(f,d)||(r[d]=f[d])}return r}:u},6547:function(t,e,r){var i=r("a691"),n=r("1d80"),o=function(t){return function(e,r){var o,a,s=String(n(e)),l=i(r),c=s.length;return l<0||l>=c?t?"":void 0:(o=s.charCodeAt(l),o<55296||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):o:t?s.slice(l,l+2):a-56320+(o-55296<<10)+65536)}};t.exports={codeAt:o(!1),charAt:o(!0)}},"65f0":function(t,e,r){var i=r("861d"),n=r("e8b5"),o=r("b622"),a=o("species");t.exports=function(t,e){var r;return n(t)&&(r=t.constructor,"function"!=typeof r||r!==Array&&!n(r.prototype)?i(r)&&(r=r[a],null===r&&(r=void 0)):r=void 0),new(void 0===r?Array:r)(0===e?0:e)}},"69f3":function(t,e,r){var i,n,o,a=r("7f9a"),s=r("da84"),l=r("861d"),c=r("9112"),u=r("5135"),p=r("c6cd"),h=r("f772"),d=r("d012"),f="Object already initialized",m=s.WeakMap,g=function(t){return o(t)?n(t):i(t,{})},y=function(t){return function(e){var r;if(!l(e)||(r=n(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}};if(a||p.state){var v=p.state||(p.state=new m),_=v.get,x=v.has,b=v.set;i=function(t,e){if(x.call(v,t))throw new TypeError(f);return e.facade=t,b.call(v,t,e),e},n=function(t){return _.call(v,t)||{}},o=function(t){return x.call(v,t)}}else{var w=h("state");d[w]=!0,i=function(t,e){if(u(t,w))throw new TypeError(f);return e.facade=t,c(t,w,e),e},n=function(t){return u(t,w)?t[w]:{}},o=function(t){return u(t,w)}}t.exports={set:i,get:n,has:o,enforce:g,getterFor:y}},"6c02":function(t,e,r){"use strict";r.d(e,"a",(function(){return Qt})),r.d(e,"b",(function(){return G}));var i=r("7a23");r("3f4e");
/*!
  * vue-router v4.0.9
  * (c) 2021 Eduardo San Martin Morote
  * @license MIT
  */
const n="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag,o=t=>n?Symbol(t):"_vr_"+t,a=o("rvlm"),s=o("rvd"),l=o("r"),c=o("rl"),u=o("rvl"),p="undefined"!==typeof window;function h(t){return t.__esModule||n&&"Module"===t[Symbol.toStringTag]}const d=Object.assign;function f(t,e){const r={};for(const i in e){const n=e[i];r[i]=Array.isArray(n)?n.map(t):t(n)}return r}let m=()=>{};const g=/\/$/,y=t=>t.replace(g,"");function v(t,e,r="/"){let i,n={},o="",a="";const s=e.indexOf("?"),l=e.indexOf("#",s>-1?s:0);return s>-1&&(i=e.slice(0,s),o=e.slice(s+1,l>-1?l:e.length),n=t(o)),l>-1&&(i=i||e.slice(0,l),a=e.slice(l,e.length)),i=I(null!=i?i:e,r),{fullPath:i+(o&&"?")+o+a,path:i,query:n,hash:a}}function _(t,e){let r=e.query?t(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function x(t,e){return e&&t.toLowerCase().startsWith(e.toLowerCase())?t.slice(e.length)||"/":t}function b(t,e,r){let i=e.matched.length-1,n=r.matched.length-1;return i>-1&&i===n&&w(e.matched[i],r.matched[n])&&S(e.params,r.params)&&t(e.query)===t(r.query)&&e.hash===r.hash}function w(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function S(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(!T(t[r],e[r]))return!1;return!0}function T(t,e){return Array.isArray(t)?E(t,e):Array.isArray(e)?E(e,t):t===e}function E(t,e){return Array.isArray(e)?t.length===e.length&&t.every((t,r)=>t===e[r]):1===t.length&&t[0]===e}function I(t,e){if(t.startsWith("/"))return t;if(!t)return e;const r=e.split("/"),i=t.split("/");let n,o,a=r.length-1;for(n=0;n<i.length;n++)if(o=i[n],1!==a&&"."!==o){if(".."!==o)break;a--}return r.slice(0,a).join("/")+"/"+i.slice(n-(n===i.length?1:0)).join("/")}var C,A;(function(t){t["pop"]="pop",t["push"]="push"})(C||(C={})),function(t){t["back"]="back",t["forward"]="forward",t["unknown"]=""}(A||(A={}));function k(t){if(!t)if(p){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return"/"!==t[0]&&"#"!==t[0]&&(t="/"+t),y(t)}const P=/^[^#]+#/;function O(t,e){return t.replace(P,"#")+e}function M(t,e){const r=document.documentElement.getBoundingClientRect(),i=t.getBoundingClientRect();return{behavior:e.behavior,left:i.left-r.left-(e.left||0),top:i.top-r.top-(e.top||0)}}const L=()=>({left:window.pageXOffset,top:window.pageYOffset});function D(t){let e;if("el"in t){let r=t.el;const i="string"===typeof r&&r.startsWith("#");0;const n="string"===typeof r?i?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!n)return;e=M(n,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(null!=e.left?e.left:window.pageXOffset,null!=e.top?e.top:window.pageYOffset)}function R(t,e){const r=history.state?history.state.position-e:-1;return r+t}const z=new Map;function N(t,e){z.set(t,e)}function B(t){const e=z.get(t);return z.delete(t),e}let F=()=>location.protocol+"//"+location.host;function j(t,e){const{pathname:r,search:i,hash:n}=e,o=t.indexOf("#");if(o>-1){let e=n.includes(t.slice(o))?t.slice(o).length:1,r=n.slice(e);return"/"!==r[0]&&(r="/"+r),x(r,"")}const a=x(r,t);return a+i+n}function U(t,e,r,i){let n=[],o=[],a=null;const s=({state:o})=>{const s=j(t,location),l=r.value,c=e.value;let u=0;if(o){if(r.value=s,e.value=o,a&&a===l)return void(a=null);u=c?o.position-c.position:0}else i(s);n.forEach(t=>{t(r.value,l,{delta:u,type:C.pop,direction:u?u>0?A.forward:A.back:A.unknown})})};function l(){a=r.value}function c(t){n.push(t);const e=()=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)};return o.push(e),e}function u(){const{history:t}=window;t.state&&t.replaceState(d({},t.state,{scroll:L()}),"")}function p(){for(const t of o)t();o=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",u),{pauseListeners:l,listen:c,destroy:p}}function V(t,e,r,i=!1,n=!1){return{back:t,current:e,forward:r,replaced:i,position:window.history.length,scroll:n?L():null}}function q(t){const{history:e,location:r}=window;let i={value:j(t,r)},n={value:e.state};function o(i,o,a){const s=t.indexOf("#"),l=s>-1?(r.host&&document.querySelector("base")?t:t.slice(s))+i:F()+t+i;try{e[a?"replaceState":"pushState"](o,"",l),n.value=o}catch(c){console.error(c),r[a?"replace":"assign"](l)}}function a(t,r){const a=d({},e.state,V(n.value.back,t,n.value.forward,!0),r,{position:n.value.position});o(t,a,!0),i.value=t}function s(t,r){const a=d({},n.value,e.state,{forward:t,scroll:L()});o(a.current,a,!0);const s=d({},V(i.value,t,null),{position:a.position+1},r);o(t,s,!1),i.value=t}return n.value||o(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0),{location:i,state:n,push:s,replace:a}}function G(t){t=k(t);const e=q(t),r=U(t,e.state,e.location,e.replace);function i(t,e=!0){e||r.pauseListeners(),history.go(t)}const n=d({location:"",base:t,go:i,createHref:O.bind(null,t)},e,r);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>e.state.value}),n}function Z(t){return"string"===typeof t||t&&"object"===typeof t}function H(t){return"string"===typeof t||"symbol"===typeof t}const W={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},K=o("nf");var X;(function(t){t[t["aborted"]=4]="aborted",t[t["cancelled"]=8]="cancelled",t[t["duplicated"]=16]="duplicated"})(X||(X={}));function Y(t,e){return d(new Error,{type:t,[K]:!0},e)}function J(t,e){return t instanceof Error&&K in t&&(null==e||!!(t.type&e))}const $="[^/]+?",Q={sensitive:!1,strict:!1,start:!0,end:!0},tt=/[.+*?^${}()[\]/\\]/g;function et(t,e){const r=d({},Q,e);let i=[],n=r.start?"^":"";const o=[];for(const u of t){const t=u.length?[]:[90];r.strict&&!u.length&&(n+="/");for(let e=0;e<u.length;e++){const i=u[e];let a=40+(r.sensitive?.25:0);if(0===i.type)e||(n+="/"),n+=i.value.replace(tt,"\\$&"),a+=40;else if(1===i.type){const{value:t,repeatable:r,optional:s,regexp:l}=i;o.push({name:t,repeatable:r,optional:s});const p=l||$;if(p!==$){a+=10;try{new RegExp(`(${p})`)}catch(c){throw new Error(`Invalid custom RegExp for param "${t}" (${p}): `+c.message)}}let h=r?`((?:${p})(?:/(?:${p}))*)`:`(${p})`;e||(h=s&&u.length<2?`(?:/${h})`:"/"+h),s&&(h+="?"),n+=h,a+=20,s&&(a+=-8),r&&(a+=-20),".*"===p&&(a+=-50)}t.push(a)}i.push(t)}if(r.strict&&r.end){const t=i.length-1;i[t][i[t].length-1]+=.7000000000000001}r.strict||(n+="/?"),r.end?n+="$":r.strict&&(n+="(?:/|$)");const a=new RegExp(n,r.sensitive?"":"i");function s(t){const e=t.match(a),r={};if(!e)return null;for(let i=1;i<e.length;i++){const t=e[i]||"",n=o[i-1];r[n.name]=t&&n.repeatable?t.split("/"):t}return r}function l(e){let r="",i=!1;for(const n of t){i&&r.endsWith("/")||(r+="/"),i=!1;for(const t of n)if(0===t.type)r+=t.value;else if(1===t.type){const{value:o,repeatable:a,optional:s}=t,l=o in e?e[o]:"";if(Array.isArray(l)&&!a)throw new Error(`Provided param "${o}" is an array but it is not repeatable (* or + modifiers)`);const c=Array.isArray(l)?l.join("/"):l;if(!c){if(!s)throw new Error(`Missing required param "${o}"`);n.length<2&&(r.endsWith("/")?r=r.slice(0,-1):i=!0)}r+=c}}return r}return{re:a,score:i,keys:o,parse:s,stringify:l}}function rt(t,e){let r=0;while(r<t.length&&r<e.length){const i=e[r]-t[r];if(i)return i;r++}return t.length<e.length?1===t.length&&80===t[0]?-1:1:t.length>e.length?1===e.length&&80===e[0]?1:-1:0}function it(t,e){let r=0;const i=t.score,n=e.score;while(r<i.length&&r<n.length){const t=rt(i[r],n[r]);if(t)return t;r++}return n.length-i.length}const nt={type:0,value:""},ot=/[a-zA-Z0-9_]/;function at(t){if(!t)return[[]];if("/"===t)return[[nt]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(t){throw new Error(`ERR (${r})/"${c}": ${t}`)}let r=0,i=r;const n=[];let o;function a(){o&&n.push(o),o=[]}let s,l=0,c="",u="";function p(){c&&(0===r?o.push({type:0,value:c}):1===r||2===r||3===r?(o.length>1&&("*"===s||"+"===s)&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:c,regexp:u,repeatable:"*"===s||"+"===s,optional:"*"===s||"?"===s})):e("Invalid state to consume buffer"),c="")}function h(){c+=s}while(l<t.length)if(s=t[l++],"\\"!==s||2===r)switch(r){case 0:"/"===s?(c&&p(),a()):":"===s?(p(),r=1):h();break;case 4:h(),r=i;break;case 1:"("===s?r=2:ot.test(s)?h():(p(),r=0,"*"!==s&&"?"!==s&&"+"!==s&&l--);break;case 2:")"===s?"\\"==u[u.length-1]?u=u.slice(0,-1)+s:r=3:u+=s;break;case 3:p(),r=0,"*"!==s&&"?"!==s&&"+"!==s&&l--,u="";break;default:e("Unknown state");break}else i=r,r=4;return 2===r&&e(`Unfinished custom RegExp for param "${c}"`),p(),a(),n}function st(t,e,r){const i=et(at(t.path),r);const n=d(i,{record:t,parent:e,children:[],alias:[]});return e&&!n.record.aliasOf===!e.record.aliasOf&&e.children.push(n),n}function lt(t,e){const r=[],i=new Map;function n(t){return i.get(t)}function o(t,r,i){let n=!i,s=ut(t);s.aliasOf=i&&i.record;const c=ft(e,t),u=[s];if("alias"in t){const e="string"===typeof t.alias?[t.alias]:t.alias;for(const t of e)u.push(d({},s,{components:i?i.record.components:s.components,path:t,aliasOf:i?i.record:s}))}let p,h;for(const e of u){let{path:u}=e;if(r&&"/"!==u[0]){let t=r.record.path,i="/"===t[t.length-1]?"":"/";e.path=r.record.path+(u&&i+u)}if(p=st(e,r,c),i?i.alias.push(p):(h=h||p,h!==p&&h.alias.push(p),n&&t.name&&!ht(p)&&a(t.name)),"children"in s){let t=s.children;for(let e=0;e<t.length;e++)o(t[e],p,i&&i.children[e])}i=i||p,l(p)}return h?()=>{a(h)}:m}function a(t){if(H(t)){const e=i.get(t);e&&(i.delete(t),r.splice(r.indexOf(e),1),e.children.forEach(a),e.alias.forEach(a))}else{let e=r.indexOf(t);e>-1&&(r.splice(e,1),t.record.name&&i.delete(t.record.name),t.children.forEach(a),t.alias.forEach(a))}}function s(){return r}function l(t){let e=0;while(e<r.length&&it(t,r[e])>=0)e++;r.splice(e,0,t),t.record.name&&!ht(t)&&i.set(t.record.name,t)}function c(t,e){let n,o,a,s={};if("name"in t&&t.name){if(n=i.get(t.name),!n)throw Y(1,{location:t});a=n.record.name,s=d(ct(e.params,n.keys.filter(t=>!t.optional).map(t=>t.name)),t.params),o=n.stringify(s)}else if("path"in t)o=t.path,n=r.find(t=>t.re.test(o)),n&&(s=n.parse(o),a=n.record.name);else{if(n=e.name?i.get(e.name):r.find(t=>t.re.test(e.path)),!n)throw Y(1,{location:t,currentLocation:e});a=n.record.name,s=d({},e.params,t.params),o=n.stringify(s)}const l=[];let c=n;while(c)l.unshift(c.record),c=c.parent;return{name:a,path:o,params:s,matched:l,meta:dt(l)}}return e=ft({strict:!1,end:!0,sensitive:!1},e),t.forEach(t=>o(t)),{addRoute:o,resolve:c,removeRoute:a,getRoutes:s,getRecordMatcher:n}}function ct(t,e){let r={};for(let i of e)i in t&&(r[i]=t[i]);return r}function ut(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:pt(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function pt(t){const e={},r=t.props||!1;if("component"in t)e.default=r;else for(let i in t.components)e[i]="boolean"===typeof r?r:r[i];return e}function ht(t){while(t){if(t.record.aliasOf)return!0;t=t.parent}return!1}function dt(t){return t.reduce((t,e)=>d(t,e.meta),{})}function ft(t,e){let r={};for(let i in t)r[i]=i in e?e[i]:t[i];return r}const mt=/#/g,gt=/&/g,yt=/\//g,vt=/=/g,_t=/\?/g,xt=/\+/g,bt=/%5B/g,wt=/%5D/g,St=/%5E/g,Tt=/%60/g,Et=/%7B/g,It=/%7C/g,Ct=/%7D/g,At=/%20/g;function kt(t){return encodeURI(""+t).replace(It,"|").replace(bt,"[").replace(wt,"]")}function Pt(t){return kt(t).replace(Et,"{").replace(Ct,"}").replace(St,"^")}function Ot(t){return kt(t).replace(xt,"%2B").replace(At,"+").replace(mt,"%23").replace(gt,"%26").replace(Tt,"`").replace(Et,"{").replace(Ct,"}").replace(St,"^")}function Mt(t){return Ot(t).replace(vt,"%3D")}function Lt(t){return kt(t).replace(mt,"%23").replace(_t,"%3F")}function Dt(t){return Lt(t).replace(yt,"%2F")}function Rt(t){try{return decodeURIComponent(""+t)}catch(e){}return""+t}function zt(t){const e={};if(""===t||"?"===t)return e;const r="?"===t[0],i=(r?t.slice(1):t).split("&");for(let n=0;n<i.length;++n){const t=i[n].replace(xt," ");let r=t.indexOf("="),o=Rt(r<0?t:t.slice(0,r)),a=r<0?null:Rt(t.slice(r+1));if(o in e){let t=e[o];Array.isArray(t)||(t=e[o]=[t]),t.push(a)}else e[o]=a}return e}function Nt(t){let e="";for(let r in t){const i=t[r];if(r=Mt(r),null==i){void 0!==i&&(e+=(e.length?"&":"")+r);continue}let n=Array.isArray(i)?i.map(t=>t&&Ot(t)):[i&&Ot(i)];n.forEach(t=>{void 0!==t&&(e+=(e.length?"&":"")+r,null!=t&&(e+="="+t))})}return e}function Bt(t){const e={};for(let r in t){let i=t[r];void 0!==i&&(e[r]=Array.isArray(i)?i.map(t=>null==t?null:""+t):null==i?i:""+i)}return e}function Ft(){let t=[];function e(e){return t.push(e),()=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)}}function r(){t=[]}return{add:e,list:()=>t,reset:r}}function jt(t,e,r,i,n){const o=i&&(i.enterCallbacks[n]=i.enterCallbacks[n]||[]);return()=>new Promise((a,s)=>{const l=t=>{!1===t?s(Y(4,{from:r,to:e})):t instanceof Error?s(t):Z(t)?s(Y(2,{from:e,to:t})):(o&&i.enterCallbacks[n]===o&&"function"===typeof t&&o.push(t),a())},c=t.call(i&&i.instances[n],e,r,l);let u=Promise.resolve(c);t.length<3&&(u=u.then(l)),u.catch(t=>s(t))})}function Ut(t,e,r,i){const n=[];for(const o of t)for(const t in o.components){let a=o.components[t];if("beforeRouteEnter"===e||o.instances[t])if(Vt(a)){let s=a.__vccOpts||a;const l=s[e];l&&n.push(jt(l,r,i,o,t))}else{let s=a();0,n.push(()=>s.then(n=>{if(!n)return Promise.reject(new Error(`Couldn't resolve component "${t}" at "${o.path}"`));const a=h(n)?n.default:n;o.components[t]=a;let s=a.__vccOpts||a;const l=s[e];return l&&jt(l,r,i,o,t)()}))}}return n}function Vt(t){return"object"===typeof t||"displayName"in t||"props"in t||"__vccOpts"in t}function qt(t){const e=Object(i["k"])(l),r=Object(i["k"])(c),n=Object(i["b"])(()=>e.resolve(Object(i["z"])(t.to))),o=Object(i["b"])(()=>{let{matched:t}=n.value,{length:e}=t;const i=t[e-1];let o=r.matched;if(!i||!o.length)return-1;let a=o.findIndex(w.bind(null,i));if(a>-1)return a;let s=Kt(t[e-2]);return e>1&&Kt(i)===s&&o[o.length-1].path!==s?o.findIndex(w.bind(null,t[e-2])):a}),a=Object(i["b"])(()=>o.value>-1&&Wt(r.params,n.value.params)),s=Object(i["b"])(()=>o.value>-1&&o.value===r.matched.length-1&&S(r.params,n.value.params));function u(r={}){return Ht(r)?e[Object(i["z"])(t.replace)?"replace":"push"](Object(i["z"])(t.to)).catch(m):Promise.resolve()}return{route:n,href:Object(i["b"])(()=>n.value.href),isActive:a,isExactActive:s,navigate:u}}const Gt=Object(i["h"])({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},setup(t,{slots:e}){const r=Object(i["t"])(qt(t)),{options:n}=Object(i["k"])(l),o=Object(i["b"])(()=>({[Xt(t.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Xt(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const n=e.default&&e.default(r);return t.custom?n:Object(i["j"])("a",{"aria-current":r.isExactActive?t.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:o.value},n)}}}),Zt=Gt;function Ht(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&(void 0===t.button||0===t.button)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Wt(t,e){for(let r in e){let i=e[r],n=t[r];if("string"===typeof i){if(i!==n)return!1}else if(!Array.isArray(n)||n.length!==i.length||i.some((t,e)=>t!==n[e]))return!1}return!0}function Kt(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Xt=(t,e,r)=>null!=t?t:null!=e?e:r,Yt=Object(i["h"])({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(t,{attrs:e,slots:r}){const n=Object(i["k"])(u),o=Object(i["b"])(()=>t.route||n.value),l=Object(i["k"])(s,0),c=Object(i["b"])(()=>o.value.matched[l]);Object(i["r"])(s,l+1),Object(i["r"])(a,c),Object(i["r"])(u,o);const p=Object(i["u"])();return Object(i["B"])(()=>[p.value,c.value,t.name],([t,e,r],[i,n,o])=>{e&&(e.instances[r]=t,n&&n!==e&&t&&t===i&&(e.leaveGuards.size||(e.leaveGuards=n.leaveGuards),e.updateGuards.size||(e.updateGuards=n.updateGuards))),!t||!e||n&&w(e,n)&&i||(e.enterCallbacks[r]||[]).forEach(e=>e(t))},{flush:"post"}),()=>{const n=o.value,a=c.value,s=a&&a.components[t.name],l=t.name;if(!s)return Jt(r.default,{Component:s,route:n});const u=a.props[t.name],h=u?!0===u?n.params:"function"===typeof u?u(n):u:null,f=t=>{t.component.isUnmounted&&(a.instances[l]=null)},m=Object(i["j"])(s,d({},h,e,{onVnodeUnmounted:f,ref:p}));return Jt(r.default,{Component:m,route:n})||m}}});function Jt(t,e){if(!t)return null;const r=t(e);return 1===r.length?r[0]:r}const $t=Yt;function Qt(t){const e=lt(t.routes,t);let r=t.parseQuery||zt,n=t.stringifyQuery||Nt,o=t.history;const a=Ft(),s=Ft(),h=Ft(),g=Object(i["x"])(W);let y=W;p&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const x=f.bind(null,t=>""+t),w=f.bind(null,Dt),S=f.bind(null,Rt);function T(t,r){let i,n;return H(t)?(i=e.getRecordMatcher(t),n=r):n=t,e.addRoute(n,i)}function E(t){let r=e.getRecordMatcher(t);r&&e.removeRoute(r)}function I(){return e.getRoutes().map(t=>t.record)}function A(t){return!!e.getRecordMatcher(t)}function k(t,i){if(i=d({},i||g.value),"string"===typeof t){let n=v(r,t,i.path),a=e.resolve({path:n.path},i),s=o.createHref(n.fullPath);return d(n,a,{params:S(a.params),hash:Rt(n.hash),redirectedFrom:void 0,href:s})}let a;"path"in t?a=d({},t,{path:v(r,t.path,i.path).path}):(a=d({},t,{params:w(t.params)}),i.params=w(i.params));let s=e.resolve(a,i);const l=t.hash||"";s.params=x(S(s.params));const c=_(n,d({},t,{hash:Pt(l),path:s.path}));let u=o.createHref(c);return d({fullPath:c,hash:l,query:n===Nt?Bt(t.query):t.query},s,{redirectedFrom:void 0,href:u})}function P(t){return"string"===typeof t?v(r,t,g.value.path):d({},t)}function O(t,e){if(y!==t)return Y(8,{from:e,to:t})}function M(t){return j(t)}function z(t){return M(d(P(t),{replace:!0}))}function F(t){const e=t.matched[t.matched.length-1];if(e&&e.redirect){const{redirect:r}=e;let i="function"===typeof r?r(t):r;return"string"===typeof i&&(i=i.includes("?")||i.includes("#")?i=P(i):{path:i},i.params={}),d({query:t.query,hash:t.hash,params:t.params},i)}}function j(t,e){const r=y=k(t),i=g.value,o=t.state,a=t.force,s=!0===t.replace,l=F(r);if(l)return j(d(P(l),{state:o,force:a,replace:s}),e||r);const c=r;let u;return c.redirectedFrom=e,!a&&b(n,i,r)&&(u=Y(16,{to:c,from:i}),it(i,i,!0,!1)),(u?Promise.resolve(u):V(c,i)).catch(t=>J(t)?t:tt(t,c,i)).then(t=>{if(t){if(J(t,2))return j(d(P(t.to),{state:o,force:a,replace:s}),e||c)}else t=G(c,i,!0,s,o);return q(c,i,t),t})}function U(t,e){const r=O(t,e);return r?Promise.reject(r):Promise.resolve()}function V(t,e){let r;const[i,n,o]=ee(t,e);r=Ut(i.reverse(),"beforeRouteLeave",t,e);for(const a of i)a.leaveGuards.forEach(i=>{r.push(jt(i,t,e))});const l=U.bind(null,t,e);return r.push(l),te(r).then(()=>{r=[];for(const i of a.list())r.push(jt(i,t,e));return r.push(l),te(r)}).then(()=>{r=Ut(n,"beforeRouteUpdate",t,e);for(const i of n)i.updateGuards.forEach(i=>{r.push(jt(i,t,e))});return r.push(l),te(r)}).then(()=>{r=[];for(const i of t.matched)if(i.beforeEnter&&!e.matched.includes(i))if(Array.isArray(i.beforeEnter))for(const n of i.beforeEnter)r.push(jt(n,t,e));else r.push(jt(i.beforeEnter,t,e));return r.push(l),te(r)}).then(()=>(t.matched.forEach(t=>t.enterCallbacks={}),r=Ut(o,"beforeRouteEnter",t,e),r.push(l),te(r))).then(()=>{r=[];for(const i of s.list())r.push(jt(i,t,e));return r.push(l),te(r)}).catch(t=>J(t,8)?t:Promise.reject(t))}function q(t,e,r){for(const i of h.list())i(t,e,r)}function G(t,e,r,i,n){const a=O(t,e);if(a)return a;const s=e===W,l=p?history.state:{};r&&(i||s?o.replace(t.fullPath,d({scroll:s&&l&&l.scroll},n)):o.push(t.fullPath,n)),g.value=t,it(t,e,r,s),rt()}let Z;function K(){Z=o.listen((t,e,r)=>{let i=k(t);const n=F(i);if(n)return void j(d(n,{replace:!0}),i).catch(m);y=i;const a=g.value;p&&N(R(a.fullPath,r.delta),L()),V(i,a).catch(t=>J(t,12)?t:J(t,2)?(j(t.to,i).then(t=>{J(t,20)&&!r.delta&&r.type===C.pop&&o.go(-1,!1)}).catch(m),Promise.reject()):(r.delta&&o.go(-r.delta,!1),tt(t,i,a))).then(t=>{t=t||G(i,a,!1),t&&(r.delta?o.go(-r.delta,!1):r.type===C.pop&&J(t,20)&&o.go(-1,!1)),q(i,a,t)}).catch(m)})}let X,$=Ft(),Q=Ft();function tt(t,e,r){rt(t);const i=Q.list();return i.length?i.forEach(i=>i(t,e,r)):console.error(t),Promise.reject(t)}function et(){return X&&g.value!==W?Promise.resolve():new Promise((t,e)=>{$.add([t,e])})}function rt(t){X||(X=!0,K(),$.list().forEach(([e,r])=>t?r(t):e()),$.reset())}function it(e,r,n,o){const{scrollBehavior:a}=t;if(!p||!a)return Promise.resolve();let s=!n&&B(R(e.fullPath,0))||(o||!n)&&history.state&&history.state.scroll||null;return Object(i["l"])().then(()=>a(e,r,s)).then(t=>t&&D(t)).catch(t=>tt(t,e,r))}const nt=t=>o.go(t);let ot;const at=new Set,st={currentRoute:g,addRoute:T,removeRoute:E,hasRoute:A,getRoutes:I,resolve:k,options:t,push:M,replace:z,go:nt,back:()=>nt(-1),forward:()=>nt(1),beforeEach:a.add,beforeResolve:s.add,afterEach:h.add,onError:Q.add,isReady:et,install(t){const e=this;t.component("RouterLink",Zt),t.component("RouterView",$t),t.config.globalProperties.$router=e,Object.defineProperty(t.config.globalProperties,"$route",{enumerable:!0,get:()=>Object(i["z"])(g)}),p&&!ot&&g.value===W&&(ot=!0,M(o.location).catch(t=>{0}));const r={};for(let o in W)r[o]=Object(i["b"])(()=>g.value[o]);t.provide(l,e),t.provide(c,Object(i["t"])(r)),t.provide(u,g);let n=t.unmount;at.add(t),t.unmount=function(){at.delete(t),at.size<1&&(Z(),g.value=W,ot=!1,X=!1),n()}}};return st}function te(t){return t.reduce((t,e)=>t.then(()=>e()),Promise.resolve())}function ee(t,e){const r=[],i=[],n=[],o=Math.max(e.matched.length,t.matched.length);for(let a=0;a<o;a++){const o=e.matched[a];o&&(t.matched.find(t=>w(t,o))?i.push(o):r.push(o));const s=t.matched[a];s&&(e.matched.find(t=>w(t,s))||n.push(s))}return[r,i,n]}},"6eeb":function(t,e,r){var i=r("da84"),n=r("9112"),o=r("5135"),a=r("ce4e"),s=r("8925"),l=r("69f3"),c=l.get,u=l.enforce,p=String(String).split("String");(t.exports=function(t,e,r,s){var l,c=!!s&&!!s.unsafe,h=!!s&&!!s.enumerable,d=!!s&&!!s.noTargetGet;"function"==typeof r&&("string"!=typeof e||o(r,"name")||n(r,"name",e),l=u(r),l.source||(l.source=p.join("string"==typeof e?e:""))),t!==i?(c?!d&&t[e]&&(h=!0):delete t[e],h?t[e]=r:n(t,e,r)):h?t[e]=r:a(e,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},7156:function(t,e,r){var i=r("861d"),n=r("d2bb");t.exports=function(t,e,r){var o,a;return n&&"function"==typeof(o=e.constructor)&&o!==r&&i(a=o.prototype)&&a!==r.prototype&&n(t,a),t}},7418:function(t,e){e.f=Object.getOwnPropertySymbols},7839:function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7a23":function(t,e,r){"use strict";r.d(e,"t",(function(){return ft})),r.d(e,"u",(function(){return Tt})),r.d(e,"x",(function(){return Et})),r.d(e,"z",(function(){return At})),r.d(e,"y",(function(){return i["J"]})),r.d(e,"a",(function(){return ci})),r.d(e,"b",(function(){return rn})),r.d(e,"d",(function(){return _i})),r.d(e,"e",(function(){return ki})),r.d(e,"f",(function(){return Ai})),r.d(e,"g",(function(){return Ei})),r.d(e,"h",(function(){return He})),r.d(e,"i",(function(){return qi})),r.d(e,"j",(function(){return nn})),r.d(e,"k",(function(){return ke})),r.d(e,"l",(function(){return $t})),r.d(e,"m",(function(){return Ye})),r.d(e,"n",(function(){return Je})),r.d(e,"o",(function(){return cr})),r.d(e,"p",(function(){return mi})),r.d(e,"q",(function(){return ye})),r.d(e,"r",(function(){return Ae})),r.d(e,"s",(function(){return ge})),r.d(e,"v",(function(){return Di})),r.d(e,"w",(function(){return oi})),r.d(e,"B",(function(){return Oe})),r.d(e,"C",(function(){return qr})),r.d(e,"D",(function(){return ve})),r.d(e,"c",(function(){return uo})),r.d(e,"A",(function(){return ao}));var i=r("9ff4");const n=new WeakMap,o=[];let a;const s=Symbol(""),l=Symbol("");function c(t){return t&&!0===t._isEffect}function u(t,e=i["b"]){c(t)&&(t=t.raw);const r=d(t,e);return e.lazy||r(),r}function p(t){t.active&&(f(t),t.options.onStop&&t.options.onStop(),t.active=!1)}let h=0;function d(t,e){const r=function(){if(!r.active)return t();if(!o.includes(r)){f(r);try{return v(),o.push(r),a=r,t()}finally{o.pop(),_(),a=o[o.length-1]}}};return r.id=h++,r.allowRecurse=!!e.allowRecurse,r._isEffect=!0,r.active=!0,r.raw=t,r.deps=[],r.options=e,r}function f(t){const{deps:e}=t;if(e.length){for(let r=0;r<e.length;r++)e[r].delete(t);e.length=0}}let m=!0;const g=[];function y(){g.push(m),m=!1}function v(){g.push(m),m=!0}function _(){const t=g.pop();m=void 0===t||t}function x(t,e,r){if(!m||void 0===a)return;let i=n.get(t);i||n.set(t,i=new Map);let o=i.get(r);o||i.set(r,o=new Set),o.has(a)||(o.add(a),a.deps.push(o))}function b(t,e,r,o,c,u){const p=n.get(t);if(!p)return;const h=new Set,d=t=>{t&&t.forEach(t=>{(t!==a||t.allowRecurse)&&h.add(t)})};if("clear"===e)p.forEach(d);else if("length"===r&&Object(i["m"])(t))p.forEach((t,e)=>{("length"===e||e>=o)&&d(t)});else switch(void 0!==r&&d(p.get(r)),e){case"add":Object(i["m"])(t)?Object(i["q"])(r)&&d(p.get("length")):(d(p.get(s)),Object(i["r"])(t)&&d(p.get(l)));break;case"delete":Object(i["m"])(t)||(d(p.get(s)),Object(i["r"])(t)&&d(p.get(l)));break;case"set":Object(i["r"])(t)&&d(p.get(s));break}const f=t=>{t.options.scheduler?t.options.scheduler(t):t()};h.forEach(f)}const w=Object(i["F"])("__proto__,__v_isRef,__isVue"),S=new Set(Object.getOwnPropertyNames(Symbol).map(t=>Symbol[t]).filter(i["C"])),T=k(),E=k(!1,!0),I=k(!0),C=k(!0,!0),A={};function k(t=!1,e=!1){return function(r,n,o){if("__v_isReactive"===n)return!t;if("__v_isReadonly"===n)return t;if("__v_raw"===n&&o===(t?e?pt:ut:e?ct:lt).get(r))return r;const a=Object(i["m"])(r);if(!t&&a&&Object(i["j"])(A,n))return Reflect.get(A,n,o);const s=Reflect.get(r,n,o);if(Object(i["C"])(n)?S.has(n):w(n))return s;if(t||x(r,"get",n),e)return s;if(St(s)){const t=!a||!Object(i["q"])(n);return t?s.value:s}return Object(i["t"])(s)?t?gt(s):ft(s):s}}["includes","indexOf","lastIndexOf"].forEach(t=>{const e=Array.prototype[t];A[t]=function(...t){const r=bt(this);for(let e=0,n=this.length;e<n;e++)x(r,"get",e+"");const i=e.apply(r,t);return-1===i||!1===i?e.apply(r,t.map(bt)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{const e=Array.prototype[t];A[t]=function(...t){y();const r=e.apply(this,t);return _(),r}});const P=M(),O=M(!0);function M(t=!1){return function(e,r,n,o){let a=e[r];if(!t&&(n=bt(n),a=bt(a),!Object(i["m"])(e)&&St(a)&&!St(n)))return a.value=n,!0;const s=Object(i["m"])(e)&&Object(i["q"])(r)?Number(r)<e.length:Object(i["j"])(e,r),l=Reflect.set(e,r,n,o);return e===bt(o)&&(s?Object(i["i"])(n,a)&&b(e,"set",r,n,a):b(e,"add",r,n)),l}}function L(t,e){const r=Object(i["j"])(t,e),n=t[e],o=Reflect.deleteProperty(t,e);return o&&r&&b(t,"delete",e,void 0,n),o}function D(t,e){const r=Reflect.has(t,e);return Object(i["C"])(e)&&S.has(e)||x(t,"has",e),r}function R(t){return x(t,"iterate",Object(i["m"])(t)?"length":s),Reflect.ownKeys(t)}const z={get:T,set:P,deleteProperty:L,has:D,ownKeys:R},N={get:I,set(t,e){return!0},deleteProperty(t,e){return!0}},B=Object(i["h"])({},z,{get:E,set:O}),F=(Object(i["h"])({},N,{get:C}),t=>Object(i["t"])(t)?ft(t):t),j=t=>Object(i["t"])(t)?gt(t):t,U=t=>t,V=t=>Reflect.getPrototypeOf(t);function q(t,e,r=!1,i=!1){t=t["__v_raw"];const n=bt(t),o=bt(e);e!==o&&!r&&x(n,"get",e),!r&&x(n,"get",o);const{has:a}=V(n),s=i?U:r?j:F;return a.call(n,e)?s(t.get(e)):a.call(n,o)?s(t.get(o)):void(t!==n&&t.get(e))}function G(t,e=!1){const r=this["__v_raw"],i=bt(r),n=bt(t);return t!==n&&!e&&x(i,"has",t),!e&&x(i,"has",n),t===n?r.has(t):r.has(t)||r.has(n)}function Z(t,e=!1){return t=t["__v_raw"],!e&&x(bt(t),"iterate",s),Reflect.get(t,"size",t)}function H(t){t=bt(t);const e=bt(this),r=V(e),i=r.has.call(e,t);return i||(e.add(t),b(e,"add",t,t)),this}function W(t,e){e=bt(e);const r=bt(this),{has:n,get:o}=V(r);let a=n.call(r,t);a||(t=bt(t),a=n.call(r,t));const s=o.call(r,t);return r.set(t,e),a?Object(i["i"])(e,s)&&b(r,"set",t,e,s):b(r,"add",t,e),this}function K(t){const e=bt(this),{has:r,get:i}=V(e);let n=r.call(e,t);n||(t=bt(t),n=r.call(e,t));const o=i?i.call(e,t):void 0,a=e.delete(t);return n&&b(e,"delete",t,void 0,o),a}function X(){const t=bt(this),e=0!==t.size,r=void 0,i=t.clear();return e&&b(t,"clear",void 0,void 0,r),i}function Y(t,e){return function(r,i){const n=this,o=n["__v_raw"],a=bt(o),l=e?U:t?j:F;return!t&&x(a,"iterate",s),o.forEach((t,e)=>r.call(i,l(t),l(e),n))}}function J(t,e,r){return function(...n){const o=this["__v_raw"],a=bt(o),c=Object(i["r"])(a),u="entries"===t||t===Symbol.iterator&&c,p="keys"===t&&c,h=o[t](...n),d=r?U:e?j:F;return!e&&x(a,"iterate",p?l:s),{next(){const{value:t,done:e}=h.next();return e?{value:t,done:e}:{value:u?[d(t[0]),d(t[1])]:d(t),done:e}},[Symbol.iterator](){return this}}}}function $(t){return function(...e){return"delete"!==t&&this}}const Q={get(t){return q(this,t)},get size(){return Z(this)},has:G,add:H,set:W,delete:K,clear:X,forEach:Y(!1,!1)},tt={get(t){return q(this,t,!1,!0)},get size(){return Z(this)},has:G,add:H,set:W,delete:K,clear:X,forEach:Y(!1,!0)},et={get(t){return q(this,t,!0)},get size(){return Z(this,!0)},has(t){return G.call(this,t,!0)},add:$("add"),set:$("set"),delete:$("delete"),clear:$("clear"),forEach:Y(!0,!1)},rt={get(t){return q(this,t,!0,!0)},get size(){return Z(this,!0)},has(t){return G.call(this,t,!0)},add:$("add"),set:$("set"),delete:$("delete"),clear:$("clear"),forEach:Y(!0,!0)},it=["keys","values","entries",Symbol.iterator];function nt(t,e){const r=e?t?rt:tt:t?et:Q;return(e,n,o)=>"__v_isReactive"===n?!t:"__v_isReadonly"===n?t:"__v_raw"===n?e:Reflect.get(Object(i["j"])(r,n)&&n in e?r:e,n,o)}it.forEach(t=>{Q[t]=J(t,!1,!1),et[t]=J(t,!0,!1),tt[t]=J(t,!1,!0),rt[t]=J(t,!0,!0)});const ot={get:nt(!1,!1)},at={get:nt(!1,!0)},st={get:nt(!0,!1)};nt(!0,!0);const lt=new WeakMap,ct=new WeakMap,ut=new WeakMap,pt=new WeakMap;function ht(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function dt(t){return t["__v_skip"]||!Object.isExtensible(t)?0:ht(Object(i["M"])(t))}function ft(t){return t&&t["__v_isReadonly"]?t:yt(t,!1,z,ot,lt)}function mt(t){return yt(t,!1,B,at,ct)}function gt(t){return yt(t,!0,N,st,ut)}function yt(t,e,r,n,o){if(!Object(i["t"])(t))return t;if(t["__v_raw"]&&(!e||!t["__v_isReactive"]))return t;const a=o.get(t);if(a)return a;const s=dt(t);if(0===s)return t;const l=new Proxy(t,2===s?n:r);return o.set(t,l),l}function vt(t){return _t(t)?vt(t["__v_raw"]):!(!t||!t["__v_isReactive"])}function _t(t){return!(!t||!t["__v_isReadonly"])}function xt(t){return vt(t)||_t(t)}function bt(t){return t&&bt(t["__v_raw"])||t}const wt=t=>Object(i["t"])(t)?ft(t):t;function St(t){return Boolean(t&&!0===t.__v_isRef)}function Tt(t){return Ct(t)}function Et(t){return Ct(t,!0)}class It{constructor(t,e=!1){this._rawValue=t,this._shallow=e,this.__v_isRef=!0,this._value=e?t:wt(t)}get value(){return x(bt(this),"get","value"),this._value}set value(t){Object(i["i"])(bt(t),this._rawValue)&&(this._rawValue=t,this._value=this._shallow?t:wt(t),b(bt(this),"set","value",t))}}function Ct(t,e=!1){return St(t)?t:new It(t,e)}function At(t){return St(t)?t.value:t}const kt={get:(t,e,r)=>At(Reflect.get(t,e,r)),set:(t,e,r,i)=>{const n=t[e];return St(n)&&!St(r)?(n.value=r,!0):Reflect.set(t,e,r,i)}};function Pt(t){return vt(t)?t:new Proxy(t,kt)}class Ot{constructor(t,e){this._object=t,this._key=e,this.__v_isRef=!0}get value(){return this._object[this._key]}set value(t){this._object[this._key]=t}}function Mt(t,e){return St(t[e])?t[e]:new Ot(t,e)}class Lt{constructor(t,e,r){this._setter=e,this._dirty=!0,this.__v_isRef=!0,this.effect=u(t,{lazy:!0,scheduler:()=>{this._dirty||(this._dirty=!0,b(bt(this),"set","value"))}}),this["__v_isReadonly"]=r}get value(){const t=bt(this);return t._dirty&&(t._value=this.effect(),t._dirty=!1),x(t,"get","value"),t._value}set value(t){this._setter(t)}}function Dt(t){let e,r;return Object(i["n"])(t)?(e=t,r=i["d"]):(e=t.get,r=t.set),new Lt(e,r,Object(i["n"])(t)||!t.set)}function Rt(t,e,r,i){let n;try{n=i?t(...i):t()}catch(o){Nt(o,e,r)}return n}function zt(t,e,r,n){if(Object(i["n"])(t)){const o=Rt(t,e,r,n);return o&&Object(i["w"])(o)&&o.catch(t=>{Nt(t,e,r)}),o}const o=[];for(let i=0;i<t.length;i++)o.push(zt(t[i],e,r,n));return o}function Nt(t,e,r,i=!0){const n=e?e.vnode:null;if(e){let i=e.parent;const n=e.proxy,o=r;while(i){const e=i.ec;if(e)for(let r=0;r<e.length;r++)if(!1===e[r](t,n,o))return;i=i.parent}const a=e.appContext.config.errorHandler;if(a)return void Rt(a,null,10,[t,n,o])}Bt(t,r,n,i)}function Bt(t,e,r,i=!0){console.error(t)}let Ft=!1,jt=!1;const Ut=[];let Vt=0;const qt=[];let Gt=null,Zt=0;const Ht=[];let Wt=null,Kt=0;const Xt=Promise.resolve();let Yt=null,Jt=null;function $t(t){const e=Yt||Xt;return t?e.then(this?t.bind(this):t):e}function Qt(t){let e=Vt+1,r=Ut.length;const i=le(t);while(e<r){const t=e+r>>>1,n=le(Ut[t]);n<i?e=t+1:r=t}return e}function te(t){if((!Ut.length||!Ut.includes(t,Ft&&t.allowRecurse?Vt+1:Vt))&&t!==Jt){const e=Qt(t);e>-1?Ut.splice(e,0,t):Ut.push(t),ee()}}function ee(){Ft||jt||(jt=!0,Yt=Xt.then(ce))}function re(t){const e=Ut.indexOf(t);e>Vt&&Ut.splice(e,1)}function ie(t,e,r,n){Object(i["m"])(t)?r.push(...t):e&&e.includes(t,t.allowRecurse?n+1:n)||r.push(t),ee()}function ne(t){ie(t,Gt,qt,Zt)}function oe(t){ie(t,Wt,Ht,Kt)}function ae(t,e=null){if(qt.length){for(Jt=e,Gt=[...new Set(qt)],qt.length=0,Zt=0;Zt<Gt.length;Zt++)Gt[Zt]();Gt=null,Zt=0,Jt=null,ae(t,e)}}function se(t){if(Ht.length){const t=[...new Set(Ht)];if(Ht.length=0,Wt)return void Wt.push(...t);for(Wt=t,Wt.sort((t,e)=>le(t)-le(e)),Kt=0;Kt<Wt.length;Kt++)Wt[Kt]();Wt=null,Kt=0}}const le=t=>null==t.id?1/0:t.id;function ce(t){jt=!1,Ft=!0,ae(t),Ut.sort((t,e)=>le(t)-le(e));try{for(Vt=0;Vt<Ut.length;Vt++){const t=Ut[Vt];t&&!1!==t.active&&Rt(t,null,14)}}finally{Vt=0,Ut.length=0,se(t),Ft=!1,Yt=null,(Ut.length||qt.length||Ht.length)&&ce(t)}}new Set;new Map;Object.create(null),Object.create(null);function ue(t,e,...r){const n=t.vnode.props||i["b"];let o=r;const a=e.startsWith("update:"),s=a&&e.slice(7);if(s&&s in n){const t=("modelValue"===s?"model":s)+"Modifiers",{number:e,trim:a}=n[t]||i["b"];a?o=r.map(t=>t.trim()):e&&(o=r.map(i["L"]))}let l;let c=n[l=Object(i["K"])(e)]||n[l=Object(i["K"])(Object(i["e"])(e))];!c&&a&&(c=n[l=Object(i["K"])(Object(i["k"])(e))]),c&&zt(c,t,6,o);const u=n[l+"Once"];if(u){if(t.emitted){if(t.emitted[l])return}else(t.emitted={})[l]=!0;zt(u,t,6,o)}}function pe(t,e,r=!1){const n=e.emitsCache,o=n.get(t);if(void 0!==o)return o;const a=t.emits;let s={},l=!1;if(!Object(i["n"])(t)){const n=t=>{const r=pe(t,e,!0);r&&(l=!0,Object(i["h"])(s,r))};!r&&e.mixins.length&&e.mixins.forEach(n),t.extends&&n(t.extends),t.mixins&&t.mixins.forEach(n)}return a||l?(Object(i["m"])(a)?a.forEach(t=>s[t]=null):Object(i["h"])(s,a),n.set(t,s),s):(n.set(t,null),null)}function he(t,e){return!(!t||!Object(i["u"])(e))&&(e=e.slice(2).replace(/Once$/,""),Object(i["j"])(t,e[0].toLowerCase()+e.slice(1))||Object(i["j"])(t,Object(i["k"])(e))||Object(i["j"])(t,e))}let de=null,fe=null;function me(t){const e=de;return de=t,fe=t&&t.type.__scopeId||null,e}function ge(t){fe=t}function ye(){fe=null}const ve=t=>_e;function _e(t,e=de,r){if(!e)return t;if(t._n)return t;const i=(...r)=>{i._d&&vi(-1);const n=me(e),o=t(...r);return me(n),i._d&&vi(1),o};return i._n=!0,i._c=!0,i._d=!0,i}function xe(t){const{type:e,vnode:r,proxy:n,withProxy:o,props:a,propsOptions:[s],slots:l,attrs:c,emit:u,render:p,renderCache:h,data:d,setupState:f,ctx:m,inheritAttrs:g}=t;let y;const v=me(t);try{let t;if(4&r.shapeFlag){const e=o||n;y=Pi(p.call(e,e,h,a,f,d,m)),t=c}else{const r=e;0,y=Pi(r.length>1?r(a,{attrs:c,slots:l,emit:u}):r(a,null)),t=e.props?c:be(c)}let v=y;if(t&&!1!==g){const e=Object.keys(t),{shapeFlag:r}=v;e.length&&(1&r||6&r)&&(s&&e.some(i["s"])&&(t=we(t,s)),v=Ci(v,t))}0,r.dirs&&(v.dirs=v.dirs?v.dirs.concat(r.dirs):r.dirs),r.transition&&(v.transition=r.transition),y=v}catch(_){di.length=0,Nt(_,t,1),y=Ei(pi)}return me(v),y}const be=t=>{let e;for(const r in t)("class"===r||"style"===r||Object(i["u"])(r))&&((e||(e={}))[r]=t[r]);return e},we=(t,e)=>{const r={};for(const n in t)Object(i["s"])(n)&&n.slice(9)in e||(r[n]=t[n]);return r};function Se(t,e,r){const{props:i,children:n,component:o}=t,{props:a,children:s,patchFlag:l}=e,c=o.emitsOptions;if(e.dirs||e.transition)return!0;if(!(r&&l>=0))return!(!n&&!s||s&&s.$stable)||i!==a&&(i?!a||Te(i,a,c):!!a);if(1024&l)return!0;if(16&l)return i?Te(i,a,c):!!a;if(8&l){const t=e.dynamicProps;for(let e=0;e<t.length;e++){const r=t[e];if(a[r]!==i[r]&&!he(c,r))return!0}}return!1}function Te(t,e,r){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let n=0;n<i.length;n++){const o=i[n];if(e[o]!==t[o]&&!he(r,o))return!0}return!1}function Ee({vnode:t,parent:e},r){while(e&&e.subTree===t)(t=e.vnode).el=r,e=e.parent}const Ie=t=>t.__isSuspense;function Ce(t,e){e&&e.pendingBranch?Object(i["m"])(t)?e.effects.push(...t):e.effects.push(t):oe(t)}function Ae(t,e){if(Vi){let r=Vi.provides;const i=Vi.parent&&Vi.parent.provides;i===r&&(r=Vi.provides=Object.create(i)),r[t]=e}else 0}function ke(t,e,r=!1){const n=Vi||de;if(n){const o=null==n.parent?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(o&&t in o)return o[t];if(arguments.length>1)return r&&Object(i["n"])(e)?e():e}else 0}const Pe={};function Oe(t,e,r){return Me(t,e,r)}function Me(t,e,{immediate:r,deep:n,flush:o,onTrack:a,onTrigger:s}=i["b"],l=Vi){let c,h,d=!1,f=!1;if(St(t)?(c=()=>t.value,d=!!t._shallow):vt(t)?(c=()=>t,n=!0):Object(i["m"])(t)?(f=!0,d=t.some(vt),c=()=>t.map(t=>St(t)?t.value:vt(t)?Re(t):Object(i["n"])(t)?Rt(t,l,2):void 0)):c=Object(i["n"])(t)?e?()=>Rt(t,l,2):()=>{if(!l||!l.isUnmounted)return h&&h(),zt(t,l,3,[m])}:i["d"],e&&n){const t=c;c=()=>Re(t())}let m=t=>{h=_.options.onStop=()=>{Rt(t,l,4)}},g=f?[]:Pe;const y=()=>{if(_.active)if(e){const t=_();(n||d||(f?t.some((t,e)=>Object(i["i"])(t,g[e])):Object(i["i"])(t,g)))&&(h&&h(),zt(e,l,3,[t,g===Pe?void 0:g,m]),g=t)}else _()};let v;y.allowRecurse=!!e,v="sync"===o?y:"post"===o?()=>Yr(y,l&&l.suspense):()=>{!l||l.isMounted?ne(y):y()};const _=u(c,{lazy:!0,onTrack:a,onTrigger:s,scheduler:v});return Qi(_,l),e?r?y():g=_():"post"===o?Yr(_,l&&l.suspense):_(),()=>{p(_),l&&Object(i["I"])(l.effects,_)}}function Le(t,e,r){const n=this.proxy,o=Object(i["B"])(t)?t.includes(".")?De(n,t):()=>n[t]:t.bind(n,n);let a;return Object(i["n"])(e)?a=e:(a=e.handler,r=e),Me(o,a.bind(n),r,this)}function De(t,e){const r=e.split(".");return()=>{let e=t;for(let t=0;t<r.length&&e;t++)e=e[r[t]];return e}}function Re(t,e=new Set){if(!Object(i["t"])(t)||e.has(t)||t["__v_skip"])return t;if(e.add(t),St(t))Re(t.value,e);else if(Object(i["m"])(t))for(let r=0;r<t.length;r++)Re(t[r],e);else if(Object(i["z"])(t)||Object(i["r"])(t))t.forEach(t=>{Re(t,e)});else if(Object(i["v"])(t))for(const r in t)Re(t[r],e);return t}function ze(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return or(()=>{t.isMounted=!0}),lr(()=>{t.isUnmounting=!0}),t}const Ne=[Function,Array],Be={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ne,onEnter:Ne,onAfterEnter:Ne,onEnterCancelled:Ne,onBeforeLeave:Ne,onLeave:Ne,onAfterLeave:Ne,onLeaveCancelled:Ne,onBeforeAppear:Ne,onAppear:Ne,onAfterAppear:Ne,onAppearCancelled:Ne},setup(t,{slots:e}){const r=qi(),i=ze();let n;return()=>{const o=e.default&&Ze(e.default(),!0);if(!o||!o.length)return;const a=bt(t),{mode:s}=a;const l=o[0];if(i.isLeaving)return Ve(l);const c=qe(l);if(!c)return Ve(l);const u=Ue(c,a,i,r);Ge(c,u);const p=r.subTree,h=p&&qe(p);let d=!1;const{getTransitionKey:f}=c.type;if(f){const t=f();void 0===n?n=t:t!==n&&(n=t,d=!0)}if(h&&h.type!==pi&&(!bi(c,h)||d)){const t=Ue(h,a,i,r);if(Ge(h,t),"out-in"===s)return i.isLeaving=!0,t.afterLeave=()=>{i.isLeaving=!1,r.update()},Ve(l);"in-out"===s&&c.type!==pi&&(t.delayLeave=(t,e,r)=>{const n=je(i,h);n[String(h.key)]=h,t._leaveCb=()=>{e(),t._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=r})}return l}}},Fe=Be;function je(t,e){const{leavingVNodes:r}=t;let i=r.get(e.type);return i||(i=Object.create(null),r.set(e.type,i)),i}function Ue(t,e,r,i){const{appear:n,mode:o,persisted:a=!1,onBeforeEnter:s,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:p,onLeave:h,onAfterLeave:d,onLeaveCancelled:f,onBeforeAppear:m,onAppear:g,onAfterAppear:y,onAppearCancelled:v}=e,_=String(t.key),x=je(r,t),b=(t,e)=>{t&&zt(t,i,9,e)},w={mode:o,persisted:a,beforeEnter(e){let i=s;if(!r.isMounted){if(!n)return;i=m||s}e._leaveCb&&e._leaveCb(!0);const o=x[_];o&&bi(t,o)&&o.el._leaveCb&&o.el._leaveCb(),b(i,[e])},enter(t){let e=l,i=c,o=u;if(!r.isMounted){if(!n)return;e=g||l,i=y||c,o=v||u}let a=!1;const s=t._enterCb=e=>{a||(a=!0,b(e?o:i,[t]),w.delayedLeave&&w.delayedLeave(),t._enterCb=void 0)};e?(e(t,s),e.length<=1&&s()):s()},leave(e,i){const n=String(t.key);if(e._enterCb&&e._enterCb(!0),r.isUnmounting)return i();b(p,[e]);let o=!1;const a=e._leaveCb=r=>{o||(o=!0,i(),b(r?f:d,[e]),e._leaveCb=void 0,x[n]===t&&delete x[n])};x[n]=t,h?(h(e,a),h.length<=1&&a()):a()},clone(t){return Ue(t,e,r,i)}};return w}function Ve(t){if(Ke(t))return t=Ci(t),t.children=null,t}function qe(t){return Ke(t)?t.children?t.children[0]:void 0:t}function Ge(t,e){6&t.shapeFlag&&t.component?Ge(t.component.subTree,e):128&t.shapeFlag?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Ze(t,e=!1){let r=[],i=0;for(let n=0;n<t.length;n++){const o=t[n];o.type===ci?(128&o.patchFlag&&i++,r=r.concat(Ze(o.children,e))):(e||o.type!==pi)&&r.push(o)}if(i>1)for(let n=0;n<r.length;n++)r[n].patchFlag=-2;return r}function He(t){return Object(i["n"])(t)?{setup:t,name:t.name}:t}const We=t=>!!t.type.__asyncLoader;const Ke=t=>t.type.__isKeepAlive;RegExp,RegExp;function Xe(t,e){return Object(i["m"])(t)?t.some(t=>Xe(t,e)):Object(i["B"])(t)?t.split(",").indexOf(e)>-1:!!t.test&&t.test(e)}function Ye(t,e){$e(t,"a",e)}function Je(t,e){$e(t,"da",e)}function $e(t,e,r=Vi){const i=t.__wdc||(t.__wdc=()=>{let e=r;while(e){if(e.isDeactivated)return;e=e.parent}t()});if(rr(e,i,r),r){let t=r.parent;while(t&&t.parent)Ke(t.parent.vnode)&&Qe(i,e,r,t),t=t.parent}}function Qe(t,e,r,n){const o=rr(e,t,n,!0);cr(()=>{Object(i["I"])(n[e],o)},r)}function tr(t){let e=t.shapeFlag;256&e&&(e-=256),512&e&&(e-=512),t.shapeFlag=e}function er(t){return 128&t.shapeFlag?t.ssContent:t}function rr(t,e,r=Vi,i=!1){if(r){const n=r[t]||(r[t]=[]),o=e.__weh||(e.__weh=(...i)=>{if(r.isUnmounted)return;y(),Gi(r);const n=zt(e,r,t,i);return Gi(null),_(),n});return i?n.unshift(o):n.push(o),o}}const ir=t=>(e,r=Vi)=>(!Wi||"sp"===t)&&rr(t,e,r),nr=ir("bm"),or=ir("m"),ar=ir("bu"),sr=ir("u"),lr=ir("bum"),cr=ir("um"),ur=ir("sp"),pr=ir("rtg"),hr=ir("rtc");function dr(t,e=Vi){rr("ec",t,e)}let fr=!0;function mr(t){const e=_r(t),r=t.proxy,n=t.ctx;fr=!1,e.beforeCreate&&yr(e.beforeCreate,t,"bc");const{data:o,computed:a,methods:s,watch:l,provide:c,inject:u,created:p,beforeMount:h,mounted:d,beforeUpdate:f,updated:m,activated:g,deactivated:y,beforeDestroy:v,beforeUnmount:_,destroyed:x,unmounted:b,render:w,renderTracked:S,renderTriggered:T,errorCaptured:E,serverPrefetch:I,expose:C,inheritAttrs:A,components:k,directives:P,filters:O}=e,M=null;if(u&&gr(u,n,M),s)for(const D in s){const t=s[D];Object(i["n"])(t)&&(n[D]=t.bind(r))}if(o){0;const e=o.call(r,r);0,Object(i["t"])(e)&&(t.data=ft(e))}if(fr=!0,a)for(const D in a){const t=a[D],e=Object(i["n"])(t)?t.bind(r,r):Object(i["n"])(t.get)?t.get.bind(r,r):i["d"];0;const o=!Object(i["n"])(t)&&Object(i["n"])(t.set)?t.set.bind(r):i["d"],s=rn({get:e,set:o});Object.defineProperty(n,D,{enumerable:!0,configurable:!0,get:()=>s.value,set:t=>s.value=t})}if(l)for(const i in l)vr(l[i],n,r,i);if(c){const t=Object(i["n"])(c)?c.call(r):c;Reflect.ownKeys(t).forEach(e=>{Ae(e,t[e])})}function L(t,e){Object(i["m"])(e)?e.forEach(e=>t(e.bind(r))):e&&t(e.bind(r))}if(p&&yr(p,t,"c"),L(nr,h),L(or,d),L(ar,f),L(sr,m),L(Ye,g),L(Je,y),L(dr,E),L(hr,S),L(pr,T),L(lr,_),L(cr,b),L(ur,I),Object(i["m"])(C))if(C.length){const e=t.exposed||(t.exposed=Pt({}));C.forEach(t=>{e[t]=Mt(r,t)})}else t.exposed||(t.exposed=i["b"]);w&&t.render===i["d"]&&(t.render=w),null!=A&&(t.inheritAttrs=A),k&&(t.components=k),P&&(t.directives=P)}function gr(t,e,r=i["d"]){Object(i["m"])(t)&&(t=Tr(t));for(const n in t){const r=t[n];Object(i["t"])(r)?e[n]="default"in r?ke(r.from||n,r.default,!0):ke(r.from||n):e[n]=ke(r)}}function yr(t,e,r){zt(Object(i["m"])(t)?t.map(t=>t.bind(e.proxy)):t.bind(e.proxy),e,r)}function vr(t,e,r,n){const o=n.includes(".")?De(r,n):()=>r[n];if(Object(i["B"])(t)){const r=e[t];Object(i["n"])(r)&&Oe(o,r)}else if(Object(i["n"])(t))Oe(o,t.bind(r));else if(Object(i["t"])(t))if(Object(i["m"])(t))t.forEach(t=>vr(t,e,r,n));else{const n=Object(i["n"])(t.handler)?t.handler.bind(r):e[t.handler];Object(i["n"])(n)&&Oe(o,n,t)}else 0}function _r(t){const e=t.type,{mixins:r,extends:i}=e,{mixins:n,optionsCache:o,config:{optionMergeStrategies:a}}=t.appContext,s=o.get(e);let l;return s?l=s:n.length||r||i?(l={},n.length&&n.forEach(t=>xr(l,t,a,!0)),xr(l,e,a)):l=e,o.set(e,l),l}function xr(t,e,r,i=!1){const{mixins:n,extends:o}=e;o&&xr(t,o,r,!0),n&&n.forEach(e=>xr(t,e,r,!0));for(const a in e)if(i&&"expose"===a);else{const i=br[a]||r&&r[a];t[a]=i?i(t[a],e[a]):e[a]}return t}const br={data:wr,props:Ir,emits:Ir,methods:Ir,computed:Ir,beforeCreate:Er,created:Er,beforeMount:Er,mounted:Er,beforeUpdate:Er,updated:Er,beforeDestroy:Er,destroyed:Er,activated:Er,deactivated:Er,errorCaptured:Er,serverPrefetch:Er,components:Ir,directives:Ir,watch:Ir,provide:wr,inject:Sr};function wr(t,e){return e?t?function(){return Object(i["h"])(Object(i["n"])(t)?t.call(this,this):t,Object(i["n"])(e)?e.call(this,this):e)}:e:t}function Sr(t,e){return Ir(Tr(t),Tr(e))}function Tr(t){if(Object(i["m"])(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function Er(t,e){return t?[...new Set([].concat(t,e))]:e}function Ir(t,e){return t?Object(i["h"])(Object(i["h"])(Object.create(null),t),e):e}function Cr(t,e,r,n=!1){const o={},a={};Object(i["g"])(a,wi,1),t.propsDefaults=Object.create(null),kr(t,e,o,a);for(const i in t.propsOptions[0])i in o||(o[i]=void 0);r?t.props=n?o:mt(o):t.type.props?t.props=o:t.props=a,t.attrs=a}function Ar(t,e,r,n){const{props:o,attrs:a,vnode:{patchFlag:s}}=t,l=bt(o),[c]=t.propsOptions;let u=!1;if(!(n||s>0)||16&s){let n;kr(t,e,o,a)&&(u=!0);for(const a in l)e&&(Object(i["j"])(e,a)||(n=Object(i["k"])(a))!==a&&Object(i["j"])(e,n))||(c?!r||void 0===r[a]&&void 0===r[n]||(o[a]=Pr(c,l,a,void 0,t,!0)):delete o[a]);if(a!==l)for(const t in a)e&&Object(i["j"])(e,t)||(delete a[t],u=!0)}else if(8&s){const r=t.vnode.dynamicProps;for(let n=0;n<r.length;n++){let s=r[n];const p=e[s];if(c)if(Object(i["j"])(a,s))p!==a[s]&&(a[s]=p,u=!0);else{const e=Object(i["e"])(s);o[e]=Pr(c,l,e,p,t,!1)}else p!==a[s]&&(a[s]=p,u=!0)}}u&&b(t,"set","$attrs")}function kr(t,e,r,n){const[o,a]=t.propsOptions;let s,l=!1;if(e)for(let c in e){if(Object(i["x"])(c))continue;const u=e[c];let p;o&&Object(i["j"])(o,p=Object(i["e"])(c))?a&&a.includes(p)?(s||(s={}))[p]=u:r[p]=u:he(t.emitsOptions,c)||u!==n[c]&&(n[c]=u,l=!0)}if(a){const e=bt(r),n=s||i["b"];for(let s=0;s<a.length;s++){const l=a[s];r[l]=Pr(o,e,l,n[l],t,!Object(i["j"])(n,l))}}return l}function Pr(t,e,r,n,o,a){const s=t[r];if(null!=s){const t=Object(i["j"])(s,"default");if(t&&void 0===n){const t=s.default;if(s.type!==Function&&Object(i["n"])(t)){const{propsDefaults:i}=o;r in i?n=i[r]:(Gi(o),n=i[r]=t.call(null,e),Gi(null))}else n=t}s[0]&&(a&&!t?n=!1:!s[1]||""!==n&&n!==Object(i["k"])(r)||(n=!0))}return n}function Or(t,e,r=!1){const n=e.propsCache,o=n.get(t);if(o)return o;const a=t.props,s={},l=[];let c=!1;if(!Object(i["n"])(t)){const n=t=>{c=!0;const[r,n]=Or(t,e,!0);Object(i["h"])(s,r),n&&l.push(...n)};!r&&e.mixins.length&&e.mixins.forEach(n),t.extends&&n(t.extends),t.mixins&&t.mixins.forEach(n)}if(!a&&!c)return n.set(t,i["a"]),i["a"];if(Object(i["m"])(a))for(let p=0;p<a.length;p++){0;const t=Object(i["e"])(a[p]);Mr(t)&&(s[t]=i["b"])}else if(a){0;for(const t in a){const e=Object(i["e"])(t);if(Mr(e)){const r=a[t],n=s[e]=Object(i["m"])(r)||Object(i["n"])(r)?{type:r}:r;if(n){const t=Rr(Boolean,n.type),r=Rr(String,n.type);n[0]=t>-1,n[1]=r<0||t<r,(t>-1||Object(i["j"])(n,"default"))&&l.push(e)}}}}const u=[s,l];return n.set(t,u),u}function Mr(t){return"$"!==t[0]}function Lr(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:""}function Dr(t,e){return Lr(t)===Lr(e)}function Rr(t,e){return Object(i["m"])(e)?e.findIndex(e=>Dr(e,t)):Object(i["n"])(e)&&Dr(e,t)?0:-1}const zr=t=>"_"===t[0]||"$stable"===t,Nr=t=>Object(i["m"])(t)?t.map(Pi):[Pi(t)],Br=(t,e,r)=>{const i=_e(t=>Nr(e(t)),r);return i._c=!1,i},Fr=(t,e,r)=>{const n=t._ctx;for(const o in t){if(zr(o))continue;const r=t[o];if(Object(i["n"])(r))e[o]=Br(o,r,n);else if(null!=r){0;const t=Nr(r);e[o]=()=>t}}},jr=(t,e)=>{const r=Nr(e);t.slots.default=()=>r},Ur=(t,e)=>{if(32&t.vnode.shapeFlag){const r=e._;r?(t.slots=bt(e),Object(i["g"])(e,"_",r)):Fr(e,t.slots={})}else t.slots={},e&&jr(t,e);Object(i["g"])(t.slots,wi,1)},Vr=(t,e,r)=>{const{vnode:n,slots:o}=t;let a=!0,s=i["b"];if(32&n.shapeFlag){const t=e._;t?r&&1===t?a=!1:(Object(i["h"])(o,e),r||1!==t||delete o._):(a=!e.$stable,Fr(e,o)),s=e}else e&&(jr(t,e),s={default:1});if(a)for(const i in o)zr(i)||i in s||delete o[i]};function qr(t,e){const r=de;if(null===r)return t;const n=r.proxy,o=t.dirs||(t.dirs=[]);for(let a=0;a<e.length;a++){let[t,r,s,l=i["b"]]=e[a];Object(i["n"])(t)&&(t={mounted:t,updated:t}),o.push({dir:t,instance:n,value:r,oldValue:void 0,arg:s,modifiers:l})}return t}function Gr(t,e,r,i){const n=t.dirs,o=e&&e.dirs;for(let a=0;a<n.length;a++){const s=n[a];o&&(s.oldValue=o[a].value);let l=s.dir[i];l&&(y(),zt(l,r,8,[t.el,s,t,e]),_())}}function Zr(){return{app:null,config:{isNativeTag:i["c"],performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Hr=0;function Wr(t,e){return function(r,n=null){null==n||Object(i["t"])(n)||(n=null);const o=Zr(),a=new Set;let s=!1;const l=o.app={_uid:Hr++,_component:r,_props:n,_container:null,_context:o,version:on,get config(){return o.config},set config(t){0},use(t,...e){return a.has(t)||(t&&Object(i["n"])(t.install)?(a.add(t),t.install(l,...e)):Object(i["n"])(t)&&(a.add(t),t(l,...e))),l},mixin(t){return o.mixins.includes(t)||o.mixins.push(t),l},component(t,e){return e?(o.components[t]=e,l):o.components[t]},directive(t,e){return e?(o.directives[t]=e,l):o.directives[t]},mount(i,a,c){if(!s){const u=Ei(r,n);return u.appContext=o,a&&e?e(u,i):t(u,i,c),s=!0,l._container=i,i.__vue_app__=l,u.component.proxy}},unmount(){s&&(t(null,l._container),delete l._container.__vue_app__)},provide(t,e){return o.provides[t]=e,l}};return l}}function Kr(){}const Xr={scheduler:te,allowRecurse:!0};const Yr=Ce,Jr=(t,e,r,n,o=!1)=>{if(Object(i["m"])(t))return void t.forEach((t,a)=>Jr(t,e&&(Object(i["m"])(e)?e[a]:e),r,n,o));if(We(n)&&!o)return;const a=4&n.shapeFlag?n.component.exposed||n.component.proxy:n.el,s=o?null:a,{i:l,r:c}=t;const u=e&&e.r,p=l.refs===i["b"]?l.refs={}:l.refs,h=l.setupState;if(null!=u&&u!==c&&(Object(i["B"])(u)?(p[u]=null,Object(i["j"])(h,u)&&(h[u]=null)):St(u)&&(u.value=null)),Object(i["B"])(c)){const t=()=>{p[c]=s,Object(i["j"])(h,c)&&(h[c]=s)};s?(t.id=-1,Yr(t,r)):t()}else if(St(c)){const t=()=>{c.value=s};s?(t.id=-1,Yr(t,r)):t()}else Object(i["n"])(c)&&Rt(c,l,12,[s,p])};function $r(t){return Qr(t)}function Qr(t,e){Kr();const{insert:r,remove:n,patchProp:o,forcePatchProp:a,createElement:s,createText:l,createComment:c,setText:h,setElementText:d,parentNode:f,nextSibling:m,setScopeId:g=i["d"],cloneNode:v,insertStaticContent:x}=t,b=(t,e,r,i=null,n=null,o=null,a=!1,s=null,l=!1)=>{t&&!bi(t,e)&&(i=X(t),G(t,n,o,!0),t=null),-2===e.patchFlag&&(l=!1,e.dynamicChildren=null);const{type:c,ref:u,shapeFlag:p}=e;switch(c){case ui:w(t,e,r,i);break;case pi:S(t,e,r,i);break;case hi:null==t&&T(e,r,i,a);break;case ci:D(t,e,r,i,n,o,a,s,l);break;default:1&p?C(t,e,r,i,n,o,a,s,l):6&p?R(t,e,r,i,n,o,a,s,l):(64&p||128&p)&&c.process(t,e,r,i,n,o,a,s,l,J)}null!=u&&n&&Jr(u,t&&t.ref,o,e||t,!e)},w=(t,e,i,n)=>{if(null==t)r(e.el=l(e.children),i,n);else{const r=e.el=t.el;e.children!==t.children&&h(r,e.children)}},S=(t,e,i,n)=>{null==t?r(e.el=c(e.children||""),i,n):e.el=t.el},T=(t,e,r,i)=>{[t.el,t.anchor]=x(t.children,e,r,i)},E=({el:t,anchor:e},i,n)=>{let o;while(t&&t!==e)o=m(t),r(t,i,n),t=o;r(e,i,n)},I=({el:t,anchor:e})=>{let r;while(t&&t!==e)r=m(t),n(t),t=r;n(e)},C=(t,e,r,i,n,o,a,s,l)=>{a=a||"svg"===e.type,null==t?A(e,r,i,n,o,a,s,l):O(t,e,n,o,a,s,l)},A=(t,e,n,a,l,c,u,p)=>{let h,f;const{type:m,props:g,shapeFlag:y,transition:_,patchFlag:x,dirs:b}=t;if(t.el&&void 0!==v&&-1===x)h=t.el=v(t.el);else{if(h=t.el=s(t.type,c,g&&g.is,g),8&y?d(h,t.children):16&y&&P(t.children,h,null,a,l,c&&"foreignObject"!==m,u,p||!!t.dynamicChildren),b&&Gr(t,null,a,"created"),g){for(const e in g)Object(i["x"])(e)||o(h,e,null,g[e],c,t.children,a,l,K);(f=g.onVnodeBeforeMount)&&ti(f,a,t)}k(h,t,t.scopeId,u,a)}b&&Gr(t,null,a,"beforeMount");const w=(!l||l&&!l.pendingBranch)&&_&&!_.persisted;w&&_.beforeEnter(h),r(h,e,n),((f=g&&g.onVnodeMounted)||w||b)&&Yr(()=>{f&&ti(f,a,t),w&&_.enter(h),b&&Gr(t,null,a,"mounted")},l)},k=(t,e,r,i,n)=>{if(r&&g(t,r),i)for(let o=0;o<i.length;o++)g(t,i[o]);if(n){let r=n.subTree;if(e===r){const e=n.vnode;k(t,e,e.scopeId,e.slotScopeIds,n.parent)}}},P=(t,e,r,i,n,o,a,s,l=0)=>{for(let c=l;c<t.length;c++){const l=t[c]=s?Oi(t[c]):Pi(t[c]);b(null,l,e,r,i,n,o,a,s)}},O=(t,e,r,n,s,l,c)=>{const u=e.el=t.el;let{patchFlag:p,dynamicChildren:h,dirs:f}=e;p|=16&t.patchFlag;const m=t.props||i["b"],g=e.props||i["b"];let y;if((y=g.onVnodeBeforeUpdate)&&ti(y,r,e,t),f&&Gr(e,t,r,"beforeUpdate"),p>0){if(16&p)L(u,e,m,g,r,n,s);else if(2&p&&m.class!==g.class&&o(u,"class",null,g.class,s),4&p&&o(u,"style",m.style,g.style,s),8&p){const i=e.dynamicProps;for(let e=0;e<i.length;e++){const l=i[e],c=m[l],p=g[l];(p!==c||a&&a(u,l))&&o(u,l,c,p,s,t.children,r,n,K)}}1&p&&t.children!==e.children&&d(u,e.children)}else c||null!=h||L(u,e,m,g,r,n,s);const v=s&&"foreignObject"!==e.type;h?M(t.dynamicChildren,h,u,r,n,v,l):c||j(t,e,u,null,r,n,v,l,!1),((y=g.onVnodeUpdated)||f)&&Yr(()=>{y&&ti(y,r,e,t),f&&Gr(e,t,r,"updated")},n)},M=(t,e,r,i,n,o,a)=>{for(let s=0;s<e.length;s++){const l=t[s],c=e[s],u=l.el&&(l.type===ci||!bi(l,c)||6&l.shapeFlag||64&l.shapeFlag)?f(l.el):r;b(l,c,u,null,i,n,o,a,!0)}},L=(t,e,r,n,s,l,c)=>{if(r!==n){for(const u in n){if(Object(i["x"])(u))continue;const p=n[u],h=r[u];(p!==h||a&&a(t,u))&&o(t,u,h,p,c,e.children,s,l,K)}if(r!==i["b"])for(const a in r)Object(i["x"])(a)||a in n||o(t,a,r[a],null,c,e.children,s,l,K)}},D=(t,e,i,n,o,a,s,c,u)=>{const p=e.el=t?t.el:l(""),h=e.anchor=t?t.anchor:l("");let{patchFlag:d,dynamicChildren:f,slotScopeIds:m}=e;f&&(u=!0),m&&(c=c?c.concat(m):m),null==t?(r(p,i,n),r(h,i,n),P(e.children,i,h,o,a,s,c,u)):d>0&&64&d&&f&&t.dynamicChildren?(M(t.dynamicChildren,f,i,o,a,s,c),(null!=e.key||o&&e===o.subTree)&&ei(t,e,!0)):j(t,e,i,h,o,a,s,c,u)},R=(t,e,r,i,n,o,a,s,l)=>{e.slotScopeIds=s,null==t?512&e.shapeFlag?n.ctx.activate(e,r,i,a,l):z(e,r,i,n,o,a,l):N(t,e,l)},z=(t,e,r,i,n,o,a)=>{const s=t.component=Ui(t,i,n);if(Ke(t)&&(s.ctx.renderer=J),Ki(s),s.asyncDep){if(n&&n.registerDep(s,B),!t.el){const t=s.subTree=Ei(pi);S(null,t,e,r)}}else B(s,t,e,r,n,o,a)},N=(t,e,r)=>{const i=e.component=t.component;if(Se(t,e,r)){if(i.asyncDep&&!i.asyncResolved)return void F(i,e,r);i.next=e,re(i.update),i.update()}else e.component=t.component,e.el=t.el,i.vnode=e},B=(t,e,r,n,o,a,s)=>{t.update=u((function(){if(t.isMounted){let e,{next:r,bu:n,u:l,parent:c,vnode:u}=t,p=r;0,r?(r.el=u.el,F(t,r,s)):r=u,n&&Object(i["l"])(n),(e=r.props&&r.props.onVnodeBeforeUpdate)&&ti(e,c,r,u);const h=xe(t);0;const d=t.subTree;t.subTree=h,b(d,h,f(d.el),X(d),t,o,a),r.el=h.el,null===p&&Ee(t,h.el),l&&Yr(l,o),(e=r.props&&r.props.onVnodeUpdated)&&Yr(()=>ti(e,c,r,u),o)}else{let s;const{el:l,props:c}=e,{bm:u,m:p,parent:h}=t;if(u&&Object(i["l"])(u),(s=c&&c.onVnodeBeforeMount)&&ti(s,h,e),l&&Q){const r=()=>{t.subTree=xe(t),Q(l,t.subTree,t,o,null)};We(e)?e.type.__asyncLoader().then(()=>!t.isUnmounted&&r()):r()}else{0;const i=t.subTree=xe(t);0,b(null,i,r,n,t,o,a),e.el=i.el}if(p&&Yr(p,o),s=c&&c.onVnodeMounted){const t=e;Yr(()=>ti(s,h,t),o)}256&e.shapeFlag&&t.a&&Yr(t.a,o),t.isMounted=!0,e=r=n=null}}),Xr)},F=(t,e,r)=>{e.component=t;const i=t.vnode.props;t.vnode=e,t.next=null,Ar(t,e.props,i,r),Vr(t,e.children,r),y(),ae(void 0,t.update),_()},j=(t,e,r,i,n,o,a,s,l=!1)=>{const c=t&&t.children,u=t?t.shapeFlag:0,p=e.children,{patchFlag:h,shapeFlag:f}=e;if(h>0){if(128&h)return void V(c,p,r,i,n,o,a,s,l);if(256&h)return void U(c,p,r,i,n,o,a,s,l)}8&f?(16&u&&K(c,n,o),p!==c&&d(r,p)):16&u?16&f?V(c,p,r,i,n,o,a,s,l):K(c,n,o,!0):(8&u&&d(r,""),16&f&&P(p,r,i,n,o,a,s,l))},U=(t,e,r,n,o,a,s,l,c)=>{t=t||i["a"],e=e||i["a"];const u=t.length,p=e.length,h=Math.min(u,p);let d;for(d=0;d<h;d++){const i=e[d]=c?Oi(e[d]):Pi(e[d]);b(t[d],i,r,null,o,a,s,l,c)}u>p?K(t,o,a,!0,!1,h):P(e,r,n,o,a,s,l,c,h)},V=(t,e,r,n,o,a,s,l,c)=>{let u=0;const p=e.length;let h=t.length-1,d=p-1;while(u<=h&&u<=d){const i=t[u],n=e[u]=c?Oi(e[u]):Pi(e[u]);if(!bi(i,n))break;b(i,n,r,null,o,a,s,l,c),u++}while(u<=h&&u<=d){const i=t[h],n=e[d]=c?Oi(e[d]):Pi(e[d]);if(!bi(i,n))break;b(i,n,r,null,o,a,s,l,c),h--,d--}if(u>h){if(u<=d){const t=d+1,i=t<p?e[t].el:n;while(u<=d)b(null,e[u]=c?Oi(e[u]):Pi(e[u]),r,i,o,a,s,l,c),u++}}else if(u>d)while(u<=h)G(t[u],o,a,!0),u++;else{const f=u,m=u,g=new Map;for(u=m;u<=d;u++){const t=e[u]=c?Oi(e[u]):Pi(e[u]);null!=t.key&&g.set(t.key,u)}let y,v=0;const _=d-m+1;let x=!1,w=0;const S=new Array(_);for(u=0;u<_;u++)S[u]=0;for(u=f;u<=h;u++){const i=t[u];if(v>=_){G(i,o,a,!0);continue}let n;if(null!=i.key)n=g.get(i.key);else for(y=m;y<=d;y++)if(0===S[y-m]&&bi(i,e[y])){n=y;break}void 0===n?G(i,o,a,!0):(S[n-m]=u+1,n>=w?w=n:x=!0,b(i,e[n],r,null,o,a,s,l,c),v++)}const T=x?ri(S):i["a"];for(y=T.length-1,u=_-1;u>=0;u--){const t=m+u,i=e[t],h=t+1<p?e[t+1].el:n;0===S[u]?b(null,i,r,h,o,a,s,l,c):x&&(y<0||u!==T[y]?q(i,r,h,2):y--)}}},q=(t,e,i,n,o=null)=>{const{el:a,type:s,transition:l,children:c,shapeFlag:u}=t;if(6&u)return void q(t.component.subTree,e,i,n);if(128&u)return void t.suspense.move(e,i,n);if(64&u)return void s.move(t,e,i,J);if(s===ci){r(a,e,i);for(let t=0;t<c.length;t++)q(c[t],e,i,n);return void r(t.anchor,e,i)}if(s===hi)return void E(t,e,i);const p=2!==n&&1&u&&l;if(p)if(0===n)l.beforeEnter(a),r(a,e,i),Yr(()=>l.enter(a),o);else{const{leave:t,delayLeave:n,afterLeave:o}=l,s=()=>r(a,e,i),c=()=>{t(a,()=>{s(),o&&o()})};n?n(a,s,c):c()}else r(a,e,i)},G=(t,e,r,i=!1,n=!1)=>{const{type:o,props:a,ref:s,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:p,dirs:h}=t;if(null!=s&&Jr(s,null,r,t,!0),256&u)return void e.ctx.deactivate(t);const d=1&u&&h;let f;if((f=a&&a.onVnodeBeforeUnmount)&&ti(f,e,t),6&u)W(t.component,r,i);else{if(128&u)return void t.suspense.unmount(r,i);d&&Gr(t,null,e,"beforeUnmount"),64&u?t.type.remove(t,e,r,n,J,i):c&&(o!==ci||p>0&&64&p)?K(c,e,r,!1,!0):(o===ci&&(128&p||256&p)||!n&&16&u)&&K(l,e,r),i&&Z(t)}((f=a&&a.onVnodeUnmounted)||d)&&Yr(()=>{f&&ti(f,e,t),d&&Gr(t,null,e,"unmounted")},r)},Z=t=>{const{type:e,el:r,anchor:i,transition:o}=t;if(e===ci)return void H(r,i);if(e===hi)return void I(t);const a=()=>{n(r),o&&!o.persisted&&o.afterLeave&&o.afterLeave()};if(1&t.shapeFlag&&o&&!o.persisted){const{leave:e,delayLeave:i}=o,n=()=>e(r,a);i?i(t.el,a,n):n()}else a()},H=(t,e)=>{let r;while(t!==e)r=m(t),n(t),t=r;n(e)},W=(t,e,r)=>{const{bum:n,effects:o,update:a,subTree:s,um:l}=t;if(n&&Object(i["l"])(n),o)for(let i=0;i<o.length;i++)p(o[i]);a&&(p(a),G(s,t,e,r)),l&&Yr(l,e),Yr(()=>{t.isUnmounted=!0},e),e&&e.pendingBranch&&!e.isUnmounted&&t.asyncDep&&!t.asyncResolved&&t.suspenseId===e.pendingId&&(e.deps--,0===e.deps&&e.resolve())},K=(t,e,r,i=!1,n=!1,o=0)=>{for(let a=o;a<t.length;a++)G(t[a],e,r,i,n)},X=t=>6&t.shapeFlag?X(t.component.subTree):128&t.shapeFlag?t.suspense.next():m(t.anchor||t.el),Y=(t,e,r)=>{null==t?e._vnode&&G(e._vnode,null,null,!0):b(e._vnode||null,t,e,null,null,null,r),se(),e._vnode=t},J={p:b,um:G,m:q,r:Z,mt:z,mc:P,pc:j,pbc:M,n:X,o:t};let $,Q;return e&&([$,Q]=e(J)),{render:Y,hydrate:$,createApp:Wr(Y,$)}}function ti(t,e,r,i=null){zt(t,e,7,[r,i])}function ei(t,e,r=!1){const n=t.children,o=e.children;if(Object(i["m"])(n)&&Object(i["m"])(o))for(let i=0;i<n.length;i++){const t=n[i];let e=o[i];1&e.shapeFlag&&!e.dynamicChildren&&((e.patchFlag<=0||32===e.patchFlag)&&(e=o[i]=Oi(o[i]),e.el=t.el),r||ei(t,e))}}function ri(t){const e=t.slice(),r=[0];let i,n,o,a,s;const l=t.length;for(i=0;i<l;i++){const l=t[i];if(0!==l){if(n=r[r.length-1],t[n]<l){e[i]=n,r.push(i);continue}o=0,a=r.length-1;while(o<a)s=(o+a)/2|0,t[r[s]]<l?o=s+1:a=s;l<t[r[o]]&&(o>0&&(e[i]=r[o-1]),r[o]=i)}}o=r.length,a=r[o-1];while(o-- >0)r[o]=a,a=e[a];return r}const ii=t=>t.__isTeleport;const ni="components";function oi(t,e){return si(ni,t,!0,e)||t}const ai=Symbol();function si(t,e,r=!0,n=!1){const o=de||Vi;if(o){const r=o.type;if(t===ni){const t=tn(r);if(t&&(t===e||t===Object(i["e"])(e)||t===Object(i["f"])(Object(i["e"])(e))))return r}const a=li(o[t]||r[t],e)||li(o.appContext[t],e);return!a&&n?r:a}}function li(t,e){return t&&(t[e]||t[Object(i["e"])(e)]||t[Object(i["f"])(Object(i["e"])(e))])}const ci=Symbol(void 0),ui=Symbol(void 0),pi=Symbol(void 0),hi=Symbol(void 0),di=[];let fi=null;function mi(t=!1){di.push(fi=t?null:[])}function gi(){di.pop(),fi=di[di.length-1]||null}let yi=1;function vi(t){yi+=t}function _i(t,e,r,n,o){const a=Ei(t,e,r,n,o,!0);return a.dynamicChildren=yi>0?fi||i["a"]:null,gi(),yi>0&&fi&&fi.push(a),a}function xi(t){return!!t&&!0===t.__v_isVNode}function bi(t,e){return t.type===e.type&&t.key===e.key}const wi="__vInternal",Si=({key:t})=>null!=t?t:null,Ti=({ref:t})=>null!=t?Object(i["B"])(t)||St(t)||Object(i["n"])(t)?{i:de,r:t}:t:null,Ei=Ii;function Ii(t,e=null,r=null,n=0,o=null,a=!1){if(t&&t!==ai||(t=pi),xi(t)){const i=Ci(t,e,!0);return r&&Mi(i,r),i}if(en(t)&&(t=t.__vccOpts),e){(xt(e)||wi in e)&&(e=Object(i["h"])({},e));let{class:t,style:r}=e;t&&!Object(i["B"])(t)&&(e.class=Object(i["G"])(t)),Object(i["t"])(r)&&(xt(r)&&!Object(i["m"])(r)&&(r=Object(i["h"])({},r)),e.style=Object(i["H"])(r))}const s=Object(i["B"])(t)?1:Ie(t)?128:ii(t)?64:Object(i["t"])(t)?4:Object(i["n"])(t)?2:0;const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Si(e),ref:e&&Ti(e),scopeId:fe,slotScopeIds:null,children:null,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null};return Mi(l,r),128&s&&t.normalize(l),yi>0&&!a&&fi&&(n>0||6&s)&&32!==n&&fi.push(l),l}function Ci(t,e,r=!1){const{props:n,ref:o,patchFlag:a,children:s}=t,l=e?Li(n||{},e):n,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:l,key:l&&Si(l),ref:e&&e.ref?r&&o?Object(i["m"])(o)?o.concat(Ti(e)):[o,Ti(e)]:Ti(e):o,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:s,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ci?-1===a?16:16|a:a,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ci(t.ssContent),ssFallback:t.ssFallback&&Ci(t.ssFallback),el:t.el,anchor:t.anchor};return c}function Ai(t=" ",e=0){return Ei(ui,null,t,e)}function ki(t="",e=!1){return e?(mi(),_i(pi,null,t)):Ei(pi,null,t)}function Pi(t){return null==t||"boolean"===typeof t?Ei(pi):Object(i["m"])(t)?Ei(ci,null,t.slice()):"object"===typeof t?Oi(t):Ei(ui,null,String(t))}function Oi(t){return null===t.el?t:Ci(t)}function Mi(t,e){let r=0;const{shapeFlag:n}=t;if(null==e)e=null;else if(Object(i["m"])(e))r=16;else if("object"===typeof e){if(1&n||64&n){const r=e.default;return void(r&&(r._c&&(r._d=!1),Mi(t,r()),r._c&&(r._d=!0)))}{r=32;const i=e._;i||wi in e?3===i&&de&&(1===de.slots._?e._=1:(e._=2,t.patchFlag|=1024)):e._ctx=de}}else Object(i["n"])(e)?(e={default:e,_ctx:de},r=32):(e=String(e),64&n?(r=16,e=[Ai(e)]):r=8);t.children=e,t.shapeFlag|=r}function Li(...t){const e=Object(i["h"])({},t[0]);for(let r=1;r<t.length;r++){const n=t[r];for(const t in n)if("class"===t)e.class!==n.class&&(e.class=Object(i["G"])([e.class,n.class]));else if("style"===t)e.style=Object(i["H"])([e.style,n.style]);else if(Object(i["u"])(t)){const r=e[t],i=n[t];r!==i&&(e[t]=r?[].concat(r,i):i)}else""!==t&&(e[t]=n[t])}return e}function Di(t,e){let r;if(Object(i["m"])(t)||Object(i["B"])(t)){r=new Array(t.length);for(let i=0,n=t.length;i<n;i++)r[i]=e(t[i],i)}else if("number"===typeof t){0,r=new Array(t);for(let i=0;i<t;i++)r[i]=e(i+1,i)}else if(Object(i["t"])(t))if(t[Symbol.iterator])r=Array.from(t,e);else{const i=Object.keys(t);r=new Array(i.length);for(let n=0,o=i.length;n<o;n++){const o=i[n];r[n]=e(t[o],o,n)}}else r=[];return r}const Ri=t=>t?Zi(t)?t.exposed?t.exposed:t.proxy:Ri(t.parent):null,zi=Object(i["h"])(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ri(t.parent),$root:t=>Ri(t.root),$emit:t=>t.emit,$options:t=>_r(t),$forceUpdate:t=>()=>te(t.update),$nextTick:t=>$t.bind(t.proxy),$watch:t=>Le.bind(t)}),Ni={get({_:t},e){const{ctx:r,setupState:n,data:o,props:a,accessCache:s,type:l,appContext:c}=t;if("__v_skip"===e)return!0;let u;if("$"!==e[0]){const l=s[e];if(void 0!==l)switch(l){case 0:return n[e];case 1:return o[e];case 3:return r[e];case 2:return a[e]}else{if(n!==i["b"]&&Object(i["j"])(n,e))return s[e]=0,n[e];if(o!==i["b"]&&Object(i["j"])(o,e))return s[e]=1,o[e];if((u=t.propsOptions[0])&&Object(i["j"])(u,e))return s[e]=2,a[e];if(r!==i["b"]&&Object(i["j"])(r,e))return s[e]=3,r[e];fr&&(s[e]=4)}}const p=zi[e];let h,d;return p?("$attrs"===e&&x(t,"get",e),p(t)):(h=l.__cssModules)&&(h=h[e])?h:r!==i["b"]&&Object(i["j"])(r,e)?(s[e]=3,r[e]):(d=c.config.globalProperties,Object(i["j"])(d,e)?d[e]:void 0)},set({_:t},e,r){const{data:n,setupState:o,ctx:a}=t;if(o!==i["b"]&&Object(i["j"])(o,e))o[e]=r;else if(n!==i["b"]&&Object(i["j"])(n,e))n[e]=r;else if(Object(i["j"])(t.props,e))return!1;return("$"!==e[0]||!(e.slice(1)in t))&&(a[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:o,propsOptions:a}},s){let l;return void 0!==r[s]||t!==i["b"]&&Object(i["j"])(t,s)||e!==i["b"]&&Object(i["j"])(e,s)||(l=a[0])&&Object(i["j"])(l,s)||Object(i["j"])(n,s)||Object(i["j"])(zi,s)||Object(i["j"])(o.config.globalProperties,s)}};const Bi=Object(i["h"])({},Ni,{get(t,e){if(e!==Symbol.unscopables)return Ni.get(t,e,t)},has(t,e){const r="_"!==e[0]&&!Object(i["o"])(e);return r}});const Fi=Zr();let ji=0;function Ui(t,e,r){const n=t.type,o=(e?e.appContext:t.appContext)||Fi,a={uid:ji++,vnode:t,type:n,parent:e,appContext:o,root:null,next:null,subTree:null,update:null,render:null,proxy:null,exposed:null,withProxy:null,effects:null,provides:e?e.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Or(n,o),emitsOptions:pe(n,o),emit:null,emitted:null,propsDefaults:i["b"],inheritAttrs:n.inheritAttrs,ctx:i["b"],data:i["b"],props:i["b"],attrs:i["b"],slots:i["b"],refs:i["b"],setupState:i["b"],setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=ue.bind(null,a),a}let Vi=null;const qi=()=>Vi||de,Gi=t=>{Vi=t};function Zi(t){return 4&t.vnode.shapeFlag}let Hi,Wi=!1;function Ki(t,e=!1){Wi=e;const{props:r,children:i}=t.vnode,n=Zi(t);Cr(t,r,n,e),Ur(t,i);const o=n?Xi(t,e):void 0;return Wi=!1,o}function Xi(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Ni);const{setup:n}=r;if(n){const r=t.setupContext=n.length>1?$i(t):null;Vi=t,y();const o=Rt(n,t,0,[t.props,r]);if(_(),Vi=null,Object(i["w"])(o)){if(e)return o.then(r=>{Yi(t,r,e)}).catch(e=>{Nt(e,t,0)});t.asyncDep=o}else Yi(t,o,e)}else Ji(t,e)}function Yi(t,e,r){Object(i["n"])(e)?t.render=e:Object(i["t"])(e)&&(t.setupState=Pt(e)),Ji(t,r)}function Ji(t,e,r){const n=t.type;if(!t.render){if(Hi&&!n.render){const e=n.template;if(e){0;const{isCustomElement:r,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:s}=n,l=Object(i["h"])(Object(i["h"])({isCustomElement:r,delimiters:a},o),s);n.render=Hi(e,l)}}t.render=n.render||i["d"],t.render._rc&&(t.withProxy=new Proxy(t.ctx,Bi))}Vi=t,y(),mr(t),_(),Vi=null}function $i(t){const e=e=>{t.exposed=Pt(e)};return{attrs:t.attrs,slots:t.slots,emit:t.emit,expose:e}}function Qi(t,e=Vi){e&&(e.effects||(e.effects=[])).push(t)}function tn(t){return Object(i["n"])(t)&&t.displayName||t.name}function en(t){return Object(i["n"])(t)&&"__vccOpts"in t}function rn(t){const e=Dt(t);return Qi(e.effect),e}function nn(t,e,r){const n=arguments.length;return 2===n?Object(i["t"])(e)&&!Object(i["m"])(e)?xi(e)?Ei(t,null,[e]):Ei(t,e):Ei(t,null,e):(n>3?r=Array.prototype.slice.call(arguments,2):3===n&&xi(r)&&(r=[r]),Ei(t,e,r))}Symbol("");const on="3.1.1",an="http://www.w3.org/2000/svg",sn="undefined"!==typeof document?document:null;let ln,cn;const un={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,i)=>{const n=e?sn.createElementNS(an,t):sn.createElement(t,r?{is:r}:void 0);return"select"===t&&i&&null!=i.multiple&&n.setAttribute("multiple",i.multiple),n},createText:t=>sn.createTextNode(t),createComment:t=>sn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>sn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,r,i){const n=i?cn||(cn=sn.createElementNS(an,"svg")):ln||(ln=sn.createElement("div"));n.innerHTML=t;const o=n.firstChild;let a=o,s=a;while(a)s=a,un.insert(a,e,r),a=n.firstChild;return[o,s]}};function pn(t,e,r){if(null==e&&(e=""),r)t.setAttribute("class",e);else{const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),t.className=e}}function hn(t,e,r){const n=t.style;if(r)if(Object(i["B"])(r)){if(e!==r){const e=n.display;n.cssText=r,"_vod"in t&&(n.display=e)}}else{for(const t in r)fn(n,t,r[t]);if(e&&!Object(i["B"])(e))for(const t in e)null==r[t]&&fn(n,t,"")}else t.removeAttribute("style")}const dn=/\s*!important$/;function fn(t,e,r){if(Object(i["m"])(r))r.forEach(r=>fn(t,e,r));else if(e.startsWith("--"))t.setProperty(e,r);else{const n=yn(t,e);dn.test(r)?t.setProperty(Object(i["k"])(n),r.replace(dn,""),"important"):t[n]=r}}const mn=["Webkit","Moz","ms"],gn={};function yn(t,e){const r=gn[e];if(r)return r;let n=Object(i["e"])(e);if("filter"!==n&&n in t)return gn[e]=n;n=Object(i["f"])(n);for(let i=0;i<mn.length;i++){const r=mn[i]+n;if(r in t)return gn[e]=r}return e}const vn="http://www.w3.org/1999/xlink";function _n(t,e,r,n,o){if(n&&e.startsWith("xlink:"))null==r?t.removeAttributeNS(vn,e.slice(6,e.length)):t.setAttributeNS(vn,e,r);else{const n=Object(i["A"])(e);null==r||n&&!1===r?t.removeAttribute(e):t.setAttribute(e,n?"":r)}}function xn(t,e,r,i,n,o,a){if("innerHTML"===e||"textContent"===e)return i&&a(i,n,o),void(t[e]=null==r?"":r);if("value"===e&&"PROGRESS"!==t.tagName){t._value=r;const i=null==r?"":r;return t.value!==i&&(t.value=i),void(null==r&&t.removeAttribute(e))}if(""===r||null==r){const i=typeof t[e];if(""===r&&"boolean"===i)return void(t[e]=!0);if(null==r&&"string"===i)return t[e]="",void t.removeAttribute(e);if("number"===i)return t[e]=0,void t.removeAttribute(e)}try{t[e]=r}catch(s){0}}let bn=Date.now,wn=!1;if("undefined"!==typeof window){bn()>document.createEvent("Event").timeStamp&&(bn=()=>performance.now());const t=navigator.userAgent.match(/firefox\/(\d+)/i);wn=!!(t&&Number(t[1])<=53)}let Sn=0;const Tn=Promise.resolve(),En=()=>{Sn=0},In=()=>Sn||(Tn.then(En),Sn=bn());function Cn(t,e,r,i){t.addEventListener(e,r,i)}function An(t,e,r,i){t.removeEventListener(e,r,i)}function kn(t,e,r,i,n=null){const o=t._vei||(t._vei={}),a=o[e];if(i&&a)a.value=i;else{const[r,s]=On(e);if(i){const a=o[e]=Mn(i,n);Cn(t,r,a,s)}else a&&(An(t,r,a,s),o[e]=void 0)}}const Pn=/(?:Once|Passive|Capture)$/;function On(t){let e;if(Pn.test(t)){let r;e={};while(r=t.match(Pn))t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[Object(i["k"])(t.slice(2)),e]}function Mn(t,e){const r=t=>{const i=t.timeStamp||bn();(wn||i>=r.attached-1)&&zt(Ln(t,r.value),e,5,[t])};return r.value=t,r.attached=In(),r}function Ln(t,e){if(Object(i["m"])(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(t=>e=>!e._stopped&&t(e))}return e}const Dn=/^on[a-z]/,Rn=(t,e)=>"value"===e,zn=(t,e,r,n,o=!1,a,s,l,c)=>{switch(e){case"class":pn(t,n,o);break;case"style":hn(t,r,n);break;default:Object(i["u"])(e)?Object(i["s"])(e)||kn(t,e,r,n,s):Nn(t,e,n,o)?xn(t,e,n,a,s,l,c):("true-value"===e?t._trueValue=n:"false-value"===e&&(t._falseValue=n),_n(t,e,n,o));break}};function Nn(t,e,r,n){return n?"innerHTML"===e||!!(e in t&&Dn.test(e)&&Object(i["n"])(r)):"spellcheck"!==e&&"draggable"!==e&&("form"!==e&&(("list"!==e||"INPUT"!==t.tagName)&&(("type"!==e||"TEXTAREA"!==t.tagName)&&((!Dn.test(e)||!Object(i["B"])(r))&&e in t))))}const Bn="transition",Fn="animation",jn=(t,{slots:e})=>nn(Fe,Gn(t),e);jn.displayName="Transition";const Un={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Vn=(jn.props=Object(i["h"])({},Fe.props,Un),(t,e=[])=>{Object(i["m"])(t)?t.forEach(t=>t(...e)):t&&t(...e)}),qn=t=>!!t&&(Object(i["m"])(t)?t.some(t=>t.length>1):t.length>1);function Gn(t){const e={};for(const i in t)i in Un||(e[i]=t[i]);if(!1===t.css)return e;const{name:r="v",type:n,duration:o,enterFromClass:a=r+"-enter-from",enterActiveClass:s=r+"-enter-active",enterToClass:l=r+"-enter-to",appearFromClass:c=a,appearActiveClass:u=s,appearToClass:p=l,leaveFromClass:h=r+"-leave-from",leaveActiveClass:d=r+"-leave-active",leaveToClass:f=r+"-leave-to"}=t,m=Zn(o),g=m&&m[0],y=m&&m[1],{onBeforeEnter:v,onEnter:_,onEnterCancelled:x,onLeave:b,onLeaveCancelled:w,onBeforeAppear:S=v,onAppear:T=_,onAppearCancelled:E=x}=e,I=(t,e,r)=>{Kn(t,e?p:l),Kn(t,e?u:s),r&&r()},C=(t,e)=>{Kn(t,f),Kn(t,d),e&&e()},A=t=>(e,r)=>{const i=t?T:_,o=()=>I(e,t,r);Vn(i,[e,o]),Xn(()=>{Kn(e,t?c:a),Wn(e,t?p:l),qn(i)||Jn(e,n,g,o)})};return Object(i["h"])(e,{onBeforeEnter(t){Vn(v,[t]),Wn(t,a),Wn(t,s)},onBeforeAppear(t){Vn(S,[t]),Wn(t,c),Wn(t,u)},onEnter:A(!1),onAppear:A(!0),onLeave(t,e){const r=()=>C(t,e);Wn(t,h),eo(),Wn(t,d),Xn(()=>{Kn(t,h),Wn(t,f),qn(b)||Jn(t,n,y,r)}),Vn(b,[t,r])},onEnterCancelled(t){I(t,!1),Vn(x,[t])},onAppearCancelled(t){I(t,!0),Vn(E,[t])},onLeaveCancelled(t){C(t),Vn(w,[t])}})}function Zn(t){if(null==t)return null;if(Object(i["t"])(t))return[Hn(t.enter),Hn(t.leave)];{const e=Hn(t);return[e,e]}}function Hn(t){const e=Object(i["L"])(t);return e}function Wn(t,e){e.split(/\s+/).forEach(e=>e&&t.classList.add(e)),(t._vtc||(t._vtc=new Set)).add(e)}function Kn(t,e){e.split(/\s+/).forEach(e=>e&&t.classList.remove(e));const{_vtc:r}=t;r&&(r.delete(e),r.size||(t._vtc=void 0))}function Xn(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Yn=0;function Jn(t,e,r,i){const n=t._endId=++Yn,o=()=>{n===t._endId&&i()};if(r)return setTimeout(o,r);const{type:a,timeout:s,propCount:l}=$n(t,e);if(!a)return i();const c=a+"end";let u=0;const p=()=>{t.removeEventListener(c,h),o()},h=e=>{e.target===t&&++u>=l&&p()};setTimeout(()=>{u<l&&p()},s+1),t.addEventListener(c,h)}function $n(t,e){const r=window.getComputedStyle(t),i=t=>(r[t]||"").split(", "),n=i(Bn+"Delay"),o=i(Bn+"Duration"),a=Qn(n,o),s=i(Fn+"Delay"),l=i(Fn+"Duration"),c=Qn(s,l);let u=null,p=0,h=0;e===Bn?a>0&&(u=Bn,p=a,h=o.length):e===Fn?c>0&&(u=Fn,p=c,h=l.length):(p=Math.max(a,c),u=p>0?a>c?Bn:Fn:null,h=u?u===Bn?o.length:l.length:0);const d=u===Bn&&/\b(transform|all)(,|$)/.test(r[Bn+"Property"]);return{type:u,timeout:p,propCount:h,hasTransform:d}}function Qn(t,e){while(t.length<e.length)t=t.concat(t);return Math.max(...e.map((e,r)=>to(e)+to(t[r])))}function to(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function eo(){return document.body.offsetHeight}new WeakMap,new WeakMap;const ro=t=>{const e=t.props["onUpdate:modelValue"];return Object(i["m"])(e)?t=>Object(i["l"])(e,t):e};function io(t){t.target.composing=!0}function no(t){const e=t.target;e.composing&&(e.composing=!1,oo(e,"input"))}function oo(t,e){const r=document.createEvent("HTMLEvents");r.initEvent(e,!0,!0),t.dispatchEvent(r)}const ao={created(t,{modifiers:{lazy:e,trim:r,number:n}},o){t._assign=ro(o);const a=n||"number"===t.type;Cn(t,e?"change":"input",e=>{if(e.target.composing)return;let n=t.value;r?n=n.trim():a&&(n=Object(i["L"])(n)),t._assign(n)}),r&&Cn(t,"change",()=>{t.value=t.value.trim()}),e||(Cn(t,"compositionstart",io),Cn(t,"compositionend",no),Cn(t,"change",no))},mounted(t,{value:e}){t.value=null==e?"":e},beforeUpdate(t,{value:e,modifiers:{trim:r,number:n}},o){if(t._assign=ro(o),t.composing)return;if(document.activeElement===t){if(r&&t.value.trim()===e)return;if((n||"number"===t.type)&&Object(i["L"])(t.value)===e)return}const a=null==e?"":e;t.value!==a&&(t.value=a)}};const so=Object(i["h"])({patchProp:zn,forcePatchProp:Rn},un);let lo;function co(){return lo||(lo=$r(so))}const uo=(...t)=>{const e=co().createApp(...t);const{mount:r}=e;return e.mount=t=>{const n=po(t);if(!n)return;const o=e._component;Object(i["n"])(o)||o.render||o.template||(o.template=n.innerHTML),n.innerHTML="";const a=r(n,!1,n instanceof SVGElement);return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),a},e};function po(t){if(Object(i["B"])(t)){const e=document.querySelector(t);return e}return t}},"7b0b":function(t,e,r){var i=r("1d80");t.exports=function(t){return Object(i(t))}},"7c73":function(t,e,r){var i,n=r("825a"),o=r("37e8"),a=r("7839"),s=r("d012"),l=r("1be4"),c=r("cc12"),u=r("f772"),p=">",h="<",d="prototype",f="script",m=u("IE_PROTO"),g=function(){},y=function(t){return h+f+p+t+h+"/"+f+p},v=function(t){t.write(y("")),t.close();var e=t.parentWindow.Object;return t=null,e},_=function(){var t,e=c("iframe"),r="java"+f+":";return e.style.display="none",l.appendChild(e),e.src=String(r),t=e.contentWindow.document,t.open(),t.write(y("document.F=Object")),t.close(),t.F},x=function(){try{i=document.domain&&new ActiveXObject("htmlfile")}catch(e){}x=i?v(i):_();var t=a.length;while(t--)delete x[d][a[t]];return x()};s[m]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(g[d]=n(t),r=new g,g[d]=null,r[m]=t):r=x(),void 0===e?r:o(r,e)}},"7dd0":function(t,e,r){"use strict";var i=r("23e7"),n=r("9ed3"),o=r("e163"),a=r("d2bb"),s=r("d44e"),l=r("9112"),c=r("6eeb"),u=r("b622"),p=r("c430"),h=r("3f8c"),d=r("ae93"),f=d.IteratorPrototype,m=d.BUGGY_SAFARI_ITERATORS,g=u("iterator"),y="keys",v="values",_="entries",x=function(){return this};t.exports=function(t,e,r,u,d,b,w){n(r,e,u);var S,T,E,I=function(t){if(t===d&&O)return O;if(!m&&t in k)return k[t];switch(t){case y:return function(){return new r(this,t)};case v:return function(){return new r(this,t)};case _:return function(){return new r(this,t)}}return function(){return new r(this)}},C=e+" Iterator",A=!1,k=t.prototype,P=k[g]||k["@@iterator"]||d&&k[d],O=!m&&P||I(d),M="Array"==e&&k.entries||P;if(M&&(S=o(M.call(new t)),f!==Object.prototype&&S.next&&(p||o(S)===f||(a?a(S,f):"function"!=typeof S[g]&&l(S,g,x)),s(S,C,!0,!0),p&&(h[C]=x))),d==v&&P&&P.name!==v&&(A=!0,O=function(){return P.call(this)}),p&&!w||k[g]===O||l(k,g,O),h[e]=O,d)if(T={values:I(v),keys:b?O:I(y),entries:I(_)},w)for(E in T)(m||A||!(E in k))&&c(k,E,T[E]);else i({target:e,proto:!0,forced:m||A},T);return T}},"7f9a":function(t,e,r){var i=r("da84"),n=r("8925"),o=i.WeakMap;t.exports="function"===typeof o&&/native code/.test(n(o))},"825a":function(t,e,r){var i=r("861d");t.exports=function(t){if(!i(t))throw TypeError(String(t)+" is not an object");return t}},"83ab":function(t,e,r){var i=r("d039");t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},8418:function(t,e,r){"use strict";var i=r("c04e"),n=r("9bf2"),o=r("5c6c");t.exports=function(t,e,r){var a=i(e);a in t?n.f(t,a,o(0,r)):t[a]=r}},"841c":function(t,e,r){"use strict";var i=r("d784"),n=r("825a"),o=r("1d80"),a=r("129f"),s=r("14c3");i("search",(function(t,e,r){return[function(e){var r=o(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,r):new RegExp(e)[t](String(r))},function(t){var i=r(e,this,t);if(i.done)return i.value;var o=n(this),l=String(t),c=o.lastIndex;a(c,0)||(o.lastIndex=0);var u=s(o,l);return a(o.lastIndex,c)||(o.lastIndex=c),null===u?-1:u.index}]}))},"857a":function(t,e,r){var i=r("1d80"),n=/"/g;t.exports=function(t,e,r,o){var a=String(i(t)),s="<"+e;return""!==r&&(s+=" "+r+'="'+String(o).replace(n,"&quot;")+'"'),s+">"+a+"</"+e+">"}},"861d":function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},8925:function(t,e,r){var i=r("c6cd"),n=Function.toString;"function"!=typeof i.inspectSource&&(i.inspectSource=function(t){return n.call(t)}),t.exports=i.inspectSource},"8aa5":function(t,e,r){"use strict";var i=r("6547").charAt;t.exports=function(t,e,r){return e+(r?i(t,e).length:1)}},"90e3":function(t,e){var r=0,i=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++r+i).toString(36)}},9112:function(t,e,r){var i=r("83ab"),n=r("9bf2"),o=r("5c6c");t.exports=i?function(t,e,r){return n.f(t,e,o(1,r))}:function(t,e,r){return t[e]=r,t}},9263:function(t,e,r){"use strict";var i=r("ad6d"),n=r("9f7f"),o=r("5692"),a=r("7c73"),s=r("69f3").get,l=r("fce3"),c=r("107c"),u=RegExp.prototype.exec,p=o("native-string-replace",String.prototype.replace),h=u,d=function(){var t=/a/,e=/b*/g;return u.call(t,"a"),u.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),f=n.UNSUPPORTED_Y||n.BROKEN_CARET,m=void 0!==/()??/.exec("")[1],g=d||m||f||l||c;g&&(h=function(t){var e,r,n,o,l,c,g,y=this,v=s(y),_=v.raw;if(_)return _.lastIndex=y.lastIndex,e=h.call(_,t),y.lastIndex=_.lastIndex,e;var x=v.groups,b=f&&y.sticky,w=i.call(y),S=y.source,T=0,E=t;if(b&&(w=w.replace("y",""),-1===w.indexOf("g")&&(w+="g"),E=String(t).slice(y.lastIndex),y.lastIndex>0&&(!y.multiline||y.multiline&&"\n"!==t[y.lastIndex-1])&&(S="(?: "+S+")",E=" "+E,T++),r=new RegExp("^(?:"+S+")",w)),m&&(r=new RegExp("^"+S+"$(?!\\s)",w)),d&&(n=y.lastIndex),o=u.call(b?r:y,E),b?o?(o.input=o.input.slice(T),o[0]=o[0].slice(T),o.index=y.lastIndex,y.lastIndex+=o[0].length):y.lastIndex=0:d&&o&&(y.lastIndex=y.global?o.index+o[0].length:n),m&&o&&o.length>1&&p.call(o[0],r,(function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(o[l]=void 0)})),o&&x)for(o.groups=c=a(null),l=0;l<x.length;l++)g=x[l],c[g[0]]=o[g[1]];return o}),t.exports=h},"94ca":function(t,e,r){var i=r("d039"),n=/#|\.prototype\./,o=function(t,e){var r=s[a(t)];return r==c||r!=l&&("function"==typeof e?i(e):!!e)},a=o.normalize=function(t){return String(t).replace(n,".").toLowerCase()},s=o.data={},l=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},"96cf":function(t,e,r){var i=function(t){"use strict";var e,r=Object.prototype,i=r.hasOwnProperty,n="function"===typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(M){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var n=e&&e.prototype instanceof g?e:g,o=Object.create(n.prototype),a=new k(i||[]);return o._invoke=E(t,r,a),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(M){return{type:"throw",arg:M}}}t.wrap=c;var p="suspendedStart",h="suspendedYield",d="executing",f="completed",m={};function g(){}function y(){}function v(){}var _={};_[o]=function(){return this};var x=Object.getPrototypeOf,b=x&&x(x(P([])));b&&b!==r&&i.call(b,o)&&(_=b);var w=v.prototype=g.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(n,o,a,s){var l=u(t[n],t,o);if("throw"!==l.type){var c=l.arg,p=c.value;return p&&"object"===typeof p&&i.call(p,"__await")?e.resolve(p.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(p).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(l.arg)}var n;function o(t,i){function o(){return new e((function(e,n){r(t,i,e,n)}))}return n=n?n.then(o,o):o()}this._invoke=o}function E(t,e,r){var i=p;return function(n,o){if(i===d)throw new Error("Generator is already running");if(i===f){if("throw"===n)throw o;return O()}r.method=n,r.arg=o;while(1){var a=r.delegate;if(a){var s=I(a,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var l=u(t,e,r);if("normal"===l.type){if(i=r.done?f:h,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=f,r.method="throw",r.arg=l.arg)}}}function I(t,r){var i=t.iterator[r.method];if(i===e){if(r.delegate=null,"throw"===r.method){if(t.iterator["return"]&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var n=u(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,m;var o=n.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function P(t){if(t){var r=t[o];if(r)return r.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function r(){while(++n<t.length)if(i.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}return{next:O}}function O(){return{value:e,done:!0}}return y.prototype=w.constructor=v,v.constructor=y,y.displayName=l(v,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,s,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},S(T.prototype),T.prototype[a]=function(){return this},t.AsyncIterator=T,t.async=function(e,r,i,n,o){void 0===o&&(o=Promise);var a=new T(c(e,r,i,n),o);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(w),l(w,s,"Generator"),w[o]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){while(e.length){var i=e.pop();if(i in t)return r.value=i,r.done=!1,r}return r.done=!0,r}},t.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(i,n){return s.type="throw",s.arg=t,r.next=i,n&&(r.method="next",r.arg=e),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;A(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,i){return this.delegate={iterator:P(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=i}catch(n){Function("r","regeneratorRuntime = r")(i)}},9911:function(t,e,r){"use strict";var i=r("23e7"),n=r("857a"),o=r("af03");i({target:"String",proto:!0,forced:o("link")},{link:function(t){return n(this,"a","href",t)}})},"99af":function(t,e,r){"use strict";var i=r("23e7"),n=r("d039"),o=r("e8b5"),a=r("861d"),s=r("7b0b"),l=r("50c4"),c=r("8418"),u=r("65f0"),p=r("1dde"),h=r("b622"),d=r("2d00"),f=h("isConcatSpreadable"),m=9007199254740991,g="Maximum allowed index exceeded",y=d>=51||!n((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),v=p("concat"),_=function(t){if(!a(t))return!1;var e=t[f];return void 0!==e?!!e:o(t)},x=!y||!v;i({target:"Array",proto:!0,forced:x},{concat:function(t){var e,r,i,n,o,a=s(this),p=u(a,0),h=0;for(e=-1,i=arguments.length;e<i;e++)if(o=-1===e?a:arguments[e],_(o)){if(n=l(o.length),h+n>m)throw TypeError(g);for(r=0;r<n;r++,h++)r in o&&c(p,h,o[r])}else{if(h>=m)throw TypeError(g);c(p,h++,o)}return p.length=h,p}})},"9bf2":function(t,e,r){var i=r("83ab"),n=r("0cfb"),o=r("825a"),a=r("c04e"),s=Object.defineProperty;e.f=i?s:function(t,e,r){if(o(t),e=a(e,!0),o(r),n)try{return s(t,e,r)}catch(i){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},"9ed3":function(t,e,r){"use strict";var i=r("ae93").IteratorPrototype,n=r("7c73"),o=r("5c6c"),a=r("d44e"),s=r("3f8c"),l=function(){return this};t.exports=function(t,e,r){var c=e+" Iterator";return t.prototype=n(i,{next:o(1,r)}),a(t,c,!1,!0),s[c]=l,t}},"9f7f":function(t,e,r){var i=r("d039"),n=function(t,e){return RegExp(t,e)};e.UNSUPPORTED_Y=i((function(){var t=n("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=i((function(){var t=n("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},"9ff4":function(t,e,r){"use strict";(function(t){function i(t,e){const r=Object.create(null),i=t.split(",");for(let n=0;n<i.length;n++)r[i[n]]=!0;return e?t=>!!r[t.toLowerCase()]:t=>!!r[t]}r.d(e,"a",(function(){return S})),r.d(e,"b",(function(){return w})),r.d(e,"c",(function(){return E})),r.d(e,"d",(function(){return T})),r.d(e,"e",(function(){return Y})),r.d(e,"f",(function(){return Q})),r.d(e,"g",(function(){return it})),r.d(e,"h",(function(){return k})),r.d(e,"i",(function(){return et})),r.d(e,"j",(function(){return M})),r.d(e,"k",(function(){return $})),r.d(e,"l",(function(){return rt})),r.d(e,"m",(function(){return L})),r.d(e,"n",(function(){return N})),r.d(e,"o",(function(){return o})),r.d(e,"p",(function(){return m})),r.d(e,"q",(function(){return H})),r.d(e,"r",(function(){return D})),r.d(e,"s",(function(){return A})),r.d(e,"t",(function(){return j})),r.d(e,"u",(function(){return C})),r.d(e,"v",(function(){return Z})),r.d(e,"w",(function(){return U})),r.d(e,"x",(function(){return W})),r.d(e,"y",(function(){return g})),r.d(e,"z",(function(){return R})),r.d(e,"A",(function(){return s})),r.d(e,"B",(function(){return B})),r.d(e,"C",(function(){return F})),r.d(e,"D",(function(){return v})),r.d(e,"E",(function(){return _})),r.d(e,"F",(function(){return i})),r.d(e,"G",(function(){return h})),r.d(e,"H",(function(){return l})),r.d(e,"I",(function(){return P})),r.d(e,"J",(function(){return x})),r.d(e,"K",(function(){return tt})),r.d(e,"L",(function(){return nt})),r.d(e,"M",(function(){return G}));const n="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",o=i(n);const a="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",s=i(a);function l(t){if(L(t)){const e={};for(let r=0;r<t.length;r++){const i=t[r],n=l(B(i)?p(i):i);if(n)for(const t in n)e[t]=n[t]}return e}if(j(t))return t}const c=/;(?![^(]*\))/g,u=/:(.+)/;function p(t){const e={};return t.split(c).forEach(t=>{if(t){const r=t.split(u);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function h(t){let e="";if(B(t))e=t;else if(L(t))for(let r=0;r<t.length;r++){const i=h(t[r]);i&&(e+=i+" ")}else if(j(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}const d="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",f="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",m=i(d),g=i(f);function y(t,e){if(t.length!==e.length)return!1;let r=!0;for(let i=0;r&&i<t.length;i++)r=v(t[i],e[i]);return r}function v(t,e){if(t===e)return!0;let r=z(t),i=z(e);if(r||i)return!(!r||!i)&&t.getTime()===e.getTime();if(r=L(t),i=L(e),r||i)return!(!r||!i)&&y(t,e);if(r=j(t),i=j(e),r||i){if(!r||!i)return!1;const n=Object.keys(t).length,o=Object.keys(e).length;if(n!==o)return!1;for(const r in t){const i=t.hasOwnProperty(r),n=e.hasOwnProperty(r);if(i&&!n||!i&&n||!v(t[r],e[r]))return!1}}return String(t)===String(e)}function _(t,e){return t.findIndex(t=>v(t,e))}const x=t=>null==t?"":j(t)?JSON.stringify(t,b,2):String(t),b=(t,e)=>D(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[e,r])=>(t[e+" =>"]=r,t),{})}:R(e)?{[`Set(${e.size})`]:[...e.values()]}:!j(e)||L(e)||Z(e)?e:String(e),w={},S=[],T=()=>{},E=()=>!1,I=/^on[^a-z]/,C=t=>I.test(t),A=t=>t.startsWith("onUpdate:"),k=Object.assign,P=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},O=Object.prototype.hasOwnProperty,M=(t,e)=>O.call(t,e),L=Array.isArray,D=t=>"[object Map]"===q(t),R=t=>"[object Set]"===q(t),z=t=>t instanceof Date,N=t=>"function"===typeof t,B=t=>"string"===typeof t,F=t=>"symbol"===typeof t,j=t=>null!==t&&"object"===typeof t,U=t=>j(t)&&N(t.then)&&N(t.catch),V=Object.prototype.toString,q=t=>V.call(t),G=t=>q(t).slice(8,-1),Z=t=>"[object Object]"===q(t),H=t=>B(t)&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,W=i(",key,ref,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),K=t=>{const e=Object.create(null);return r=>{const i=e[r];return i||(e[r]=t(r))}},X=/-(\w)/g,Y=K(t=>t.replace(X,(t,e)=>e?e.toUpperCase():"")),J=/\B([A-Z])/g,$=K(t=>t.replace(J,"-$1").toLowerCase()),Q=K(t=>t.charAt(0).toUpperCase()+t.slice(1)),tt=K(t=>t?"on"+Q(t):""),et=(t,e)=>t!==e&&(t===t||e===e),rt=(t,e)=>{for(let r=0;r<t.length;r++)t[r](e)},it=(t,e,r)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:r})},nt=t=>{const e=parseFloat(t);return isNaN(e)?t:e}}).call(this,r("c8ba"))},a4b4:function(t,e,r){var i=r("342f");t.exports=/web0s(?!.*chrome)/i.test(i)},a691:function(t,e){var r=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:r)(t)}},a79d:function(t,e,r){"use strict";var i=r("23e7"),n=r("c430"),o=r("fea9"),a=r("d039"),s=r("d066"),l=r("4840"),c=r("cdf9"),u=r("6eeb"),p=!!o&&a((function(){o.prototype["finally"].call({then:function(){}},(function(){}))}));if(i({target:"Promise",proto:!0,real:!0,forced:p},{finally:function(t){var e=l(this,s("Promise")),r="function"==typeof t;return this.then(r?function(r){return c(e,t()).then((function(){return r}))}:t,r?function(r){return c(e,t()).then((function(){throw r}))}:t)}}),!n&&"function"==typeof o){var h=s("Promise").prototype["finally"];o.prototype["finally"]!==h&&u(o.prototype,"finally",h,{unsafe:!0})}},a9e3:function(t,e,r){"use strict";var i=r("83ab"),n=r("da84"),o=r("94ca"),a=r("6eeb"),s=r("5135"),l=r("c6b6"),c=r("7156"),u=r("c04e"),p=r("d039"),h=r("7c73"),d=r("241c").f,f=r("06cf").f,m=r("9bf2").f,g=r("58a8").trim,y="Number",v=n[y],_=v.prototype,x=l(h(_))==y,b=function(t){var e,r,i,n,o,a,s,l,c=u(t,!1);if("string"==typeof c&&c.length>2)if(c=g(c),e=c.charCodeAt(0),43===e||45===e){if(r=c.charCodeAt(2),88===r||120===r)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+c}for(o=c.slice(2),a=o.length,s=0;s<a;s++)if(l=o.charCodeAt(s),l<48||l>n)return NaN;return parseInt(o,i)}return+c};if(o(y,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var w,S=function(t){var e=arguments.length<1?0:t,r=this;return r instanceof S&&(x?p((function(){_.valueOf.call(r)})):l(r)!=y)?c(new v(b(e)),r,S):b(e)},T=i?d(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),E=0;T.length>E;E++)s(v,w=T[E])&&!s(S,w)&&m(S,w,f(v,w));S.prototype=_,_.constructor=S,a(n,y,S)}},abc5:function(t,e,r){"use strict";(function(t){function i(){return n().__VUE_DEVTOOLS_GLOBAL_HOOK__}function n(){return"undefined"!==typeof navigator?window:"undefined"!==typeof t?t:{}}r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return n}))}).call(this,r("c8ba"))},ac1f:function(t,e,r){"use strict";var i=r("23e7"),n=r("9263");i({target:"RegExp",proto:!0,forced:/./.exec!==n},{exec:n})},ad6d:function(t,e,r){"use strict";var i=r("825a");t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},ae93:function(t,e,r){"use strict";var i,n,o,a=r("d039"),s=r("e163"),l=r("9112"),c=r("5135"),u=r("b622"),p=r("c430"),h=u("iterator"),d=!1,f=function(){return this};[].keys&&(o=[].keys(),"next"in o?(n=s(s(o)),n!==Object.prototype&&(i=n)):d=!0);var m=void 0==i||a((function(){var t={};return i[h].call(t)!==t}));m&&(i={}),p&&!m||c(i,h)||l(i,h,f),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:d}},af03:function(t,e,r){var i=r("d039");t.exports=function(t){return i((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},b041:function(t,e,r){"use strict";var i=r("00ee"),n=r("f5df");t.exports=i?{}.toString:function(){return"[object "+n(this)+"]"}},b0c0:function(t,e,r){var i=r("83ab"),n=r("9bf2").f,o=Function.prototype,a=o.toString,s=/^\s*function ([^ (]*)/,l="name";i&&!(l in o)&&n(o,l,{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(t){return""}}})},b575:function(t,e,r){var i,n,o,a,s,l,c,u,p=r("da84"),h=r("06cf").f,d=r("2cf4").set,f=r("1cdc"),m=r("a4b4"),g=r("605d"),y=p.MutationObserver||p.WebKitMutationObserver,v=p.document,_=p.process,x=p.Promise,b=h(p,"queueMicrotask"),w=b&&b.value;w||(i=function(){var t,e;g&&(t=_.domain)&&t.exit();while(n){e=n.fn,n=n.next;try{e()}catch(r){throw n?a():o=void 0,r}}o=void 0,t&&t.enter()},f||g||m||!y||!v?x&&x.resolve?(c=x.resolve(void 0),c.constructor=x,u=c.then,a=function(){u.call(c,i)}):a=g?function(){_.nextTick(i)}:function(){d.call(p,i)}:(s=!0,l=v.createTextNode(""),new y(i).observe(l,{characterData:!0}),a=function(){l.data=s=!s})),t.exports=w||function(t){var e={fn:t,next:void 0};o&&(o.next=e),n||(n=e,a()),o=e}},b622:function(t,e,r){var i=r("da84"),n=r("5692"),o=r("5135"),a=r("90e3"),s=r("4930"),l=r("fdbf"),c=n("wks"),u=i.Symbol,p=l?u:u&&u.withoutSetter||a;t.exports=function(t){return o(c,t)&&(s||"string"==typeof c[t])||(s&&o(u,t)?c[t]=u[t]:c[t]=p("Symbol."+t)),c[t]}},b727:function(t,e,r){var i=r("0366"),n=r("44ad"),o=r("7b0b"),a=r("50c4"),s=r("65f0"),l=[].push,c=function(t){var e=1==t,r=2==t,c=3==t,u=4==t,p=6==t,h=7==t,d=5==t||p;return function(f,m,g,y){for(var v,_,x=o(f),b=n(x),w=i(m,g,3),S=a(b.length),T=0,E=y||s,I=e?E(f,S):r||h?E(f,0):void 0;S>T;T++)if((d||T in b)&&(v=b[T],_=w(v,T,x),t))if(e)I[T]=_;else if(_)switch(t){case 3:return!0;case 5:return v;case 6:return T;case 2:l.call(I,v)}else switch(t){case 4:return!1;case 7:l.call(I,v)}return p?-1:c||u?u:I}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},b774:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));const i="devtools-plugin:setup"},c04e:function(t,e,r){var i=r("861d");t.exports=function(t,e){if(!i(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!i(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!i(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!i(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")}},c430:function(t,e){t.exports=!1},c6b6:function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},c6cd:function(t,e,r){var i=r("da84"),n=r("ce4e"),o="__core-js_shared__",a=i[o]||n(o,{});t.exports=a},c8ba:function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(i){"object"===typeof window&&(r=window)}t.exports=r},ca84:function(t,e,r){var i=r("5135"),n=r("fc6a"),o=r("4d64").indexOf,a=r("d012");t.exports=function(t,e){var r,s=n(t),l=0,c=[];for(r in s)!i(a,r)&&i(s,r)&&c.push(r);while(e.length>l)i(s,r=e[l++])&&(~o(c,r)||c.push(r));return c}},cc12:function(t,e,r){var i=r("da84"),n=r("861d"),o=i.document,a=n(o)&&n(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},cca6:function(t,e,r){var i=r("23e7"),n=r("60da");i({target:"Object",stat:!0,forced:Object.assign!==n},{assign:n})},cdf9:function(t,e,r){var i=r("825a"),n=r("861d"),o=r("f069");t.exports=function(t,e){if(i(t),n(e)&&e.constructor===t)return e;var r=o.f(t),a=r.resolve;return a(e),r.promise}},ce4e:function(t,e,r){var i=r("da84"),n=r("9112");t.exports=function(t,e){try{n(i,t,e)}catch(r){i[t]=e}return e}},d012:function(t,e){t.exports={}},d039:function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},d066:function(t,e,r){var i=r("428f"),n=r("da84"),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(i[t])||o(n[t]):i[t]&&i[t][e]||n[t]&&n[t][e]}},d1e7:function(t,e,r){"use strict";var i={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,o=n&&!i.call({1:2},1);e.f=o?function(t){var e=n(this,t);return!!e&&e.enumerable}:i},d2bb:function(t,e,r){var i=r("825a"),n=r("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,t.call(r,[]),e=r instanceof Array}catch(o){}return function(r,o){return i(r),n(o),e?t.call(r,o):r.__proto__=o,r}}():void 0)},d3b7:function(t,e,r){var i=r("00ee"),n=r("6eeb"),o=r("b041");i||n(Object.prototype,"toString",o,{unsafe:!0})},d44e:function(t,e,r){var i=r("9bf2").f,n=r("5135"),o=r("b622"),a=o("toStringTag");t.exports=function(t,e,r){t&&!n(t=r?t:t.prototype,a)&&i(t,a,{configurable:!0,value:e})}},d784:function(t,e,r){"use strict";r("ac1f");var i=r("6eeb"),n=r("9263"),o=r("d039"),a=r("b622"),s=r("9112"),l=a("species"),c=RegExp.prototype;t.exports=function(t,e,r,u){var p=a(t),h=!o((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),d=h&&!o((function(){var e=!1,r=/a/;return"split"===t&&(r={},r.constructor={},r.constructor[l]=function(){return r},r.flags="",r[p]=/./[p]),r.exec=function(){return e=!0,null},r[p](""),!e}));if(!h||!d||r){var f=/./[p],m=e(p,""[t],(function(t,e,r,i,o){var a=e.exec;return a===n||a===c.exec?h&&!o?{done:!0,value:f.call(e,r,i)}:{done:!0,value:t.call(r,e,i)}:{done:!1}}));i(String.prototype,t,m[0]),i(c,p,m[1])}u&&s(c[p],"sham",!0)}},da84:function(t,e,r){(function(e){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this,r("c8ba"))},ddb0:function(t,e,r){var i=r("da84"),n=r("fdbc"),o=r("e260"),a=r("9112"),s=r("b622"),l=s("iterator"),c=s("toStringTag"),u=o.values;for(var p in n){var h=i[p],d=h&&h.prototype;if(d){if(d[l]!==u)try{a(d,l,u)}catch(m){d[l]=u}if(d[c]||a(d,c,p),n[p])for(var f in o)if(d[f]!==o[f])try{a(d,f,o[f])}catch(m){d[f]=o[f]}}}},df75:function(t,e,r){var i=r("ca84"),n=r("7839");t.exports=Object.keys||function(t){return i(t,n)}},e163:function(t,e,r){var i=r("5135"),n=r("7b0b"),o=r("f772"),a=r("e177"),s=o("IE_PROTO"),l=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=n(t),i(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?l:null}},e177:function(t,e,r){var i=r("d039");t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},e260:function(t,e,r){"use strict";var i=r("fc6a"),n=r("44d2"),o=r("3f8c"),a=r("69f3"),s=r("7dd0"),l="Array Iterator",c=a.set,u=a.getterFor(l);t.exports=s(Array,"Array",(function(t,e){c(this,{type:l,target:i(t),index:0,kind:e})}),(function(){var t=u(this),e=t.target,r=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:i,done:!1}:"values"==r?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},e2cc:function(t,e,r){var i=r("6eeb");t.exports=function(t,e,r){for(var n in e)i(t,n,e[n],r);return t}},e667:function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}},e6cf:function(t,e,r){"use strict";var i,n,o,a,s=r("23e7"),l=r("c430"),c=r("da84"),u=r("d066"),p=r("fea9"),h=r("6eeb"),d=r("e2cc"),f=r("d2bb"),m=r("d44e"),g=r("2626"),y=r("861d"),v=r("1c0b"),_=r("19aa"),x=r("8925"),b=r("2266"),w=r("1c7e"),S=r("4840"),T=r("2cf4").set,E=r("b575"),I=r("cdf9"),C=r("44de"),A=r("f069"),k=r("e667"),P=r("69f3"),O=r("94ca"),M=r("b622"),L=r("6069"),D=r("605d"),R=r("2d00"),z=M("species"),N="Promise",B=P.get,F=P.set,j=P.getterFor(N),U=p&&p.prototype,V=p,q=U,G=c.TypeError,Z=c.document,H=c.process,W=A.f,K=W,X=!!(Z&&Z.createEvent&&c.dispatchEvent),Y="function"==typeof PromiseRejectionEvent,J="unhandledrejection",$="rejectionhandled",Q=0,tt=1,et=2,rt=1,it=2,nt=!1,ot=O(N,(function(){var t=x(V)!==String(V);if(!t&&66===R)return!0;if(l&&!q["finally"])return!0;if(R>=51&&/native code/.test(V))return!1;var e=new V((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))},i=e.constructor={};return i[z]=r,nt=e.then((function(){}))instanceof r,!nt||!t&&L&&!Y})),at=ot||!w((function(t){V.all(t)["catch"]((function(){}))})),st=function(t){var e;return!(!y(t)||"function"!=typeof(e=t.then))&&e},lt=function(t,e){if(!t.notified){t.notified=!0;var r=t.reactions;E((function(){var i=t.value,n=t.state==tt,o=0;while(r.length>o){var a,s,l,c=r[o++],u=n?c.ok:c.fail,p=c.resolve,h=c.reject,d=c.domain;try{u?(n||(t.rejection===it&&ht(t),t.rejection=rt),!0===u?a=i:(d&&d.enter(),a=u(i),d&&(d.exit(),l=!0)),a===c.promise?h(G("Promise-chain cycle")):(s=st(a))?s.call(a,p,h):p(a)):h(i)}catch(f){d&&!l&&d.exit(),h(f)}}t.reactions=[],t.notified=!1,e&&!t.rejection&&ut(t)}))}},ct=function(t,e,r){var i,n;X?(i=Z.createEvent("Event"),i.promise=e,i.reason=r,i.initEvent(t,!1,!0),c.dispatchEvent(i)):i={promise:e,reason:r},!Y&&(n=c["on"+t])?n(i):t===J&&C("Unhandled promise rejection",r)},ut=function(t){T.call(c,(function(){var e,r=t.facade,i=t.value,n=pt(t);if(n&&(e=k((function(){D?H.emit("unhandledRejection",i,r):ct(J,r,i)})),t.rejection=D||pt(t)?it:rt,e.error))throw e.value}))},pt=function(t){return t.rejection!==rt&&!t.parent},ht=function(t){T.call(c,(function(){var e=t.facade;D?H.emit("rejectionHandled",e):ct($,e,t.value)}))},dt=function(t,e,r){return function(i){t(e,i,r)}},ft=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=et,lt(t,!0))},mt=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw G("Promise can't be resolved itself");var i=st(e);i?E((function(){var r={done:!1};try{i.call(e,dt(mt,r,t),dt(ft,r,t))}catch(n){ft(r,n,t)}})):(t.value=e,t.state=tt,lt(t,!1))}catch(n){ft({done:!1},n,t)}}};if(ot&&(V=function(t){_(this,V,N),v(t),i.call(this);var e=B(this);try{t(dt(mt,e),dt(ft,e))}catch(r){ft(e,r)}},q=V.prototype,i=function(t){F(this,{type:N,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:Q,value:void 0})},i.prototype=d(q,{then:function(t,e){var r=j(this),i=W(S(this,V));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=D?H.domain:void 0,r.parent=!0,r.reactions.push(i),r.state!=Q&&lt(r,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),n=function(){var t=new i,e=B(t);this.promise=t,this.resolve=dt(mt,e),this.reject=dt(ft,e)},A.f=W=function(t){return t===V||t===o?new n(t):K(t)},!l&&"function"==typeof p&&U!==Object.prototype)){a=U.then,nt||(h(U,"then",(function(t,e){var r=this;return new V((function(t,e){a.call(r,t,e)})).then(t,e)}),{unsafe:!0}),h(U,"catch",q["catch"],{unsafe:!0}));try{delete U.constructor}catch(gt){}f&&f(U,q)}s({global:!0,wrap:!0,forced:ot},{Promise:V}),m(V,N,!1,!0),g(N),o=u(N),s({target:N,stat:!0,forced:ot},{reject:function(t){var e=W(this);return e.reject.call(void 0,t),e.promise}}),s({target:N,stat:!0,forced:l||ot},{resolve:function(t){return I(l&&this===o?V:this,t)}}),s({target:N,stat:!0,forced:at},{all:function(t){var e=this,r=W(e),i=r.resolve,n=r.reject,o=k((function(){var r=v(e.resolve),o=[],a=0,s=1;b(t,(function(t){var l=a++,c=!1;o.push(void 0),s++,r.call(e,t).then((function(t){c||(c=!0,o[l]=t,--s||i(o))}),n)})),--s||i(o)}));return o.error&&n(o.value),r.promise},race:function(t){var e=this,r=W(e),i=r.reject,n=k((function(){var n=v(e.resolve);b(t,(function(t){n.call(e,t).then(r.resolve,i)}))}));return n.error&&i(n.value),r.promise}})},e893:function(t,e,r){var i=r("5135"),n=r("56ef"),o=r("06cf"),a=r("9bf2");t.exports=function(t,e){for(var r=n(e),s=a.f,l=o.f,c=0;c<r.length;c++){var u=r[c];i(t,u)||s(t,u,l(e,u))}}},e8b5:function(t,e,r){var i=r("c6b6");t.exports=Array.isArray||function(t){return"Array"==i(t)}},e95a:function(t,e,r){var i=r("b622"),n=r("3f8c"),o=i("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||a[o]===t)}},f069:function(t,e,r){"use strict";var i=r("1c0b"),n=function(t){var e,r;this.promise=new t((function(t,i){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=i})),this.resolve=i(e),this.reject=i(r)};t.exports.f=function(t){return new n(t)}},f5df:function(t,e,r){var i=r("00ee"),n=r("c6b6"),o=r("b622"),a=o("toStringTag"),s="Arguments"==n(function(){return arguments}()),l=function(t,e){try{return t[e]}catch(r){}};t.exports=i?n:function(t){var e,r,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=l(e=Object(t),a))?r:s?n(e):"Object"==(i=n(e))&&"function"==typeof e.callee?"Arguments":i}},f772:function(t,e,r){var i=r("5692"),n=r("90e3"),o=i("keys");t.exports=function(t){return o[t]||(o[t]=n(t))}},fc6a:function(t,e,r){var i=r("44ad"),n=r("1d80");t.exports=function(t){return i(n(t))}},fce3:function(t,e,r){var i=r("d039");t.exports=i((function(){var t=RegExp(".","string".charAt(0));return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)}))},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(t,e,r){var i=r("4930");t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},fea9:function(t,e,r){var i=r("da84");t.exports=i.Promise},ff49:function(t,e,r){(function(t){
/*!
MICROSOFT SOFTWARE LICENSE TERMS
MICROSOFT AZURE MAPS WEB SDK
These license terms are an agreement between you and Microsoft Corporation (or one of its affiliates). They apply to the software named above and any Microsoft services or software updates (except to the extent such services or updates are accompanied by new or additional terms, in which case those different terms apply prospectively and do not alter your or Microsoft’s rights relating to pre-updated software or services). IF YOU COMPLY WITH THESE LICENSE TERMS, YOU HAVE THE RIGHTS BELOW.  BY USING THE SOFTWARE, YOU ACCEPT THESE TERMS.
1. INSTALLATION AND USE RIGHTS.
  a) General. You may install and use any number of copies of the software to develop and test your applications.
  b) User Region Parameters. The software will allow you to select from a View list to set the map view within your application for a given customer. By default the View parameter (also referred to as “user region parameter” is set to “Unified”.  Countries/Regions that are not on the View list will default to the “Unified” View. It is your responsibility to determine the location of your users, and then set the View parameter correctly for that location. The View parameter must be used in compliance with applicable laws, including those regarding mapping, of the country where maps, images and other data and third party content that You are authorized to access via the software is made available. 
  c) Third Party Software. The software may include third party applications that Microsoft, not the third party, licenses to you under this agreement. Any included notices for third party applications are for your information only.
  d) Microsoft Online Subscription Agreement. Some features of the software provide access to, or rely on, Microsoft Azure Services. The use of those services (but not the software) is governed by the separate terms and privacy policies associated with your Microsoft Azure subscription. The services may not be available in all regions. For more information see https://go.microsoft.com/fwLink/?LinkID=522330&amp;clcid=0x9.
2. DISTRIBUTABLE CODE. The software is comprised of “Distributable Code”. “Distributable Code” is code that you are permitted to distribute in applications you develop if you comply with the terms below and otherwise set forth in these license terms. 
  a) Distribution Rights. 
    i. You may copy and distribute the object code form of the software.
    i. Third Party Distribution. You may permit distributors of your applications to copy and distribute any of this distributable code you elect to distribute with your applications.
  b) Distribution Requirements. For any code you distribute, you must:
    i. add significant primary functionality to it in your applications;
    ii. require distributors and external end users to agree to terms that protect it and Microsoft at least as much as this agreement; and
    iii. indemnify, defend, and hold harmless Microsoft from any claims, including attorneys’ fees, related to the distribution or use of your applications, except to the extent that any claim is based solely on the unmodified distributable code.
  c) Distribution Restrictions. You may not:
    i. use Microsoft’s trademarks or trade dress in your application in any way that suggests your application comes from or is endorsed by Microsoft; or
    ii. modify or distribute the source code of any distributable code so that any part of it becomes subject to any license that requires that the distributable code, any other part of the software, or any of Microsoft’s other intellectual property be disclosed or distributed in source code form, or that others have the right to modify it.
3. DATA COLLECTION. The software may collect information about you and your use of the software and send that to Microsoft. Microsoft may use this information to provide services and improve Microsoft’s products and services. Your opt-out rights, if any, are described in the product documentation. Some features in the software may enable collection of data from users of your applications that access or use the software. If you use these features to enable data collection in your applications, you must comply with applicable law, including getting any required user consent, and maintain a prominent privacy policy that accurately informs users about how you use, collect, and share their data. You can learn more about Microsoft’s data collection and use in the product documentation and the Microsoft Privacy Statement at https://go.microsoft.com/fwlink/?LinkId=512132. You agree to comply with all applicable provisions of the Microsoft Privacy Statement.
4. SCOPE OF LICENSE. The software is licensed, not sold. Microsoft reserves all other rights. Unless applicable law gives you more rights despite this limitation, you will not (and have no right to):
  a) work around any technical limitations in the software that only allow you to use it in certain ways;
  b) reverse engineer, decompile, or disassemble the software, or attempt to do so, except and only to the extent permitted by licensing terms governing the use of open-source components that may be included with the software;
  c) remove, minimize, block, or modify any notices of Microsoft or its suppliers in the software;
  d) use the software in any way that is against the law or to create or propagate malware; or
  e) share, publish, distribute, or lend the software (except for any distributable code, subject to the terms above), provide the software as a stand-alone hosted solution for others to use, or transfer the software or this agreement to any third party.
5. EXPORT RESTRICTIONS. You must comply with all domestic and international export laws and regulations that apply to the software, which include restrictions on destinations, end users, and end use. For further information on export restrictions, visit http://aka.ms/exporting.
6. SUPPORT SERVICES. Microsoft is not obligated under this agreement to provide any support services for the software. Any support provided is “as is”, “with all faults”, and without warranty of any kind.
7. UPDATES. The software may periodically check for updates, and download and install them for you. You may obtain updates only from Microsoft or authorized sources. Microsoft may need to update your system to provide you with updates. You agree to receive these automatic updates without any additional notice. Updates may not include or support all existing software features, services, or peripheral devices.
8. ENTIRE AGREEMENT. This agreement, and any other terms Microsoft may provide for supplements, updates, or third-party applications, is the entire agreement for the software.
9. APPLICABLE LAW AND PLACE TO RESOLVE DISPUTES. If you acquired the software in the United States or Canada, the laws of the state or province where you live (or, if a business, where your principal place of business is located) govern the interpretation of this agreement, claims for its breach, and all other claims (including consumer protection, unfair competition, and tort claims), regardless of conflict of laws principles. If you acquired the software in any other country, its laws apply. If U.S. federal jurisdiction exists, you and Microsoft consent to exclusive jurisdiction and venue in the federal court in King County, Washington for all disputes heard in court. If not, you and Microsoft consent to exclusive jurisdiction and venue in the Superior Court of King County, Washington for all disputes heard in court.
10. CONSUMER RIGHTS; REGIONAL VARIATIONS. This agreement describes certain legal rights. You may have other rights, including consumer rights, under the laws of your state or country. Separate and apart from your relationship with Microsoft, you may also have rights with respect to the party from which you acquired the software. This agreement does not change those other rights if the laws of your state or country do not permit it to do so. For example, if you acquired the software in one of the below regions, or mandatory country law applies, then the following provisions apply to you:
  a) Australia. You have statutory guarantees under the Australian Consumer Law and nothing in this agreement is intended to affect those rights.
  b) Canada. If you acquired this software in Canada, you may stop receiving updates by turning off the automatic update feature, disconnecting your device from the Internet (if and when you re-connect to the Internet, however, the software will resume checking for and installing updates), or uninstalling the software. The product documentation, if any, may also specify how to turn off updates for your specific device or software.
  c) Germany and Austria.
    i. Warranty. The properly licensed software will perform substantially as described in any Microsoft materials that accompany the software. However, Microsoft gives no contractual guarantee in relation to the licensed software.
    ii. Limitation of Liability. In case of intentional conduct, gross negligence, claims based on the Product Liability Act, as well as, in case of death or personal or physical injury, Microsoft is liable according to the statutory law.
  Subject to the foregoing clause ii., Microsoft will only be liable for slight negligence if Microsoft is in breach of such material contractual obligations, the fulfillment of which facilitate the due performance of this agreement, the breach of which would endanger the purpose of this agreement and the compliance with which a party may constantly trust in (so-called "cardinal obligations"). In other cases of slight negligence, Microsoft will not be liable for slight negligence.
11. DISCLAIMER OF WARRANTY. THE SOFTWARE IS LICENSED “AS IS.” YOU BEAR THE RISK OF USING IT. MICROSOFT GIVES NO EXPRESS WARRANTIES, GUARANTEES, OR CONDITIONS. TO THE EXTENT PERMITTED UNDER APPLICABLE LAWS, MICROSOFT EXCLUDES ALL IMPLIED WARRANTIES, INCLUDING MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.
12. LIMITATION ON AND EXCLUSION OF DAMAGES. IF YOU HAVE ANY BASIS FOR RECOVERING DAMAGES DESPITE THE PRECEDING DISCLAIMER OF WARRANTY, YOU CAN RECOVER FROM MICROSOFT AND ITS SUPPLIERS ONLY DIRECT DAMAGES UP TO U.S. $5.00. YOU CANNOT RECOVER ANY OTHER DAMAGES, INCLUDING CONSEQUENTIAL, LOST PROFITS, SPECIAL, INDIRECT, OR INCIDENTAL DAMAGES.
This limitation applies to (a) anything related to the software, services, content (including code) on third party Internet sites, or third party applications; and (b) claims for breach of contract, warranty, guarantee, or condition; strict liability, negligence, or other tort; or any other claim; in each case to the extent permitted by applicable law.
It also applies even if Microsoft knew or should have known about the possibility of the damages. The above limitation or exclusion may not apply to you because your state, province, or country may not allow the exclusion or limitation of incidental, consequential, or other damages.
Please note: As this software is distributed in Canada, some of the clauses in this agreement are provided below in French.
Remarque: Ce logiciel étant distribué au Canada, certaines des clauses dans ce contrat sont fournies ci-dessous en français.
EXONÉRATION DE GARANTIE. Le logiciel visé par une licence est offert « tel quel ». Toute utilisation de ce logiciel est à votre seule risque et péril. Microsoft n’accorde aucune autre garantie expresse. Vous pouvez bénéficier de droits additionnels en vertu du droit local sur la protection des consommateurs, que ce contrat ne peut modifier. La ou elles sont permises par le droit locale, les garanties implicites de qualité marchande, d’adéquation à un usage particulier et d’absence de contrefaçon sont exclues.
LIMITATION DES DOMMAGES-INTÉRÊTS ET EXCLUSION DE RESPONSABILITÉ POUR LES DOMMAGES. Vous pouvez obtenir de Microsoft et de ses fournisseurs une indemnisation en cas de dommages directs uniquement à hauteur de 5,00 $ US. Vous ne pouvez prétendre à aucune indemnisation pour les autres dommages, y compris les dommages spéciaux, indirects ou accessoires et pertes de bénéfices.
Cette limitation concerne:
• tout ce qui est relié au logiciel, aux services ou au contenu (y compris le code) figurant sur des sites Internet tiers ou dans des programmes tiers; et
• les réclamations au titre de violation de contrat ou de garantie, ou au titre de responsabilité stricte, de négligence ou d’une autre faute dans la limite autorisée par la loi en vigueur.
Elle s’applique également, même si Microsoft connaissait ou devrait connaître l’éventualité d’un tel dommage. Si votre pays n’autorise pas l’exclusion ou la limitation de responsabilité pour les dommages indirects, accessoires ou de quelque nature que ce soit, il se peut que la limitation ou l’exclusion ci-dessus ne s’appliquera pas à votre égard.
EFFET JURIDIQUE. Le présent contrat décrit certains droits juridiques. Vous pourriez avoir d’autres droits prévus par les lois de votre pays. Le présent contrat ne modifie pas les droits que vous confèrent les lois de votre pays si celles-ci ne le permettent pas.
*/
!function(t,r){r(e)}(0,(function(e){"use strict";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{};function i(t,e){return t(e={exports:{}},e.exports),e.exports}var n=i((function(t,e){function r(t,e){if(i)if(n){var r="var sharedChunk = {}; ("+i+")(sharedChunk); ("+n+")(sharedChunk);",a={};i(a),o=e(a),"undefined"!=typeof window&&(o.workerUrl=window.URL.createObjectURL(new Blob([r],{type:"text/javascript"})))}else n=e;else i=e}var i,n,o;t.exports=(r(0,(function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var r=i;function i(t,e,r,i){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=r,this.p2y=i}i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){var r,i,n,o,a;for(void 0===e&&(e=1e-6),n=t,a=0;a<8;a++){if(o=this.sampleCurveX(n)-t,Math.abs(o)<e)return n;var s=this.sampleCurveDerivativeX(n);if(Math.abs(s)<1e-6)break;n-=o/s}if((n=t)<(r=0))return r;if(n>(i=1))return i;for(;r<i;){if(o=this.sampleCurveX(n),Math.abs(o-t)<e)return n;o<t?r=n:i=n,n=.5*(i-r)+r}return n},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var n=o;function o(t,e){this.x=t,this.y=e}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),i=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),i=Math.sin(t),n=e.y+i*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-i*(this.y-e.y),this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o||!Array.isArray(t)?t:new o(t[0],t[1])};var a="undefined"!=typeof self?self:{};function s(t,e,i,n){var o=new r(t,e,i,n);return function(t){return o.solve(t)}}var l=s(.25,.1,.25,1);function c(t,e,r){return Math.min(r,Math.max(e,t))}function u(t,e,r){var i=r-e,n=((t-e)%i+i)%i+e;return n===e?r:n}function p(t){for(var e=[],r=arguments.length-1;0<r--;)e[r]=arguments[r+1];for(var i=0,n=e;i<n.length;i+=1){var o=n[i];for(var a in o)t[a]=o[a]}return t}var h=1;function d(){return h++}function f(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function m(t){return t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function g(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}function y(t,e){return-1!==t.indexOf(e,t.length-e.length)}function v(t,e,r){var i={};for(var n in t)i[n]=e.call(r||this,t[n],n,t);return i}function _(t,e,r){var i={};for(var n in t)e.call(r||this,t[n],n,t)&&(i[n]=t[n]);return i}function x(t){return Array.isArray(t)?t.map(x):"object"==typeof t&&t?v(t,x):t}var b={};function w(t){b[t]||("undefined"!=typeof console&&console.warn(t),b[t]=!0)}function S(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function T(t){for(var e=0,r=0,i=t.length,n=i-1,o=void 0,a=void 0;r<i;n=r++)e+=((a=t[n]).x-(o=t[r]).x)*(o.y+a.y);return e}function E(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function I(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(t,r,i,n){var o=i||n;return e[r]=!o||o.toLowerCase(),""})),e["max-age"]){var r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}var C=null;function A(t){if(null==C){var e=t.navigator?t.navigator.userAgent:null;C=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return C}function k(t){try{var e=a[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var P,O,M,L,D=a.performance&&a.performance.now?a.performance.now.bind(a.performance):Date.now.bind(Date),R=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,z=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame||a.msCancelAnimationFrame,N={now:D,frame:function(t){var e=R(t);return{cancel:function(){return z(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var r=a.document.createElement("canvas"),i=r.getContext("2d");if(!i)throw new Error("failed to create canvas 2d context");return r.width=t.width,r.height=t.height,i.drawImage(t,0,0,t.width,t.height),i.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return(P=P||a.document.createElement("a")).href=t,P.href},hardwareConcurrency:a.navigator&&a.navigator.hardwareConcurrency||4,get devicePixelRatio(){return a.devicePixelRatio},get prefersReducedMotion(){return!!a.matchMedia&&(null==O&&(O=a.matchMedia("(prefers-reduced-motion: reduce)")),O.matches)}},B={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},F={supported:!1,testSupport:function(t){!j&&L&&(U?V(t):M=t)}},j=!1,U=!1;function V(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,L),t.isContextLost())return;F.supported=!0}catch(t){}t.deleteTexture(e),j=!0}function q(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()}a.document&&((L=a.document.createElement("img")).onload=function(){M&&V(M),U=!(M=null)},L.onerror=function(){j=!0,M=null},L.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var G="01";function Z(t){return 0===t.indexOf("mapbox:")}q.prototype._createSkuToken=function(){var t=function(){for(var t="",e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",G,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},q.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},q.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},q.prototype.normalizeStyleURL=function(t,e){if(!Z(t))return t;var r=X(t);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},q.prototype.normalizeGlyphsURL=function(t,e){if(!Z(t))return t;var r=X(t);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},q.prototype.normalizeSourceURL=function(t,e){if(!Z(t))return t;var r=X(t);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||e)},q.prototype.normalizeSpriteURL=function(t,e,r,i){var n=X(t);return Z(t)?(n.path="/styles/v1"+n.path+"/sprite"+e+r,this._makeAPIURL(n,this._customAccessToken||i)):(n.path+=""+e+r,Y(n))},q.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Z(t))return t;var r=X(t);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(2<=N.devicePixelRatio||512===e?"@2x":"")+(F.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var i=this._customAccessToken||function(){for(var t=0,e=r.params;t<e.length;t+=1){var i=e[t].match(/^access_token=(.*)$/);if(i)return i[1]}return null}()||B.ACCESS_TOKEN;return B.REQUIRE_ACCESS_TOKEN&&i&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,i)},q.prototype.canonicalizeTileURL=function(t,e){var r=X(t);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return t;var i="mapbox://tiles/";i+=r.path.replace("/v4/","");var n=r.params;return e&&(n=n.filter((function(t){return!t.match(/^access_token=/)}))),n.length&&(i+="?"+n.join("&")),i},q.prototype.canonicalizeTileset=function(t,e){for(var r=!!e&&Z(e),i=[],n=0,o=t.tiles||[];n<o.length;n+=1){var a=o[n];W(a)?i.push(this.canonicalizeTileURL(a,r)):i.push(a)}return i},q.prototype._makeAPIURL=function(t,e){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",i=X(B.API_URL);if(t.protocol=i.protocol,t.authority=i.authority,"/"!==i.path&&(t.path=""+i.path+t.path),!B.REQUIRE_ACCESS_TOKEN)return Y(t);if(!(e=e||B.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return t.params=t.params.filter((function(t){return-1===t.indexOf("access_token")})),t.params.push("access_token="+e),Y(t)};var H=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function W(t){return H.test(t)}var K=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function X(t){var e=t.match(K);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Y(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function J(t){if(!t)return null;var e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(a.atob(e[1]).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(t){return null}}function $(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}$.prototype.getStorageKey=function(t){var e,r=J(B.ACCESS_TOKEN);return e=r&&r.u?a.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x"+e))}))):B.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},$.prototype.fetchEventData=function(){var t=k("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{var i=a.localStorage.getItem(e);i&&(this.eventData=JSON.parse(i));var n=a.localStorage.getItem(r);n&&(this.anonId=n)}catch(t){w("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var t=k("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{a.localStorage.setItem(r,this.anonId),1<=Object.keys(this.eventData).length&&a.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){w("Unable to write to LocalStorage")}},$.prototype.processRequests=function(t){},$.prototype.postEvent=function(t,e,r,i){var n=this;if(B.EVENTS_URL){var o=X(B.EVENTS_URL);o.params.push("access_token="+(i||B.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.11.1",skuId:G,userId:this.anonId},s=e?p(a,e):a,l={url:Y(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=It(l,(function(t){n.pendingRequest=null,r(t),n.saveEventData(),n.processRequests(i)}))}},$.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var Q,tt,et,rt,it=(pt.__proto__=rt=$,((pt.prototype=Object.create(rt&&rt.prototype)).constructor=pt).prototype.postMapLoadEvent=function(t,e,r,i){this.skuToken=r,(B.EVENTS_URL&&i||B.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return Z(t)||W(t)})))&&this.queueRequest({id:e,timestamp:Date.now()},i)},pt.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var r=this.queue.shift(),i=r.id,n=r.timestamp;i&&this.success[i]||(this.anonId||this.fetchEventData(),m(this.anonId)||(this.anonId=f()),this.postEvent(n,{skuToken:this.skuToken},(function(t){t||i&&(e.success[i]=!0)}),t))}},pt),nt=(ut.__proto__=et=$,((ut.prototype=Object.create(et&&et.prototype)).constructor=ut).prototype.postTurnstileEvent=function(t,e){B.EVENTS_URL&&B.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return Z(t)||W(t)}))&&this.queueRequest(Date.now(),e)},ut.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var r=J(B.ACCESS_TOKEN),i=r?r.u:B.ACCESS_TOKEN,n=i!==this.eventData.tokenU;m(this.anonId)||(this.anonId=f(),n=!0);var o=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),s=new Date(o),l=(o-this.eventData.lastSuccess)/864e5;n=n||1<=l||l<-1||a.getDate()!==s.getDate()}else n=!0;if(!n)return this.processRequests();this.postEvent(o,{"enabled.telemetry":!1},(function(t){t||(e.eventData.lastSuccess=o,e.eventData.tokenU=i)}),t)}},new ut),ot=nt.postTurnstileEvent.bind(nt),at=new it,st=at.postMapLoadEvent.bind(at),lt=500,ct=50;function ut(t){et.call(this,"appUserTurnstile"),this._customAccessToken=t}function pt(){rt.call(this,"map.load"),this.success={},this.skuToken=""}function ht(){a.caches&&!Q&&(Q=a.caches.open("mapbox-tiles"))}function dt(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var ft,mt=1/0;function gt(){return null==ft&&(ft=a.OffscreenCanvas&&new a.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.createImageBitmap),ft}var yt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(yt);var vt,_t=((vt=Error)&&(bt.__proto__=vt),((bt.prototype=Object.create(vt&&vt.prototype)).constructor=bt).prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},bt),xt=E()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===a.location.protocol?a.parent:a).location.href};function bt(t,e,r){401===e&&W(r)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),vt.call(this,t),this.status=e,this.url=r,this.name=this.constructor.name,this.message=t}function wt(t,e){if(!(/^file:/.test(r=t.url)||/^file:/.test(xt())&&!/^\w+:/.test(r))){if(a.fetch&&a.Request&&a.AbortController&&a.Request.prototype.hasOwnProperty("signal"))return function(t,e){var r,i=new a.AbortController,n=new a.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:xt(),signal:i.signal}),o=!1,s=!1,l=0<(r=n.url).indexOf("sku=")&&W(r);function c(r,i,o){if(!s){if(r&&"SecurityError"!==r.message&&w(r),i&&o)return u(i);var c=Date.now();a.fetch(n).then((function(r){if(r.ok){var i=l?r.clone():null;return u(r,i,c)}return e(new _t(r.statusText,r.status,t.url))})).catch((function(t){20!==t.code&&e(new Error(t.message))}))}}"json"===t.type&&n.headers.set("Accept","application/json");var u=function(r,i,l){("arrayBuffer"===t.type?r.arrayBuffer():"json"===t.type?r.json():r.text()).then((function(t){s||(i&&l&&function(t,e,r){if(ht(),Q){var i={status:e.status,statusText:e.statusText,headers:new a.Headers};e.headers.forEach((function(t,e){return i.headers.set(e,t)}));var n=I(e.headers.get("Cache-Control")||"");n["no-store"]||(n["max-age"]&&i.headers.set("Expires",new Date(r+1e3*n["max-age"]).toUTCString()),new Date(i.headers.get("Expires")).getTime()-r<42e4||function(t,e){if(void 0===tt)try{new Response(new ReadableStream),tt=!0}catch(t){tt=!1}tt?e(t.body):t.blob().then(e)}(e,(function(e){var r=new a.Response(e,i);ht(),Q&&Q.then((function(e){return e.put(dt(t.url),r)})).catch((function(t){return w(t.message)}))})))}}(n,i,l),o=!0,e(null,t,r.headers.get("Cache-Control"),r.headers.get("Expires")))})).catch((function(t){s||e(new Error(t.message))}))};return l?function(t,e){if(ht(),!Q)return e(null);var r=dt(t.url);Q.then((function(t){t.match(r).then((function(i){var n=function(t){if(!t)return!1;var e=new Date(t.headers.get("Expires")||0),r=I(t.headers.get("Cache-Control")||"");return e>Date.now()&&!r["no-cache"]}(i);t.delete(r),n&&t.put(r,i.clone()),e(null,i,n)})).catch(e)})).catch(e)}(n,c):c(null,null),{cancel:function(){s=!0,o||i.abort()}}}(t,e);if(E()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var r;return function(t,e){var r=new a.XMLHttpRequest;for(var i in r.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(r.responseType="arraybuffer"),t.headers)r.setRequestHeader(i,t.headers[i]);return"json"===t.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===t.credentials,r.onerror=function(){e(new Error(r.statusText))},r.onload=function(){if((200<=r.status&&r.status<300||0===r.status)&&null!==r.response){var i=r.response;if("json"===t.type)try{i=JSON.parse(r.response)}catch(i){return e(i)}e(null,i,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else e(new _t(r.statusText,r.status,t.url))},r.send(t.body),{cancel:function(){return r.abort()}}}(t,e)}function St(t,e){return wt(p(t,{type:"arrayBuffer"}),e)}var Tt,Et,It=function(t,e){return wt(p(t,{method:"POST"}),e)};Tt=[],Et=0;var Ct=function(t,e){if(F.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Et>=B.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return Tt.push(r),r}function i(){if(!n)for(n=!0,Et--;Tt.length&&Et<B.MAX_PARALLEL_IMAGE_REQUESTS;){var t=Tt.shift();t.cancelled||(t.cancel=Ct(t.requestParameters,t.callback).cancel)}}Et++;var n=!1,o=St(t,(function(t,r,n,o){var s,l,c;i(),t?e(t):r&&(gt()?(s=r,l=e,c=new a.Blob([new Uint8Array(s)],{type:"image/png"}),a.createImageBitmap(c).then((function(t){l(null,t)})).catch((function(t){l(new Error("Could not load image because of "+t.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))):function(t,e,r,i){var n=new a.Image,o=a.URL;n.onload=function(){e(null,n),o.revokeObjectURL(n.src)},n.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var s=new a.Blob([new Uint8Array(t)],{type:"image/png"});n.cacheControl=r,n.expires=i,n.src=t.byteLength?o.createObjectURL(s):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(r,e,n,o))}));return{cancel:function(){o.cancel(),i()}}};function At(t,e,r){r[t]&&-1!==r[t].indexOf(e)||(r[t]=r[t]||[],r[t].push(e))}function kt(t,e,r){if(r&&r[t]){var i=r[t].indexOf(e);-1!==i&&r[t].splice(i,1)}}function Pt(t,e){void 0===e&&(e={}),p(this,e),this.type=t}function Ot(){}var Mt,Lt=(Dt.__proto__=Mt=Pt,(Dt.prototype=Object.create(Mt&&Mt.prototype)).constructor=Dt);function Dt(t,e){void 0===e&&(e={}),Mt.call(this,"error",p({error:t},e))}Ot.prototype.on=function(t,e){return this._listeners=this._listeners||{},At(t,e,this._listeners),this},Ot.prototype.off=function(t,e){return kt(t,e,this._listeners),kt(t,e,this._oneTimeListeners),this},Ot.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},At(t,e,this._oneTimeListeners),this},Ot.prototype.fire=function(t,e){"string"==typeof t&&(t=new Pt(t,e||{}));var r=t.type;if(this.listens(r)){for(var i=0,n=(t.target=this)._listeners&&this._listeners[r]?this._listeners[r].slice():[];i<n.length;i+=1)n[i].call(this,t);for(var o=0,a=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];o<a.length;o+=1){var s=a[o];kt(r,s,this._oneTimeListeners),s.call(this,t)}var l=this._eventedParent;l&&(p(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),l.fire(t))}else t instanceof Lt&&console.error(t.error);return this},Ot.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&0<this._listeners[t].length||this._oneTimeListeners&&this._oneTimeListeners[t]&&0<this._oneTimeListeners[t].length||this._eventedParent&&this._eventedParent.listens(t)};var Rt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!(Ot.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this})},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},zt=function(t,e,r,i){this.message=(t?t+": ":"")+r,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)};function Nt(t){var e=t.value;return e?[new zt(t.key,e,"constants have been deprecated as of v8")]:[]}function Bt(t){for(var e=[],r=arguments.length-1;0<r--;)e[r]=arguments[r+1];for(var i=0,n=e;i<n.length;i+=1){var o=n[i];for(var a in o)t[a]=o[a]}return t}function Ft(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function jt(t){if(Array.isArray(t))return t.map(jt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var r in t)e[r]=jt(t[r]);return e}return Ft(t)}function Ut(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var r=0,i=e;r<i.length;r+=1){var n=i[r];this.bindings[n[0]]=n[1]}}var Vt,qt=((Vt=Error)&&(Gt.__proto__=Vt),(Gt.prototype=Object.create(Vt&&Vt.prototype)).constructor=Gt);function Gt(t,e){Vt.call(this,e),this.message=e,this.key=t}Ut.prototype.concat=function(t){return new Ut(this,t)},Ut.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Ut.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Zt={kind:"null"},Ht={kind:"number"},Wt={kind:"string"},Kt={kind:"boolean"},Xt={kind:"color"},Yt={kind:"object"},Jt={kind:"value"},$t={kind:"collator"},Qt={kind:"formatted"},te={kind:"resolvedImage"};function ee(t,e){return{kind:"array",itemType:t,N:e}}function re(t){if("array"!==t.kind)return t.kind;var e=re(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}var ie=[Zt,Ht,Wt,Kt,Xt,Qt,Yt,ee(Jt),te];function ne(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!ne(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var r=0,i=ie;r<i.length;r+=1)if(!ne(i[r],e))return null}return"Expected "+re(t)+" but found "+re(e)+" instead."}function oe(t,e){return e.some((function(e){return e.kind===t.kind}))}function ae(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t}))}var se=e((function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(t){return(t=Math.round(t))<0?0:255<t?255:t}function n(t){return i("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function o(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:1<e?1:e;var e}function a(t,e,r){return r<0?r+=1:1<r&&--r,6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,s=t.replace(/ /g,"").toLowerCase();if(s in r)return r[s].slice();if("#"===s[0])return 4===s.length?0<=(e=parseInt(s.substr(1),16))&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===s.length&&0<=(e=parseInt(s.substr(1),16))&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=s.indexOf("("),c=s.indexOf(")");if(-1!==l&&c+1===s.length){var u=s.substr(0,l),p=s.substr(l+1,c-(l+1)).split(","),h=1;switch(u){case"rgba":if(4!==p.length)return null;h=o(p.pop());case"rgb":return 3!==p.length?null:[n(p[0]),n(p[1]),n(p[2]),h];case"hsla":if(4!==p.length)return null;h=o(p.pop());case"hsl":if(3!==p.length)return null;var d=(parseFloat(p[0])%360+360)%360/360,f=o(p[1]),m=o(p[2]),g=m<=.5?m*(f+1):m+f-m*f,y=2*m-g;return[i(255*a(y,g,d+1/3)),i(255*a(y,g,d)),i(255*a(y,g,d-1/3)),h];default:return null}}return null}}catch(t){}})).parseCSSColor,le=function(t,e,r,i){void 0===i&&(i=1),this.r=t,this.g=e,this.b=r,this.a=i};le.parse=function(t){if(t){if(t instanceof le)return t;if("string"==typeof t){var e=se(t);if(e)return new le(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},le.prototype.toString=function(){var t=this.toArray(),e=t[1],r=t[2],i=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(r)+","+i+")"},le.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},le.black=new le(0,0,0,1),le.white=new le(1,1,1,1),le.transparent=new le(0,0,0,0),le.red=new le(1,0,0,1);var ce=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};function ue(t,e,r,i,n){this.text=t,this.image=e,this.scale=r,this.fontStack=i,this.textColor=n}ce.prototype.compare=function(t,e){return this.collator.compare(t,e)},ce.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var pe=function(t){this.sections=t};pe.fromString=function(t){return new pe([new ue(t,null,null,null,null)])},pe.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},pe.factory=function(t){return t instanceof pe?t:pe.fromString(t)},pe.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},pe.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var i=r[e];if(i.image)t.push(["image",i.image.name]);else{t.push(i.text);var n={};i.fontStack&&(n["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(n["font-scale"]=i.scale),i.textColor&&(n["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(n)}}return t};var he=function(t){this.name=t.name,this.available=t.available};function de(t,e,r,i){return"number"==typeof t&&0<=t&&t<=255&&"number"==typeof e&&0<=e&&e<=255&&"number"==typeof r&&0<=r&&r<=255?void 0===i||"number"==typeof i&&0<=i&&i<=1?null:"Invalid rgba value ["+[t,e,r,i].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof i?[t,e,r,i]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function fe(t){if(null===t)return 1;if("string"==typeof t)return 1;if("boolean"==typeof t)return 1;if("number"==typeof t)return 1;if(t instanceof le)return 1;if(t instanceof ce)return 1;if(t instanceof pe)return 1;if(t instanceof he)return 1;if(Array.isArray(t)){for(var e=0,r=t;e<r.length;e+=1)if(!fe(r[e]))return;return 1}if("object"==typeof t){for(var i in t)if(!fe(t[i]))return;return 1}}function me(t){if(null===t)return Zt;if("string"==typeof t)return Wt;if("boolean"==typeof t)return Kt;if("number"==typeof t)return Ht;if(t instanceof le)return Xt;if(t instanceof ce)return $t;if(t instanceof pe)return Qt;if(t instanceof he)return te;if(Array.isArray(t)){for(var e,r=t.length,i=0,n=t;i<n.length;i+=1){var o=me(n[i]);if(e){if(e===o)continue;e=Jt;break}e=o}return ee(e||Jt,r)}return Yt}function ge(t){var e=typeof t;return null===t?"":"string"==e||"number"==e||"boolean"==e?String(t):t instanceof le||t instanceof pe||t instanceof he?t.toString():JSON.stringify(t)}function ye(t,e){this.type=t,this.value=e}he.prototype.toString=function(){return this.name},he.fromString=function(t){return t?new he({name:t,available:!1}):null},he.prototype.serialize=function(){return["image",this.name]},ye.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!fe(t[1]))return e.error("invalid value");var r=t[1],i=me(r),n=e.expectedType;return"array"!==i.kind||0!==i.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(i=n),new ye(i,r)},ye.prototype.evaluate=function(){return this.value},ye.prototype.eachChild=function(){},ye.prototype.outputDefined=function(){return!0},ye.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof le?["rgba"].concat(this.value.toArray()):this.value instanceof pe?this.value.serialize():this.value};var ve=function(t){this.name="ExpressionEvaluationError",this.message=t};function _e(t,e){this.type=t,this.args=e}ve.prototype.toJSON=function(){return this.message};var xe={string:Wt,number:Ht,boolean:Kt,object:Yt};function be(t){this.type=Qt,this.sections=t}function we(t){this.type=te,this.input=t}function Se(t,e){this.type=t,this.args=e}_e.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r,i=1,n=t[0];if("array"===n){var o,a;if(2<t.length){var s=t[1];if("string"!=typeof s||!(s in xe)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=xe[s],i++}else o=Jt;if(3<t.length){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],i++}r=ee(o,a)}else r=xe[n];for(var l=[];i<t.length;i++){var c=e.parse(t[i],i,Jt);if(!c)return null;l.push(c)}return new _e(r,l)},_e.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!ne(this.type,me(r)))return r;if(e===this.args.length-1)throw new ve("Expected value to be of type "+re(this.type)+", but found "+re(me(r))+" instead.")}return null},_e.prototype.eachChild=function(t){this.args.forEach(t)},_e.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},_e.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);var i=t.N;("number"==typeof i||1<this.args.length)&&e.push(i)}}return e.concat(this.args.map((function(t){return t.serialize()})))},be.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[1];if(!Array.isArray(r)&&"object"==typeof r)return e.error("First argument must be an image or text section.");for(var i=[],n=!1,o=1;o<=t.length-1;++o){var a=t[o];if(n&&"object"==typeof a&&!Array.isArray(a)){n=!1;var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,Ht)))return null;var l=null;if(a["text-font"]&&!(l=e.parse(a["text-font"],1,ee(Wt))))return null;var c=null;if(a["text-color"]&&!(c=e.parse(a["text-color"],1,Xt)))return null;var u=i[i.length-1];u.scale=s,u.font=l,u.textColor=c}else{var p=e.parse(t[o],1,Jt);if(!p)return null;var h=p.type.kind;if("string"!==h&&"value"!==h&&"null"!==h&&"resolvedImage"!==h)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");n=!0,i.push({content:p,scale:null,font:null,textColor:null})}}return new be(i)},be.prototype.evaluate=function(t){return new pe(this.sections.map((function(e){var r=e.content.evaluate(t);return me(r)===te?new ue("",r,null,null,null):new ue(ge(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},be.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var i=r[e];t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}},be.prototype.outputDefined=function(){return!1},be.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var i=r[e];t.push(i.content.serialize());var n={};i.scale&&(n["font-scale"]=i.scale.serialize()),i.font&&(n["text-font"]=i.font.serialize()),i.textColor&&(n["text-color"]=i.textColor.serialize()),t.push(n)}return t},we.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,Wt);return r?new we(r):e.error("No image name provided.")},we.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=he.fromString(e);return r&&t.availableImages&&(r.available=-1<t.availableImages.indexOf(e)),r},we.prototype.eachChild=function(t){t(this.input)},we.prototype.outputDefined=function(){return!1},we.prototype.serialize=function(){return["image",this.input.serialize()]};var Te={"to-boolean":Kt,"to-color":Xt,"to-number":Ht,"to-string":Wt};function Ee(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}Se.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[0];if(("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");for(var i=Te[r],n=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,Jt);if(!a)return null;n.push(a)}return new Se(i,n)},Se.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,r,i=0,n=this.args;i<n.length;i+=1){if(r=null,(e=n[i].evaluate(t))instanceof le)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(r=e.length<3||4<e.length?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":de(e[0],e[1],e[2],e[3])))return new le(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ve(r||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"!==this.type.kind)return"formatted"===this.type.kind?pe.fromString(ge(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?he.fromString(ge(this.args[0].evaluate(t))):ge(this.args[0].evaluate(t));for(var a=null,s=0,l=this.args;s<l.length;s+=1){if(null===(a=l[s].evaluate(t)))return 0;var c=Number(a);if(!isNaN(c))return c}throw new ve("Could not convert "+JSON.stringify(a)+" to number.")},Se.prototype.eachChild=function(t){this.args.forEach(t)},Se.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},Se.prototype.serialize=function(){if("formatted"===this.type.kind)return new be([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new we(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var Ie=["Unknown","Point","LineString","Polygon"];Ee.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ee.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Ie[this.feature.type]:this.feature.type:null},Ee.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ee.prototype.canonicalID=function(){return this.canonical},Ee.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ee.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(this._parseColorCache[t]=le.parse(t))};var Ce=function(t,e,r,i){this.name=t,this.type=e,this._evaluate=r,this.args=i};function Ae(t,e,r){this.type=$t,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e}function ke(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Pe(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Oe(t,e){for(var r,i,n,o,a,s,l=!1,c=0,u=e.length;c<u;c++)for(var p=e[c],h=0,d=p.length;h<d-1;h++){if((n=t[0]-(r=p[h])[0])*(s=t[1]-(i=p[h+1])[1])-(a=t[0]-i[0])*(o=t[1]-r[1])==0&&n*a<=0&&o*s<=0)return;f=t,m=p[h],g=p[h+1],m[1]>f[1]!=g[1]>f[1]&&f[0]<(g[0]-m[0])*(f[1]-m[1])/(g[1]-m[1])+m[0]&&(l=!l)}var f,m,g;return l}function Me(t,e){for(var r=0;r<e.length;r++)if(Oe(t,e[r]))return 1}function Le(t,e,r,i){var n=i[0]-r[0],o=i[1]-r[1],a=(t[0]-r[0])*o-n*(t[1]-r[1]),s=(e[0]-r[0])*o-n*(e[1]-r[1]);return 0<a&&s<0||a<0&&0<s}function De(t,e,r){for(var i=0,n=r;i<n.length;i+=1)for(var o=n[i],a=0;a<o.length-1;++a)if(0!=(c=[(l=o[a+1])[0]-(s=o[a])[0],l[1]-s[1]])[0]*(u=[e[0]-t[0],e[1]-t[1]])[1]-c[1]*u[0]&&Le(t,e,s,l)&&Le(s,l,t,e))return 1;var s,l,c,u}function Re(t,e){for(var r=0;r<t.length;++r)if(!Oe(t[r],e))return;for(var i=0;i<t.length-1;++i)if(De(t[i],t[i+1],e))return;return 1}function ze(t,e){for(var r=0;r<e.length;r++)if(Re(t,e[r]))return 1}function Ne(t,e,r){for(var i=[],n=0;n<t.length;n++){for(var o=[],a=0;a<t[n].length;a++){var s=(l=t[n][a],c=r,u=(180+l[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,h=Math.pow(2,c.z),[Math.round(u*h*8192),Math.round(p*h*8192)]);ke(e,s),o.push(s)}i.push(o)}var l,c,u,p,h;return i}function Be(t,e,r){for(var i=[],n=0;n<t.length;n++){var o=Ne(t[n],e,r);i.push(o)}return i}function Fe(t,e,r,i){if(t[0]<r[0]||t[0]>r[2]){var n=.5*i,o=t[0]-r[0]>n?-i:r[0]-t[0]>n?i:0;0===o&&(o=t[0]-r[2]>n?-i:r[2]-t[0]>n?i:0),t[0]+=o}ke(e,t)}function je(t,e,r,i){for(var n=8192*Math.pow(2,i.z),o=[8192*i.x,8192*i.y],a=[],s=0,l=t;s<l.length;s+=1)for(var c=0,u=l[s];c<u.length;c+=1){var p=u[c],h=[p.x+o[0],p.y+o[1]];Fe(h,e,r,n),a.push(h)}return a}function Ue(t,e,r,i){for(var n,o=8192*Math.pow(2,i.z),a=[8192*i.x,8192*i.y],s=[],l=0,c=t;l<c.length;l+=1){for(var u=[],p=0,h=c[l];p<h.length;p+=1){var d=h[p],f=[d.x+a[0],d.y+a[1]];ke(e,f),u.push(f)}s.push(u)}if(e[2]-e[0]<=o/2){(n=e)[0]=n[1]=1/0,n[2]=n[3]=-1/0;for(var m=0,g=s;m<g.length;m+=1)for(var y=0,v=g[m];y<v.length;y+=1)Fe(v[y],e,r,o)}return s}Ce.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Ce.prototype.eachChild=function(t){this.args.forEach(t)},Ce.prototype.outputDefined=function(){return!1},Ce.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},Ce.parse=function(t,e){var r,i=t[0],n=Ce.definitions[i];if(!n)return e.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,s=a.filter((function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1})),l=null,c=0,u=s;c<u.length;c+=1){var p=u[c],h=p[0],d=p[1];l=new We(e.registry,e.path,null,e.scope);for(var f=[],m=!1,g=1;g<t.length;g++){var y=t[g],v=Array.isArray(h)?h[g-1]:h.type,_=l.parse(y,1+f.length,v);if(!_){m=!0;break}f.push(_)}if(!m)if(Array.isArray(h)&&h.length!==f.length)l.error("Expected "+h.length+" arguments, but found "+f.length+" instead.");else{for(var x=0;x<f.length;x++){var b=Array.isArray(h)?h[x]:h.type,w=f[x];l.concat(x+1).checkSubtype(b,w.type)}if(0===l.errors.length)return new Ce(i,o,d,f)}}if(1===s.length)(r=e.errors).push.apply(r,l.errors);else{for(var S=(s.length?s:a).map((function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(re).join(", ")+")":"("+re(e.type)+"...)"})).join(" | "),T=[],E=1;E<t.length;E++){var I=e.parse(t[E],1+T.length);if(!I)return null;T.push(re(I.type))}e.error("Expected arguments of type "+S+", but found ("+T.join(", ")+") instead.")}return null},Ce.register=function(t,e){for(var r in Ce.definitions=e)t[r]=Ce},Ae.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var r=t[1];if("object"!=typeof r||Array.isArray(r))return e.error("Collator options argument must be an object.");var i=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Kt);if(!i)return null;var n=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Kt);if(!n)return null;var o=null;return r.locale&&!(o=e.parse(r.locale,1,Wt))?null:new Ae(i,n,o)},Ae.prototype.evaluate=function(t){return new ce(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Ae.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Ae.prototype.outputDefined=function(){return!1},Ae.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Ve=function(t,e){this.type=Kt,this.geojson=t,this.geometries=e};function qe(t){if(t instanceof Ce){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Ve)return!1;var e=!0;return t.eachChild((function(t){e&&!qe(t)&&(e=!1)})),e}function Ge(t){if(!(t instanceof Ce&&"feature-state"===t.name)){var e=!0;return t.eachChild((function(t){e&&!Ge(t)&&(e=!1)})),e}}function Ze(t,e){if(t instanceof Ce&&0<=e.indexOf(t.name))return!1;var r=!0;return t.eachChild((function(t){r&&!Ze(t,e)&&(r=!1)})),r}function He(t,e){this.type=e.type,this.name=t,this.boundExpression=e}Ve.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(fe(t[1])){var r=t[1];if("FeatureCollection"===r.type)for(var i=0;i<r.features.length;++i){var n=r.features[i].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new Ve(r,r.features[i].geometry)}else if("Feature"===r.type){var o=r.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new Ve(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new Ve(r,r)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Ve.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){var o=Ne(e.coordinates,i,n),a=je(t.geometry(),r,i,n);if(!Pe(r,i))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!Oe(l[s],o))return!1}if("MultiPolygon"===e.type){var c=Be(e.coordinates,i,n),u=je(t.geometry(),r,i,n);if(!Pe(r,i))return!1;for(var p=0,h=u;p<h.length;p+=1)if(!Me(h[p],c))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){var o=Ne(e.coordinates,i,n),a=Ue(t.geometry(),r,i,n);if(!Pe(r,i))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!Re(l[s],o))return!1}if("MultiPolygon"===e.type){var c=Be(e.coordinates,i,n),u=Ue(t.geometry(),r,i,n);if(!Pe(r,i))return!1;for(var p=0,h=u;p<h.length;p+=1)if(!ze(h[p],c))return!1}return!0}(t,this.geometries)}return!1},Ve.prototype.eachChild=function(){},Ve.prototype.outputDefined=function(){return!0},Ve.prototype.serialize=function(){return["within",this.geojson]},He.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new He(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},He.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},He.prototype.eachChild=function(){},He.prototype.outputDefined=function(){return!1},He.prototype.serialize=function(){return["var",this.name]};var We=function(t,e,r,i,n){void 0===e&&(e=[]),void 0===i&&(i=new Ut),void 0===n&&(n=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=i,this.errors=n,this.expectedType=r};function Ke(t,e){for(var r,i=t.length-1,n=0,o=i,a=0;n<=o;)if((r=t[a=Math.floor((n+o)/2)])<=e){if(a===i||e<t[a+1])return a;n=a+1}else{if(!(e<r))throw new ve("Input is not a number.");o=a-1}return 0}We.prototype.parse=function(t,e,r,i,n){return void 0===n&&(n={}),e?this.concat(e,r,i)._parse(t,n):this._parse(t,n)},We.prototype._parse=function(t,e){function r(t,e,r){return"assert"===r?new _e(e,[t]):"coerce"===r?new Se(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var i=t[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found "+typeof i+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var n=this.registry[i];if(n){var o=n.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=r(o,a,e.typeAnnotation||"coerce");else o=r(o,a,e.typeAnnotation||"assert")}if(!(o instanceof ye)&&"resolvedImage"!==o.type.kind&&function t(e){if(e instanceof He)return t(e.boundExpression);if(e instanceof Ce&&"error"===e.name)return!1;if(e instanceof Ae)return!1;if(e instanceof Ve)return!1;var r=e instanceof Se||e instanceof _e,i=!0;return e.eachChild((function(e){i=r?i&&t(e):i&&e instanceof ye})),!!i&&qe(e)&&Ze(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var l=new Ee;try{o=new ye(o.type,o.evaluate(l))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},We.prototype.concat=function(t,e,r){var i="number"==typeof t?this.path.concat(t):this.path,n=r?this.scope.concat(r):this.scope;return new We(this.registry,i,e||null,n,this.errors)},We.prototype.error=function(t){for(var e=[],r=arguments.length-1;0<r--;)e[r]=arguments[r+1];var i=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new qt(i,t))},We.prototype.checkSubtype=function(t,e){var r=ne(t,e);return r&&this.error(r),r};var Xe=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var i=0,n=r;i<n.length;i+=1){var o=n[i],a=o[1];this.labels.push(o[0]),this.outputs.push(a)}};function Ye(t,e,r){return t*(1-r)+e*r}Xe.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var r=e.parse(t[1],1,Ht);if(!r)return null;var i=[],n=null;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var o=1;o<t.length;o+=2){var a=1===o?-1/0:t[o],s=t[o+1],l=o,c=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(i.length&&i[i.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var u=e.parse(s,c,n);if(!u)return null;n=n||u.type,i.push([a,u])}return new Xe(n,r,i)},Xe.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return r[0].evaluate(t);var n=e.length;return i>=e[n-1]?r[n-1].evaluate(t):r[Ke(e,i)].evaluate(t)},Xe.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},Xe.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},Xe.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)0<e&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Je=Object.freeze({__proto__:null,number:Ye,color:function(t,e,r){return new le(Ye(t.r,e.r,r),Ye(t.g,e.g,r),Ye(t.b,e.b,r),Ye(t.a,e.a,r))},array:function(t,e,r){return t.map((function(t,i){return Ye(t,e[i],r)}))}}),$e=6/29*3*(6/29),Qe=Math.PI/180,tr=180/Math.PI;function er(t){return.008856451679035631<t?Math.pow(t,1/3):t/$e+4/29}function rr(t){return 6/29<t?t*t*t:$e*(t-4/29)}function ir(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function nr(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function or(t){var e=nr(t.r),r=nr(t.g),i=nr(t.b),n=er((.4124564*e+.3575761*r+.1804375*i)/.95047),o=er(.2126729*e+.7151522*r+.072175*i);return{l:116*o-16,a:500*(n-o),b:200*(o-er((.0193339*e+.119192*r+.9503041*i)/1.08883)),alpha:t.a}}function ar(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=+rr(e),r=.95047*rr(r),i=1.08883*rr(i),new le(ir(3.2404542*r-1.5371385*e-.4985314*i),ir(-.969266*r+1.8760108*e+.041556*i),ir(.0556434*r-.2040259*e+1.0572252*i),t.alpha)}var sr={forward:or,reverse:ar,interpolate:function(t,e,r){return{l:Ye(t.l,e.l,r),a:Ye(t.a,e.a,r),b:Ye(t.b,e.b,r),alpha:Ye(t.alpha,e.alpha,r)}}},lr={forward:function(t){var e=or(t),r=e.l,i=e.a,n=e.b,o=Math.atan2(n,i)*tr;return{h:o<0?360+o:o,c:Math.sqrt(i*i+n*n),l:r,alpha:t.a}},reverse:function(t){var e=t.h*Qe,r=t.c;return ar({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:(i=t.h,n=e.h,i+r*(180<(o=n-i)||o<-180?o-360*Math.round(o/360):o)),c:Ye(t.c,e.c,r),l:Ye(t.l,e.l,r),alpha:Ye(t.alpha,e.alpha,r)};var i,n,o}},cr=Object.freeze({__proto__:null,lab:sr,hcl:lr}),ur=function(t,e,r,i,n){this.type=t,this.operator=e,this.interpolation=r,this.input=i,this.labels=[],this.outputs=[];for(var o=0,a=n;o<a.length;o+=1){var s=a[o],l=s[1];this.labels.push(s[0]),this.outputs.push(l)}};function pr(t,e,r,i){var n=i-r,o=t-r;return 0==n?0:1===e?o/n:(Math.pow(e,o)-1)/(Math.pow(e,n)-1)}ur.interpolationFactor=function(t,e,i,n){var o=0;if("exponential"===t.name)o=pr(e,t.base,i,n);else if("linear"===t.name)o=pr(e,1,i,n);else if("cubic-bezier"===t.name){var a=t.controlPoints;o=new r(a[0],a[1],a[2],a[3]).solve(pr(e,1,i,n))}return o},ur.parse=function(t,e){var r=t[0],i=t[1],n=t[2],o=t.slice(3);if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){var a=i[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:a}}else{if("cubic-bezier"!==i[0])return e.error("Unknown interpolation type "+String(i[0]),1,0);var s=i.slice(1);if(4!==s.length||s.some((function(t){return"number"!=typeof t||t<0||1<t})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(n=e.parse(n,2,Ht)))return null;var l=[],c=null;"interpolate-hcl"===r||"interpolate-lab"===r?c=Xt:e.expectedType&&"value"!==e.expectedType.kind&&(c=e.expectedType);for(var u=0;u<o.length;u+=2){var p=o[u],h=o[u+1],d=u+3,f=u+4;if("number"!=typeof p)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(l.length&&l[l.length-1][0]>=p)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var m=e.parse(h,f,c);if(!m)return null;c=c||m.type,l.push([p,m])}return"number"===c.kind||"color"===c.kind||"array"===c.kind&&"number"===c.itemType.kind&&"number"==typeof c.N?new ur(c,r,i,n,l):e.error("Type "+re(c)+" is not interpolatable.")},ur.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return r[0].evaluate(t);var n=e.length;if(i>=e[n-1])return r[n-1].evaluate(t);var o=Ke(e,i),a=ur.interpolationFactor(this.interpolation,i,e[o],e[o+1]),s=r[o].evaluate(t),l=r[o+1].evaluate(t);return"interpolate"===this.operator?Je[this.type.kind.toLowerCase()](s,l,a):"interpolate-hcl"===this.operator?lr.reverse(lr.interpolate(lr.forward(s),lr.forward(l),a)):sr.reverse(sr.interpolate(sr.forward(s),sr.forward(l),a))},ur.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},ur.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},ur.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],r=0;r<this.labels.length;r++)e.push(this.labels[r],this.outputs[r].serialize());return e};var hr=function(t,e){this.type=t,this.args=e};hr.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,i=e.expectedType;i&&"value"!==i.kind&&(r=i);for(var n=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=e.parse(a[o],1+n.length,r,void 0,{typeAnnotation:"omit"});if(!s)return null;r=r||s.type,n.push(s)}var l=i&&n.some((function(t){return ne(i,t.type)}));return new hr(l?Jt:r,n)},hr.prototype.evaluate=function(t){for(var e,r=null,i=0,n=0,o=this.args;n<o.length&&(i++,(r=o[n].evaluate(t))&&r instanceof he&&!r.available&&(e=e||r.name,r=null,i===this.args.length&&(r=e)),null===r);n+=1);return r},hr.prototype.eachChild=function(t){this.args.forEach(t)},hr.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},hr.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var dr=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};function fr(t,e,r){this.type=t,this.index=e,this.input=r}function mr(t,e){this.type=Kt,this.needle=t,this.haystack=e}function gr(t,e,r){this.type=Ht,this.needle=t,this.haystack=e,this.fromIndex=r}function yr(t,e,r,i,n,o){this.inputType=t,this.type=e,this.input=r,this.cases=i,this.outputs=n,this.otherwise=o}function vr(t,e,r){this.type=t,this.branches=e,this.otherwise=r}function _r(t,e,r,i){this.type=t,this.input=e,this.beginIndex=r,this.endIndex=i}function xr(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function br(t,e,r,i){return 0===i.compare(e,r)}function wr(t,e,r){var i="=="!==t&&"!="!==t;return n.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var r=t[0],o=e.parse(t[1],1,Jt);if(!o)return null;if(!xr(r,o.type))return e.concat(1).error('"'+r+"\" comparisons are not supported for type '"+re(o.type)+"'.");var a=e.parse(t[2],2,Jt);if(!a)return null;if(!xr(r,a.type))return e.concat(2).error('"'+r+"\" comparisons are not supported for type '"+re(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+re(o.type)+"' and '"+re(a.type)+"'.");i&&("value"===o.type.kind&&"value"!==a.type.kind?o=new _e(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new _e(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,$t)))return null}return new n(o,a,s)},n.prototype.evaluate=function(n){var o=this.lhs.evaluate(n),a=this.rhs.evaluate(n);if(i&&this.hasUntypedArgument){var s=me(o),l=me(a);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new ve('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+l.kind+") instead.")}if(this.collator&&!i&&this.hasUntypedArgument){var c=me(o),u=me(a);if("string"!==c.kind||"string"!==u.kind)return e(n,o,a)}return this.collator?r(n,o,a,this.collator.evaluate(n)):e(n,o,a)},n.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},n.prototype.outputDefined=function(){return!0},n.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},n;function n(t,e,r){this.type=Kt,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}}function Sr(t,e,r,i,n){this.type=Wt,this.number=t,this.locale=e,this.currency=r,this.minFractionDigits=i,this.maxFractionDigits=n}dr.prototype.evaluate=function(t){return this.result.evaluate(t)},dr.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1)t(r[e][1]);t(this.result)},dr.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],i=1;i<t.length-1;i+=2){var n=t[i];if("string"!=typeof n)return e.error("Expected string, but found "+typeof n+" instead.",i);if(/[^a-zA-Z0-9_]/.test(n))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=e.parse(t[i+1],i+1);if(!o)return null;r.push([n,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return a?new dr(r,a):null},dr.prototype.outputDefined=function(){return this.result.outputDefined()},dr.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var i=r[e];t.push(i[0],i[1].serialize())}return t.push(this.result.serialize()),t},fr.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,Ht),i=e.parse(t[2],2,ee(e.expectedType||Jt));return r&&i?new fr(i.type.itemType,r,i):null},fr.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new ve("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new ve("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new ve("Array index must be an integer, but found "+e+" instead.");return r[e]},fr.prototype.eachChild=function(t){t(this.index),t(this.input)},fr.prototype.outputDefined=function(){return!1},fr.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]},mr.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,Jt),i=e.parse(t[2],2,Jt);return r&&i?oe(r.type,[Kt,Wt,Ht,Zt,Jt])?new mr(r,i):e.error("Expected first argument to be of type boolean, string, number or null, but found "+re(r.type)+" instead"):null},mr.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!r)return!1;if(!ae(e,["boolean","string","number","null"]))throw new ve("Expected first argument to be of type boolean, string, number or null, but found "+re(me(e))+" instead.");if(!ae(r,["string","array"]))throw new ve("Expected second argument to be of type array or string, but found "+re(me(r))+" instead.");return 0<=r.indexOf(e)},mr.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},mr.prototype.outputDefined=function(){return!0},mr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]},gr.parse=function(t,e){if(t.length<=2||5<=t.length)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,Jt),i=e.parse(t[2],2,Jt);if(!r||!i)return null;if(!oe(r.type,[Kt,Wt,Ht,Zt,Jt]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+re(r.type)+" instead");if(4!==t.length)return new gr(r,i);var n=e.parse(t[3],3,Ht);return n?new gr(r,i,n):null},gr.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!ae(e,["boolean","string","number","null"]))throw new ve("Expected first argument to be of type boolean, string, number or null, but found "+re(me(e))+" instead.");if(!ae(r,["string","array"]))throw new ve("Expected second argument to be of type array or string, but found "+re(me(r))+" instead.");if(this.fromIndex){var i=this.fromIndex.evaluate(t);return r.indexOf(e,i)}return r.indexOf(e)},gr.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},gr.prototype.outputDefined=function(){return!1},gr.prototype.serialize=function(){if(null==this.fromIndex||void 0===this.fromIndex)return["index-of",this.needle.serialize(),this.haystack.serialize()];var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]},yr.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var n={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],l=t[a+1];Array.isArray(s)||(s=[s]);var c=e.concat(a);if(0===s.length)return c.error("Expected at least one branch label.");for(var u=0,p=s;u<p.length;u+=1){var h=p[u];if("number"!=typeof h&&"string"!=typeof h)return c.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return c.error("Numeric branch labels must be integer values.");if(r){if(c.checkSubtype(r,me(h)))return null}else r=me(h);if(void 0!==n[String(h)])return c.error("Branch labels must be unique.");n[String(h)]=o.length}var d=e.parse(l,a,i);if(!d)return null;i=i||d.type,o.push(d)}var f=e.parse(t[1],1,Jt);if(!f)return null;var m=e.parse(t[t.length-1],t.length-1,i);return!m||"value"!==f.type.kind&&e.concat(1).checkSubtype(r,f.type)?null:new yr(r,i,f,n,o,m)},yr.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(me(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},yr.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},yr.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},yr.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],i={},n=0,o=Object.keys(this.cases).sort();n<o.length;n+=1){var a=o[n];void 0===(p=i[this.cases[a]])?(i[this.cases[a]]=r.length,r.push([this.cases[a],[a]])):r[p][1].push(a)}for(var s=function(e){return"number"===t.inputType.kind?Number(e):e},l=0,c=r;l<c.length;l+=1){var u=c[l],p=u[0],h=u[1];e.push(1===h.length?s(h[0]):h.map(s)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e},vr.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var i=[],n=1;n<t.length-1;n+=2){var o=e.parse(t[n],n,Kt);if(!o)return null;var a=e.parse(t[n+1],n+1,r);if(!a)return null;i.push([o,a]),r=r||a.type}var s=e.parse(t[t.length-1],t.length-1,r);return s?new vr(r,i,s):null},vr.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var i=r[e],n=i[1];if(i[0].evaluate(t))return n.evaluate(t)}return this.otherwise.evaluate(t)},vr.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var i=r[e],n=i[1];t(i[0]),t(n)}t(this.otherwise)},vr.prototype.outputDefined=function(){return this.branches.every((function(t){return t[1].outputDefined()}))&&this.otherwise.outputDefined()},vr.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t},_r.parse=function(t,e){if(t.length<=2||5<=t.length)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,Jt),i=e.parse(t[2],2,Ht);if(!r||!i)return null;if(!oe(r.type,[ee(Jt),Wt,Jt]))return e.error("Expected first argument to be of type array or string, but found "+re(r.type)+" instead");if(4!==t.length)return new _r(r.type,r,i);var n=e.parse(t[3],3,Ht);return n?new _r(r.type,r,i,n):null},_r.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!ae(e,["string","array"]))throw new ve("Expected first argument to be of type array or string, but found "+re(me(e))+" instead.");if(this.endIndex){var i=this.endIndex.evaluate(t);return e.slice(r,i)}return e.slice(r)},_r.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},_r.prototype.outputDefined=function(){return!1},_r.prototype.serialize=function(){if(null==this.endIndex||void 0===this.endIndex)return["slice",this.input.serialize(),this.beginIndex.serialize()];var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]};var Tr=wr("==",(function(t,e,r){return e===r}),br),Er=wr("!=",(function(t,e,r){return e!==r}),(function(t,e,r,i){return!br(0,e,r,i)})),Ir=wr("<",(function(t,e,r){return e<r}),(function(t,e,r,i){return i.compare(e,r)<0})),Cr=wr(">",(function(t,e,r){return r<e}),(function(t,e,r,i){return 0<i.compare(e,r)})),Ar=wr("<=",(function(t,e,r){return e<=r}),(function(t,e,r,i){return i.compare(e,r)<=0})),kr=wr(">=",(function(t,e,r){return r<=e}),(function(t,e,r,i){return 0<=i.compare(e,r)}));function Pr(t){this.type=Ht,this.input=t}Sr.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,Ht);if(!r)return null;var i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");var n=null;if(i.locale&&!(n=e.parse(i.locale,1,Wt)))return null;var o=null;if(i.currency&&!(o=e.parse(i.currency,1,Wt)))return null;var a=null;if(i["min-fraction-digits"]&&!(a=e.parse(i["min-fraction-digits"],1,Ht)))return null;var s=null;return i["max-fraction-digits"]&&!(s=e.parse(i["max-fraction-digits"],1,Ht))?null:new Sr(r,n,o,a,s)},Sr.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Sr.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Sr.prototype.outputDefined=function(){return!1},Sr.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]},Pr.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error("Expected argument of type string or array, but found "+re(r.type)+" instead."):new Pr(r):null},Pr.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ve("Expected value to be of type string or array, but found "+re(me(e))+" instead.")},Pr.prototype.eachChild=function(t){t(this.input)},Pr.prototype.outputDefined=function(){return!1},Pr.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Or={"==":Tr,"!=":Er,">":Cr,"<":Ir,">=":kr,"<=":Ar,array:_e,at:fr,boolean:_e,case:vr,coalesce:hr,collator:Ae,format:be,image:we,in:mr,"index-of":gr,interpolate:ur,"interpolate-hcl":ur,"interpolate-lab":ur,length:Pr,let:dr,literal:ye,match:yr,number:_e,"number-format":Sr,object:_e,slice:_r,step:Xe,string:_e,"to-boolean":Se,"to-color":Se,"to-number":Se,"to-string":Se,var:He,within:Ve};function Mr(t,e){var r=e[0],i=e[1],n=e[2],o=e[3];r=r.evaluate(t),i=i.evaluate(t),n=n.evaluate(t);var a=o?o.evaluate(t):1,s=de(r,i,n,a);if(s)throw new ve(s);return new le(r/255*a,i/255*a,n/255*a,a)}function Lr(t,e){return t in e}function Dr(t,e){var r=e[t];return void 0===r?null:r}function Rr(t){return{type:t}}function zr(t){return{result:"success",value:t}}function Nr(t){return{result:"error",value:t}}function Br(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Fr(t){return t.expression&&-1<t.expression.parameters.indexOf("zoom")}function jr(t){return t.expression&&t.expression.interpolated}function Ur(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Vr(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function qr(t){return t}function Gr(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function Zr(t,e,r,i,n){return Gr(typeof r===n?i[r]:void 0,t.default,e.default)}function Hr(t,e,r){if("number"!==Ur(r))return Gr(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];var n=Ke(t.stops.map((function(t){return t[0]})),r);return t.stops[n][1]}function Wr(t,e,r){var i=void 0!==t.base?t.base:1;if("number"!==Ur(r))return Gr(t.default,e.default);var n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];var o,a,s,l,c,u=Ke(t.stops.map((function(t){return t[0]})),r),p=(o=r,a=i,s=t.stops[u][0],l=t.stops[u+1][0]-s,c=o-s,0==l?0:1===a?c/l:(Math.pow(a,c)-1)/(Math.pow(a,l)-1)),h=t.stops[u][1],d=t.stops[u+1][1],f=Je[e.type]||qr;if(t.colorSpace&&"rgb"!==t.colorSpace){var m=cr[t.colorSpace];f=function(t,e){return m.reverse(m.interpolate(m.forward(t),m.forward(e),p))}}return"function"==typeof h.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=h.evaluate.apply(void 0,t),i=d.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==i)return f(r,i,p)}}:f(h,d,p)}function Kr(t,e,r){return"color"===e.type?r=le.parse(r):"formatted"===e.type?r=pe.fromString(r.toString()):"resolvedImage"===e.type?r=he.fromString(r.toString()):Ur(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),Gr(r,t.default,e.default)}Ce.register(Or,{error:[{kind:"error"},[Wt],function(t,e){throw new ve(e[0].evaluate(t))}],typeof:[Wt,[Jt],function(t,e){return re(me(e[0].evaluate(t)))}],"to-rgba":[ee(Ht,4),[Xt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Xt,[Ht,Ht,Ht],Mr],rgba:[Xt,[Ht,Ht,Ht,Ht],Mr],has:{type:Kt,overloads:[[[Wt],function(t,e){return Lr(e[0].evaluate(t),t.properties())}],[[Wt,Yt],function(t,e){var r=e[1];return Lr(e[0].evaluate(t),r.evaluate(t))}]]},get:{type:Jt,overloads:[[[Wt],function(t,e){return Dr(e[0].evaluate(t),t.properties())}],[[Wt,Yt],function(t,e){var r=e[1];return Dr(e[0].evaluate(t),r.evaluate(t))}]]},"feature-state":[Jt,[Wt],function(t,e){return Dr(e[0].evaluate(t),t.featureState||{})}],properties:[Yt,[],function(t){return t.properties()}],"geometry-type":[Wt,[],function(t){return t.geometryType()}],id:[Jt,[],function(t){return t.id()}],zoom:[Ht,[],function(t){return t.globals.zoom}],"heatmap-density":[Ht,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Ht,[],function(t){return t.globals.lineProgress||0}],accumulated:[Jt,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Ht,Rr(Ht),function(t,e){for(var r=0,i=0,n=e;i<n.length;i+=1)r+=n[i].evaluate(t);return r}],"*":[Ht,Rr(Ht),function(t,e){for(var r=1,i=0,n=e;i<n.length;i+=1)r*=n[i].evaluate(t);return r}],"-":{type:Ht,overloads:[[[Ht,Ht],function(t,e){var r=e[1];return e[0].evaluate(t)-r.evaluate(t)}],[[Ht],function(t,e){return-e[0].evaluate(t)}]]},"/":[Ht,[Ht,Ht],function(t,e){var r=e[1];return e[0].evaluate(t)/r.evaluate(t)}],"%":[Ht,[Ht,Ht],function(t,e){var r=e[1];return e[0].evaluate(t)%r.evaluate(t)}],ln2:[Ht,[],function(){return Math.LN2}],pi:[Ht,[],function(){return Math.PI}],e:[Ht,[],function(){return Math.E}],"^":[Ht,[Ht,Ht],function(t,e){var r=e[1];return Math.pow(e[0].evaluate(t),r.evaluate(t))}],sqrt:[Ht,[Ht],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[Ht,[Ht],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[Ht,[Ht],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[Ht,[Ht],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[Ht,[Ht],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[Ht,[Ht],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[Ht,[Ht],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[Ht,[Ht],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[Ht,[Ht],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[Ht,[Ht],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[Ht,Rr(Ht),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[Ht,Rr(Ht),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[Ht,[Ht],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[Ht,[Ht],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ht,[Ht],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[Ht,[Ht],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Kt,[Wt,Jt],function(t,e){var r=e[0],i=e[1];return t.properties()[r.value]===i.value}],"filter-id-==":[Kt,[Jt],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[Kt,[Wt],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[Kt,[Wt,Jt],function(t,e){var r=e[0],i=e[1],n=t.properties()[r.value],o=i.value;return typeof n==typeof o&&n<o}],"filter-id-<":[Kt,[Jt],function(t,e){var r=e[0],i=t.id(),n=r.value;return typeof i==typeof n&&i<n}],"filter->":[Kt,[Wt,Jt],function(t,e){var r=e[0],i=e[1],n=t.properties()[r.value],o=i.value;return typeof n==typeof o&&o<n}],"filter-id->":[Kt,[Jt],function(t,e){var r=e[0],i=t.id(),n=r.value;return typeof i==typeof n&&n<i}],"filter-<=":[Kt,[Wt,Jt],function(t,e){var r=e[0],i=e[1],n=t.properties()[r.value],o=i.value;return typeof n==typeof o&&n<=o}],"filter-id-<=":[Kt,[Jt],function(t,e){var r=e[0],i=t.id(),n=r.value;return typeof i==typeof n&&i<=n}],"filter->=":[Kt,[Wt,Jt],function(t,e){var r=e[0],i=e[1],n=t.properties()[r.value],o=i.value;return typeof n==typeof o&&o<=n}],"filter-id->=":[Kt,[Jt],function(t,e){var r=e[0],i=t.id(),n=r.value;return typeof i==typeof n&&n<=i}],"filter-has":[Kt,[Jt],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Kt,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Kt,[ee(Wt)],function(t,e){return 0<=e[0].value.indexOf(t.geometryType())}],"filter-id-in":[Kt,[ee(Jt)],function(t,e){return 0<=e[0].value.indexOf(t.id())}],"filter-in-small":[Kt,[Wt,ee(Jt)],function(t,e){var r=e[0];return 0<=e[1].value.indexOf(t.properties()[r.value])}],"filter-in-large":[Kt,[Wt,ee(Jt)],function(t,e){var r=e[0],i=e[1];return function(t,e,r,i){for(;r<=i;){var n=r+i>>1;if(e[n]===t)return!0;e[n]>t?i=n-1:r=1+n}return!1}(t.properties()[r.value],i.value,0,i.value.length-1)}],all:{type:Kt,overloads:[[[Kt,Kt],function(t,e){var r=e[1];return e[0].evaluate(t)&&r.evaluate(t)}],[Rr(Kt),function(t,e){for(var r=0,i=e;r<i.length;r+=1)if(!i[r].evaluate(t))return!1;return!0}]]},any:{type:Kt,overloads:[[[Kt,Kt],function(t,e){var r=e[1];return e[0].evaluate(t)||r.evaluate(t)}],[Rr(Kt),function(t,e){for(var r=0,i=e;r<i.length;r+=1)if(i[r].evaluate(t))return!0;return!1}]]},"!":[Kt,[Kt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Kt,[Wt],function(t,e){var r=t.globals&&t.globals.isSupportedScript;return!r||r(e[0].evaluate(t))}],upcase:[Wt,[Wt],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Wt,[Wt],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Wt,Rr(Jt),function(t,e){return e.map((function(e){return ge(e.evaluate(t))})).join("")}],"resolved-locale":[Wt,[$t],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Xr=function(t,e){var r;this.expression=t,this._warningHistory={},this._evaluator=new Ee,this._defaultValue=e?"color"===(r=e).type&&Vr(r.default)?new le(0,0,0,0):"color"===r.type?le.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=e&&"enum"===e.type?e.values:null};function Yr(t){return Array.isArray(t)&&0<t.length&&"string"==typeof t[0]&&t[0]in Or}function Jr(t,e){var r,i=new We(Or,[],e?(r={color:Xt,string:Wt,number:Ht,enum:Wt,boolean:Kt,formatted:Qt,resolvedImage:te},"array"===e.type?ee(r[e.value]||Jt,e.length):r[e.type]):void 0),n=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return n?zr(new Xr(n,e)):Nr(i.errors)}Xr.prototype.evaluateWithoutErrorHandling=function(t,e,r,i,n,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.canonical=i,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)},Xr.prototype.evaluate=function(t,e,r,i,n,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.canonical=i,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new ve("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var $r=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Ge(e.expression)};$r.prototype.evaluateWithoutErrorHandling=function(t,e,r,i,n,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,i,n,o)},$r.prototype.evaluate=function(t,e,r,i,n,o){return this._styleExpression.evaluate(t,e,r,i,n,o)};var Qr=function(t,e,r,i){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Ge(e.expression),this.interpolationType=i};function ti(t,e){if("error"===(t=Jr(t,e)).result)return t;var r=t.value.expression,i=qe(r);if(!i&&!Br(e))return Nr([new qt("","data expressions not supported")]);var n=Ze(r,["zoom"]);if(!n&&!Fr(e))return Nr([new qt("","zoom expressions not supported")]);var o=function t(e){var r=null;if(e instanceof dr)r=t(e.result);else if(e instanceof hr)for(var i=0,n=e.args;i<n.length&&!(r=t(n[i]));i+=1);else(e instanceof Xe||e instanceof ur)&&e.input instanceof Ce&&"zoom"===e.input.name&&(r=e);return r instanceof qt||e.eachChild((function(e){var i=t(e);i instanceof qt?r=i:!r&&i?r=new qt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&i&&r!==i&&(r=new qt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}(r);return o||n?o instanceof qt?Nr([o]):o instanceof ur&&!jr(e)?Nr([new qt("",'"interpolate" expressions cannot be used with this property')]):zr(o?new Qr(i?"camera":"composite",t.value,o.labels,o instanceof ur?o.interpolation:void 0):new $r(i?"constant":"source",t.value)):Nr([new qt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}function ei(t,e){this._parameters=t,this._specification=e,Bt(this,function t(e,r){var i,n,o,a="color"===r.type,s=e.stops&&"object"==typeof e.stops[0][0],l=s||!(s||void 0!==e.property),c=e.type||(jr(r)?"exponential":"interval");if(a&&((e=Bt({},e)).stops&&(e.stops=e.stops.map((function(t){return[t[0],le.parse(t[1])]}))),e.default=le.parse(e.default?e.default:r.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!cr[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===c)i=Wr;else if("interval"===c)i=Hr;else if("categorical"===c){i=Zr,n=Object.create(null);for(var u=0,p=e.stops;u<p.length;u+=1){var h=p[u];n[h[0]]=h[1]}o=typeof e.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');i=Kr}if(s){for(var d={},f=[],m=0;m<e.stops.length;m++){var g=e.stops[m],y=g[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:e.type,property:e.property,default:e.default,stops:[]},f.push(y)),d[y].stops.push([g[0].value,g[1]])}for(var v=[],_=0,x=f;_<x.length;_+=1){var b=x[_];v.push([d[b].zoom,t(d[b],r)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:ur.interpolationFactor.bind(void 0,w),zoomStops:v.map((function(t){return t[0]})),evaluate:function(t,i){var n=t.zoom;return Wr({stops:v,base:e.base},r,n).evaluate(n,i)}}}if(l){var S="exponential"===c?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:ur.interpolationFactor.bind(void 0,S),zoomStops:e.stops.map((function(t){return t[0]})),evaluate:function(t){return i(e,r,t.zoom,n,o)}}}return{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?Gr(e.default,r.default):i(e,r,s,n,o)}}}(this._parameters,this._specification))}function ri(t){var e=t.key,r=t.value,i=t.valueSpec||{},n=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],l=Ur(r);if("object"!==l)return[new zt(e,r,"object expected, "+l+" found")];for(var c in r){var u=c.split(".")[0],p=i[u]||i["*"],h=void 0;if(n[u])h=n[u];else if(i[u])h=Ci;else if(n["*"])h=n["*"];else{if(!i["*"]){s.push(new zt(e,r[c],'unknown property "'+c+'"'));continue}h=Ci}s=s.concat(h({key:(e?e+".":e)+c,value:r[c],valueSpec:p,style:o,styleSpec:a,object:r,objectKey:c},r))}for(var d in i)n[d]||i[d].required&&void 0===i[d].default&&void 0===r[d]&&s.push(new zt(e,r,'missing required property "'+d+'"'));return s}function ii(t){var e=t.value,r=t.valueSpec,i=t.style,n=t.styleSpec,o=t.key,a=t.arrayElementValidator||Ci;if("array"!==Ur(e))return[new zt(o,e,"array expected, "+Ur(e)+" found")];if(r.length&&e.length!==r.length)return[new zt(o,e,"array length "+r.length+" expected, length "+e.length+" found")];if(r["min-length"]&&e.length<r["min-length"])return[new zt(o,e,"array length at least "+r["min-length"]+" expected, length "+e.length+" found")];var s={type:r.value,values:r.values};n.$version<7&&(s.function=r.function),"object"===Ur(r.value)&&(s=r.value);for(var l=[],c=0;c<e.length;c++)l=l.concat(a({array:e,arrayIndex:c,value:e[c],valueSpec:s,style:i,styleSpec:n,key:o+"["+c+"]"}));return l}function ni(t){var e=t.key,r=t.value,i=t.valueSpec,n=Ur(r);return"number"===n&&r!=r&&(n="NaN"),"number"!==n?[new zt(e,r,"number expected, "+n+" found")]:"minimum"in i&&r<i.minimum?[new zt(e,r,r+" is less than the minimum value "+i.minimum)]:"maximum"in i&&r>i.maximum?[new zt(e,r,r+" is greater than the maximum value "+i.maximum)]:[]}function oi(t){var e,r,i,n=t.valueSpec,o=Ft(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,l=!s,c="array"===Ur(t.value.stops)&&"array"===Ur(t.value.stops[0])&&"object"===Ur(t.value.stops[0][0]),u=ri({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new zt(t.key,t.value,'identity function may not have a "stops" property')];var e=[],r=t.value;return e=e.concat(ii({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:p})),"array"===Ur(r)&&0===r.length&&e.push(new zt(t.key,r,"array must have at least one stop")),e},default:function(t){return Ci({key:t.key,value:t.value,valueSpec:n,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&u.push(new zt(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||u.push(new zt(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!jr(t.valueSpec)&&u.push(new zt(t.key,t.value,"exponential functions not supported")),8<=t.styleSpec.$version&&(l&&!Br(t.valueSpec)?u.push(new zt(t.key,t.value,"property functions not supported")):s&&!Fr(t.valueSpec)&&u.push(new zt(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!c||void 0!==t.value.property||u.push(new zt(t.key,t.value,'"property" property is required')),u;function p(t){var e=[],o=t.value,s=t.key;if("array"!==Ur(o))return[new zt(s,o,"array expected, "+Ur(o)+" found")];if(2!==o.length)return[new zt(s,o,"array length 2 expected, length "+o.length+" found")];if(c){if("object"!==Ur(o[0]))return[new zt(s,o,"object expected, "+Ur(o[0])+" found")];if(void 0===o[0].zoom)return[new zt(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new zt(s,o,"object stop key must have value")];if(i&&i>Ft(o[0].zoom))return[new zt(s,o[0].zoom,"stop zoom values must appear in ascending order")];Ft(o[0].zoom)!==i&&(i=Ft(o[0].zoom),r=void 0,a={}),e=e.concat(ri({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:ni,value:h}}))}else e=e.concat(h({key:s+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return Yr(jt(o[1]))?e.concat([new zt(s+"[1]",o[1],"expressions are not allowed in function stops.")]):e.concat(Ci({key:s+"[1]",value:o[1],valueSpec:n,style:t.style,styleSpec:t.styleSpec}))}function h(t,i){var s=Ur(t.value),l=Ft(t.value),c=null!==t.value?t.value:i;if(e){if(s!==e)return[new zt(t.key,c,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new zt(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"===s||"categorical"===o)return"categorical"!==o||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==o&&"number"===s&&void 0!==r&&l<r?[new zt(t.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===o&&l in a?[new zt(t.key,c,"stop domain values must be unique")]:(a[l]=!0,[])):[new zt(t.key,c,"integer expected, found "+l)];var u="number expected, "+s+" found";return Br(n)&&void 0===o&&(u+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new zt(t.key,c,u)]}}function ai(t){var e=("property"===t.expressionContext?ti:Jr)(jt(t.value),t.valueSpec);if("error"===e.result)return e.value.map((function(e){return new zt(""+t.key+e.key,t.value,e.message)}));var r=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!r.outputDefined())return[new zt(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Ge(r))return[new zt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Ge(r))return[new zt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Ze(r,["zoom","feature-state"]))return[new zt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!qe(r))return[new zt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function si(t){var e=t.key,r=t.value,i=t.valueSpec,n=[];return Array.isArray(i.values)?-1===i.values.indexOf(Ft(r))&&n.push(new zt(e,r,"expected one of ["+i.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(i.values).indexOf(Ft(r))&&n.push(new zt(e,r,"expected one of ["+Object.keys(i.values).join(", ")+"], "+JSON.stringify(r)+" found")),n}function li(t){if(!0===t||!1===t)return 1;if(Array.isArray(t)&&0!==t.length)switch(t[0]){case"has":return 2<=t.length&&"$id"!==t[1]&&"$type"!==t[1];case"in":return 3<=t.length&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,r=t.slice(1);e<r.length;e+=1){var i=r[e];if(!li(i)&&"boolean"!=typeof i)return}return 1;default:return 1}}Qr.prototype.evaluateWithoutErrorHandling=function(t,e,r,i,n,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,i,n,o)},Qr.prototype.evaluate=function(t,e,r,i,n,o){return this._styleExpression.evaluate(t,e,r,i,n,o)},Qr.prototype.interpolationFactor=function(t,e,r){return this.interpolationType?ur.interpolationFactor(this.interpolationType,t,e,r):0},ei.deserialize=function(t){return new ei(t._parameters,t._specification)};var ci={type:"boolean",default:!(ei.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}}),transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ui(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};li(t)||(t=hi(t));var e=Jr(t,ci);if("error"===e.result)throw new Error(e.value.map((function(t){return t.key+": "+t.message})).join(", "));return{filter:function(t,r,i){return e.value.evaluate(t,r,{},i)},needGeometry:function t(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var r=1;r<e.length;r++)if(t(e[r]))return!0;return!1}(t)}}function pi(t,e){return t<e?-1:e<t?1:0}function hi(t){if(!t)return!0;var e,r=t[0];return t.length<=1?"any"!==r:"=="===r?di(t[1],t[2],"=="):"!="===r?gi(di(t[1],t[2],"==")):"<"===r||">"===r||"<="===r||">="===r?di(t[1],t[2],r):"any"===r?(e=t.slice(1),["any"].concat(e.map(hi))):"all"===r?["all"].concat(t.slice(1).map(hi)):"none"===r?["all"].concat(t.slice(1).map(hi).map(gi)):"in"===r?fi(t[1],t.slice(2)):"!in"===r?gi(fi(t[1],t.slice(2))):"has"===r?mi(t[1]):"!has"===r?gi(mi(t[1])):"within"!==r||t}function di(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function fi(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return 200<e.length&&!e.some((function(t){return typeof t!=typeof e[0]}))?["filter-in-large",t,["literal",e.sort(pi)]]:["filter-in-small",t,["literal",e]]}}function mi(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function gi(t){return["!",t]}function yi(t){return li(jt(t.value))?ai(Bt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var r=e.value,i=e.key;if("array"!==Ur(r))return[new zt(i,r,"array expected, "+Ur(r)+" found")];var n,o=e.styleSpec,a=[];if(r.length<1)return[new zt(i,r,"filter array must have at least 1 element")];switch(a=a.concat(si({key:i+"[0]",value:r[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),Ft(r[0])){case"<":case"<=":case">":case">=":2<=r.length&&"$type"===Ft(r[1])&&a.push(new zt(i,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&a.push(new zt(i,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":2<=r.length&&"string"!==(n=Ur(r[1]))&&a.push(new zt(i+"[1]",r[1],"string expected, "+n+" found"));for(var s=2;s<r.length;s++)n=Ur(r[s]),"$type"===Ft(r[1])?a=a.concat(si({key:i+"["+s+"]",value:r[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&a.push(new zt(i+"["+s+"]",r[s],"string, number, or boolean expected, "+n+" found"));break;case"any":case"all":case"none":for(var l=1;l<r.length;l++)a=a.concat(t({key:i+"["+l+"]",value:r[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":n=Ur(r[1]),2!==r.length?a.push(new zt(i,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==n&&a.push(new zt(i+"[1]",r[1],"string expected, "+n+" found"));break;case"within":n=Ur(r[1]),2!==r.length?a.push(new zt(i,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"object"!==n&&a.push(new zt(i+"[1]",r[1],"object expected, "+n+" found"))}return a}(t)}function vi(t,e){var r=t.key,i=t.style,n=t.styleSpec,o=t.value,a=t.objectKey,s=n[e+"_"+t.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return Ci({key:r,value:o,valueSpec:n.transition,style:i,styleSpec:n});var c,u=t.valueSpec||s[a];if(!u)return[new zt(r,o,'unknown property "'+a+'"')];if("string"===Ur(o)&&Br(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new zt(r,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(c[1])+" }`.")];var p=[];return"symbol"===t.layerType&&("text-field"===a&&i&&!i.glyphs&&p.push(new zt(r,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Vr(jt(o))&&"identity"===Ft(o.type)&&p.push(new zt(r,o,'"text-font" does not support identity functions'))),p.concat(Ci({key:t.key,value:o,valueSpec:u,style:i,styleSpec:n,expressionContext:"property",propertyType:e,propertyKey:a}))}function _i(t){return vi(t,"paint")}function xi(t){return vi(t,"layout")}function bi(t){var e=[],r=t.value,i=t.key,n=t.style,o=t.styleSpec;r.type||r.ref||e.push(new zt(i,r,'either "type" or "ref" is required'));var a,s=Ft(r.type),l=Ft(r.ref);if(r.id)for(var c=Ft(r.id),u=0;u<t.arrayIndex;u++){var p=n.layers[u];Ft(p.id)===c&&e.push(new zt(i,r.id,'duplicate layer id "'+r.id+'", previously used at line '+p.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach((function(t){t in r&&e.push(new zt(i,r[t],'"'+t+'" is prohibited for ref layers'))})),n.layers.forEach((function(t){Ft(t.id)===l&&(a=t)})),a?a.ref?e.push(new zt(i,r.ref,"ref cannot reference another ref layer")):s=Ft(a.type):e.push(new zt(i,r.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(r.source){var h=n.sources&&n.sources[r.source],d=h&&Ft(h.type);h?"vector"===d&&"raster"===s?e.push(new zt(i,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===d&&"raster"!==s?e.push(new zt(i,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==d||r["source-layer"]?"raster-dem"===d&&"hillshade"!==s?e.push(new zt(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===d&&h.lineMetrics||e.push(new zt(i,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new zt(i,r,'layer "'+r.id+'" must specify a "source-layer"')):e.push(new zt(i,r.source,'source "'+r.source+'" not found'))}else e.push(new zt(i,r,'missing required property "source"'));return e=e.concat(ri({key:i,value:r,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ci({key:i+".type",value:r.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"})},filter:yi,layout:function(t){return ri({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return xi(Bt({layerType:s},t))}}})},paint:function(t){return ri({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return _i(Bt({layerType:s},t))}}})}}}))}function wi(t){var e=t.value,r=t.key,i=Ur(e);return"string"!==i?[new zt(r,e,"string expected, "+i+" found")]:[]}var Si={promoteId:function(t){var e=t.key,r=t.value;if("string"===Ur(r))return wi({key:e,value:r});var i=[];for(var n in r)i.push.apply(i,wi({key:e+"."+n,value:r[n]}));return i}};function Ti(t){var e=t.value,r=t.key,i=t.styleSpec,n=t.style;if(!e.type)return[new zt(r,e,'"type" is required')];var o,a=Ft(e.type);switch(a){case"vector":case"raster":case"raster-dem":return ri({key:r,value:e,valueSpec:i["source_"+a.replace("-","_")],style:t.style,styleSpec:i,objectElementValidators:Si});case"geojson":if(o=ri({key:r,value:e,valueSpec:i.source_geojson,style:n,styleSpec:i,objectElementValidators:Si}),e.cluster)for(var s in e.clusterProperties){var l=e.clusterProperties[s],c=l[0],u="string"==typeof c?[c,["accumulated"],["get",s]]:c;o.push.apply(o,ai({key:r+"."+s+".map",value:l[1],expressionContext:"cluster-map"})),o.push.apply(o,ai({key:r+"."+s+".reduce",value:u,expressionContext:"cluster-reduce"}))}return o;case"video":return ri({key:r,value:e,valueSpec:i.source_video,style:n,styleSpec:i});case"image":return ri({key:r,value:e,valueSpec:i.source_image,style:n,styleSpec:i});case"canvas":return[new zt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return si({key:r+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,styleSpec:i})}}function Ei(t){var e=t.value,r=t.styleSpec,i=r.light,n=t.style,o=[],a=Ur(e);if(void 0===e)return o;if("object"!==a)return o.concat([new zt("light",e,"object expected, "+a+" found")]);for(var s in e){var l=s.match(/^(.*)-transition$/);o=o.concat(l&&i[l[1]]&&i[l[1]].transition?Ci({key:s,value:e[s],valueSpec:r.transition,style:n,styleSpec:r}):i[s]?Ci({key:s,value:e[s],valueSpec:i[s],style:n,styleSpec:r}):[new zt(s,e[s],'unknown property "'+s+'"')])}return o}var Ii={"*":function(){return[]},array:ii,boolean:function(t){var e=t.value,r=t.key,i=Ur(e);return"boolean"!==i?[new zt(r,e,"boolean expected, "+i+" found")]:[]},number:ni,color:function(t){var e=t.key,r=t.value,i=Ur(r);return"string"!==i?[new zt(e,r,"color expected, "+i+" found")]:null===se(r)?[new zt(e,r,'color expected, "'+r+'" found')]:[]},constants:Nt,enum:si,filter:yi,function:oi,layer:bi,object:ri,source:Ti,light:Ei,string:wi,formatted:function(t){return 0===wi(t).length?[]:ai(t)},resolvedImage:function(t){return 0===wi(t).length?[]:ai(t)}};function Ci(t){var e=t.value,r=t.valueSpec,i=t.styleSpec;return r.expression&&Vr(Ft(e))?oi(t):r.expression&&Yr(jt(e))?ai(t):r.type&&Ii[r.type]?Ii[r.type](t):ri(Bt({},t,{valueSpec:r.type?i[r.type]:r}))}function Ai(t){var e=t.value,r=t.key,i=wi(t);return i.length||(-1===e.indexOf("{fontstack}")&&i.push(new zt(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new zt(r,e,'"glyphs" url must include a "{range}" token'))),i}function ki(t,e){void 0===e&&(e=Rt);var r=[];return r=r.concat(Ci({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Ai,"*":function(){return[]}}})),t.constants&&(r=r.concat(Nt({key:"constants",value:t.constants,style:t,styleSpec:e}))),Pi(r)}function Pi(t){return[].concat(t).sort((function(t,e){return t.line-e.line}))}function Oi(t){return function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return Pi(t.apply(this,e))}}ki.source=Oi(Ti),ki.light=Oi(Ei),ki.layer=Oi(bi),ki.filter=Oi(yi),ki.paintProperty=Oi(_i),ki.layoutProperty=Oi(xi);var Mi=ki,Li=Mi.light,Di=Mi.paintProperty,Ri=Mi.layoutProperty;function zi(t,e){var r=!1;if(e&&e.length)for(var i=0,n=e;i<n.length;i+=1)t.fire(new Lt(new Error(n[i].message))),r=!0;return r}var Ni=Bi;function Bi(t,e,r){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var n=new Int32Array(this.arrayBuffer);t=n[0],this.d=(e=n[1])+2*(r=n[2]);for(var o=0;o<this.d*this.d;o++){var a=n[3+o],s=n[3+o+1];i.push(a===s?null:n.subarray(a,s))}var l=n[3+i.length+1];this.keys=n.subarray(n[3+i.length],l),this.bboxes=n.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var u=r/e*t;this.min=-u,this.max=t+u}Bi.prototype.insert=function(t,e,r,i,n){this._forEachCell(e,r,i,n,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)},Bi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Bi.prototype._insertCell=function(t,e,r,i,n,o){this.cells[n].push(o)},Bi.prototype.query=function(t,e,r,i,n){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=r&&a<=i&&!n)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,r,i,this._queryCell,s,{},n),s},Bi.prototype._queryCell=function(t,e,r,i,n,o,a,s){var l=this.cells[n];if(null!==l)for(var c=this.keys,u=this.bboxes,p=0;p<l.length;p++){var h=l[p];if(void 0===a[h]){var d=4*h;(s?s(u[0+d],u[1+d],u[2+d],u[3+d]):t<=u[2+d]&&e<=u[3+d]&&r>=u[0+d]&&i>=u[1+d])?(a[h]=!0,o.push(c[h])):a[h]=!1}}},Bi.prototype._forEachCell=function(t,e,r,i,n,o,a,s){for(var l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),u=this._convertToCellCoord(r),p=this._convertToCellCoord(i),h=l;h<=u;h++)for(var d=c;d<=p;d++){var f=this.d*d+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(d),this._convertFromCellCoord(h+1),this._convertFromCellCoord(d+1)))&&n.call(this,t,e,r,i,f,o,a,s))return}},Bi.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Bi.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Bi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,r=0,i=0;i<this.cells.length;i++)r+=this.cells[i].length;var n=new Int32Array(e+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];n[3+a]=o,n.set(s,o),o+=s.length}return n[3+t.length]=o,n.set(this.keys,o),n[3+t.length+1]=o+=this.keys.length,n.set(this.bboxes,o),o+=this.bboxes.length,n.buffer};var Fi=a.ImageData,ji=a.ImageBitmap,Ui={};function Vi(t,e,r){void 0===r&&(r={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Ui[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}for(var qi in Vi("Object",Object),Ni.serialize=function(t,e){var r=t.toArrayBuffer();return e&&e.push(r),{buffer:r}},Ni.deserialize=function(t){return new Ni(t.buffer)},Vi("Grid",Ni),Vi("Color",le),Vi("Error",Error),Vi("ResolvedImage",he),Vi("StylePropertyFunction",ei),Vi("StyleExpression",Xr,{omit:["_evaluator"]}),Vi("ZoomDependentExpression",Qr),Vi("ZoomConstantExpression",$r),Vi("CompoundExpression",Ce,{omit:["_evaluate"]}),Or)Or[qi]._classRegistryKey||Vi("Expression_"+qi,Or[qi]);function Gi(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Zi(t){return ji&&t instanceof ji}function Hi(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Gi(t)||Zi(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var r=t;return e&&e.push(r.buffer),r}if(t instanceof Fi)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var i=[],n=0,o=t;n<o.length;n+=1)i.push(Hi(o[n],e));return i}if("object"!=typeof t)throw new Error("can't serialize object of type "+typeof t);var a=t.constructor,s=a._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var l=a.serialize?a.serialize(t,e):{};if(!a.serialize){for(var c in t)if(t.hasOwnProperty(c)&&!(0<=Ui[s].omit.indexOf(c))){var u=t[c];l[c]=0<=Ui[s].shallow.indexOf(c)?u:Hi(u,e)}t instanceof Error&&(l.message=t.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(l.$name=s),l}function Wi(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Gi(t)||Zi(t)||ArrayBuffer.isView(t)||t instanceof Fi)return t;if(Array.isArray(t))return t.map(Wi);if("object"!=typeof t)throw new Error("can't deserialize object of type "+typeof t);var e=t.$name||"Object",r=Ui[e].klass;if(!r)throw new Error("can't deserialize unregistered class "+e);if(r.deserialize)return r.deserialize(t);for(var i=Object.create(r.prototype),n=0,o=Object.keys(t);n<o.length;n+=1){var a=o[n];if("$name"!==a){var s=t[a];i[a]=0<=Ui[e].shallow.indexOf(a)?s:Wi(s)}}return i}function Ki(){this.first=!0}Ki.prototype.update=function(t,e){var r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))};var Xi={"Latin-1 Supplement":function(t){return 128<=t&&t<=255},Arabic:function(t){return 1536<=t&&t<=1791},"Arabic Supplement":function(t){return 1872<=t&&t<=1919},"Arabic Extended-A":function(t){return 2208<=t&&t<=2303},"Hangul Jamo":function(t){return 4352<=t&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return 5120<=t&&t<=5759},Khmer:function(t){return 6016<=t&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return 6320<=t&&t<=6399},"General Punctuation":function(t){return 8192<=t&&t<=8303},"Letterlike Symbols":function(t){return 8448<=t&&t<=8527},"Number Forms":function(t){return 8528<=t&&t<=8591},"Miscellaneous Technical":function(t){return 8960<=t&&t<=9215},"Control Pictures":function(t){return 9216<=t&&t<=9279},"Optical Character Recognition":function(t){return 9280<=t&&t<=9311},"Enclosed Alphanumerics":function(t){return 9312<=t&&t<=9471},"Geometric Shapes":function(t){return 9632<=t&&t<=9727},"Miscellaneous Symbols":function(t){return 9728<=t&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return 11008<=t&&t<=11263},"CJK Radicals Supplement":function(t){return 11904<=t&&t<=12031},"Kangxi Radicals":function(t){return 12032<=t&&t<=12255},"Ideographic Description Characters":function(t){return 12272<=t&&t<=12287},"CJK Symbols and Punctuation":function(t){return 12288<=t&&t<=12351},Hiragana:function(t){return 12352<=t&&t<=12447},Katakana:function(t){return 12448<=t&&t<=12543},Bopomofo:function(t){return 12544<=t&&t<=12591},"Hangul Compatibility Jamo":function(t){return 12592<=t&&t<=12687},Kanbun:function(t){return 12688<=t&&t<=12703},"Bopomofo Extended":function(t){return 12704<=t&&t<=12735},"CJK Strokes":function(t){return 12736<=t&&t<=12783},"Katakana Phonetic Extensions":function(t){return 12784<=t&&t<=12799},"Enclosed CJK Letters and Months":function(t){return 12800<=t&&t<=13055},"CJK Compatibility":function(t){return 13056<=t&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return 13312<=t&&t<=19903},"Yijing Hexagram Symbols":function(t){return 19904<=t&&t<=19967},"CJK Unified Ideographs":function(t){return 19968<=t&&t<=40959},"Yi Syllables":function(t){return 40960<=t&&t<=42127},"Yi Radicals":function(t){return 42128<=t&&t<=42191},"Hangul Jamo Extended-A":function(t){return 43360<=t&&t<=43391},"Hangul Syllables":function(t){return 44032<=t&&t<=55215},"Hangul Jamo Extended-B":function(t){return 55216<=t&&t<=55295},"Private Use Area":function(t){return 57344<=t&&t<=63743},"CJK Compatibility Ideographs":function(t){return 63744<=t&&t<=64255},"Arabic Presentation Forms-A":function(t){return 64336<=t&&t<=65023},"Vertical Forms":function(t){return 65040<=t&&t<=65055},"CJK Compatibility Forms":function(t){return 65072<=t&&t<=65103},"Small Form Variants":function(t){return 65104<=t&&t<=65135},"Arabic Presentation Forms-B":function(t){return 65136<=t&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return 65280<=t&&t<=65519}};function Yi(t){for(var e=0,r=t;e<r.length;e+=1)if(Ji(r[e].charCodeAt(0)))return!0;return!1}function Ji(t){return 746===t||747===t||!(t<4352)&&(Xi["Bopomofo Extended"](t)||Xi.Bopomofo(t)||Xi["CJK Compatibility Forms"](t)&&!(65097<=t&&t<=65103)||Xi["CJK Compatibility Ideographs"](t)||Xi["CJK Compatibility"](t)||Xi["CJK Radicals Supplement"](t)||Xi["CJK Strokes"](t)||!(!Xi["CJK Symbols and Punctuation"](t)||12296<=t&&t<=12305||12308<=t&&t<=12319||12336===t)||Xi["CJK Unified Ideographs Extension A"](t)||Xi["CJK Unified Ideographs"](t)||Xi["Enclosed CJK Letters and Months"](t)||Xi["Hangul Compatibility Jamo"](t)||Xi["Hangul Jamo Extended-A"](t)||Xi["Hangul Jamo Extended-B"](t)||Xi["Hangul Jamo"](t)||Xi["Hangul Syllables"](t)||Xi.Hiragana(t)||Xi["Ideographic Description Characters"](t)||Xi.Kanbun(t)||Xi["Kangxi Radicals"](t)||Xi["Katakana Phonetic Extensions"](t)||Xi.Katakana(t)&&12540!==t||!(!Xi["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||65306<=t&&t<=65310||65339===t||65341===t||65343===t||65371<=t&&t<=65503||65507===t||65512<=t&&t<=65519)||!(!Xi["Small Form Variants"](t)||65112<=t&&t<=65118||65123<=t&&t<=65126)||Xi["Unified Canadian Aboriginal Syllabics"](t)||Xi["Unified Canadian Aboriginal Syllabics Extended"](t)||Xi["Vertical Forms"](t)||Xi["Yijing Hexagram Symbols"](t)||Xi["Yi Syllables"](t)||Xi["Yi Radicals"](t))}function $i(t){return!(Ji(t)||(e=t,Xi["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Xi["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Xi["Letterlike Symbols"](e)||Xi["Number Forms"](e)||Xi["Miscellaneous Technical"](e)&&(8960<=e&&e<=8967||8972<=e&&e<=8991||8996<=e&&e<=9e3||9003===e||9085<=e&&e<=9114||9150<=e&&e<=9165||9167===e||9169<=e&&e<=9179||9186<=e&&e<=9215)||Xi["Control Pictures"](e)&&9251!==e||Xi["Optical Character Recognition"](e)||Xi["Enclosed Alphanumerics"](e)||Xi["Geometric Shapes"](e)||Xi["Miscellaneous Symbols"](e)&&!(9754<=e&&e<=9759)||Xi["Miscellaneous Symbols and Arrows"](e)&&(11026<=e&&e<=11055||11088<=e&&e<=11097||11192<=e&&e<=11243)||Xi["CJK Symbols and Punctuation"](e)||Xi.Katakana(e)||Xi["Private Use Area"](e)||Xi["CJK Compatibility Forms"](e)||Xi["Small Form Variants"](e)||Xi["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||9984<=e&&e<=10087||10102<=e&&e<=10131||65532===e||65533===e));var e}function Qi(t){return 1424<=t&&t<=2303||Xi["Arabic Presentation Forms-A"](t)||Xi["Arabic Presentation Forms-B"](t)}function tn(t){for(var e=0,r=t;e<r.length;e+=1)if(Qi(r[e].charCodeAt(0)))return 1}function en(t){t&&"string"==typeof t&&-1<t.indexOf("NetworkError")&&(nn="error"),rn&&rn(t)}var rn=null,nn="unavailable",on=null;function an(){un.fire(new Pt("pluginStateChange",{pluginStatus:nn,pluginURL:on}))}function sn(){return nn}function ln(){if("deferred"!==nn||!on)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");nn="loading",an(),on&&St({url:on},(function(t){t?en(t):(nn="loaded",an())}))}function cn(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ki,this.transition={})}var un=new Ot,pn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===nn||null!=pn.applyArabicShaping},isLoading:function(){return"loading"===nn},setState:function(t){nn=t.pluginStatus,on=t.pluginURL},isParsed:function(){return null!=pn.applyArabicShaping&&null!=pn.processBidirectionalText&&null!=pn.processStyledBidirectionalText},getPluginURL:function(){return on}};function hn(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Vr(t))return new ei(t,e);if(Yr(t)){var r=ti(t,e);if("error"===r.result)throw new Error(r.value.map((function(t){return t.key+": "+t.message})).join(", "));return r.value}var i=t;return"string"==typeof t&&"color"===e.type&&(i=le.parse(t)),{kind:"constant",evaluate:function(){return i}}}(void 0===e?t.specification.default:e,t.specification)}function dn(t){this.property=t,this.value=new hn(t,void 0)}function fn(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}cn.prototype.isSupportedScript=function(t){return function(t,e){for(var r=0,i=t;r<i.length;r+=1)if(n=i[r].charCodeAt(0),!e&&Qi(n)||2304<=n&&n<=3583||3840<=n&&n<=4255||Xi.Khmer(n))return!1;var n;return!0}(t,pn.isLoaded())},cn.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},cn.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),r=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*e}},hn.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},hn.prototype.possiblyEvaluate=function(t,e,r){return this.property.possiblyEvaluate(this,t,e,r)},dn.prototype.transitioned=function(t,e){return new mn(this.property,this.value,e,p({},t.transition,this.transition),t.now)},dn.prototype.untransitioned=function(){return new mn(this.property,this.value,null,{},0)},fn.prototype.getValue=function(t){return x(this._values[t].value.value)},fn.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new dn(this._values[t].property)),this._values[t].value=new hn(this._values[t].property,null===e?void 0:x(e))},fn.prototype.getTransition=function(t){return x(this._values[t].transition)},fn.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new dn(this._values[t].property)),this._values[t].transition=x(e)||void 0},fn.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var i=r[e],n=this.getValue(i);void 0!==n&&(t[i]=n);var o=this.getTransition(i);void 0!==o&&(t[i+"-transition"]=o)}return t},fn.prototype.transitioned=function(t,e){for(var r=new gn(this._properties),i=0,n=Object.keys(this._values);i<n.length;i+=1){var o=n[i];r._values[o]=this._values[o].transitioned(t,e._values[o])}return r},fn.prototype.untransitioned=function(){for(var t=new gn(this._properties),e=0,r=Object.keys(this._values);e<r.length;e+=1){var i=r[e];t._values[i]=this._values[i].untransitioned()}return t};var mn=function(t,e,r,i,n){this.property=t,this.value=e,this.begin=n+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=r)};mn.prototype.possiblyEvaluate=function(t,e,r){var i=t.now||0,n=this.value.possiblyEvaluate(t,e,r),o=this.prior;if(o){if(i>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(i<this.begin)return o.possiblyEvaluate(t,e,r);var a=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,r),n,function(){if(a<=0)return 0;if(1<=a)return 1;var t=a*a,e=t*a;return 4*(a<.5?e:3*(a-t)+e-.75)}())}return n};var gn=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};function yn(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}function vn(t,e,r){this.property=t,this.value=e,this.parameters=r}gn.prototype.possiblyEvaluate=function(t,e,r){for(var i=new _n(this._properties),n=0,o=Object.keys(this._values);n<o.length;n+=1){var a=o[n];i._values[a]=this._values[a].possiblyEvaluate(t,e,r)}return i},gn.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1},yn.prototype.getValue=function(t){return x(this._values[t].value)},yn.prototype.setValue=function(t,e){this._values[t]=new hn(this._values[t].property,null===e?void 0:x(e))},yn.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var i=r[e],n=this.getValue(i);void 0!==n&&(t[i]=n)}return t},yn.prototype.possiblyEvaluate=function(t,e,r){for(var i=new _n(this._properties),n=0,o=Object.keys(this._values);n<o.length;n+=1){var a=o[n];i._values[a]=this._values[a].possiblyEvaluate(t,e,r)}return i},vn.prototype.isConstant=function(){return"constant"===this.value.kind},vn.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},vn.prototype.evaluate=function(t,e,r,i){return this.property.evaluate(this.value,this.parameters,t,e,r,i)};var _n=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};function xn(t){this.specification=t}function bn(t,e){this.specification=t,this.overrides=e}function wn(t){this.specification=t}_n.prototype.get=function(t){return this._values[t]},xn.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},xn.prototype.interpolate=function(t,e,r){var i=Je[this.specification.type];return i?i(t,e,r):t},bn.prototype.possiblyEvaluate=function(t,e,r,i){return new vn(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},r,i)}:t.expression,e)},bn.prototype.interpolate=function(t,e,r){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new vn(this,{kind:"constant",value:void 0},t.parameters);var i=Je[this.specification.type];return i?new vn(this,{kind:"constant",value:i(t.value.value,e.value.value,r)},t.parameters):t},bn.prototype.evaluate=function(t,e,r,i,n,o){return"constant"===t.kind?t.value:t.evaluate(e,r,i,n,o)};var Sn,Tn=(En.__proto__=Sn=bn,((En.prototype=Object.create(Sn&&Sn.prototype)).constructor=En).prototype.possiblyEvaluate=function(t,e,r,i){if(void 0===t.value)return new vn(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var n=t.expression.evaluate(e,null,{},r,i),o="resolvedImage"===t.property.specification.type&&"string"!=typeof n?n.name:n,a=this._calculate(o,o,o,e);return new vn(this,{kind:"constant",value:a},e)}if("camera"!==t.expression.kind)return new vn(this,t.expression,e);var s=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new vn(this,{kind:"constant",value:s},e)},En.prototype.evaluate=function(t,e,r,i,n,o){if("source"!==t.kind)return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},r,i),t.evaluate({zoom:Math.floor(e.zoom)},r,i),t.evaluate({zoom:Math.floor(e.zoom)+1},r,i),e):t.value;var a=t.evaluate(e,r,i,n,o);return this._calculate(a,a,a,e)},En.prototype._calculate=function(t,e,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},En.prototype.interpolate=function(t){return t},En);function En(){Sn.apply(this,arguments)}function In(t){this.specification=t}function Cn(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var r=t[e];r.specification.overridable&&this.overridableProperties.push(e);var i=this.defaultPropertyValues[e]=new hn(r,void 0),n=this.defaultTransitionablePropertyValues[e]=new dn(r);this.defaultTransitioningPropertyValues[e]=n.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}}function An(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}function kn(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}wn.prototype.possiblyEvaluate=function(t,e,r,i){if(void 0!==t.value){if("constant"!==t.expression.kind)return this._calculate(t.expression.evaluate(new cn(Math.floor(e.zoom-1),e)),t.expression.evaluate(new cn(Math.floor(e.zoom),e)),t.expression.evaluate(new cn(Math.floor(e.zoom+1),e)),e);var n=t.expression.evaluate(e,null,{},r,i);return this._calculate(n,n,n,e)}},wn.prototype._calculate=function(t,e,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},wn.prototype.interpolate=function(t){return t},In.prototype.possiblyEvaluate=function(t,e,r,i){return!!t.expression.evaluate(e,null,{},r,i)},In.prototype.interpolate=function(){return!1},Vi("DataDrivenProperty",bn),Vi("DataConstantProperty",xn),Vi("CrossFadedDataDrivenProperty",Tn),Vi("CrossFadedProperty",wn),Vi("ColorRampProperty",In);var Pn,On=(Ln.__proto__=Pn=Ot,((Ln.prototype=Object.create(Pn&&Pn.prototype)).constructor=Ln).prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},Ln.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},Ln.prototype.setLayoutProperty=function(t,e,r){void 0===r&&(r={}),null!=e&&this._validate(Ri,"layers."+this.id+".layout."+t,t,e,r)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)},Ln.prototype.getPaintProperty=function(t){return y(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},Ln.prototype.setPaintProperty=function(t,e,r){if(void 0===r&&(r={}),null!=e&&this._validate(Di,"layers."+this.id+".paint."+t,t,e,r))return!1;if(y(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var i=this._transitionablePaint._values[t],n="cross-faded-data-driven"===i.property.specification["property-type"],o=i.value.isDataDriven(),a=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var s=this._transitionablePaint._values[t].value;return s.isDataDriven()||o||n||this._handleOverridablePaintPropertyUpdate(t,a,s)},Ln.prototype._handleSpecialPaintPropertyUpdate=function(t){},Ln.prototype._handleOverridablePaintPropertyUpdate=function(t,e,r){return!1},Ln.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},Ln.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},Ln.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},Ln.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)},Ln.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),_(t,(function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)}))},Ln.prototype._validate=function(t,e,r,i,n){return void 0===n&&(n={}),(!n||!1!==n.validate)&&zi(this,t.call(Mi,{key:e,layerType:this.type,objectKey:r,value:i,styleSpec:Rt,style:{glyphs:!0,sprite:!0}}))},Ln.prototype.is3D=function(){return!1},Ln.prototype.isTileClipped=function(){return!1},Ln.prototype.hasOffscreenPass=function(){return!1},Ln.prototype.resize=function(){},Ln.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof vn&&Br(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},Ln),Mn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};function Ln(t,e){if(Pn.call(this),this.id=t.id,this.type=t.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new yn(e.layout)),e.paint)){for(var r in this._transitionablePaint=new fn(e.paint),t.paint)this.setPaintProperty(r,t.paint[r],{validate:!1});for(var i in t.layout)this.setLayoutProperty(i,t.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _n(e.paint)}}function Dn(t,e){void 0===e&&(e=1);var r=0,i=0;return{members:t.map((function(t){var n=Mn[t.type].BYTES_PER_ELEMENT,o=r=Rn(r,Math.max(e,n)),a=t.components||1;return i=Math.max(i,n),r+=n*a,{name:t.name,type:t.type,components:a,offset:o}})),size:Rn(r,Math.max(i,e)),alignment:e}}function Rn(t,e){return Math.ceil(t/e)*e}kn.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},kn.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},kn.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},kn.prototype.clear=function(){this.length=0},kn.prototype.resize=function(t){this.reserve(t),this.length=t},kn.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},kn.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var zn,Nn=(Bn.__proto__=zn=kn,((Bn.prototype=Object.create(zn&&zn.prototype)).constructor=Bn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Bn.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},Bn.prototype.emplace=function(t,e,r){var i=2*t;return this.int16[0+i]=e,this.int16[1+i]=r,t},Bn);function Bn(){zn.apply(this,arguments)}Nn.prototype.bytesPerElement=4,Vi("StructArrayLayout2i4",Nn);var Fn,jn=(Un.__proto__=Fn=kn,((Un.prototype=Object.create(Fn&&Fn.prototype)).constructor=Un).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Un.prototype.emplaceBack=function(t,e,r,i){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)},Un.prototype.emplace=function(t,e,r,i,n){var o=4*t;return this.int16[0+o]=e,this.int16[1+o]=r,this.int16[2+o]=i,this.int16[3+o]=n,t},Un);function Un(){Fn.apply(this,arguments)}jn.prototype.bytesPerElement=8,Vi("StructArrayLayout4i8",jn);var Vn,qn=(Gn.__proto__=Vn=kn,((Gn.prototype=Object.create(Vn&&Vn.prototype)).constructor=Gn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Gn.prototype.emplaceBack=function(t,e,r,i,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o)},Gn.prototype.emplace=function(t,e,r,i,n,o,a){var s=6*t;return this.int16[0+s]=e,this.int16[1+s]=r,this.int16[2+s]=i,this.int16[3+s]=n,this.int16[4+s]=o,this.int16[5+s]=a,t},Gn);function Gn(){Vn.apply(this,arguments)}qn.prototype.bytesPerElement=12,Vi("StructArrayLayout2i4i12",qn);var Zn,Hn=(Wn.__proto__=Zn=kn,((Wn.prototype=Object.create(Zn&&Zn.prototype)).constructor=Wn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Wn.prototype.emplaceBack=function(t,e,r,i,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o)},Wn.prototype.emplace=function(t,e,r,i,n,o,a){var s=4*t,l=8*t;return this.int16[0+s]=e,this.int16[1+s]=r,this.uint8[4+l]=i,this.uint8[5+l]=n,this.uint8[6+l]=o,this.uint8[7+l]=a,t},Wn);function Wn(){Zn.apply(this,arguments)}Hn.prototype.bytesPerElement=8,Vi("StructArrayLayout2i4ub8",Hn);var Kn,Xn=(Yn.__proto__=Kn=kn,((Yn.prototype=Object.create(Kn&&Kn.prototype)).constructor=Yn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Yn.prototype.emplaceBack=function(t,e,r,i,n,o,a,s,l,c){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,r,i,n,o,a,s,l,c)},Yn.prototype.emplace=function(t,e,r,i,n,o,a,s,l,c,u){var p=10*t;return this.uint16[0+p]=e,this.uint16[1+p]=r,this.uint16[2+p]=i,this.uint16[3+p]=n,this.uint16[4+p]=o,this.uint16[5+p]=a,this.uint16[6+p]=s,this.uint16[7+p]=l,this.uint16[8+p]=c,this.uint16[9+p]=u,t},Yn);function Yn(){Kn.apply(this,arguments)}Xn.prototype.bytesPerElement=20,Vi("StructArrayLayout10ui20",Xn);var Jn,$n=(Qn.__proto__=Jn=kn,((Qn.prototype=Object.create(Jn&&Jn.prototype)).constructor=Qn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Qn.prototype.emplaceBack=function(t,e,r,i,n,o,a,s,l,c,u,p){var h=this.length;return this.resize(h+1),this.emplace(h,t,e,r,i,n,o,a,s,l,c,u,p)},Qn.prototype.emplace=function(t,e,r,i,n,o,a,s,l,c,u,p,h){var d=12*t;return this.int16[0+d]=e,this.int16[1+d]=r,this.int16[2+d]=i,this.int16[3+d]=n,this.uint16[4+d]=o,this.uint16[5+d]=a,this.uint16[6+d]=s,this.uint16[7+d]=l,this.int16[8+d]=c,this.int16[9+d]=u,this.int16[10+d]=p,this.int16[11+d]=h,t},Qn);function Qn(){Jn.apply(this,arguments)}$n.prototype.bytesPerElement=24,Vi("StructArrayLayout4i4ui4i24",$n);var to,eo=(ro.__proto__=to=kn,((ro.prototype=Object.create(to&&to.prototype)).constructor=ro).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},ro.prototype.emplaceBack=function(t,e,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)},ro.prototype.emplace=function(t,e,r,i){var n=3*t;return this.float32[0+n]=e,this.float32[1+n]=r,this.float32[2+n]=i,t},ro);function ro(){to.apply(this,arguments)}eo.prototype.bytesPerElement=12,Vi("StructArrayLayout3f12",eo);var io,no=(oo.__proto__=io=kn,((oo.prototype=Object.create(io&&io.prototype)).constructor=oo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},oo.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},oo.prototype.emplace=function(t,e){return this.uint32[+t+0]=e,t},oo);function oo(){io.apply(this,arguments)}no.prototype.bytesPerElement=4,Vi("StructArrayLayout1ul4",no);var ao,so=(lo.__proto__=ao=kn,((lo.prototype=Object.create(ao&&ao.prototype)).constructor=lo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},lo.prototype.emplaceBack=function(t,e,r,i,n,o,a,s,l){var c=this.length;return this.resize(c+1),this.emplace(c,t,e,r,i,n,o,a,s,l)},lo.prototype.emplace=function(t,e,r,i,n,o,a,s,l,c){var u=10*t,p=5*t;return this.int16[0+u]=e,this.int16[1+u]=r,this.int16[2+u]=i,this.int16[3+u]=n,this.int16[4+u]=o,this.int16[5+u]=a,this.uint32[3+p]=s,this.uint16[8+u]=l,this.uint16[9+u]=c,t},lo);function lo(){ao.apply(this,arguments)}so.prototype.bytesPerElement=20,Vi("StructArrayLayout6i1ul2ui20",so);var co,uo=(po.__proto__=co=kn,((po.prototype=Object.create(co&&co.prototype)).constructor=po).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},po.prototype.emplaceBack=function(t,e,r,i,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,i,n,o)},po.prototype.emplace=function(t,e,r,i,n,o,a){var s=6*t;return this.int16[0+s]=e,this.int16[1+s]=r,this.int16[2+s]=i,this.int16[3+s]=n,this.int16[4+s]=o,this.int16[5+s]=a,t},po);function po(){co.apply(this,arguments)}uo.prototype.bytesPerElement=12,Vi("StructArrayLayout2i2i2i12",uo);var ho,fo=(mo.__proto__=ho=kn,((mo.prototype=Object.create(ho&&ho.prototype)).constructor=mo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},mo.prototype.emplaceBack=function(t,e,r,i,n){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,r,i,n)},mo.prototype.emplace=function(t,e,r,i,n,o){var a=4*t,s=8*t;return this.float32[0+a]=e,this.float32[1+a]=r,this.float32[2+a]=i,this.int16[6+s]=n,this.int16[7+s]=o,t},mo);function mo(){ho.apply(this,arguments)}fo.prototype.bytesPerElement=16,Vi("StructArrayLayout2f1f2i16",fo);var go,yo=(vo.__proto__=go=kn,((vo.prototype=Object.create(go&&go.prototype)).constructor=vo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},vo.prototype.emplaceBack=function(t,e,r,i){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)},vo.prototype.emplace=function(t,e,r,i,n){var o=12*t,a=3*t;return this.uint8[0+o]=e,this.uint8[1+o]=r,this.float32[1+a]=i,this.float32[2+a]=n,t},vo);function vo(){go.apply(this,arguments)}yo.prototype.bytesPerElement=12,Vi("StructArrayLayout2ub2f12",yo);var _o,xo=(bo.__proto__=_o=kn,((bo.prototype=Object.create(_o&&_o.prototype)).constructor=bo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},bo.prototype.emplaceBack=function(t,e,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)},bo.prototype.emplace=function(t,e,r,i){var n=3*t;return this.uint16[0+n]=e,this.uint16[1+n]=r,this.uint16[2+n]=i,t},bo);function bo(){_o.apply(this,arguments)}xo.prototype.bytesPerElement=6,Vi("StructArrayLayout3ui6",xo);var wo,So=(To.__proto__=wo=kn,((To.prototype=Object.create(wo&&wo.prototype)).constructor=To).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},To.prototype.emplaceBack=function(t,e,r,i,n,o,a,s,l,c,u,p,h,d,f,m,g){var y=this.length;return this.resize(y+1),this.emplace(y,t,e,r,i,n,o,a,s,l,c,u,p,h,d,f,m,g)},To.prototype.emplace=function(t,e,r,i,n,o,a,s,l,c,u,p,h,d,f,m,g,y){var v=24*t,_=12*t,x=48*t;return this.int16[0+v]=e,this.int16[1+v]=r,this.uint16[2+v]=i,this.uint16[3+v]=n,this.uint32[2+_]=o,this.uint32[3+_]=a,this.uint32[4+_]=s,this.uint16[10+v]=l,this.uint16[11+v]=c,this.uint16[12+v]=u,this.float32[7+_]=p,this.float32[8+_]=h,this.uint8[36+x]=d,this.uint8[37+x]=f,this.uint8[38+x]=m,this.uint32[10+_]=g,this.int16[22+v]=y,t},To);function To(){wo.apply(this,arguments)}So.prototype.bytesPerElement=48,Vi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",So);var Eo,Io=(Co.__proto__=Eo=kn,((Co.prototype=Object.create(Eo&&Eo.prototype)).constructor=Co).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Co.prototype.emplaceBack=function(t,e,r,i,n,o,a,s,l,c,u,p,h,d,f,m,g,y,v,_,x,b,w,S,T,E,I,C){var A=this.length;return this.resize(A+1),this.emplace(A,t,e,r,i,n,o,a,s,l,c,u,p,h,d,f,m,g,y,v,_,x,b,w,S,T,E,I,C)},Co.prototype.emplace=function(t,e,r,i,n,o,a,s,l,c,u,p,h,d,f,m,g,y,v,_,x,b,w,S,T,E,I,C,A){var k=34*t,P=17*t;return this.int16[0+k]=e,this.int16[1+k]=r,this.int16[2+k]=i,this.int16[3+k]=n,this.int16[4+k]=o,this.int16[5+k]=a,this.int16[6+k]=s,this.int16[7+k]=l,this.uint16[8+k]=c,this.uint16[9+k]=u,this.uint16[10+k]=p,this.uint16[11+k]=h,this.uint16[12+k]=d,this.uint16[13+k]=f,this.uint16[14+k]=m,this.uint16[15+k]=g,this.uint16[16+k]=y,this.uint16[17+k]=v,this.uint16[18+k]=_,this.uint16[19+k]=x,this.uint16[20+k]=b,this.uint16[21+k]=w,this.uint16[22+k]=S,this.uint32[12+P]=T,this.float32[13+P]=E,this.float32[14+P]=I,this.float32[15+P]=C,this.float32[16+P]=A,t},Co);function Co(){Eo.apply(this,arguments)}Io.prototype.bytesPerElement=68,Vi("StructArrayLayout8i15ui1ul4f68",Io);var Ao,ko=(Po.__proto__=Ao=kn,((Po.prototype=Object.create(Ao&&Ao.prototype)).constructor=Po).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Po.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},Po.prototype.emplace=function(t,e){return this.float32[+t+0]=e,t},Po);function Po(){Ao.apply(this,arguments)}ko.prototype.bytesPerElement=4,Vi("StructArrayLayout1f4",ko);var Oo,Mo=(Lo.__proto__=Oo=kn,((Lo.prototype=Object.create(Oo&&Oo.prototype)).constructor=Lo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Lo.prototype.emplaceBack=function(t,e,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)},Lo.prototype.emplace=function(t,e,r,i){var n=3*t;return this.int16[0+n]=e,this.int16[1+n]=r,this.int16[2+n]=i,t},Lo);function Lo(){Oo.apply(this,arguments)}Mo.prototype.bytesPerElement=6,Vi("StructArrayLayout3i6",Mo);var Do,Ro=(zo.__proto__=Do=kn,((zo.prototype=Object.create(Do&&Do.prototype)).constructor=zo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},zo.prototype.emplaceBack=function(t,e,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r)},zo.prototype.emplace=function(t,e,r,i){var n=4*t;return this.uint32[2*t+0]=e,this.uint16[2+n]=r,this.uint16[3+n]=i,t},zo);function zo(){Do.apply(this,arguments)}Ro.prototype.bytesPerElement=8,Vi("StructArrayLayout1ul2ui8",Ro);var No,Bo=(Fo.__proto__=No=kn,((Fo.prototype=Object.create(No&&No.prototype)).constructor=Fo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Fo.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},Fo.prototype.emplace=function(t,e,r){var i=2*t;return this.uint16[0+i]=e,this.uint16[1+i]=r,t},Fo);function Fo(){No.apply(this,arguments)}Bo.prototype.bytesPerElement=4,Vi("StructArrayLayout2ui4",Bo);var jo,Uo=(Vo.__proto__=jo=kn,((Vo.prototype=Object.create(jo&&jo.prototype)).constructor=Vo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Vo.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},Vo.prototype.emplace=function(t,e){return this.uint16[+t+0]=e,t},Vo);function Vo(){jo.apply(this,arguments)}Uo.prototype.bytesPerElement=2,Vi("StructArrayLayout1ui2",Uo);var qo,Go=(Zo.__proto__=qo=kn,((Zo.prototype=Object.create(qo&&qo.prototype)).constructor=Zo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Zo.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},Zo.prototype.emplace=function(t,e,r){var i=2*t;return this.float32[0+i]=e,this.float32[1+i]=r,t},Zo);function Zo(){qo.apply(this,arguments)}Go.prototype.bytesPerElement=8,Vi("StructArrayLayout2f8",Go);var Ho,Wo=(Ko.__proto__=Ho=kn,((Ko.prototype=Object.create(Ho&&Ho.prototype)).constructor=Ko).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Ko.prototype.emplaceBack=function(t,e,r,i){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,i)},Ko.prototype.emplace=function(t,e,r,i,n){var o=4*t;return this.float32[0+o]=e,this.float32[1+o]=r,this.float32[2+o]=i,this.float32[3+o]=n,t},Ko);function Ko(){Ho.apply(this,arguments)}Wo.prototype.bytesPerElement=16,Vi("StructArrayLayout4f16",Wo);var Xo=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new n(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,r),e}(An);Xo.prototype.size=20;var Yo,Jo=((Yo=so)&&($o.__proto__=Yo),(($o.prototype=Object.create(Yo&&Yo.prototype)).constructor=$o).prototype.get=function(t){return new Xo(this,t)},$o);function $o(){Yo.apply(this,arguments)}Vi("CollisionBoxArray",Jo);var Qo=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(t){this._structArray.uint8[this._pos1+37]=t},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(t){this._structArray.uint8[this._pos1+38]=t},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(t){this._structArray.uint32[this._pos4+10]=t},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,r),e}(An);Qo.prototype.size=48;var ta,ea=((ta=So)&&(ra.__proto__=ta),((ra.prototype=Object.create(ta&&ta.prototype)).constructor=ra).prototype.get=function(t){return new Qo(this,t)},ra);function ra(){ta.apply(this,arguments)}Vi("PlacedSymbolArray",ea);var ia=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(t){this._structArray.uint32[this._pos4+12]=t},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,r),e}(An);ia.prototype.size=68;var na,oa=((na=Io)&&(aa.__proto__=na),((aa.prototype=Object.create(na&&na.prototype)).constructor=aa).prototype.get=function(t){return new ia(this,t)},aa);function aa(){na.apply(this,arguments)}Vi("SymbolInstanceArray",oa);var sa,la=((sa=ko)&&(ca.__proto__=sa),((ca.prototype=Object.create(sa&&sa.prototype)).constructor=ca).prototype.getoffsetX=function(t){return this.float32[+t+0]},ca);function ca(){sa.apply(this,arguments)}Vi("GlyphOffsetArray",la);var ua,pa=((ua=Mo)&&(ha.__proto__=ua),((ha.prototype=Object.create(ua&&ua.prototype)).constructor=ha).prototype.getx=function(t){return this.int16[3*t+0]},ha.prototype.gety=function(t){return this.int16[3*t+1]},ha.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},ha);function ha(){ua.apply(this,arguments)}Vi("SymbolLineVertexArray",pa);var da=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,r),e}(An);da.prototype.size=8;var fa,ma=((fa=Ro)&&(ga.__proto__=fa),((ga.prototype=Object.create(fa&&fa.prototype)).constructor=ga).prototype.get=function(t){return new da(this,t)},ga);function ga(){fa.apply(this,arguments)}function ya(t){void 0===t&&(t=[]),this.segments=t}Vi("FeatureIndexArray",ma);var va=Dn([{name:"a_pos",components:2,type:"Int16"}],4).members;function _a(t,e){return 256*(t=c(Math.floor(t),0,255))+c(Math.floor(e),0,255)}ya.prototype.prepareSegment=function(t,e,r,i){var n=this.segments[this.segments.length-1];return ya.MAX_VERTEX_ARRAY_LENGTH<t&&w("Max vertices per segment is "+ya.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!n||n.vertexLength+t>ya.MAX_VERTEX_ARRAY_LENGTH||n.sortKey!==i)&&(n={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==i&&(n.sortKey=i),this.segments.push(n)),n},ya.prototype.get=function(){return this.segments},ya.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var r=e[t];for(var i in r.vaos)r.vaos[i].destroy()}},ya.simpleSegment=function(t,e,r,i){return new ya([{vertexOffset:t,primitiveOffset:e,vertexLength:r,primitiveLength:i,vaos:{},sortKey:0}])},ya.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Vi("SegmentVector",ya);var xa=Dn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ba=e((function(t){t.exports=function(t,e){var r,i,n,o,a,s,l,c;for(i=t.length-(r=3&t.length),n=e,a=3432918353,s=461845907,c=0;c<i;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,n=27492+(65535&(o=5*(65535&(n=(n^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:n^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return n^=t.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0}})),wa=e((function(t){t.exports=function(t,e){for(var r,i=t.length,n=e^i,o=0;4<=i;)r=1540483477*(65535&(r=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(r>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),i-=4,++o;switch(i){case 3:n^=(255&t.charCodeAt(o+2))<<16;case 2:n^=(255&t.charCodeAt(o+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(o)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}})),Sa=ba,Ta=wa;function Ea(){this.ids=[],this.positions=[],this.indexed=!1}Sa.murmur3=ba,Sa.murmur2=Ta,Ea.prototype.add=function(t,e,r,i){this.ids.push(Ca(t)),this.positions.push(e,r,i)},Ea.prototype.getPositions=function(t){for(var e=Ca(t),r=0,i=this.ids.length-1;r<i;){var n=r+i>>1;this.ids[n]>=e?i=n:r=1+n}for(var o=[];this.ids[r]===e;)o.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return o},Ea.serialize=function(t,e){var r=new Float64Array(t.ids),i=new Uint32Array(t.positions);return function t(e,r,i,n){for(;i<n;){for(var o=e[i+n>>1],a=i-1,s=n+1;;){for(;e[++a]<o;);for(;e[--s]>o;);if(s<=a)break;Aa(e,a,s),Aa(r,3*a,3*s),Aa(r,3*a+1,3*s+1),Aa(r,3*a+2,3*s+2)}s-i<n-s?(t(e,r,i,s),i=s+1):(t(e,r,s+1,n),n=s)}}(r,i,0,r.length-1),e&&e.push(r.buffer,i.buffer),{ids:r,positions:i}},Ea.deserialize=function(t){var e=new Ea;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var Ia=Math.pow(2,53)-1;function Ca(t){var e=+t;return!isNaN(e)&&e<=Ia?e:Sa(String(t))}function Aa(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function ka(t,e){this.gl=t.gl,this.location=e}Vi("FeaturePositionMap",Ea);var Pa,Oa,Ma,La,Da,Ra,za,Na=(Ja.__proto__=za=ka,((Ja.prototype=Object.create(za&&za.prototype)).constructor=Ja).prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},Ja),Ba=(Ya.__proto__=Ra=ka,((Ya.prototype=Object.create(Ra&&Ra.prototype)).constructor=Ya).prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},Ya),Fa=(Xa.__proto__=Da=ka,((Xa.prototype=Object.create(Da&&Da.prototype)).constructor=Xa).prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},Xa),ja=(Ka.__proto__=La=ka,((Ka.prototype=Object.create(La&&La.prototype)).constructor=Ka).prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},Ka),Ua=(Wa.__proto__=Ma=ka,((Wa.prototype=Object.create(Ma&&Ma.prototype)).constructor=Wa).prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},Wa),Va=(Ha.__proto__=Oa=ka,((Ha.prototype=Object.create(Oa&&Oa.prototype)).constructor=Ha).prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},Ha),qa=new Float32Array(16),Ga=(Za.__proto__=Pa=ka,((Za.prototype=Object.create(Pa&&Pa.prototype)).constructor=Za).prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},Za);function Za(t,e){Pa.call(this,t,e),this.current=qa}function Ha(t,e){Oa.call(this,t,e),this.current=le.transparent}function Wa(t,e){Ma.call(this,t,e),this.current=[0,0,0,0]}function Ka(t,e){La.call(this,t,e),this.current=[0,0,0]}function Xa(t,e){Da.call(this,t,e),this.current=[0,0]}function Ya(t,e){Ra.call(this,t,e),this.current=0}function Ja(t,e){za.call(this,t,e),this.current=0}function $a(t){return[_a(255*t.r,255*t.g),_a(255*t.b,255*t.a)]}function Qa(t,e,r){this.value=t,this.uniformNames=e.map((function(t){return"u_"+t})),this.type=r}function ts(t,e){this.uniformNames=e.map((function(t){return"u_"+t})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}function es(t,e,r,i){this.expression=t,this.type=r,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?2:1,offset:0}})),this.paintVertexArray=new i}function rs(t,e,r,i,n,o){this.expression=t,this.uniformNames=e.map((function(t){return"u_"+t+"_t"})),this.type=r,this.useIntegerZoom=i,this.zoom=n,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?4:2,offset:0}})),this.paintVertexArray=new o}function is(t,e,r,i,n,o){this.expression=t,this.type=e,this.useIntegerZoom=r,this.zoom=i,this.layerId=o,this.zoomInPaintVertexArray=new n,this.zoomOutPaintVertexArray=new n}function ns(t,e,r){this.binders={},this._buffers=[];var i,n,o=[];for(var a in t.paint._values)if(r(a)){var s=t.paint.get(a);if(s instanceof vn&&Br(s.property.specification)){var l=(i=a,n=t.type,{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(n+"-","").replace(/-/g,"_")]),c=s.value,u=s.property.specification.type,p=s.property.useIntegerZoom,h=s.property.specification["property-type"],d="cross-faded"===h||"cross-faded-data-driven"===h;if("constant"===c.kind)this.binders[a]=d?new ts(c.value,l):new Qa(c.value,l,u),o.push("/u_"+a);else if("source"===c.kind||d){var f=as(a,u,"source");this.binders[a]=d?new is(c,u,p,e,f,t.id):new es(c,l,u,f),o.push("/a_"+a)}else{var m=as(a,u,"composite");this.binders[a]=new rs(c,l,u,p,e,m),o.push("/z_"+a)}}}this.cacheKey=o.sort().join("")}function os(t,e,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var i=0,n=t;i<n.length;i+=1){var o=n[i];this.programConfigurations[o.id]=new ns(o,e,r)}this.needsUpload=!1,this._featureMap=new Ea,this._bufferOffset=0}function as(t,e,r){var i={color:{source:Go,composite:Wo},number:{source:ko,composite:Go}},n={"line-pattern":{source:Xn,composite:Xn},"fill-pattern":{source:Xn,composite:Xn},"fill-extrusion-pattern":{source:Xn,composite:Xn}}[t];return n&&n[r]||i[e][r]}Qa.prototype.setUniform=function(t,e,r){t.set(r.constantOr(this.value))},Qa.prototype.getBinding=function(t,e,r){return new("color"===this.type?Va:Ba)(t,e)},ts.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},ts.prototype.setUniform=function(t,e,r,i){var n="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;n&&t.set(n)},ts.prototype.getBinding=function(t,e,r){return new("u_pattern"===r.substr(0,9)?Ua:Ba)(t,e)},es.prototype.populatePaintArray=function(t,e,r,i,n){var o=this.paintVertexArray.length,a=this.expression.evaluate(new cn(0),e,{},i,[],n);this.paintVertexArray.resize(t),this._setPaintValue(o,t,a)},es.prototype.updatePaintArray=function(t,e,r,i){var n=this.expression.evaluate({zoom:0},r,i);this._setPaintValue(t,e,n)},es.prototype._setPaintValue=function(t,e,r){if("color"===this.type)for(var i=$a(r),n=t;n<e;n++)this.paintVertexArray.emplace(n,i[0],i[1]);else{for(var o=t;o<e;o++)this.paintVertexArray.emplace(o,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},es.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},es.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},rs.prototype.populatePaintArray=function(t,e,r,i,n){var o=this.expression.evaluate(new cn(this.zoom),e,{},i,[],n),a=this.expression.evaluate(new cn(this.zoom+1),e,{},i,[],n),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,o,a)},rs.prototype.updatePaintArray=function(t,e,r,i){var n=this.expression.evaluate({zoom:this.zoom},r,i),o=this.expression.evaluate({zoom:this.zoom+1},r,i);this._setPaintValue(t,e,n,o)},rs.prototype._setPaintValue=function(t,e,r,i){if("color"===this.type)for(var n=$a(r),o=$a(i),a=t;a<e;a++)this.paintVertexArray.emplace(a,n[0],n[1],o[0],o[1]);else{for(var s=t;s<e;s++)this.paintVertexArray.emplace(s,r,i);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(i))}},rs.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},rs.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},rs.prototype.setUniform=function(t,e){var r=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,i=c(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);t.set(i)},rs.prototype.getBinding=function(t,e,r){return new Ba(t,e)},is.prototype.populatePaintArray=function(t,e,r){var i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(i,t,e.patterns&&e.patterns[this.layerId],r)},is.prototype.updatePaintArray=function(t,e,r,i,n){this._setPaintValues(t,e,r.patterns&&r.patterns[this.layerId],n)},is.prototype._setPaintValues=function(t,e,r,i){if(i&&r){var n=i[r.min],o=i[r.mid],a=i[r.max];if(n&&o&&a)for(var s=t;s<e;s++)this.zoomInPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1],o.pixelRatio,n.pixelRatio),this.zoomOutPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],o.pixelRatio,a.pixelRatio)}},is.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,xa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,xa.members,this.expression.isStateDependent))},is.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},ns.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof es||e instanceof rs?e.maxValue:0},ns.prototype.populatePaintArrays=function(t,e,r,i,n){for(var o in this.binders){var a=this.binders[o];(a instanceof es||a instanceof rs||a instanceof is)&&a.populatePaintArray(t,e,r,i,n)}},ns.prototype.setConstantPatternPositions=function(t,e){for(var r in this.binders){var i=this.binders[r];i instanceof ts&&i.setConstantPatternPositions(t,e)}},ns.prototype.updatePaintArrays=function(t,e,r,i,n){var o=!1;for(var a in t)for(var s=0,l=e.getPositions(a);s<l.length;s+=1){var c=l[s],u=r.feature(c.index);for(var p in this.binders){var h=this.binders[p];if((h instanceof es||h instanceof rs||h instanceof is)&&!0===h.expression.isStateDependent){var d=i.paint.get(p);h.expression=d.value,h.updatePaintArray(c.start,c.end,u,t[a],n),o=!0}}}return o},ns.prototype.defines=function(){var t=[];for(var e in this.binders){var r=this.binders[e];(r instanceof Qa||r instanceof ts)&&t.push.apply(t,r.uniformNames.map((function(t){return"#define HAS_UNIFORM_"+t})))}return t},ns.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var r=this.binders[e];if(r instanceof es||r instanceof rs)for(var i=0;i<r.paintVertexAttributes.length;i++)t.push(r.paintVertexAttributes[i].name);else if(r instanceof is)for(var n=0;n<xa.members.length;n++)t.push(xa.members[n].name)}return t},ns.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var r=this.binders[e];if(r instanceof Qa||r instanceof ts||r instanceof rs)for(var i=0,n=r.uniformNames;i<n.length;i+=1)t.push(n[i])}return t},ns.prototype.getPaintVertexBuffers=function(){return this._buffers},ns.prototype.getUniforms=function(t,e){var r=[];for(var i in this.binders){var n=this.binders[i];if(n instanceof Qa||n instanceof ts||n instanceof rs)for(var o=0,a=n.uniformNames;o<a.length;o+=1){var s=a[o];if(e[s]){var l=n.getBinding(t,e[s],s);r.push({name:s,property:i,binding:l})}}}return r},ns.prototype.setUniforms=function(t,e,r,i){for(var n=0,o=e;n<o.length;n+=1){var a=o[n],s=a.name,l=a.property;this.binders[l].setUniform(a.binding,i,r.get(l),s)}},ns.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var r=this.binders[e];if(t&&r instanceof is){var i=2===t.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(r instanceof es||r instanceof rs)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},ns.prototype.upload=function(t){for(var e in this.binders){var r=this.binders[e];(r instanceof es||r instanceof rs||r instanceof is)&&r.upload(t)}this.updatePaintBuffers()},ns.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof es||e instanceof rs||e instanceof is)&&e.destroy()}},os.prototype.populatePaintArrays=function(t,e,r,i,n,o){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(t,e,i,n,o);void 0!==e.id&&this._featureMap.add(e.id,r,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},os.prototype.updatePaintArrays=function(t,e,r,i){for(var n=0,o=r;n<o.length;n+=1){var a=o[n];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,this._featureMap,e,a,i)||this.needsUpload}},os.prototype.get=function(t){return this.programConfigurations[t]},os.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},os.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Vi("ConstantBinder",Qa),Vi("CrossFadedConstantBinder",ts),Vi("SourceExpressionBinder",es),Vi("CrossFadedCompositeBinder",is),Vi("CompositeExpressionBinder",rs),Vi("ProgramConfiguration",ns,{omit:["_buffers"]}),Vi("ProgramConfigurationSet",os);var ss=Math.pow(2,14)-1,ls=-ss-1;function cs(t){for(var e=8192/t.extent,r=t.loadGeometry(),i=0;i<r.length;i++)for(var n=r[i],o=0;o<n.length;o++){var a=n[o],s=Math.round(a.x*e),l=Math.round(a.y*e);a.x=c(s,ls,ss),a.y=c(l,ls,ss),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&w("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function us(t,e,r,i,n){t.emplaceBack(2*e+(i+1)/2,2*r+(n+1)/2)}function ps(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Nn,this.indexArray=new xo,this.segments=new ya,this.programConfigurations=new os(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))}function hs(t,e){for(var r=0;r<t.length;r++)if(_s(e,t[r]))return!0;for(var i=0;i<e.length;i++)if(_s(t,e[i]))return!0;return!!ms(t,e)}function ds(t,e){if(1===t.length)return vs(e,t[0]);for(var r=0;r<e.length;r++)for(var i=e[r],n=0;n<i.length;n++)if(_s(t,i[n]))return!0;for(var o=0;o<t.length;o++)if(vs(e,t[o]))return!0;for(var a=0;a<e.length;a++)if(ms(t,e[a]))return!0;return!1}function fs(t,e,r){if(1<t.length){if(ms(t,e))return 1;for(var i=0;i<e.length;i++)if(gs(e[i],t,r))return 1}for(var n=0;n<t.length;n++)if(gs(t[n],e,r))return 1}function ms(t,e){var r,i,n,o;if(0!==t.length&&0!==e.length)for(var a=0;a<t.length-1;a++)for(var s=t[a],l=t[a+1],c=0;c<e.length-1;c++)if(r=s,i=l,n=e[c],o=e[c+1],S(r,n,o)!==S(i,n,o)&&S(r,i,n)!==S(r,i,o))return 1}function gs(t,e,r){var i=r*r;if(1===e.length)return t.distSqr(e[0])<i;for(var n=1;n<e.length;n++)if(ys(t,e[n-1],e[n])<i)return 1}function ys(t,e,r){var i=e.distSqr(r);if(0===i)return t.distSqr(e);var n=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/i;return t.distSqr(n<0?e:1<n?r:r.sub(e)._mult(n)._add(e))}function vs(t,e){for(var r,i,n,o=!1,a=0;a<t.length;a++)for(var s=0,l=(r=t[a]).length-1;s<r.length;l=s++)(i=r[s]).y>e.y!=(n=r[l]).y>e.y&&e.x<(n.x-i.x)*(e.y-i.y)/(n.y-i.y)+i.x&&(o=!o);return o}function _s(t,e){for(var r=!1,i=0,n=t.length-1;i<t.length;n=i++){var o=t[i],a=t[n];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function xs(t,e,r){var i=r[0],n=r[2];if(!(t.x<i.x&&e.x<i.x||t.x>n.x&&e.x>n.x||t.y<i.y&&e.y<i.y||t.y>n.y&&e.y>n.y)){var o=S(t,e,r[0]);return o!==S(t,e,r[1])||o!==S(t,e,r[2])||o!==S(t,e,r[3])}}function bs(t,e,r){var i=e.paint.get(t).value;return"constant"===i.kind?i.value:r.programConfigurations.get(e.id).getMaxValue(t)}function ws(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Ss(t,e,r,i,o){if(!e[0]&&!e[1])return t;var a=n.convert(e)._mult(o);"viewport"===r&&a._rotate(-i);for(var s=[],l=0;l<t.length;l++)s.push(t[l].sub(a));return s}ps.prototype.populate=function(t,e,r){var i=this.layers[0],n=[],o=null;"circle"===i.type&&(o=i.layout.get("circle-sort-key"));for(var a=0,s=t;a<s.length;a+=1){var l=s[a],c=l.feature,u=l.id,p=l.index,h=l.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,f={type:c.type,id:u,properties:c.properties,geometry:d?cs(c):[]};if(this.layers[0]._featureFilter.filter(new cn(this.zoom),f,r)){d||(f.geometry=cs(c));var m=o?o.evaluate(f,{},r):void 0;n.push({id:u,properties:c.properties,type:c.type,sourceLayerIndex:h,index:p,geometry:f.geometry,patterns:{},sortKey:m})}}o&&n.sort((function(t,e){return t.sortKey-e.sortKey}));for(var g=0,y=n;g<y.length;g+=1){var v=y[g],_=v.geometry,x=v.index,b=v.sourceLayerIndex,w=t[x].feature;this.addFeature(v,_,x,r),e.featureIndex.insert(w,_,x,b,this.index)}},ps.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},ps.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ps.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,va),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ps.prototype.addFeature=function(t,e,r,i){for(var n=0,o=e;n<o.length;n+=1)for(var a=0,s=o[n];a<s.length;a+=1){var l=s[a],c=l.x,u=l.y;if(!(c<0||8192<=c||u<0||8192<=u)){var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),h=p.vertexLength;us(this.layoutVertexArray,c,u,-1,-1),us(this.layoutVertexArray,c,u,1,-1),us(this.layoutVertexArray,c,u,1,1),us(this.layoutVertexArray,c,u,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),p.vertexLength+=4,p.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{},i)},Vi("CircleBucket",ps,{omit:["layers"]});var Ts=new Cn({"circle-sort-key":new bn(Rt.layout_circle["circle-sort-key"])}),Es={paint:new Cn({"circle-radius":new bn(Rt.paint_circle["circle-radius"]),"circle-color":new bn(Rt.paint_circle["circle-color"]),"circle-blur":new bn(Rt.paint_circle["circle-blur"]),"circle-opacity":new bn(Rt.paint_circle["circle-opacity"]),"circle-translate":new xn(Rt.paint_circle["circle-translate"]),"circle-translate-anchor":new xn(Rt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new xn(Rt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new xn(Rt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new bn(Rt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new bn(Rt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new bn(Rt.paint_circle["circle-stroke-opacity"])}),layout:Ts},Is="undefined"!=typeof Float32Array?Float32Array:Array;function Cs(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function As(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],p=e[8],h=e[9],d=e[10],f=e[11],m=e[12],g=e[13],y=e[14],v=e[15],_=r[0],x=r[1],b=r[2],w=r[3];return t[0]=_*i+x*s+b*p+w*m,t[1]=_*n+x*l+b*h+w*g,t[2]=_*o+x*c+b*d+w*y,t[3]=_*a+x*u+b*f+w*v,t[4]=(_=r[4])*i+(x=r[5])*s+(b=r[6])*p+(w=r[7])*m,t[5]=_*n+x*l+b*h+w*g,t[6]=_*o+x*c+b*d+w*y,t[7]=_*a+x*u+b*f+w*v,t[8]=(_=r[8])*i+(x=r[9])*s+(b=r[10])*p+(w=r[11])*m,t[9]=_*n+x*l+b*h+w*g,t[10]=_*o+x*c+b*d+w*y,t[11]=_*a+x*u+b*f+w*v,t[12]=(_=r[12])*i+(x=r[13])*s+(b=r[14])*p+(w=r[15])*m,t[13]=_*n+x*l+b*h+w*g,t[14]=_*o+x*c+b*d+w*y,t[15]=_*a+x*u+b*f+w*v,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,r=arguments.length;r--;)e+=t[r]*t[r];return Math.sqrt(e)});var ks,Ps,Os=As;function Ms(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*o+r[12]*a,t[1]=r[1]*i+r[5]*n+r[9]*o+r[13]*a,t[2]=r[2]*i+r[6]*n+r[10]*o+r[14]*a,t[3]=r[3]*i+r[7]*n+r[11]*o+r[15]*a,t}ks=new Is(3),Is!=Float32Array&&(ks[0]=0,ks[1]=0,ks[2]=0),Ps=new Is(4),Is!=Float32Array&&(Ps[0]=0,Ps[1]=0,Ps[2]=0,Ps[3]=0);var Ls,Ds,Rs=(Ds=new Is(2),Is!=Float32Array&&(Ds[0]=0,Ds[1]=0),zs.__proto__=Ls=On,((zs.prototype=Object.create(Ls&&Ls.prototype)).constructor=zs).prototype.createBucket=function(t){return new ps(t)},zs.prototype.queryRadius=function(t){var e=t;return bs("circle-radius",this,e)+bs("circle-stroke-width",this,e)+ws(this.paint.get("circle-translate"))},zs.prototype.queryIntersectsFeature=function(t,e,r,i,n,o,a,s){for(var l=Ss(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),c=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r),u="map"===this.paint.get("circle-pitch-alignment"),p=u?l:function(t){return l.map((function(e){return Ns(e,t)}))}(s),h=u?c*a:c,d=0,f=i;d<f.length;d+=1)for(var m=0,g=f[d];m<g.length;m+=1){var y=g[m],v=u?y:Ns(y,s),_=h,x=Ms([],[y.x,y.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=x[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/x[3]),S=_,_s(b=p,w=v)||gs(w,b,S))return!0}var b,w,S;return!1},zs);function zs(t){Ls.call(this,t,Es)}function Ns(t,e){var r=Ms([],[t.x,t.y,0,1],e);return new n(r[0]/r[3],r[1]/r[3])}var Bs,Fs=(js.__proto__=Bs=ps,(js.prototype=Object.create(Bs&&Bs.prototype)).constructor=js);function js(){Bs.apply(this,arguments)}function Us(t,e,r,i){var n=e.width,o=e.height;if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==n*o*r)throw new RangeError("mismatched image size")}else i=new Uint8Array(n*o*r);return t.width=n,t.height=o,t.data=i,t}function Vs(t,e,r){var i=e.width,n=e.height;if(i!==t.width||n!==t.height){var o=Us({},{width:i,height:n},r);qs(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,n)},r),t.width=i,t.height=n,t.data=o.data}}function qs(t,e,r,i,n,o){if(0===n.width||0===n.height)return e;if(n.width>t.width||n.height>t.height||r.x>t.width-n.width||r.y>t.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||i.x>e.width-n.width||i.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,l=0;l<n.height;l++)for(var c=((r.y+l)*t.width+r.x)*o,u=((i.y+l)*e.width+i.x)*o,p=0;p<n.width*o;p++)s[u+p]=a[c+p];return e}Vi("HeatmapBucket",Fs,{omit:["layers"]});var Gs=function(t,e){Us(this,t,1,e)};function Zs(t,e){Us(this,t,4,e)}Gs.prototype.resize=function(t){Vs(this,t,1)},Gs.prototype.clone=function(){return new Gs({width:this.width,height:this.height},new Uint8Array(this.data))},Gs.copy=function(t,e,r,i,n){qs(t,e,r,i,n,1)},Zs.prototype.resize=function(t){Vs(this,t,4)},Zs.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},Zs.prototype.clone=function(){return new Zs({width:this.width,height:this.height},new Uint8Array(this.data))},Zs.copy=function(t,e,r,i,n){qs(t,e,r,i,n,4)},Vi("AlphaImage",Gs),Vi("RGBAImage",Zs);var Hs={paint:new Cn({"heatmap-radius":new bn(Rt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new bn(Rt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new xn(Rt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new In(Rt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new xn(Rt.paint_heatmap["heatmap-opacity"])})};function Ws(t,e){for(var r=new Uint8Array(1024),i={},n=0,o=0;n<256;n++,o+=4){i[e]=n/255;var a=t.evaluate(i);r[o+0]=Math.floor(255*a.r/a.a),r[o+1]=Math.floor(255*a.g/a.a),r[o+2]=Math.floor(255*a.b/a.a),r[o+3]=Math.floor(255*a.a)}return new Zs({width:256,height:1},r)}var Ks,Xs,Ys=(il.__proto__=Xs=On,((il.prototype=Object.create(Xs&&Xs.prototype)).constructor=il).prototype.createBucket=function(t){return new Fs(t)},il.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},il.prototype._updateColorRamp=function(){this.colorRamp=Ws(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},il.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},il.prototype.queryRadius=function(){return 0},il.prototype.queryIntersectsFeature=function(){return!1},il.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},il),Js={paint:new Cn({"hillshade-illumination-direction":new xn(Rt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new xn(Rt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new xn(Rt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new xn(Rt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new xn(Rt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new xn(Rt.paint_hillshade["hillshade-accent-color"])})},$s=(rl.__proto__=Ks=On,((rl.prototype=Object.create(Ks&&Ks.prototype)).constructor=rl).prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},rl),Qs=Dn([{name:"a_pos",components:2,type:"Int16"}],4).members,tl=nl,el=nl;function rl(t){Ks.call(this,t,Js)}function il(t){Xs.call(this,t,Hs),this._updateColorRamp()}function nl(t,e,r){r=r||2;var i,n,o,a,s,l,c,u=e&&e.length,p=u?e[0]*r:t.length,h=ol(t,0,p,r,!0),d=[];if(!h||h.next===h.prev)return d;if(u&&(h=function(t,e,r,i){var n,o,a,s=[];for(n=0,o=e.length;n<o;n++)(a=ol(t,e[n]*i,n<o-1?e[n+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),s.push(ml(a));for(s.sort(hl),n=0;n<s.length;n++)dl(s[n],r),r=al(r,r.next);return r}(t,e,h,r)),t.length>80*r){i=o=t[0],n=a=t[1];for(var f=r;f<p;f+=r)(s=t[f])<i&&(i=s),(l=t[f+1])<n&&(n=l),o<s&&(o=s),a<l&&(a=l);c=0!==(c=Math.max(o-i,a-n))?1/c:0}return sl(h,d,r,i,n,c),d}function ol(t,e,r,i,n){var o,a;if(n===0<Cl(t,e,r,i))for(o=e;o<r;o+=i)a=Tl(o,t[o],t[o+1],a);else for(o=r-i;e<=o;o-=i)a=Tl(o,t[o],t[o+1],a);return a&&vl(a,a.next)&&(El(a),a=a.next),a}function al(t,e){if(!t)return t;e=e||t;var r,i=t;do{if(r=!1,i.steiner||!vl(i,i.next)&&0!==yl(i.prev,i,i.next))i=i.next;else{if(El(i),(i=e=i.prev)===i.next)break;r=!0}}while(r||i!==e);return e}function sl(t,e,r,i,n,o,a){if(t){!a&&o&&function(t,e,r,i){for(var n=t;null===n.z&&(n.z=fl(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,(n=n.next)!==t;);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,r,i,n,o,a,s,l,c=1;do{for(r=t,o=t=null,a=0;r;){for(a++,i=r,e=s=0;e<c&&(s++,i=i.nextZ);e++);for(l=c;0<s||0<l&&i;)0!==s&&(0===l||!i||r.z<=i.z)?(r=(n=r).nextZ,s--):(i=(n=i).nextZ,l--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;r=i}o.nextZ=null,c*=2}while(1<a)}(n)}(t,i,n,o);for(var s,l,c=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?cl(t,i,n,o):ll(t))e.push(s.i/r),e.push(t.i/r),e.push(l.i/r),El(t),t=l.next,c=l.next;else if((t=l)===c){a?1===a?sl(t=ul(al(t),e,r),e,r,i,n,o,2):2===a&&pl(t,e,r,i,n,o):sl(al(t),e,r,i,n,o,1);break}}}function ll(t){var e=t.prev,r=t,i=t.next;if(!(0<=yl(e,r,i))){for(var n=t.next.next;n!==t.prev;){if(gl(e.x,e.y,r.x,r.y,i.x,i.y,n.x,n.y)&&0<=yl(n.prev,n,n.next))return;n=n.next}return 1}}function cl(t,e,r,i){var n=t.prev,o=t,a=t.next;if(!(0<=yl(n,o,a))){for(var s=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,l=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,c=fl(n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,e,r,i),u=fl(s,l,e,r,i),p=t.prevZ,h=t.nextZ;p&&p.z>=c&&h&&h.z<=u;){if(p!==t.prev&&p!==t.next&&gl(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=yl(p.prev,p,p.next))return;if(p=p.prevZ,h!==t.prev&&h!==t.next&&gl(n.x,n.y,o.x,o.y,a.x,a.y,h.x,h.y)&&0<=yl(h.prev,h,h.next))return;h=h.nextZ}for(;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&gl(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=yl(p.prev,p,p.next))return;p=p.prevZ}for(;h&&h.z<=u;){if(h!==t.prev&&h!==t.next&&gl(n.x,n.y,o.x,o.y,a.x,a.y,h.x,h.y)&&0<=yl(h.prev,h,h.next))return;h=h.nextZ}return 1}}function ul(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!vl(n,o)&&_l(n,i,i.next,o)&&wl(n,o)&&wl(o,n)&&(e.push(n.i/r),e.push(i.i/r),e.push(o.i/r),El(i),El(i.next),i=t=o),i=i.next}while(i!==t);return al(i)}function pl(t,e,r,i,n,o){var a,s,l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&(s=c,(a=l).next.i!==s.i&&a.prev.i!==s.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&_l(r,r.next,t,e))return 1;r=r.next}while(r!==t)}(a,s)&&(wl(a,s)&&wl(s,a)&&function(t,e){for(var r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),(r=r.next)!==t;);return i}(a,s)&&(yl(a.prev,a,s.prev)||yl(a,s.prev,s))||vl(a,s)&&0<yl(a.prev,a,a.next)&&0<yl(s.prev,s,s.next)))){var u=Sl(l,c);return l=al(l,l.next),u=al(u,u.next),sl(l,e,r,i,n,o),void sl(u,e,r,i,n,o)}c=c.next}l=l.next}while(l!==t)}function hl(t,e){return t.x-e.x}function dl(t,e){if(e=function(t,e){var r,i=e,n=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&a<s){if((a=s)===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!r)return null;if(n===a)return r;var l,c,u,p=r,h=r.x,d=r.y,f=1/0;for(i=r;n>=i.x&&i.x>=h&&n!==i.x&&gl(o<d?n:a,o,h,d,o<d?a:n,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(n-i.x),wl(i,t)&&(l<f||l===f&&(i.x>r.x||i.x===r.x&&(u=i,yl((c=r).prev,c,u.prev)<0&&yl(u.next,c,c.next)<0)))&&(r=i,f=l)),(i=i.next)!==p;);return r}(t,e)){var r=Sl(e,t);al(e,e.next),al(r,r.next)}}function fl(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ml(t){for(var e=t,r=t;(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),(e=e.next)!==t;);return r}function gl(t,e,r,i,n,o,a,s){return 0<=(n-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(i-s)-(r-a)*(e-s)&&0<=(r-a)*(o-s)-(n-a)*(i-s)}function yl(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function vl(t,e){return t.x===e.x&&t.y===e.y}function _l(t,e,r,i){var n=bl(yl(t,e,r)),o=bl(yl(t,e,i)),a=bl(yl(r,i,t)),s=bl(yl(r,i,e));return n!==o&&a!==s||0===n&&xl(t,r,e)||0===o&&xl(t,i,e)||0===a&&xl(r,t,i)||0===s&&xl(r,e,i)}function xl(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function bl(t){return 0<t?1:t<0?-1:0}function wl(t,e){return yl(t.prev,t,t.next)<0?0<=yl(t,e,t.next)&&0<=yl(t,t.prev,e):yl(t,e,t.prev)<0||yl(t,t.next,e)<0}function Sl(t,e){var r=new Il(t.i,t.x,t.y),i=new Il(e.i,e.x,e.y),n=t.next,o=e.prev;return(t.next=e).prev=t,(r.next=n).prev=r,(i.next=r).prev=i,(o.next=i).prev=o,i}function Tl(t,e,r,i){var n=new Il(t,e,r);return i?(n.next=i.next,(n.prev=i).next.prev=n,i.next=n):(n.prev=n).next=n,n}function El(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Il(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cl(t,e,r,i){for(var n=0,o=e,a=r-i;o<r;o+=i)n+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return n}function Al(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function kl(t,e){return t<e?-1:e<t?1:0}function Pl(t,e){var r,i,n,o,a,s=t.length;if(s<=1)return[t];for(var l,c,u=[],p=0;p<s;p++){var h=T(t[p]);0!==h&&(t[p].area=Math.abs(h),void 0===c&&(c=h<0),c===h<0?(l&&u.push(l),l=[t[p]]):l.push(t[p]))}if(l&&u.push(l),1<e)for(var d=0;d<u.length;d++)u[d].length<=e||(r=u[d],i=e,n=1,o=u[d].length-1,a=Ol,function t(e,r,i,n,o){for(;i<n;){if(600<n-i){var a=n-i+1,s=r-i+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(s-a/2<0?-1:1);t(e,r,Math.max(i,Math.floor(r-s*c/a+u)),Math.min(n,Math.floor(r+(a-s)*c/a+u)),o)}var p=e[r],h=i,d=n;for(Al(e,i,r),0<o(e[n],p)&&Al(e,i,n);h<d;){for(Al(e,h,d),h++,d--;o(e[h],p)<0;)h++;for(;0<o(e[d],p);)d--}0===o(e[i],p)?Al(e,i,d):Al(e,++d,n),d<=r&&(i=d+1),r<=d&&(n=d-1)}}(r,i,n||0,o||r.length-1,a||kl),u[d]=u[d].slice(0,e));return u}function Ol(t,e){return e.area-t.area}function Ml(t,e,r){for(var i=r.patternDependencies,n=!1,o=0,a=e;o<a.length;o+=1){var s=a[o].paint.get(t+"-pattern");s.isConstant()||(n=!0);var l=s.constantOr(null);l&&(n=!0,i[l.to]=!0,i[l.from]=!0)}return n}function Ll(t,e,r,i,n){for(var o=n.patternDependencies,a=0,s=e;a<s.length;a+=1){var l=s[a],c=l.paint.get(t+"-pattern").value;if("constant"!==c.kind){var u=c.evaluate({zoom:i-1},r,{},n.availableImages),p=c.evaluate({zoom:i},r,{},n.availableImages),h=c.evaluate({zoom:i+1},r,{},n.availableImages);p=p&&p.name?p.name:p,h=h&&h.name?h.name:h,o[u=u&&u.name?u.name:u]=!0,o[p]=!0,o[h]=!0,r.patterns[l.id]={min:u,mid:p,max:h}}}return r}function Dl(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Nn,this.indexArray=new xo,this.indexArray2=new Bo,this.programConfigurations=new os(t.layers,t.zoom),this.segments=new ya,this.segments2=new ya,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))}nl.deviation=function(t,e,r,i){var n=e&&e.length,o=Math.abs(Cl(t,0,n?e[0]*r:t.length,r));if(n)for(var a=0,s=e.length;a<s;a++)o-=Math.abs(Cl(t,e[a]*r,a<s-1?e[a+1]*r:t.length,r));var l=0;for(a=0;a<i.length;a+=3){var c=i[a]*r,u=i[a+1]*r,p=i[a+2]*r;l+=Math.abs((t[c]-t[p])*(t[1+u]-t[1+c])-(t[c]-t[u])*(t[1+p]-t[1+c]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},nl.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[n][o][a]);0<n&&r.holes.push(i+=t[n-1].length)}return r},tl.default=el,Dl.prototype.populate=function(t,e,r){this.hasPattern=Ml("fill",this.layers,e);for(var i=this.layers[0].layout.get("fill-sort-key"),n=[],o=0,a=t;o<a.length;o+=1){var s=a[o],l=s.feature,c=s.id,u=s.index,p=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:l.type,id:c,properties:l.properties,geometry:h?cs(l):[]};if(this.layers[0]._featureFilter.filter(new cn(this.zoom),d,r)){h||(d.geometry=cs(l));var f=i?i.evaluate(d,{},r,e.availableImages):void 0;n.push({id:c,properties:l.properties,type:l.type,sourceLayerIndex:p,index:u,geometry:d.geometry,patterns:{},sortKey:f})}}i&&n.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,g=n;m<g.length;m+=1){var y=g[m],v=y.geometry,_=y.index,x=y.sourceLayerIndex;if(this.hasPattern){var b=Ll("fill",this.layers,y,this.zoom,e);this.patternFeatures.push(b)}else this.addFeature(y,v,_,r,{});e.featureIndex.insert(t[_].feature,v,_,x,this.index)}},Dl.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},Dl.prototype.addFeatures=function(t,e,r){for(var i=0,n=this.patternFeatures;i<n.length;i+=1){var o=n[i];this.addFeature(o,o.geometry,o.index,e,r)}},Dl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Dl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Dl.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Qs),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},Dl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Dl.prototype.addFeature=function(t,e,r,i,n){for(var o=0,a=Pl(e,500);o<a.length;o+=1){for(var s=a[o],l=0,c=0,u=s;c<u.length;c+=1)l+=u[c].length;for(var p=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),h=p.vertexLength,d=[],f=[],m=0,g=s;m<g.length;m+=1){var y=g[m];if(0!==y.length){y!==s[0]&&f.push(d.length/2);var v=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),_=v.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(_+y.length-1,_),d.push(y[0].x),d.push(y[0].y);for(var x=1;x<y.length;x++)this.layoutVertexArray.emplaceBack(y[x].x,y[x].y),this.indexArray2.emplaceBack(_+x-1,_+x),d.push(y[x].x),d.push(y[x].y);v.vertexLength+=y.length,v.primitiveLength+=y.length}}for(var b=tl(d,f),w=0;w<b.length;w+=3)this.indexArray.emplaceBack(h+b[w],h+b[w+1],h+b[w+2]);p.vertexLength+=l,p.primitiveLength+=b.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,n,i)},Vi("FillBucket",Dl,{omit:["layers","patternFeatures"]});var Rl,zl=new Cn({"fill-sort-key":new bn(Rt.layout_fill["fill-sort-key"])}),Nl={paint:new Cn({"fill-antialias":new xn(Rt.paint_fill["fill-antialias"]),"fill-opacity":new bn(Rt.paint_fill["fill-opacity"]),"fill-color":new bn(Rt.paint_fill["fill-color"]),"fill-outline-color":new bn(Rt.paint_fill["fill-outline-color"]),"fill-translate":new xn(Rt.paint_fill["fill-translate"]),"fill-translate-anchor":new xn(Rt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tn(Rt.paint_fill["fill-pattern"])}),layout:zl},Bl=(Ul.__proto__=Rl=On,((Ul.prototype=Object.create(Rl&&Rl.prototype)).constructor=Ul).prototype.recalculate=function(t,e){Rl.prototype.recalculate.call(this,t,e);var r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},Ul.prototype.createBucket=function(t){return new Dl(t)},Ul.prototype.queryRadius=function(){return ws(this.paint.get("fill-translate"))},Ul.prototype.queryIntersectsFeature=function(t,e,r,i,n,o,a){return ds(Ss(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),i)},Ul.prototype.isTileClipped=function(){return!0},Ul),Fl=Dn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,jl=Vl;function Ul(t){Rl.call(this,t,Nl)}function Vl(t,e,r,i,n){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=n,t.readFields(ql,this,e)}function ql(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var i=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[i]=n}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function Gl(t){for(var e,r,i=0,n=0,o=t.length,a=o-1;n<o;a=n++)i+=((r=t[a]).x-(e=t[n]).x)*(e.y+r.y);return i}Vl.types=["Unknown","Point","LineString","Polygon"],Vl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,i=1,o=0,a=0,s=0,l=[];t.pos<r;){if(o<=0){var c=t.readVarint();i=7&c,o=c>>3}if(o--,1===i||2===i)a+=t.readSVarint(),s+=t.readSVarint(),1===i&&(e&&l.push(e),e=[]),e.push(new n(a,s));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&l.push(e),l},Vl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,i=0,n=0,o=0,a=1/0,s=-1/0,l=1/0,c=-1/0;t.pos<e;){if(i<=0){var u=t.readVarint();r=7&u,i=u>>3}if(i--,1===r||2===r)(n+=t.readSVarint())<a&&(a=n),s<n&&(s=n),(o+=t.readSVarint())<l&&(l=o),c<o&&(c=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,l,s,c]},Vl.prototype.toGeoJSON=function(t,e,r){var i,n,o=this.extent*Math.pow(2,r),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),c=Vl.types[this.type];function u(t){for(var e=0;e<t.length;e++){var r=t[e];t[e]=[360*(r.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(i=0;i<l.length;i++)p[i]=l[i][0];u(l=p);break;case 2:for(i=0;i<l.length;i++)u(l[i]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var r,i,n=[],o=0;o<e;o++){var a=Gl(t[o]);0!==a&&(void 0===i&&(i=a<0),i===a<0?(r&&n.push(r),r=[t[o]]):r.push(t[o]))}return r&&n.push(r),n}(l),i=0;i<l.length;i++)for(n=0;n<l[i].length;n++)u(l[i][n])}1===l.length?l=l[0]:c="Multi"+c;var h={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var Zl=Hl;function Hl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Wl,this,e),this.length=this._features.length}function Wl(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var i=t.readVarint()>>3;e=1==i?t.readString():2==i?t.readFloat():3==i?t.readDouble():4==i?t.readVarint64():5==i?t.readVarint():6==i?t.readSVarint():7==i?t.readBoolean():null}return e}(r))}function Kl(t,e,r){if(3===t){var i=new Zl(r,r.readVarint()+r.pos);i.length&&(e[i.name]=i)}}Hl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new jl(this._pbf,e,this.extent,this._keys,this._values)};var Xl={VectorTile:function(t,e){this.layers=t.readFields(Kl,{},e)},VectorTileFeature:jl,VectorTileLayer:Zl},Yl=Xl.VectorTileFeature.types,Jl=Math.pow(2,13);function $l(t,e,r,i,n,o,a,s){t.emplaceBack(e,r,2*Math.floor(i*Jl)+a,n*Jl*2,o*Jl*2,Math.round(s))}function Ql(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new qn,this.indexArray=new xo,this.programConfigurations=new os(t.layers,t.zoom),this.segments=new ya,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))}Ql.prototype.populate=function(t,e,r){this.features=[],this.hasPattern=Ml("fill-extrusion",this.layers,e);for(var i=0,n=t;i<n.length;i+=1){var o=n[i],a=o.feature,s=o.id,l=o.index,c=o.sourceLayerIndex,u=this.layers[0]._featureFilter.needGeometry,p={type:a.type,id:s,properties:a.properties,geometry:u?cs(a):[]};if(this.layers[0]._featureFilter.filter(new cn(this.zoom),p,r)){var h={id:s,sourceLayerIndex:c,index:l,geometry:u?p.geometry:cs(a),properties:a.properties,type:a.type,patterns:{}};void 0!==a.id&&(h.id=a.id),this.hasPattern?this.features.push(Ll("fill-extrusion",this.layers,h,this.zoom,e)):this.addFeature(h,h.geometry,l,r,{}),e.featureIndex.insert(a,h.geometry,l,c,this.index,!0)}}},Ql.prototype.addFeatures=function(t,e,r){for(var i=0,n=this.features;i<n.length;i+=1){var o=n[i];this.addFeature(o,o.geometry,o.index,e,r)}},Ql.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},Ql.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ql.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ql.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Fl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Ql.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ql.prototype.addFeature=function(t,e,r,i,n){for(var o=0,a=Pl(e,500);o<a.length;o+=1){for(var s=a[o],l=0,c=0,u=s;c<u.length;c+=1)l+=u[c].length;for(var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=0,d=s;h<d.length;h+=1){var f=d[h];if(0!==f.length&&!((D=f).every((function(t){return t.x<0}))||D.every((function(t){return 8192<t.x}))||D.every((function(t){return t.y<0}))||D.every((function(t){return 8192<t.y}))))for(var m=0,g=0;g<f.length;g++){var y=f[g];if(1<=g){var v=f[g-1];if(L=v,!((M=y).x===L.x&&(M.x<0||8192<M.x)||M.y===L.y&&(M.y<0||8192<M.y))){p.vertexLength+4>ya.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=y.sub(v)._perp()._unit(),x=v.dist(y);32768<m+x&&(m=0),$l(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,0,m),$l(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,1,m),$l(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,0,m+=x),$l(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,1,m);var b=p.vertexLength;this.indexArray.emplaceBack(b,b+2,b+1),this.indexArray.emplaceBack(b+1,b+2,b+3),p.vertexLength+=4,p.primitiveLength+=2}}}}if(p.vertexLength+l>ya.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),"Polygon"===Yl[t.type]){for(var w=[],S=[],T=p.vertexLength,E=0,I=s;E<I.length;E+=1){var C=I[E];if(0!==C.length){C!==s[0]&&S.push(w.length/2);for(var A=0;A<C.length;A++){var k=C[A];$l(this.layoutVertexArray,k.x,k.y,0,0,1,1,0),w.push(k.x),w.push(k.y)}}}for(var P=tl(w,S),O=0;O<P.length;O+=3)this.indexArray.emplaceBack(T+P[O],T+P[O+2],T+P[O+1]);p.primitiveLength+=P.length/3,p.vertexLength+=l}}var M,L,D;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,n,i)},Vi("FillExtrusionBucket",Ql,{omit:["layers","features"]});var tc,ec={paint:new Cn({"fill-extrusion-opacity":new xn(Rt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new bn(Rt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new xn(Rt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new xn(Rt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tn(Rt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new bn(Rt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new bn(Rt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new xn(Rt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},rc=(ic.__proto__=tc=On,((ic.prototype=Object.create(tc&&tc.prototype)).constructor=ic).prototype.createBucket=function(t){return new Ql(t)},ic.prototype.queryRadius=function(){return ws(this.paint.get("fill-extrusion-translate"))},ic.prototype.is3D=function(){return!0},ic.prototype.queryIntersectsFeature=function(t,e,r,i,o,a,s,l){var c=Ss(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),u=this.paint.get("fill-extrusion-height").evaluate(e,r),p=this.paint.get("fill-extrusion-base").evaluate(e,r),h=function(t){for(var e=[],r=0,i=c;r<i.length;r+=1){var o=i[r],a=[o.x,o.y,0,1];Ms(a,a,t),e.push(new n(a[0]/a[3],a[1]/a[3]))}return e}(l),d=function(t,e){for(var r=[],i=[],o=e[8]*p,a=e[9]*p,s=e[10]*p,l=e[11]*p,c=e[8]*u,h=e[9]*u,d=e[10]*u,f=e[11]*u,m=0,g=t;m<g.length;m+=1){for(var y=[],v=[],_=0,x=g[m];_<x.length;_+=1){var b=x[_],w=b.x,S=b.y,T=e[0]*w+e[4]*S+e[12],E=e[1]*w+e[5]*S+e[13],I=e[2]*w+e[6]*S+e[14],C=e[3]*w+e[7]*S+e[15],A=I+s,k=C+l,P=T+c,O=E+h,M=I+d,L=C+f,D=new n((T+o)/k,(E+a)/k);D.z=A/k,y.push(D);var R=new n(P/L,O/L);R.z=M/L,v.push(R)}r.push(y),i.push(v)}return[r,i]}(i,l);return function(t,e,r){var i=1/0;ds(r,e)&&(i=oc(r,e[0]));for(var n=0;n<e.length;n++)for(var o=e[n],a=t[n],s=0;s<o.length-1;s++){var l=o[s],c=[l,o[s+1],a[s+1],a[s],l];hs(r,c)&&(i=Math.min(i,oc(r,c)))}return i!==1/0&&i}(d[0],d[1],h)},ic);function ic(t){tc.call(this,t,ec)}function nc(t,e){return t.x*e.x+t.y*e.y}function oc(t,e){if(1===t.length){for(var r,i=0,n=e[i++];!r||n.equals(r);)if(!(r=e[i++]))return 1/0;for(;i<e.length;i++){var o=e[i],a=t[0],s=r.sub(n),l=o.sub(n),c=a.sub(n),u=nc(s,s),p=nc(s,l),h=nc(l,l),d=nc(c,s),f=nc(c,l),m=u*h-p*p,g=(h*d-p*f)/m,y=(u*f-p*d)/m,v=n.z*(1-g-y)+r.z*g+o.z*y;if(isFinite(v))return v}return 1/0}for(var _=1/0,x=0,b=e;x<b.length;x+=1)_=Math.min(_,b[x].z);return _}function ac(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Hn,this.indexArray=new xo,this.programConfigurations=new os(t.layers,t.zoom),this.segments=new ya,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))}var sc=Dn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,lc=Xl.VectorTileFeature.types,cc=Math.cos(Math.PI/180*37.5),uc=Math.pow(2,14)/.5;ac.prototype.populate=function(t,e,r){this.hasPattern=Ml("line",this.layers,e);for(var i=this.layers[0].layout.get("line-sort-key"),n=[],o=0,a=t;o<a.length;o+=1){var s=a[o],l=s.feature,c=s.id,u=s.index,p=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:l.type,id:c,properties:l.properties,geometry:h?cs(l):[]};if(this.layers[0]._featureFilter.filter(new cn(this.zoom),d,r)){h||(d.geometry=cs(l));var f=i?i.evaluate(d,{},r):void 0;n.push({id:c,properties:l.properties,type:l.type,sourceLayerIndex:p,index:u,geometry:d.geometry,patterns:{},sortKey:f})}}i&&n.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,g=n;m<g.length;m+=1){var y=g[m],v=y.geometry,_=y.index,x=y.sourceLayerIndex;if(this.hasPattern){var b=Ll("line",this.layers,y,this.zoom,e);this.patternFeatures.push(b)}else this.addFeature(y,v,_,r,{});e.featureIndex.insert(t[_].feature,v,_,x,this.index)}},ac.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},ac.prototype.addFeatures=function(t,e,r){for(var i=0,n=this.patternFeatures;i<n.length;i+=1){var o=n[i];this.addFeature(o,o.geometry,o.index,e,r)}},ac.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ac.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ac.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,sc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ac.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ac.prototype.addFeature=function(t,e,r,i,n){for(var o=this.layers[0].layout,a=o.get("line-join").evaluate(t,{}),s=o.get("line-cap"),l=o.get("line-miter-limit"),c=o.get("line-round-limit"),u=0,p=e;u<p.length;u+=1)this.addLine(p[u],t,a,s,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,n,i)},ac.prototype.addLine=function(t,e,r,i,n,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+e.properties.mapbox_clip_start,this.clipEnd=+e.properties.mapbox_clip_end;for(var a=0;a<t.length-1;a++)this.totalDistance+=t[a].dist(t[a+1]);this.updateScaledDistance()}for(var s="Polygon"===lc[e.type],l=t.length;2<=l&&t[l-1].equals(t[l-2]);)l--;for(var c=0;c<l-1&&t[c].equals(t[c+1]);)c++;if(!(l<(s?3:2))){"bevel"===r&&(n=1.05);var u,p=this.overscaling<=16?122880/(512*this.overscaling):0,h=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray),d=void 0,f=void 0,m=void 0,g=void 0;this.e1=this.e2=-1,s&&(g=t[c].sub(u=t[l-2])._unit()._perp());for(var y=c;y<l;y++)if(!(f=y===l-1?s?t[c+1]:void 0:t[y+1])||!t[y].equals(f)){g&&(m=g),u&&(d=u),u=t[y],g=f?f.sub(u)._unit()._perp():m;var v=(m=m||g).add(g);0===v.x&&0===v.y||v._unit();var _=m.x*g.x+m.y*g.y,x=v.x*g.x+v.y*g.y,b=0!=x?1/x:1/0,w=2*Math.sqrt(2-2*x),S=x<cc&&d&&f,T=0<m.x*g.y-m.y*g.x;if(S&&c<y){var E=u.dist(d);if(2*p<E){var I=u.sub(u.sub(d)._mult(p/E)._round());this.updateDistance(d,I),this.addCurrentVertex(I,m,0,0,h),d=I}}var C=d&&f,A=C?r:s?"butt":i;if(C&&"round"===A&&(b<o?A="miter":b<=2&&(A="fakeround")),"miter"===A&&n<b&&(A="bevel"),"bevel"===A&&(2<b&&(A="flipbevel"),b<n&&(A="miter")),d&&this.updateDistance(d,u),"miter"===A)v._mult(b),this.addCurrentVertex(u,v,0,0,h);else if("flipbevel"===A){if(100<b)v=g.mult(-1);else{var k=b*m.add(g).mag()/m.sub(g).mag();v._perp()._mult(k*(T?-1:1))}this.addCurrentVertex(u,v,0,0,h),this.addCurrentVertex(u,v.mult(-1),0,0,h)}else if("bevel"===A||"fakeround"===A){var P=-Math.sqrt(b*b-1),O=T?P:0,M=T?0:P;if(d&&this.addCurrentVertex(u,m,O,M,h),"fakeround"===A)for(var L=Math.round(180*w/Math.PI/20),D=1;D<L;D++){var R=D/L;if(.5!==R){var z=R-.5;R+=R*z*(R-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*z*z+(.848013+_*(.215638*_-1.06021)))}var N=g.sub(m)._mult(R)._add(m)._unit()._mult(T?-1:1);this.addHalfVertex(u,N.x,N.y,!1,T,0,h)}f&&this.addCurrentVertex(u,g,-O,-M,h)}else if("butt"===A)this.addCurrentVertex(u,v,0,0,h);else if("square"===A){var B=d?1:-1;this.addCurrentVertex(u,v,B,B,h)}else"round"===A&&(d&&(this.addCurrentVertex(u,m,0,0,h),this.addCurrentVertex(u,m,1,1,h,!0)),f&&(this.addCurrentVertex(u,g,-1,-1,h,!0),this.addCurrentVertex(u,g,0,0,h)));if(S&&y<l-1){var F=u.dist(f);if(2*p<F){var j=u.add(f.sub(u)._mult(p/F)._round());this.updateDistance(u,j),this.addCurrentVertex(j,g,0,0,h),u=j}}}}},ac.prototype.addCurrentVertex=function(t,e,r,i,n,o){void 0===o&&(o=!1);var a=e.y*i-e.x,s=-e.y-e.x*i;this.addHalfVertex(t,e.x+e.y*r,e.y-e.x*r,o,!1,r,n),this.addHalfVertex(t,a,s,o,!0,-i,n),this.distance>uc/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,r,i,n,o))},ac.prototype.addHalfVertex=function(t,e,r,i,n,o,a){var s=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((t.x<<1)+(i?1:0),(t.y<<1)+(n?1:0),Math.round(63*e)+128,Math.round(63*r)+128,1+(0===o?0:o<0?-1:1)|(63&s)<<2,s>>6);var l=a.vertexLength++;0<=this.e1&&0<=this.e2&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),n?this.e2=l:this.e1=l},ac.prototype.updateScaledDistance=function(){this.scaledDistance=0<this.totalDistance?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(uc-1):this.distance},ac.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},Vi("LineBucket",ac,{omit:["layers","patternFeatures"]});var pc,hc=new Cn({"line-cap":new xn(Rt.layout_line["line-cap"]),"line-join":new bn(Rt.layout_line["line-join"]),"line-miter-limit":new xn(Rt.layout_line["line-miter-limit"]),"line-round-limit":new xn(Rt.layout_line["line-round-limit"]),"line-sort-key":new bn(Rt.layout_line["line-sort-key"])}),dc={paint:new Cn({"line-opacity":new bn(Rt.paint_line["line-opacity"]),"line-color":new bn(Rt.paint_line["line-color"]),"line-translate":new xn(Rt.paint_line["line-translate"]),"line-translate-anchor":new xn(Rt.paint_line["line-translate-anchor"]),"line-width":new bn(Rt.paint_line["line-width"]),"line-gap-width":new bn(Rt.paint_line["line-gap-width"]),"line-offset":new bn(Rt.paint_line["line-offset"]),"line-blur":new bn(Rt.paint_line["line-blur"]),"line-dasharray":new wn(Rt.paint_line["line-dasharray"]),"line-pattern":new Tn(Rt.paint_line["line-pattern"]),"line-gradient":new In(Rt.paint_line["line-gradient"])}),layout:hc},fc=(mc.__proto__=pc=bn,((mc.prototype=Object.create(pc&&pc.prototype)).constructor=mc).prototype.possiblyEvaluate=function(t,e){return e=new cn(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),pc.prototype.possiblyEvaluate.call(this,t,e)},mc.prototype.evaluate=function(t,e,r,i){return e=p({},e,{zoom:Math.floor(e.zoom)}),pc.prototype.evaluate.call(this,t,e,r,i)},new mc(dc.paint.properties["line-width"].specification));function mc(){pc.apply(this,arguments)}fc.useIntegerZoom=!0;var gc,yc=(vc.__proto__=gc=On,((vc.prototype=Object.create(gc&&gc.prototype)).constructor=vc).prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},vc.prototype._updateGradient=function(){this.gradient=Ws(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},vc.prototype.recalculate=function(t,e){gc.prototype.recalculate.call(this,t,e),this.paint._values["line-floorwidth"]=fc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},vc.prototype.createBucket=function(t){return new ac(t)},vc.prototype.queryRadius=function(t){var e=t,r=_c(bs("line-width",this,e),bs("line-gap-width",this,e)),i=bs("line-offset",this,e);return r/2+Math.abs(i)+ws(this.paint.get("line-translate"))},vc.prototype.queryIntersectsFeature=function(t,e,r,i,o,a,s){var l=Ss(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),c=s/2*_c(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),u=this.paint.get("line-offset").evaluate(e,r);return u&&(i=function(t,e){for(var r=[],i=new n(0,0),o=0;o<t.length;o++){for(var a=t[o],s=[],l=0;l<a.length;l++){var c=a[l],u=a[l+1],p=0===l?i:c.sub(a[l-1])._unit()._perp(),h=l===a.length-1?i:u.sub(c)._unit()._perp(),d=p._add(h)._unit();d._mult(1/(d.x*h.x+d.y*h.y)),s.push(d._mult(e)._add(c))}r.push(s)}return r}(i,u*s)),function(t,e,r){for(var i=0;i<e.length;i++){var n=e[i];if(3<=t.length)for(var o=0;o<n.length;o++)if(_s(t,n[o]))return!0;if(fs(t,n,r))return!0}return!1}(l,i,c)},vc.prototype.isTileClipped=function(){return!0},vc);function vc(t){gc.call(this,t,dc)}function _c(t,e){return 0<e?e+2*t:t}var xc=Dn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),bc=Dn([{name:"a_projected_pos",components:3,type:"Float32"}],4),wc=(Dn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Dn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Sc=(Dn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Dn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Tc=Dn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ec(t,e,r){return t.sections.forEach((function(t){var i,n,o;t.text=(i=t.text,n=r,"uppercase"===(o=e.layout.get("text-transform").evaluate(n,{}))?i=i.toLocaleUpperCase():"lowercase"===o&&(i=i.toLocaleLowerCase()),pn.applyArabicShaping&&(i=pn.applyArabicShaping(i)),i)})),t}function Ic(t,e,r,i,n){var o,a,s=8*n-i-1,l=(1<<s)-1,c=l>>1,u=-7,p=r?n-1:0,h=r?-1:1,d=t[e+p];for(p+=h,o=d&(1<<-u)-1,d>>=-u,u+=s;0<u;o=256*o+t[e+p],p+=h,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;0<u;a=256*a+t[e+p],p+=h,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,i),o-=c}return(d?-1:1)*a*Math.pow(2,o-i)}function Cc(t,e,r,i,n,o){var a,s,l,c=8*o-n-1,u=(1<<c)-1,p=u>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(e+=1<=a+p?h/l:h*Math.pow(2,1-p))*l&&(a++,l/=2),u<=a+p?(s=0,a=u):1<=a+p?(s=(e*l-1)*Math.pow(2,n),a+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,n),a=0));8<=n;t[r+d]=255&s,d+=f,s/=256,n-=8);for(a=a<<n|s,c+=n;0<c;t[r+d]=255&a,d+=f,a/=256,c-=8);t[r+d-f]|=128*m}Dn([{name:"triangle",components:3,type:"Uint16"}]),Dn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Dn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Dn([{type:"Float32",name:"offsetX"}]),Dn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ac={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},kc=Pc;function Pc(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Pc.Varint=0,Pc.Fixed64=1,Pc.Bytes=2,Pc.Fixed32=5;var Oc="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Mc(t){return t.type===Pc.Bytes?t.readVarint()+t.pos:t.pos+1}function Lc(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Dc(t,e,r){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(i);for(var n=r.pos-1;t<=n;n--)r.buf[n+i]=r.buf[n]}function Rc(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function zc(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function Nc(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function Bc(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function Fc(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function jc(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function Uc(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function Vc(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function qc(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function Gc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Zc(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function Hc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Wc(t,e,r){1===t&&r.readMessage(Kc,e)}function Kc(t,e,r){if(3===t){var i=r.readMessage(Xc,{}),n=i.width,o=i.height,a=i.left,s=i.top,l=i.advance;e.push({id:i.id,bitmap:new Gs({width:n+6,height:o+6},i.bitmap),metrics:{width:n,height:o,left:a,top:s,advance:l}})}}function Xc(t,e,r){1===t?e.id=r.readVarint():2===t?e.bitmap=r.readBytes():3===t?e.width=r.readVarint():4===t?e.height=r.readVarint():5===t?e.left=r.readSVarint():6===t?e.top=r.readSVarint():7===t&&(e.advance=r.readVarint())}function Yc(t){for(var e=0,r=0,i=0,n=t;i<n.length;i+=1){var o=n[i];e+=o.w*o.h,r=Math.max(r,o.w)}t.sort((function(t,e){return e.h-t.h}));for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],s=0,l=0,c=0,u=t;c<u.length;c+=1)for(var p=u[c],h=a.length-1;0<=h;h--){var d=a[h];if(!(p.w>d.w||p.h>d.h)){if(p.x=d.x,p.y=d.y,l=Math.max(l,p.y+p.h),s=Math.max(s,p.x+p.w),p.w===d.w&&p.h===d.h){var f=a.pop();h<a.length&&(a[h]=f)}else p.h===d.h?(d.x+=p.w,d.w-=p.w):(p.w===d.w||a.push({x:d.x+p.w,y:d.y,w:d.w-p.w,h:p.h}),d.y+=p.h,d.h-=p.h);break}}return{w:s,h:l,fill:e/(s*l)||0}}function Jc(t,e){var r=e.pixelRatio,i=e.version,n=e.stretchX,o=e.stretchY,a=e.content;this.paddedRect=t,this.pixelRatio=r,this.stretchX=n,this.stretchY=o,this.content=a,this.version=i}Pc.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,o=this.pos;this.type=7&i,t(n,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Gc(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Hc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Gc(this.buf,this.pos)+4294967296*Gc(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Gc(this.buf,this.pos)+4294967296*Hc(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Ic(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ic(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,i=this.buf;return e=127&(r=i[this.pos++]),r<128?e:(e|=(127&(r=i[this.pos++]))<<7,r<128?e:(e|=(127&(r=i[this.pos++]))<<14,r<128?e:(e|=(127&(r=i[this.pos++]))<<21,r<128?e:function(t,e,r){var i,n,o=r.buf;if(i=(112&(n=o[r.pos++]))>>4,n<128)return Lc(t,i,e);if(i|=(127&(n=o[r.pos++]))<<3,n<128)return Lc(t,i,e);if(i|=(127&(n=o[r.pos++]))<<10,n<128)return Lc(t,i,e);if(i|=(127&(n=o[r.pos++]))<<17,n<128)return Lc(t,i,e);if(i|=(127&(n=o[r.pos++]))<<24,n<128)return Lc(t,i,e);if(i|=(1&(n=o[r.pos++]))<<31,n<128)return Lc(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t,e,r,i=this.readVarint()+this.pos,n=this.pos;return 12<=(this.pos=i)-n&&Oc?(t=this.buf,e=n,r=i,Oc.decode(t.subarray(e,r))):function(t,e){for(var r="",i=n;i<e;){var o,a,s,l=t[i],c=null,u=239<l?4:223<l?3:191<l?2:1;if(e<i+u)break;1===u?l<128&&(c=l):2===u?128==(192&(o=t[i+1]))&&(c=(31&l)<<6|63&o)<=127&&(c=null):3===u?(a=t[i+2],128==(192&(o=t[i+1]))&&128==(192&a)&&((c=(15&l)<<12|(63&o)<<6|63&a)<=2047||55296<=c&&c<=57343)&&(c=null)):4===u&&(a=t[i+2],s=t[i+3],128==(192&(o=t[i+1]))&&128==(192&a)&&128==(192&s)&&((c=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||1114112<=c)&&(c=null)),null===c?(c=65533,u=1):65535<c&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=u}return r}(this.buf,i)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Pc.Bytes)return t.push(this.readVarint(e));var r=Mc(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Pc.Bytes)return t.push(this.readSVarint());var e=Mc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Pc.Bytes)return t.push(this.readBoolean());var e=Mc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Pc.Bytes)return t.push(this.readFloat());var e=Mc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Pc.Bytes)return t.push(this.readDouble());var e=Mc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Pc.Bytes)return t.push(this.readFixed32());var e=Mc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Pc.Bytes)return t.push(this.readSFixed32());var e=Mc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Pc.Bytes)return t.push(this.readFixed64());var e=Mc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Pc.Bytes)return t.push(this.readSFixed64());var e=Mc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Pc.Varint)for(;127<this.buf[this.pos++];);else if(e===Pc.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Pc.Fixed32)this.pos+=4;else{if(e!==Pc.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Zc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Zc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Zc(this.buf,-1&t,this.pos),Zc(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Zc(this.buf,-1&t,this.pos),Zc(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){268435455<(t=+t||0)||t<0?function(e){var r,i,n,o,a,s,l;if(0<=t?(r=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:i=i+1|(r=0)),0x10000000000000000<=t||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),s=r,(l=e).buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos++]=127&s|128,l.buf[l.pos]=127&(s>>>=7),a=(7&(n=i))<<4,(o=e).buf[o.pos++]|=a|((n>>>=3)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n)))))}(this):(this.realloc(4),this.buf[this.pos++]=127&t|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var i,n,o=0;o<e.length;o++){if(55295<(i=e.charCodeAt(o))&&i<57344){if(!n){56319<i||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):n=i;continue}if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,n=i;continue}i=n-55296<<10|i-56320|65536,n=null}else n&&(t[r++]=239,t[r++]=191,t[r++]=189,n=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=63&i|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;128<=r&&Dc(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),Cc(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Cc(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r;128<=i&&Dc(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,Pc.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Rc,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,zc,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Fc,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Nc,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Bc,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,jc,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Uc,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Vc,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,qc,e)},writeBytesField:function(t,e){this.writeTag(t,Pc.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Pc.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Pc.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Pc.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Pc.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Pc.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Pc.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Pc.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Pc.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Pc.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var $c={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};function Qc(t,e){var r={},i={};this.haveRenderCallbacks=[];var n=[];this.addImages(t,r,n),this.addImages(e,i,n);var o=Yc(n),a=new Zs({width:o.w||1,height:o.h||1});for(var s in t){var l=t[s],c=r[s].paddedRect;Zs.copy(l.data,a,{x:0,y:0},{x:c.x+1,y:c.y+1},l.data)}for(var u in e){var p=e[u],h=i[u].paddedRect,d=h.x+1,f=h.y+1,m=p.data.width,g=p.data.height;Zs.copy(p.data,a,{x:0,y:0},{x:d,y:f},p.data),Zs.copy(p.data,a,{x:0,y:g-1},{x:d,y:f-1},{width:m,height:1}),Zs.copy(p.data,a,{x:0,y:0},{x:d,y:f+g},{width:m,height:1}),Zs.copy(p.data,a,{x:m-1,y:0},{x:d-1,y:f},{width:1,height:g}),Zs.copy(p.data,a,{x:0,y:0},{x:d+m,y:f},{width:1,height:g})}this.image=a,this.iconPositions=r,this.patternPositions=i}function tu(){this.scale=1,this.fontStack="",this.imageName=null}$c.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},$c.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},$c.tlbr.get=function(){return this.tl.concat(this.br)},$c.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Jc.prototype,$c),Qc.prototype.addImages=function(t,e,r){for(var i in t){var n=t[i],o={x:0,y:0,w:n.data.width+2,h:n.data.height+2};r.push(o),e[i]=new Jc(o,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(i)}},Qc.prototype.patchUpdatedImages=function(t,e){for(var r in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[r],t.getImage(r),e),this.patchUpdatedImage(this.patternPositions[r],t.getImage(r),e)},Qc.prototype.patchUpdatedImage=function(t,e,r){if(t&&e&&t.version!==e.version){t.version=e.version;var i=t.tl;r.update(e.data,void 0,{x:i[0],y:i[1]})}},Vi("ImagePosition",Jc),Vi("ImageAtlas",Qc);var eu={horizontal:1,vertical:2,horizontalOnly:3};function ru(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}function iu(t,e,r,i,n,o,a,s,l,c,u,p,h,d,f,m){var g,y=ru.fromFeature(t,n);p===eu.vertical&&y.verticalizePunctuation();var v=pn.processBidirectionalText,_=pn.processStyledBidirectionalText;if(v&&1===y.sections.length){g=[];for(var x=0,b=v(y.toString(),cu(y,c,o,e,i,d,f));x<b.length;x+=1){var w=b[x],S=new ru;S.text=w,S.sections=y.sections;for(var T=0;T<w.length;T++)S.sectionIndex.push(0);g.push(S)}}else if(_){g=[];for(var E=0,I=_(y.text,y.sectionIndex,cu(y,c,o,e,i,d,f));E<I.length;E+=1){var C=I[E],A=new ru;A.text=C[0],A.sectionIndex=C[1],A.sections=y.sections,g.push(A)}}else g=function(t,e){for(var r=[],i=t.text,n=0,o=0,a=e;o<a.length;o+=1){var s=a[o];r.push(t.substring(n,s)),n=s}return n<i.length&&r.push(t.substring(n,i.length)),r}(y,cu(y,c,o,e,i,d,f));var k=[],P={positionedLines:k,text:y.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:p,iconsInText:!1,verticalizable:!1};return function(t,e,r,i,n,o,a,s,c,u,p){for(var h=0,d=-17,f=0,m=0,g="right"===l?1:"left"===l?0:.5,y=0,v=0,_=n;v<_.length;v+=1){var x=_[v];x.trim();var b=x.getMaxScale(),w=24*(b-1),S={positionedGlyphs:[],lineOffset:0},T=(t.positionedLines[y]=S).positionedGlyphs,E=0;if(x.length()){for(var I=0;I<x.length();I++){var C=x.getSection(I),A=x.getSectionIndex(I),k=x.getCharCode(I),P=0,O=null,M=null,L=null,D=24,R=!(s===eu.horizontal||!u&&!Ji(k)||u&&(nu[k]||(G=k,Xi.Arabic(G)||Xi["Arabic Supplement"](G)||Xi["Arabic Extended-A"](G)||Xi["Arabic Presentation Forms-A"](G)||Xi["Arabic Presentation Forms-B"](G))));if(C.imageName){var z=i[C.imageName];if(!z)continue;L=C.imageName,t.iconsInText=t.iconsInText||!0,M=z.paddedRect;var N=z.displaySize;C.scale=24*C.scale/p,P=w+(24-N[1]*C.scale),D=(O={width:N[0],height:N[1],left:1,top:-3,advance:R?N[1]:N[0]}).advance;var B=R?N[0]*C.scale-24*b:N[1]*C.scale-24*b;0<B&&E<B&&(E=B)}else{var F=r[C.fontStack],j=F&&F[k];if(j&&j.rect)M=j.rect,O=j.metrics;else{var U=e[C.fontStack],V=U&&U[k];if(!V)continue;O=V.metrics}P=24*(b-C.scale)}R?(t.verticalizable=!0,T.push({glyph:k,imageName:L,x:h,y:d+P,vertical:R,scale:C.scale,fontStack:C.fontStack,sectionIndex:A,metrics:O,rect:M}),h+=D*C.scale+c):(T.push({glyph:k,imageName:L,x:h,y:d+P,vertical:R,scale:C.scale,fontStack:C.fontStack,sectionIndex:A,metrics:O,rect:M}),h+=O.advance*C.scale+c)}0!==T.length&&(f=Math.max(h-c,f),pu(T,0,T.length-1,g,E)),h=0;var q=o*b+E;S.lineOffset=Math.max(E,w),d+=q,m=Math.max(q,m),++y}else d+=o,++y}var G,Z=d- -17,H=uu(a),W=H.horizontalAlign,K=H.verticalAlign;(function(t,e,r,i,n,a,s){var l,c=(e-r)*i;l=n!==o?-a*K+17:(-K*s+.5)*o;for(var u=0,p=t;u<p.length;u+=1)for(var h=0,d=p[u].positionedGlyphs;h<d.length;h+=1){var f=d[h];f.x+=c,f.y+=l}})(t.positionedLines,g,W,f,m,Z,n.length),t.top+=-K*Z,t.bottom=t.top+Z,t.left+=-W*f,t.right=t.left+f}(P,e,r,i,g,a,s,p,c,h,m),!function(){for(var t=0,e=k;t<e.length;t+=1)if(0!==e[t].positionedGlyphs.length)return;return 1}()&&P}tu.forText=function(t,e){var r=new tu;return r.scale=t||1,r.fontStack=e,r},tu.forImage=function(t){var e=new tu;return e.imageName=t,e},ru.fromFeature=function(t,e){for(var r=new ru,i=0;i<t.sections.length;i++){var n=t.sections[i];n.image?r.addImageSection(n):r.addTextSection(n,e)}return r},ru.prototype.length=function(){return this.text.length},ru.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},ru.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},ru.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},ru.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",r=0;r<t.length;r++){var i=t.charCodeAt(r+1)||null,n=t.charCodeAt(r-1)||null;e+=i&&$i(i)&&!Ac[t[r+1]]||n&&$i(n)&&!Ac[t[r-1]]||!Ac[t[r]]?t[r]:Ac[t[r]]}return e}(this.text)},ru.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&nu[this.text.charCodeAt(e)];e++)t++;for(var r=this.text.length,i=this.text.length-1;0<=i&&t<=i&&nu[this.text.charCodeAt(i)];i--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)},ru.prototype.substring=function(t,e){var r=new ru;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r},ru.prototype.toString=function(){return this.text},ru.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce((function(e,r){return Math.max(e,t.sections[r].scale)}),0)},ru.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(tu.forText(t.scale,t.fontStack||e));for(var r=this.sections.length-1,i=0;i<t.text.length;++i)this.sectionIndex.push(r)},ru.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(tu.forImage(e)),this.sectionIndex.push(this.sections.length-1)):w("Reached maximum number of images 6401")}else w("Can't add FormattedSection with an empty image.")},ru.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?63743<=this.imageSectionID?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var nu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ou={};function au(t,e,r,i,n,o){if(e.imageName){var a=i[e.imageName];return a?a.displaySize[0]*e.scale*24/o+n:0}var s=r[e.fontStack],l=s&&s[t];return l?l.metrics.advance*e.scale+n:0}function su(t,e,r,i){var n=Math.pow(t-e,2);return i?t<e?n/2:2*n:n+Math.abs(r)*r}function lu(t,e,r,i,n,o){for(var a=null,s=su(e,r,n,o),l=0,c=i;l<c.length;l+=1){var u=c[l],p=su(e-u.x,r,n,o)+u.badness;p<=s&&(a=u,s=p)}return{index:t,x:e,priorBreak:a,badness:s}}function cu(t,e,r,i,n,o,a){if("point"!==o)return[];if(!t)return[];for(var s,l=[],c=function(t,e,r,i,n,o){for(var a=0,s=0;s<t.length();s++){var l=t.getSection(s);a+=au(t.getCharCode(s),l,i,n,e,o)}return a/Math.max(1,Math.ceil(a/r))}(t,e,r,i,n,a),u=0<=t.text.indexOf("​"),p=0,h=0;h<t.length();h++){var d=t.getSection(h),f=t.getCharCode(h);if(nu[f]||(p+=au(f,d,i,n,e,a)),h<t.length()-1){var m=!((s=f)<11904||!(Xi["Bopomofo Extended"](s)||Xi.Bopomofo(s)||Xi["CJK Compatibility Forms"](s)||Xi["CJK Compatibility Ideographs"](s)||Xi["CJK Compatibility"](s)||Xi["CJK Radicals Supplement"](s)||Xi["CJK Strokes"](s)||Xi["CJK Symbols and Punctuation"](s)||Xi["CJK Unified Ideographs Extension A"](s)||Xi["CJK Unified Ideographs"](s)||Xi["Enclosed CJK Letters and Months"](s)||Xi["Halfwidth and Fullwidth Forms"](s)||Xi.Hiragana(s)||Xi["Ideographic Description Characters"](s)||Xi["Kangxi Radicals"](s)||Xi["Katakana Phonetic Extensions"](s)||Xi.Katakana(s)||Xi["Vertical Forms"](s)||Xi["Yi Radicals"](s)||Xi["Yi Syllables"](s)));(ou[f]||m||d.imageName)&&l.push(lu(h+1,p,c,l,(g=f,y=t.getCharCode(h+1),v=void 0,v=0,10===g&&(v-=1e4),m&&u&&(v+=150),40!==g&&65288!==g||(v+=50),41!==y&&65289!==y||(v+=50),v),!1))}}var g,y,v;return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(lu(t.length(),p,c,l,0,!0))}function uu(t){var e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function pu(t,e,r,i,n){if(i||n)for(var o=t[r],a=(t[r].x+o.metrics.advance*o.scale)*i,s=e;s<=r;s++)t[s].x-=a,t[s].y+=n}function hu(t,e,r,i,n,o){var a,s=t.image;if(s.content){var l=s.content,c=s.pixelRatio||1;a=[l[0]/c,l[1]/c,s.displaySize[0]-l[2]/c,s.displaySize[1]-l[3]/c]}var u,p,h,d,f=e.left*o,m=e.right*o;p="width"===r||"both"===r?(d=n[0]+f-i[3],n[0]+m+i[1]):(d=n[0]+(f+m-s.displaySize[0])/2)+s.displaySize[0];var g=e.top*o,y=e.bottom*o;return h="height"===r||"both"===r?(u=n[1]+g-i[0],n[1]+y+i[2]):(u=n[1]+(g+y-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:u,right:p,bottom:h,left:d,collisionPadding:a}}ou[10]=!0,ou[32]=!0,ou[38]=!0,ou[40]=!0,ou[41]=!0,ou[43]=!0,ou[45]=!0,ou[47]=!0,ou[173]=!0,ou[183]=!0,ou[8203]=!0,ou[8208]=!0,ou[8211]=!0,ou[8231]=!0;var du,fu=((du=n)&&(mu.__proto__=du),((mu.prototype=Object.create(du&&du.prototype)).constructor=mu).prototype.clone=function(){return new mu(this.x,this.y,this.angle,this.segment)},mu);function mu(t,e,r,i){du.call(this,t,e),this.angle=r,void 0!==i&&(this.segment=i)}function gu(t,e){var r=e.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new cn(t+1))};if("source"===r.kind)return{kind:"source"};for(var i=r.zoomStops,n=r.interpolationType,o=0;o<i.length&&i[o]<=t;)o++;for(var a=o=Math.max(0,o-1);a<i.length&&i[a]<t+1;)a++;a=Math.min(i.length-1,a);var s=i[o],l=i[a];return"composite"===r.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:n}:{kind:"camera",minZoom:s,maxZoom:l,minSize:r.evaluate(new cn(s)),maxSize:r.evaluate(new cn(l)),interpolationType:n}}function yu(t,e,r){var i=e.uSize,n=r.lowerSize;return"source"===t.kind?n/128:"composite"===t.kind?Ye(n/128,r.upperSize/128,e.uSizeT):i}function vu(t,e){var r=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){var n=t.interpolationType,o=n?c(ur.interpolationFactor(n,e,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?i=Ye(t.minSize,t.maxSize,o):r=o}return{uSizeT:r,uSize:i}}Vi("Anchor",fu);var _u=Object.freeze({__proto__:null,getSizeData:gu,evaluateSizeForFeature:yu,evaluateSizeForZoom:vu,SIZE_PACK_FACTOR:128});function xu(t,e,r,i,n){if(void 0===e.segment)return 1;for(var o=e,a=e.segment+1,s=0;-r/2<s;){if(--a<0)return;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],c=0;s<r/2;){var u=t[a],p=t[a+1];if(!p)return;var h=t[a-1].angleTo(u)-u.angleTo(p);for(h=Math.abs((h+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:h}),c+=h;s-l[0].distance>i;)c-=l.shift().angleDelta;if(n<c)return;a++,s+=u.dist(p)}return 1}function bu(t){for(var e=0,r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function wu(t,e,r){return t?.6*e*r:0}function Su(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Tu(t,e,r,i,n,o){for(var a=wu(r,n,o),s=Su(r,i)*o,l=0,c=bu(t)/2,u=0;u<t.length-1;u++){var p=t[u],h=t[u+1],d=p.dist(h);if(c<l+d){var f=(c-l)/d,m=Ye(p.x,h.x,f),g=Ye(p.y,h.y,f),y=new fu(m,g,h.angleTo(p),u);return y._round(),!a||xu(t,y,s,a,e)?y:void 0}l+=d}}function Eu(t,e,r,i,o){for(var a=[],s=0;s<t.length;s++)for(var l=t[s],c=void 0,u=0;u<l.length-1;u++){var p=l[u],h=l[u+1];p.x<e&&h.x<e||(p.x<e?p=new n(e,p.y+(e-p.x)/(h.x-p.x)*(h.y-p.y))._round():h.x<e&&(h=new n(e,p.y+(e-p.x)/(h.x-p.x)*(h.y-p.y))._round()),p.y<r&&h.y<r||(p.y<r?p=new n(p.x+(r-p.y)/(h.y-p.y)*(h.x-p.x),r)._round():h.y<r&&(h=new n(p.x+(r-p.y)/(h.y-p.y)*(h.x-p.x),r)._round()),p.x>=i&&h.x>=i||(p.x>=i?p=new n(i,p.y+(i-p.x)/(h.x-p.x)*(h.y-p.y))._round():h.x>=i&&(h=new n(i,p.y+(i-p.x)/(h.x-p.x)*(h.y-p.y))._round()),p.y>=o&&h.y>=o||(p.y>=o?p=new n(p.x+(o-p.y)/(h.y-p.y)*(h.x-p.x),o)._round():h.y>=o&&(h=new n(p.x+(o-p.y)/(h.y-p.y)*(h.x-p.x),o)._round()),c&&p.equals(c[c.length-1])||a.push(c=[p]),c.push(h)))))}return a}function Iu(t,e,r,i){function o(t,e){return t+e[1]-e[0]}var a=[],s=t.image,l=s.pixelRatio,c=s.paddedRect.w-2,u=s.paddedRect.h-2,p=t.right-t.left,h=t.bottom-t.top,d=s.stretchX||[[0,c]],f=s.stretchY||[[0,u]],m=d.reduce(o,0),g=f.reduce(o,0),y=c-m,v=u-g,_=0,x=m,b=0,w=g,S=0,T=y,E=0,I=v;if(s.content&&i){var C=s.content;_=Cu(d,0,C[0]),b=Cu(f,0,C[1]),x=Cu(d,C[0],C[2]),w=Cu(f,C[1],C[3]),S=C[0]-_,E=C[1]-b,T=C[2]-C[0]-x,I=C[3]-C[1]-w}function A(i,o,a,c){var u=ku(i.stretch-_,x,p,t.left),d=Pu(i.fixed-S,T,i.stretch,m),f=ku(o.stretch-b,w,h,t.top),y=Pu(o.fixed-E,I,o.stretch,g),v=ku(a.stretch-_,x,p,t.left),C=Pu(a.fixed-S,T,a.stretch,m),A=ku(c.stretch-b,w,h,t.top),k=Pu(c.fixed-E,I,c.stretch,g),P=new n(u,f),O=new n(v,f),M=new n(v,A),L=new n(u,A),D=new n(d/l,y/l),R=new n(C/l,k/l),z=e*Math.PI/180;if(z){var N=Math.sin(z),B=Math.cos(z),F=[B,-N,N,B];P._matMult(F),O._matMult(F),L._matMult(F),M._matMult(F)}var j=i.stretch+i.fixed,U=o.stretch+o.fixed;return{tl:P,tr:O,bl:L,br:M,tex:{x:s.paddedRect.x+1+j,y:s.paddedRect.y+1+U,w:a.stretch+a.fixed-j,h:c.stretch+c.fixed-U},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:D,pixelOffsetBR:R,minFontScaleX:T/l/p,minFontScaleY:I/l/h,isSDF:r}}if(i&&(s.stretchX||s.stretchY))for(var k=Au(d,y,m),P=Au(f,v,g),O=0;O<k.length-1;O++)for(var M=k[O],L=k[O+1],D=0;D<P.length-1;D++)a.push(A(M,P[D],L,P[D+1]));else a.push(A({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:1+c},{fixed:0,stretch:1+u}));return a}function Cu(t,e,r){for(var i=0,n=0,o=t;n<o.length;n+=1){var a=o[n];i+=Math.max(e,Math.min(r,a[1]))-Math.max(e,Math.min(r,a[0]))}return i}function Au(t,e,r){for(var i=[{fixed:-1,stretch:0}],n=0,o=t;n<o.length;n+=1){var a=o[n],s=a[0],l=a[1],c=i[i.length-1];i.push({fixed:s-c.stretch,stretch:c.stretch}),i.push({fixed:s-c.stretch,stretch:c.stretch+(l-s)})}return i.push({fixed:e+1,stretch:r}),i}function ku(t,e,r,i){return t/e*r+i}function Pu(t,e,r,i){return t-e*r/i}function Ou(t,e,r,i,o,a,s,l,c,u){if(this.boxStartIndex=t.length,c){var p=a.top,h=a.bottom,d=a.collisionPadding;d&&(p-=d[1],h+=d[3]);var f=h-p;0<f&&(f=Math.max(10,f),this.circleDiameter=f)}else{var m=a.top*s-l,g=a.bottom*s+l,y=a.left*s-l,v=a.right*s+l,_=a.collisionPadding;if(_&&(y-=_[0]*s,m-=_[1]*s,v+=_[2]*s,g+=_[3]*s),u){var x=new n(y,m),b=new n(v,m),w=new n(y,g),S=new n(v,g),T=u*Math.PI/180;x._rotate(T),b._rotate(T),w._rotate(T),S._rotate(T),y=Math.min(x.x,b.x,w.x,S.x),v=Math.max(x.x,b.x,w.x,S.x),m=Math.min(x.y,b.y,w.y,S.y),g=Math.max(x.y,b.y,w.y,S.y)}t.emplaceBack(e.x,e.y,y,m,v,g,r,i,o)}this.boxEndIndex=t.length}var Mu=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=Lu),this.data=t,this.length=this.data.length,this.compare=e,0<this.length)for(var r=(this.length>>1)-1;0<=r;r--)this._down(r)};function Lu(t,e){return t<e?-1:e<t?1:0}function Du(t,e,r){void 0===e&&(e=1),void 0===r&&(r=!1);for(var i=1/0,o=1/0,a=-1/0,s=-1/0,l=t[0],c=0;c<l.length;c++){var u=l[c];(!c||u.x<i)&&(i=u.x),(!c||u.y<o)&&(o=u.y),(!c||u.x>a)&&(a=u.x),(!c||u.y>s)&&(s=u.y)}var p=Math.min(a-i,s-o),h=p/2,d=new Mu([],Ru);if(0===p)return new n(i,o);for(var f=i;f<a;f+=p)for(var m=o;m<s;m+=p)d.push(new zu(f+h,m+h,h,t));for(var g=function(t){for(var e=0,r=0,i=0,n=t[0],o=0,a=n.length,s=a-1;o<a;s=o++){var l=n[o],c=n[s],u=l.x*c.y-c.x*l.y;r+=(l.x+c.x)*u,i+=(l.y+c.y)*u,e+=3*u}return new zu(r/e,i/e,0,t)}(t),y=d.length;d.length;){var v=d.pop();(v.d>g.d||!g.d)&&(g=v,r&&console.log("found best %d after %d probes",Math.round(1e4*v.d)/1e4,y)),v.max-g.d<=e||(d.push(new zu(v.p.x-(h=v.h/2),v.p.y-h,h,t)),d.push(new zu(v.p.x+h,v.p.y-h,h,t)),d.push(new zu(v.p.x-h,v.p.y+h,h,t)),d.push(new zu(v.p.x+h,v.p.y+h,h,t)),y+=4)}return r&&(console.log("num probes: "+y),console.log("best distance: "+g.d)),g.p}function Ru(t,e){return e.max-t.max}function zu(t,e,r,i){this.p=new n(t,e),this.h=r,this.d=function(t,e){for(var r=!1,i=1/0,n=0;n<e.length;n++)for(var o=e[n],a=0,s=o.length,l=s-1;a<s;l=a++){var c=o[a],u=o[l];c.y>t.y!=u.y>t.y&&t.x<(u.x-c.x)*(t.y-c.y)/(u.y-c.y)+c.x&&(r=!r),i=Math.min(i,ys(t,c,u))}return(r?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}Mu.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Mu.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,0<this.length&&(this.data[0]=e,this._down(0)),t}},Mu.prototype.peek=function(){return this.data[0]},Mu.prototype._up=function(t){for(var e=this.data,r=this.compare,i=e[t];0<t;){var n=t-1>>1,o=e[n];if(0<=r(i,o))break;e[t]=o,t=n}e[t]=i},Mu.prototype._down=function(t){for(var e=this.data,r=this.compare,i=this.length>>1,n=e[t];t<i;){var o=1+(t<<1),a=e[o],s=o+1;if(s<this.length&&r(e[s],a)<0&&(a=e[o=s]),0<=r(a,n))break;e[t]=a,t=o}e[t]=n};var Nu=Number.POSITIVE_INFINITY;function Bu(t,e){return e[1]!==Nu?function(t,e,r){var i=0,n=0;switch(e=Math.abs(e),r=Math.abs(r),t){case"top-right":case"top-left":case"top":n=r-7;break;case"bottom-right":case"bottom-left":case"bottom":n=7-r}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}return[i,n]}(t,e[0],e[1]):function(t,e){var r=0,i=0;e<0&&(e=0);var n=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":i=n-7;break;case"bottom-right":case"bottom-left":i=7-n;break;case"bottom":i=7-e;break;case"top":i=e-7}switch(t){case"top-right":case"bottom-right":r=-n;break;case"top-left":case"bottom-left":r=n;break;case"left":r=e;break;case"right":r=-e}return[r,i]}(t,e[0])}function Fu(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ju(t,e,r,i,o,a,s,l,c,u,p,h,d,f,m){var g=function(t,e,r,i,o,a,s){for(var l=r.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,c=[],u=0,p=t.positionedLines;u<p.length;u+=1)for(var h=p[u],d=0,f=h.positionedGlyphs;d<f.length;d+=1){var m=f[d];if(m.rect){var g=m.rect||{},y=4,v=!0,_=1,x=0,b=(i||s)&&m.vertical,w=m.metrics.advance*m.scale/2;if(s&&t.verticalizable&&(x=h.lineOffset/2-(m.imageName?-(24-m.metrics.width*m.scale)/2:24*(m.scale-1))),m.imageName){var S=a[m.imageName];v=S.sdf,y=1/(_=S.pixelRatio)}var T=i?[m.x+w,m.y]:[0,0],E=i?[0,0]:[m.x+w+e[0],m.y+e[1]-x],I=[0,0];b&&(I=E,E=[0,0]);var C=(m.metrics.left-y)*m.scale-w+E[0],A=(-m.metrics.top-y)*m.scale+E[1],k=C+g.w*m.scale/_,P=A+g.h*m.scale/_,O=new n(C,A),M=new n(k,A),L=new n(C,P),D=new n(k,P);if(b){var R=new n(-w,17+w),z=-Math.PI/2,N=12-w,B=new n(22-N,-(m.imageName?N:0)),F=new(Function.prototype.bind.apply(n,[null].concat(I)));O._rotateAround(z,R)._add(B)._add(F),M._rotateAround(z,R)._add(B)._add(F),L._rotateAround(z,R)._add(B)._add(F),D._rotateAround(z,R)._add(B)._add(F)}if(l){var j=Math.sin(l),U=Math.cos(l),V=[U,-j,j,U];O._matMult(V),M._matMult(V),L._matMult(V),D._matMult(V)}var q=new n(0,0),G=new n(0,0);c.push({tl:O,tr:M,bl:L,br:D,tex:g,writingMode:t.writingMode,glyphOffset:T,sectionIndex:m.sectionIndex,isSDF:v,pixelOffsetTL:q,pixelOffsetBR:G,minFontScaleX:0,minFontScaleY:0})}}return c}(r,l,o,a,s,i,t.allowVerticalPlacement),y=t.textSizeData,v=null;"source"===y.kind?32640<(v=[128*o.layout.get("text-size").evaluate(s,{})])[0]&&w(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===y.kind&&(32640<(v=[128*f.compositeTextSizes[0].evaluate(s,{},m),128*f.compositeTextSizes[1].evaluate(s,{},m)])[0]||32640<v[1])&&w(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,g,v,l,a,s,u,e,c.lineStartIndex,c.lineLength,d,m);for(var _=0,x=p;_<x.length;_+=1)h[x[_]]=t.text.placedSymbolArray.length-1;return 4*g.length}function Uu(t){for(var e in t)return t[e];return null}function Vu(t,e,r,i){var n=t.compareText;if(e in n){for(var o=n[e],a=o.length-1;0<=a;a--)if(i.dist(o[a])<r)return 1}else n[e]=[];return n[e].push(i),0}var qu=Xl.VectorTileFeature.types,Gu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Zu(t,e,r,i,n,o,a,s,l,c,u,p,h){var d=s?Math.min(32640,Math.round(s[0])):0,f=s?Math.min(32640,Math.round(s[1])):0;t.emplaceBack(e,r,Math.round(32*i),Math.round(32*n),o,a,(d<<1)+(l?1:0),f,16*c,16*u,256*p,256*h)}function Hu(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function Wu(t){for(var e=0,r=t.sections;e<r.length;e+=1)if(tn(r[e].text))return 1}function Ku(t){this.layoutVertexArray=new $n,this.indexArray=new xo,this.programConfigurations=t,this.segments=new ya,this.dynamicLayoutVertexArray=new eo,this.opacityVertexArray=new no,this.placedSymbolArray=new ea}function Xu(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new ya,this.collisionVertexArray=new yo}function Yu(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Cs([]),this.placementViewportMatrix=Cs([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=gu(this.zoom,e["text-size"]),this.iconSizeData=gu(this.zoom,e["icon-size"]);var r=this.layers[0].layout,i=r.get("symbol-sort-key"),n=r.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==n&&void 0!==i.constantOr(1),this.sortFeaturesByY=("viewport-y"===n||"auto"===n&&!this.sortFeaturesByKey)&&(r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")),"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map((function(t){return eu[t]}))),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id})),this.sourceID=t.sourceID}function Ju(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Zt,this.defaultValue=t}Ku.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Ku.prototype.upload=function(t,e,r,i){this.isEmpty()||(r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,bc.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Gu,!0),this.opacityVertexBuffer.itemSize=1),(r||i)&&this.programConfigurations.upload(t))},Ku.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Vi("SymbolBuffers",Ku),Xu.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,wc.members,!0)},Xu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Vi("CollisionBuffers",Xu),Yu.prototype.createArrays=function(){this.text=new Ku(new os(this.layers,this.zoom,(function(t){return/^text/.test(t)}))),this.icon=new Ku(new os(this.layers,this.zoom,(function(t){return/^icon/.test(t)}))),this.glyphOffsetArray=new la,this.lineVertexArray=new pa,this.symbolInstances=new oa},Yu.prototype.calculateGlyphDependencies=function(t,e,r,i,n){for(var o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(r||i)&&n){var a=Ac[t.charAt(o)];a&&(e[a.charCodeAt(0)]=!0)}},Yu.prototype.populate=function(t,e,r){var i=this.layers[0],n=i.layout,o=n.get("text-font"),a=n.get("text-field"),s=n.get("icon-image"),l=("constant"!==a.value.kind||a.value.value instanceof pe&&!a.value.value.isEmpty()||0<a.value.value.toString().length)&&("constant"!==o.value.kind||0<o.value.value.length),c="constant"!==s.value.kind||!!s.value.value||0<Object.keys(s.parameters).length,u=n.get("symbol-sort-key");if(this.features=[],l||c){for(var p=e.iconDependencies,h=e.glyphDependencies,d=e.availableImages,f=new cn(this.zoom),m=0,g=t;m<g.length;m+=1){var y=g[m],v=y.feature,_=y.id,x=y.index,b=y.sourceLayerIndex,w=i._featureFilter.needGeometry,S={type:v.type,id:_,properties:v.properties,geometry:w?cs(v):[]};if(i._featureFilter.filter(f,S,r)){w||(S.geometry=cs(v));var T=void 0;if(l){var E=i.getValueAndResolveTokens("text-field",S,r,d),I=pe.factory(E);Wu(I)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===sn()||this.hasRTLText&&pn.isParsed())&&(T=Ec(I,i,S))}var C=void 0;if(c){var A=i.getValueAndResolveTokens("icon-image",S,r,d);C=A instanceof he?A:he.fromString(A)}if(T||C){var k=this.sortFeaturesByKey?u.evaluate(S,{},r):void 0,P={id:_,text:T,icon:C,index:x,sourceLayerIndex:b,geometry:cs(v),properties:v.properties,type:qu[v.type],sortKey:k};if(this.features.push(P),C&&(p[C.name]=!0),T){var O=o.evaluate(S,{},r).join(","),M="map"===n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&0<=this.writingModes.indexOf(eu.vertical);for(var L=0,D=T.sections;L<D.length;L+=1){var R=D[L];if(R.image)p[R.image.name]=!0;else{var z=Yi(T.toString()),N=R.fontStack||O,B=h[N]=h[N]||{};this.calculateGlyphDependencies(R.text,B,M,this.allowVerticalPlacement,z)}}}}}}"line"===n.get("symbol-placement")&&(this.features=function(t){var e={},r={},i=[],n=0;function o(e){i.push(t[e]),n++}function a(t,e,n){var o=r[t];return delete r[t],r[e]=o,i[o].geometry[0].pop(),i[o].geometry[0]=i[o].geometry[0].concat(n[0]),o}function s(t,r,n){var o=e[r];return delete e[r],e[t]=o,i[o].geometry[0].shift(),i[o].geometry[0]=n[0].concat(i[o].geometry[0]),o}function l(t,e,r){var i=r?e[0][e[0].length-1]:e[0][0];return t+":"+i.x+":"+i.y}for(var c=0;c<t.length;c++){var u=t[c],p=u.geometry,h=u.text?u.text.toString():null;if(h){var d=l(h,p),f=l(h,p,!0);if(d in r&&f in e&&r[d]!==e[f]){var m=s(d,f,p),g=a(d,f,i[m].geometry);delete e[d],delete r[f],r[l(h,i[g].geometry,!0)]=g,i[m].geometry=null}else d in r?a(d,f,p):f in e?s(d,f,p):(o(c),e[d]=n-1,r[f]=n-1)}else o(c)}return i.filter((function(t){return t.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(t,e){return t.sortKey-e.sortKey}))}},Yu.prototype.update=function(t,e,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,r),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,r))},Yu.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Yu.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Yu.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Yu.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Yu.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Yu.prototype.addToLineVertexArray=function(t,e){var r=this.lineVertexArray.length;if(void 0!==t.segment){for(var i=t.dist(e[t.segment+1]),n=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:i},a<e.length-1&&(i+=e[a+1].dist(e[a]));for(var s=t.segment||0;0<=s;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:n},0<s&&(n+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var c=o[l];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Yu.prototype.addSymbols=function(t,e,r,i,n,o,a,s,l,c,u,p){for(var h=t.indexArray,d=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,d,h,o.sortKey),m=this.glyphOffsetArray.length,g=f.vertexLength,y=this.allowVerticalPlacement&&a===eu.vertical?Math.PI/2:0,v=o.text&&o.text.sections,_=0;_<e.length;_++){var x=e[_],b=x.tl,w=x.tr,S=x.bl,T=x.br,E=x.tex,I=x.pixelOffsetTL,C=x.pixelOffsetBR,A=x.minFontScaleX,k=x.minFontScaleY,P=x.glyphOffset,O=x.isSDF,M=x.sectionIndex,L=f.vertexLength,D=P[1];Zu(d,s.x,s.y,b.x,D+b.y,E.x,E.y,r,O,I.x,I.y,A,k),Zu(d,s.x,s.y,w.x,D+w.y,E.x+E.w,E.y,r,O,C.x,I.y,A,k),Zu(d,s.x,s.y,S.x,D+S.y,E.x,E.y+E.h,r,O,I.x,C.y,A,k),Zu(d,s.x,s.y,T.x,D+T.y,E.x+E.w,E.y+E.h,r,O,C.x,C.y,A,k),Hu(t.dynamicLayoutVertexArray,s,y),h.emplaceBack(L,L+1,L+2),h.emplaceBack(L+1,L+2,L+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(P[0]),_!==e.length-1&&M===e[_+1].sectionIndex||t.programConfigurations.populatePaintArrays(d.length,o,o.index,{},p,v&&v[M])}t.placedSymbolArray.emplaceBack(s.x,s.y,m,this.glyphOffsetArray.length-m,g,l,c,s.segment,r?r[0]:0,r?r[1]:0,i[0],i[1],a,0,!1,0,u)},Yu.prototype._addCollisionDebugVertex=function(t,e,r,i,n,o){return e.emplaceBack(0,0),t.emplaceBack(r.x,r.y,i,n,Math.round(o.x),Math.round(o.y))},Yu.prototype.addCollisionDebugVertices=function(t,e,r,i,o,a,s){var l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),c=l.vertexLength,u=o.layoutVertexArray,p=o.collisionVertexArray,h=s.anchorX,d=s.anchorY;this._addCollisionDebugVertex(u,p,a,h,d,new n(t,e)),this._addCollisionDebugVertex(u,p,a,h,d,new n(r,e)),this._addCollisionDebugVertex(u,p,a,h,d,new n(r,i)),this._addCollisionDebugVertex(u,p,a,h,d,new n(t,i)),l.vertexLength+=4;var f=o.indexArray;f.emplaceBack(c,c+1),f.emplaceBack(c+1,c+2),f.emplaceBack(c+2,c+3),f.emplaceBack(c+3,c),l.primitiveLength+=4},Yu.prototype.addDebugCollisionBoxes=function(t,e,r,i){for(var n=t;n<e;n++){var o=this.collisionBoxArray.get(n);this.addCollisionDebugVertices(o.x1,o.y1,o.x2,o.y2,i?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,r)}},Yu.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xu(uo,Sc.members,Bo),this.iconCollisionBox=new Xu(uo,Sc.members,Bo);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},Yu.prototype._deserializeCollisionBoxesForSymbol=function(t,e,r,i,n,o,a,s,l){for(var c={},u=e;u<r;u++){var p=t.get(u);c.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},c.textFeatureIndex=p.featureIndex;break}for(var h=i;h<n;h++){var d=t.get(h);c.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.verticalTextFeatureIndex=d.featureIndex;break}for(var f=o;f<a;f++){var m=t.get(f);c.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},c.iconFeatureIndex=m.featureIndex;break}for(var g=s;g<l;g++){var y=t.get(g);c.verticalIconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},c.verticalIconFeatureIndex=y.featureIndex;break}return c},Yu.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var r=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},Yu.prototype.hasTextData=function(){return 0<this.text.segments.get().length},Yu.prototype.hasIconData=function(){return 0<this.icon.segments.get().length},Yu.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Yu.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&0<this.textCollisionBox.segments.get().length},Yu.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&0<this.iconCollisionBox.segments.get().length},Yu.prototype.addIndicesForPlacedSymbol=function(t,e){for(var r=t.placedSymbolArray.get(e),i=r.vertexStartIndex+4*r.numGlyphs,n=r.vertexStartIndex;n<i;n+=4)t.indexArray.emplaceBack(n,n+1,n+2),t.indexArray.emplaceBack(n+1,n+2,n+3)},Yu.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),r=Math.cos(t),i=[],n=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);i.push(0|Math.round(e*s.anchorX+r*s.anchorY)),n.push(s.featureIndex)}return o.sort((function(t,e){return i[t]-i[e]||n[e]-n[t]})),o},Yu.prototype.addToSortKeyRanges=function(t,e){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===e?r.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Yu.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,i=this.symbolInstanceIndexes;r<i.length;r+=1){var n=this.symbolInstances.get(i[r]);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((function(t,r,i){0<=t&&i.indexOf(t)===r&&e.addIndicesForPlacedSymbol(e.text,t)})),0<=n.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),0<=n.placedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),0<=n.verticalPlacedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Vi("SymbolBucket",Yu,{omit:["layers","collisionBoxArray","features","compareText"]}),Yu.MAX_GLYPHS=65535,Yu.addDynamicAttributes=Hu;var $u=new Cn({"symbol-placement":new xn(Rt.layout_symbol["symbol-placement"]),"symbol-spacing":new xn(Rt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new xn(Rt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new bn(Rt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new xn(Rt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new xn(Rt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new xn(Rt.layout_symbol["icon-ignore-placement"]),"icon-optional":new xn(Rt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new xn(Rt.layout_symbol["icon-rotation-alignment"]),"icon-size":new bn(Rt.layout_symbol["icon-size"]),"icon-text-fit":new xn(Rt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new xn(Rt.layout_symbol["icon-text-fit-padding"]),"icon-image":new bn(Rt.layout_symbol["icon-image"]),"icon-rotate":new bn(Rt.layout_symbol["icon-rotate"]),"icon-padding":new xn(Rt.layout_symbol["icon-padding"]),"icon-keep-upright":new xn(Rt.layout_symbol["icon-keep-upright"]),"icon-offset":new bn(Rt.layout_symbol["icon-offset"]),"icon-anchor":new bn(Rt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new xn(Rt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new xn(Rt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new xn(Rt.layout_symbol["text-rotation-alignment"]),"text-field":new bn(Rt.layout_symbol["text-field"]),"text-font":new bn(Rt.layout_symbol["text-font"]),"text-size":new bn(Rt.layout_symbol["text-size"]),"text-max-width":new bn(Rt.layout_symbol["text-max-width"]),"text-line-height":new xn(Rt.layout_symbol["text-line-height"]),"text-letter-spacing":new bn(Rt.layout_symbol["text-letter-spacing"]),"text-justify":new bn(Rt.layout_symbol["text-justify"]),"text-radial-offset":new bn(Rt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new xn(Rt.layout_symbol["text-variable-anchor"]),"text-anchor":new bn(Rt.layout_symbol["text-anchor"]),"text-max-angle":new xn(Rt.layout_symbol["text-max-angle"]),"text-writing-mode":new xn(Rt.layout_symbol["text-writing-mode"]),"text-rotate":new bn(Rt.layout_symbol["text-rotate"]),"text-padding":new xn(Rt.layout_symbol["text-padding"]),"text-keep-upright":new xn(Rt.layout_symbol["text-keep-upright"]),"text-transform":new bn(Rt.layout_symbol["text-transform"]),"text-offset":new bn(Rt.layout_symbol["text-offset"]),"text-allow-overlap":new xn(Rt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new xn(Rt.layout_symbol["text-ignore-placement"]),"text-optional":new xn(Rt.layout_symbol["text-optional"])}),Qu={paint:new Cn({"icon-opacity":new bn(Rt.paint_symbol["icon-opacity"]),"icon-color":new bn(Rt.paint_symbol["icon-color"]),"icon-halo-color":new bn(Rt.paint_symbol["icon-halo-color"]),"icon-halo-width":new bn(Rt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new bn(Rt.paint_symbol["icon-halo-blur"]),"icon-translate":new xn(Rt.paint_symbol["icon-translate"]),"icon-translate-anchor":new xn(Rt.paint_symbol["icon-translate-anchor"]),"text-opacity":new bn(Rt.paint_symbol["text-opacity"]),"text-color":new bn(Rt.paint_symbol["text-color"],{runtimeType:Xt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new bn(Rt.paint_symbol["text-halo-color"]),"text-halo-width":new bn(Rt.paint_symbol["text-halo-width"]),"text-halo-blur":new bn(Rt.paint_symbol["text-halo-blur"]),"text-translate":new xn(Rt.paint_symbol["text-translate"]),"text-translate-anchor":new xn(Rt.paint_symbol["text-translate-anchor"])}),layout:$u};function tp(t,e,r,i){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,i)}Ju.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Ju.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Ju.prototype.outputDefined=function(){return!1},Ju.prototype.serialize=function(){return null},Vi("FormatSectionOverride",Ju,{omit:["defaultValue"]});var ep,rp,ip,np,op=(xp.__proto__=np=On,((xp.prototype=Object.create(np&&np.prototype)).constructor=xp).prototype.recalculate=function(t,e){if(np.prototype.recalculate.call(this,t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var r=this.layout.get("text-writing-mode");if(r){for(var i=[],n=0,o=r;n<o.length;n+=1){var a=o[n];i.indexOf(a)<0&&i.push(a)}this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},xp.prototype.getValueAndResolveTokens=function(t,e,r,i){var n,o=this.layout.get(t).evaluate(e,{},r,i),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||Yr(a.value)||!o?o:(n=e.properties,o.replace(/{([^{}]+)}/g,(function(t,e){return e in n?String(n[e]):""})))},xp.prototype.createBucket=function(t){return new Yu(t)},xp.prototype.queryRadius=function(){return 0},xp.prototype.queryIntersectsFeature=function(){return!1},xp.prototype._setPaintOverrides=function(){for(var t=0,e=Qu.paint.overridableProperties;t<e.length;t+=1){var r=e[t];if(xp.hasPaintOverride(this.layout,r)){var i,n=this.paint.get(r),o=new Ju(n),a=new Xr(o,n.property.specification);i="constant"===n.value.kind||"source"===n.value.kind?new $r("source",a):new Qr("composite",a,n.value.zoomStops,n.value._interpolationType),this.paint._values[r]=new vn(n.property,i,n.parameters)}}},xp.prototype._handleOverridablePaintPropertyUpdate=function(t,e,r){return!(!this.layout||e.isDataDriven()||r.isDataDriven())&&xp.hasPaintOverride(this.layout,t)},xp.hasPaintOverride=function(t,e){function r(t){for(var e=0,r=t;e<r.length;e+=1)if(n.overrides&&n.overrides.hasOverride(r[e]))return o=!0,0}var i=t.get("text-field"),n=Qu.paint.properties[e],o=!1;if("constant"===i.value.kind&&i.value.value instanceof pe)r(i.value.value.sections);else if("source"===i.value.kind){var a=function(t){o||(t instanceof ye&&me(t.value)===Qt?r(t.value.sections):t instanceof be?r(t.sections):t.eachChild(a))},s=i.value;s._styleExpression&&a(s._styleExpression.expression)}return o},xp),ap={paint:new Cn({"background-color":new xn(Rt.paint_background["background-color"]),"background-pattern":new wn(Rt.paint_background["background-pattern"]),"background-opacity":new xn(Rt.paint_background["background-opacity"])})},sp=(_p.__proto__=ip=On,(_p.prototype=Object.create(ip&&ip.prototype)).constructor=_p),lp={paint:new Cn({"raster-opacity":new xn(Rt.paint_raster["raster-opacity"]),"raster-hue-rotate":new xn(Rt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new xn(Rt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new xn(Rt.paint_raster["raster-brightness-max"]),"raster-saturation":new xn(Rt.paint_raster["raster-saturation"]),"raster-contrast":new xn(Rt.paint_raster["raster-contrast"]),"raster-resampling":new xn(Rt.paint_raster["raster-resampling"]),"raster-fade-duration":new xn(Rt.paint_raster["raster-fade-duration"])})},cp=(vp.__proto__=rp=On,(vp.prototype=Object.create(rp&&rp.prototype)).constructor=vp),up=(yp.__proto__=ep=On,((yp.prototype=Object.create(ep&&ep.prototype)).constructor=yp).prototype.is3D=function(){return"3d"===this.implementation.renderingMode},yp.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},yp.prototype.recalculate=function(){},yp.prototype.updateTransitions=function(){},yp.prototype.hasTransition=function(){},yp.prototype.serialize=function(){},yp.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},yp.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},yp),pp={circle:Rs,heatmap:Ys,hillshade:$s,fill:Bl,"fill-extrusion":rc,line:yc,symbol:op,background:sp,raster:cp},hp=a.HTMLImageElement,dp=a.HTMLCanvasElement,fp=a.HTMLVideoElement,mp=a.ImageData,gp=a.ImageBitmap;function yp(t){ep.call(this,t,{}),this.implementation=t}function vp(t){rp.call(this,t,lp)}function _p(t){ip.call(this,t,ap)}function xp(t){np.call(this,t,Qu)}function bp(t){var e=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})}function wp(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},g(["receive","process"],this),this.invoker=new bp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=E()?t:a}function Sp(t,e,r){var i=2*Math.PI*6378137/256/Math.pow(2,r);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}function Tp(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}tp.prototype.update=function(t,e,r){var i=t.width,n=t.height,o=!(this.size&&this.size[0]===i&&this.size[1]===n||r),a=this.context,s=a.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[i,n],t instanceof hp||t instanceof dp||t instanceof fp||t instanceof mp||gp&&t instanceof gp?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,t):s.texImage2D(s.TEXTURE_2D,0,this.format,i,n,0,this.format,s.UNSIGNED_BYTE,t.data);else{var l=r||{x:0,y:0},c=l.x,u=l.y;t instanceof hp||t instanceof dp||t instanceof fp||t instanceof mp||gp&&t instanceof gp?s.texSubImage2D(s.TEXTURE_2D,0,c,u,s.RGBA,s.UNSIGNED_BYTE,t):s.texSubImage2D(s.TEXTURE_2D,0,c,u,i,n,s.RGBA,s.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},tp.prototype.bind=function(t,e,r){var i=this.context.gl;i.bindTexture(i.TEXTURE_2D,this.texture),r!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=i.LINEAR),t!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r||t),this.filter=t),e!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrap=e)},tp.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},tp.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null},bp.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){t._triggered=!1,t._callback()}),0))},bp.prototype.remove=function(){delete this._channel,this._callback=function(){}},wp.prototype.send=function(t,e,r,i,n){var o=this;void 0===n&&(n=!1);var a=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[a]=r);var s=A(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!r,targetMapId:i,mustQueue:n,sourceMapId:this.mapId,data:Hi(e,s)},s),{cancel:function(){r&&delete o.callbacks[a],o.target.postMessage({id:a,type:"<cancel>",targetMapId:i,sourceMapId:o.mapId})}}},wp.prototype.receive=function(t){var e=t.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[r];var i=this.cancelCallbacks[r];delete this.cancelCallbacks[r],i&&i()}else E()||e.mustQueue?(this.tasks[r]=e,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,e)},wp.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},wp.prototype.processTask=function(t,e){var r=this;if("<response>"===e.type){var i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i(Wi(e.error)):i(null,Wi(e.data)))}else{var n=!1,o=A(this.globalScope)?void 0:[],a=e.hasCallback?function(e,i){n=!0,delete r.cancelCallbacks[t],r.target.postMessage({id:t,type:"<response>",sourceMapId:r.mapId,error:e?Hi(e):null,data:Hi(i,o)},o)}:function(t){n=!0},s=null,l=Wi(e.data);if(this.parent[e.type])s=this.parent[e.type](e.sourceMapId,l,a);else if(this.parent.getWorkerSource){var c=e.type.split(".");s=this.parent.getWorkerSource(e.sourceMapId,c[0],l.source)[c[1]](l,a)}else a(new Error("Could not find function "+e.type));!n&&s&&s.cancel&&(this.cancelCallbacks[t]=s.cancel)}},wp.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)},Tp.prototype.setNorthEast=function(t){return this._ne=t instanceof Ep?new Ep(t.lng,t.lat):Ep.convert(t),this},Tp.prototype.setSouthWest=function(t){return this._sw=t instanceof Ep?new Ep(t.lng,t.lat):Ep.convert(t),this},Tp.prototype.extend=function(t){var e,r,i=this._sw,n=this._ne;if(t instanceof Ep)r=e=t;else{if(!(t instanceof Tp))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Tp.convert(t)):this.extend(Ep.convert(t)):this;if(r=t._ne,!(e=t._sw)||!r)return this}return i||n?(i.lng=Math.min(e.lng,i.lng),i.lat=Math.min(e.lat,i.lat),n.lng=Math.max(r.lng,n.lng),n.lat=Math.max(r.lat,n.lat)):(this._sw=new Ep(e.lng,e.lat),this._ne=new Ep(r.lng,r.lat)),this},Tp.prototype.getCenter=function(){return new Ep((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Tp.prototype.getSouthWest=function(){return this._sw},Tp.prototype.getNorthEast=function(){return this._ne},Tp.prototype.getNorthWest=function(){return new Ep(this.getWest(),this.getNorth())},Tp.prototype.getSouthEast=function(){return new Ep(this.getEast(),this.getSouth())},Tp.prototype.getWest=function(){return this._sw.lng},Tp.prototype.getSouth=function(){return this._sw.lat},Tp.prototype.getEast=function(){return this._ne.lng},Tp.prototype.getNorth=function(){return this._ne.lat},Tp.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Tp.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Tp.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Tp.prototype.contains=function(t){var e=Ep.convert(t),r=e.lng,i=e.lat,n=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&n},Tp.convert=function(t){return!t||t instanceof Tp?t:new Tp(t)};var Ep=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,90<this.lat||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ep.prototype.wrap=function(){return new Ep(u(this.lng,-180,180),this.lat)},Ep.prototype.toArray=function(){return[this.lng,this.lat]},Ep.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ep.prototype.distanceTo=function(t){var e=Math.PI/180,r=this.lat*e,i=t.lat*e,n=Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.cos((t.lng-this.lng)*e);return 6371008.8*Math.acos(Math.min(n,1))},Ep.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new Tp(new Ep(this.lng-r,this.lat-e),new Ep(this.lng+r,this.lat+e))},Ep.convert=function(t){if(t instanceof Ep)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Ep(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Ep(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ip=2*Math.PI*6371008.8;function Cp(t){return Ip*Math.cos(t*Math.PI/180)}function Ap(t){return(180+t)/360}function kp(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Pp(t,e){return t/Cp(e)}function Op(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Mp(t,e,r){void 0===r&&(r=0),this.x=+t,this.y=+e,this.z=+r}function Lp(t,e,r){this.z=t,this.x=e,this.y=r,this.key=zp(0,t,t,e,r)}function Dp(t,e){this.wrap=t,this.canonical=e,this.key=zp(t,e.z,e.z,e.x,e.y)}function Rp(t,e,r,i,n){this.overscaledZ=t,this.wrap=e,this.canonical=new Lp(r,+i,+n),this.key=zp(e,t,r,i,n)}function zp(t,e,r,i,n){(t*=2)<0&&(t=-1*t-1);var o=1<<r;return(o*o*t+o*n+i).toString(36)+r.toString(36)+e.toString(36)}function Np(t,e,r){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return w('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var i=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=r||"mapbox";for(var n=0;n<i;n++)this.data[this._idx(-1,n)]=this.data[this._idx(0,n)],this.data[this._idx(i,n)]=this.data[this._idx(i-1,n)],this.data[this._idx(n,-1)]=this.data[this._idx(n,0)],this.data[this._idx(n,i)]=this.data[this._idx(n,i-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(i,-1)]=this.data[this._idx(i-1,0)],this.data[this._idx(-1,i)]=this.data[this._idx(0,i-1)],this.data[this._idx(i,i)]=this.data[this._idx(i-1,i-1)]}function Bp(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}}function Fp(t,e,r,i,n){this.type="Feature",(this._vectorTileFeature=t)._z=e,t._x=r,t._y=i,this.properties=t.properties,this.id=n}Mp.fromLngLat=function(t,e){void 0===e&&(e=0);var r=Ep.convert(t);return new Mp(Ap(r.lng),kp(r.lat),Pp(e,r.lat))},Mp.prototype.toLngLat=function(){return new Ep(360*this.x-180,Op(this.y))},Mp.prototype.toAltitude=function(){return this.z*Cp(Op(this.y))},Mp.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ip*(t=Op(this.y),1/Math.cos(t*Math.PI/180));var t},Lp.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Lp.prototype.url=function(t,e){var r,i,n,o,a,s=(i=this.y,n=this.z,o=Sp(256*(r=this.x),256*(i=Math.pow(2,n)-i-1),n),a=Sp(256*(r+1),256*(i+1),n),o[0]+","+o[1]+","+a[0]+","+a[1]),l=function(t,e,r){for(var i,n="",o=t;0<o;o--)n+=(e&(i=1<<o-1)?1:0)+(r&i?2:0);return n}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",s)},Lp.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new n(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},Lp.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},Rp.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Rp.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Rp(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Rp(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Rp.prototype.calculateScaledKey=function(t,e){var r=this.canonical.z-t;return t>this.canonical.z?zp(this.wrap*e,t,this.canonical.z,this.canonical.x,this.canonical.y):zp(this.wrap*e,t,t,this.canonical.x>>r,this.canonical.y>>r)},Rp.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Rp.prototype.children=function(t){if(this.overscaledZ>=t)return[new Rp(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,r=2*this.canonical.x,i=2*this.canonical.y;return[new Rp(e,this.wrap,e,r,i),new Rp(e,this.wrap,e,1+r,i),new Rp(e,this.wrap,e,r,1+i),new Rp(e,this.wrap,e,1+r,1+i)]},Rp.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Rp.prototype.wrapped=function(){return new Rp(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Rp.prototype.unwrapTo=function(t){return new Rp(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Rp.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Rp.prototype.toUnwrapped=function(){return new Dp(this.wrap,this.canonical)},Rp.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Rp.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new Mp(t.x-this.wrap,t.y))},Vi("CanonicalTileID",Lp),Vi("OverscaledTileID",Rp,{omit:["posMatrix"]}),Np.prototype.get=function(t,e){var r=new Uint8Array(this.data.buffer),i=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[i],r[1+i],r[2+i])},Np.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Np.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Np.prototype._unpackMapbox=function(t,e,r){return(256*t*256+256*e+r)/10-1e4},Np.prototype._unpackTerrarium=function(t,e,r){return 256*t+e+r/256-32768},Np.prototype.getPixels=function(){return new Zs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Np.prototype.backfillBorder=function(t,e,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var i=e*this.dim,n=e*this.dim+this.dim,o=r*this.dim,a=r*this.dim+this.dim;switch(e){case-1:i=n-1;break;case 1:n=i+1}switch(r){case-1:o=a-1;break;case 1:a=o+1}for(var s=-e*this.dim,l=-r*this.dim,c=o;c<a;c++)for(var u=i;u<n;u++)this.data[this._idx(u,c)]=t.data[this._idx(u+s,c+l)]},Vi("DEMData",Np),Bp.prototype.encode=function(t){return this._stringToNumber[t]},Bp.prototype.decode=function(t){return this._numberToString[t]};var jp={geometry:{configurable:!0}};function Up(){this.state={},this.stateChanges={},this.deletedStates={}}function Vp(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ni(8192,16,0),this.grid3D=new Ni(8192,16,0),this.featureIndexArray=new ma,this.promoteId=e}function qp(t,e,r,i,n){return v(t,(function(t,o){var a=e instanceof _n?e.get(o):null;return a&&a.evaluate?a.evaluate(r,i,n):a}))}function Gp(t){for(var e=1/0,r=1/0,i=-1/0,n=-1/0,o=0,a=t;o<a.length;o+=1){var s=a[o];e=Math.min(e,s.x),r=Math.min(r,s.y),i=Math.max(i,s.x),n=Math.max(n,s.y)}return{minX:e,minY:r,maxX:i,maxY:n}}function Zp(t,e){return e-t}function Hp(t,e){this.tileID=t,this.uid=d(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}function Wp(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Kp.mark(this._marks.start)}jp.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},jp.geometry.set=function(t){this._geometry=t},Fp.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Fp.prototype,jp),Up.prototype.updateState=function(t,e,r){var i=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},p(this.stateChanges[t][i],r),null===this.deletedStates[t])for(var n in this.deletedStates[t]={},this.state[t])n!==i&&(this.deletedStates[t][n]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][i])for(var o in this.deletedStates[t][i]={},this.state[t][i])r[o]||(this.deletedStates[t][i][o]=null);else for(var a in r)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][a]&&delete this.deletedStates[t][i][a]},Up.prototype.removeFeatureState=function(t,e,r){if(null!==this.deletedStates[t]){var i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},r&&void 0!==e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][r]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(r in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][r]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}},Up.prototype.getState=function(t,e){var r=String(e),i=p({},(this.state[t]||{})[r],(this.stateChanges[t]||{})[r]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var n=this.deletedStates[t][e];if(null===n)return{};for(var o in n)delete i[o]}return i},Up.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Up.prototype.coalesceChanges=function(t,e){var r={};for(var i in this.stateChanges){this.state[i]=this.state[i]||{};var n={};for(var o in this.stateChanges[i])this.state[i][o]||(this.state[i][o]={}),p(this.state[i][o],this.stateChanges[i][o]),n[o]=this.state[i][o];r[i]=n}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var s={};if(null===this.deletedStates[a])for(var l in this.state[a])s[l]={},this.state[a][l]={};else for(var c in this.deletedStates[a]){if(null===this.deletedStates[a][c])this.state[a][c]={};else for(var u=0,h=Object.keys(this.deletedStates[a][c]);u<h.length;u+=1)delete this.state[a][c][h[u]];s[c]=this.state[a][c]}r[a]=r[a]||{},p(r[a],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var d in t)t[d].setFeatureState(r,e)},Vp.prototype.insert=function(t,e,r,i,n,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,i,n);for(var s=o?this.grid3D:this.grid,l=0;l<e.length;l++){for(var c=e[l],u=[1/0,1/0,-1/0,-1/0],p=0;p<c.length;p++){var h=c[p];u[0]=Math.min(u[0],h.x),u[1]=Math.min(u[1],h.y),u[2]=Math.max(u[2],h.x),u[3]=Math.max(u[3],h.y)}u[0]<8192&&u[1]<8192&&0<=u[2]&&0<=u[3]&&s.insert(a,u[0],u[1],u[2],u[3])}},Vp.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Xl.VectorTile(new kc(this.rawTileData)).layers,this.sourceLayerCoder=new Bp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Vp.prototype.query=function(t,e,r,i){var o=this;this.loadVTLayers();for(var a=t.params||{},s=8192/t.tileSize/t.scale,l=ui(a.filter),c=t.queryGeometry,u=t.queryPadding*s,p=Gp(c),h=this.grid.query(p.minX-u,p.minY-u,p.maxX+u,p.maxY+u),d=Gp(t.cameraQueryGeometry),f=0,m=this.grid3D.query(d.minX-u,d.minY-u,d.maxX+u,d.maxY+u,(function(e,r,i,o){return function(t,e,r,i,o){for(var a=0,s=t;a<s.length;a+=1){var l=s[a];if(e<=l.x&&r<=l.y&&i>=l.x&&o>=l.y)return!0}var c=[new n(e,r),new n(e,o),new n(i,o),new n(i,r)];if(2<t.length)for(var u=0,p=c;u<p.length;u+=1)if(_s(t,p[u]))return!0;for(var h=0;h<t.length-1;h++)if(xs(t[h],t[h+1],c))return!0;return!1}(t.cameraQueryGeometry,e-u,r-u,i+u,o+u)}));f<m.length;f+=1)h.push(m[f]);h.sort(Zp);for(var g,y={},v=function(n){var u=h[n];if(u!==g){g=u;var p=o.featureIndexArray.get(u),d=null;o.loadMatchingFeature(y,p.bucketIndex,p.sourceLayerIndex,p.featureIndex,l,a.layers,a.availableImages,e,r,i,(function(e,r,i){return d=d||cs(e),r.queryIntersectsFeature(c,e,i,d,o.z,t.transform,s,t.pixelPosMatrix)}))}},_=0;_<h.length;_++)v(_);return y},Vp.prototype.loadMatchingFeature=function(t,e,r,i,n,o,a,s,l,c,u){var p=this.bucketLayerIDs[e];if(!o||function(t,e){for(var r=0;r<t.length;r++)if(0<=e.indexOf(t[r]))return 1}(o,p)){var h=this.sourceLayerCoder.decode(r),d=this.vtLayers[h].feature(i);if(n.filter(new cn(this.tileID.overscaledZ),d))for(var f=this.getId(d,h),m=0;m<p.length;m++){var g=p[m];if(!(o&&o.indexOf(g)<0)){var y=s[g];if(y){var v={};void 0!==f&&c&&(v=c.getState(y.sourceLayer||"_geojsonTileLayer",f));var _=l[g];_.paint=qp(_.paint,y.paint,d,v,a),_.layout=qp(_.layout,y.layout,d,v,a);var x=!u||u(d,y,v);if(x){var b=new Fp(d,this.z,this.x,this.y,f);b.layer=_;var w=t[g];void 0===w&&(w=t[g]=[]),w.push({featureIndex:i,feature:b,intersectionZ:x})}}}}}},Vp.prototype.lookupSymbolFeatures=function(t,e,r,i,n,o,a,s){var l={};this.loadVTLayers();for(var c=ui(n),u=0,p=t;u<p.length;u+=1)this.loadMatchingFeature(l,r,i,p[u],c,o,a,s,e);return l},Vp.prototype.hasLayer=function(t){for(var e=0,r=this.bucketLayerIDs;e<r.length;e+=1)for(var i=0,n=r[e];i<n.length;i+=1)if(t===n[i])return!0;return!1},Vp.prototype.getId=function(t,e){var r=t.id;return this.promoteId&&"boolean"==typeof(r=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(r=Number(r)),r},Vi("FeatureIndex",Vp,{omit:["rawTileData","sourceLayerCoder"]}),Hp.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<N.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Hp.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Hp.prototype.loadVectorData=function(t,e,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var i in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var r={};if(!e)return r;for(var i=function(){var t=o[n],i=t.layerIds.map((function(t){return e.getLayer(t)})).filter(Boolean);if(0!==i.length){t.layers=i,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map((function(t){return i.filter((function(e){return e.id===t}))[0]})));for(var a=0,s=i;a<s.length;a+=1)r[s[a].id]=t}},n=0,o=t;n<o.length;n+=1)i();return r}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var n=this.buckets[i];if(n instanceof Yu){if(this.hasSymbolBuckets=!0,!r)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var o in this.buckets){var a=this.buckets[o];if(a instanceof Yu&&a.hasRTLText){this.hasRTLText=!0,pn.isLoading()||pn.isLoaded()||"deferred"!==sn()||ln();break}}for(var s in this.queryPadding=0,this.buckets){var l=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(s).queryRadius(l))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Jo},Hp.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Hp.prototype.getBucket=function(t){return this.buckets[t.id]},Hp.prototype.upload=function(t){for(var e in this.buckets){var r=this.buckets[e];r.uploadPending()&&r.upload(t)}var i=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new tp(t,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new tp(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)},Hp.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Hp.prototype.queryRenderedFeatures=function(t,e,r,i,n,o,a,s,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:n,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:a,queryPadding:this.queryPadding*l},t,e,r):{}},Hp.prototype.querySourceFeatures=function(t,e){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var i=r.loadVTLayers(),n=e?e.sourceLayer:"",o=i._geojsonTileLayer||i[n];if(o)for(var a=ui(e&&e.filter),s=this.tileID.canonical,l=s.z,c=s.x,u=s.y,p={z:l,x:c,y:u},h=0;h<o.length;h++){var d=o.feature(h);if(a.filter(new cn(this.tileID.overscaledZ),d)){var f=r.getId(d,n),m=new Fp(d,l,c,u,f);m.tile=p,t.push(m)}}}},Hp.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Hp.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Hp.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var r=I(t.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var i=Date.now(),n=!1;if(this.expirationTime>i)n=!1;else if(e)if(this.expirationTime<e)n=!0;else{var o=this.expirationTime-e;o?this.expirationTime=i+Math.max(o,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Hp.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Hp.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var r=this.latestFeatureIndex.loadVTLayers();for(var i in this.buckets)if(e.style.hasLayer(i)){var n=this.buckets[i],o=n.layers[0].sourceLayer||"_geojsonTileLayer",a=r[o],s=t[o];if(a&&s&&0!==Object.keys(s).length){n.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});var l=e&&e.style&&e.style.getLayer(i);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(n)))}}}},Hp.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Hp.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()},Hp.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Hp.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=N.now()+t},Hp.prototype.setDependencies=function(t,e){for(var r={},i=0,n=e;i<n.length;i+=1)r[n[i]]=!0;this.dependencies[t]=r},Hp.prototype.hasDependency=function(t,e){for(var r=0,i=t;r<i.length;r+=1){var n=this.dependencies[i[r]];if(n)for(var o=0,a=e;o<a.length;o+=1)if(n[a[o]])return!0}return!1};var Kp=a.performance;Wp.prototype.finish=function(){Kp.mark(this._marks.end);var t=Kp.getEntriesByName(this._marks.measure);return 0===t.length&&(Kp.measure(this._marks.measure,this._marks.start,this._marks.end),t=Kp.getEntriesByName(this._marks.measure),Kp.clearMarks(this._marks.start),Kp.clearMarks(this._marks.end),Kp.clearMeasures(this._marks.measure)),t},t.Actor=wp,t.AlphaImage=Gs,t.CanonicalTileID=Lp,t.CollisionBoxArray=Jo,t.Color=le,t.DEMData=Np,t.DataConstantProperty=xn,t.DictionaryCoder=Bp,t.EXTENT=8192,t.ErrorEvent=Lt,t.EvaluationParameters=cn,t.Event=Pt,t.Evented=Ot,t.FeatureIndex=Vp,t.FillBucket=Dl,t.FillExtrusionBucket=Ql,t.ImageAtlas=Qc,t.ImagePosition=Jc,t.LineBucket=ac,t.LngLat=Ep,t.LngLatBounds=Tp,t.MercatorCoordinate=Mp,t.ONE_EM=24,t.OverscaledTileID=Rp,t.Point=n,t.Point$1=n,t.Properties=Cn,t.Protobuf=kc,t.RGBAImage=Zs,t.RequestManager=q,t.RequestPerformance=Wp,t.ResourceType=yt,t.SegmentVector=ya,t.SourceFeatureState=Up,t.StructArrayLayout1ui2=Uo,t.StructArrayLayout2f1f2i16=fo,t.StructArrayLayout2i4=Nn,t.StructArrayLayout3ui6=xo,t.StructArrayLayout4i8=jn,t.SymbolBucket=Yu,t.Texture=tp,t.Tile=Hp,t.Transitionable=fn,t.Uniform1f=Ba,t.Uniform1i=Na,t.Uniform2f=Fa,t.Uniform3f=ja,t.Uniform4f=Ua,t.UniformColor=Va,t.UniformMatrix4f=Ga,t.UnwrappedTileID=Dp,t.ValidationError=zt,t.WritingMode=eu,t.ZoomHistory=Ki,t.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},t.addDynamicAttributes=Hu,t.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var i=t.length,n=new Array(t.length),o=null;t.forEach((function(t,a){e(t,(function(t,e){t&&(o=t),n[a]=e,0==--i&&r(o,n)}))}))},t.bezier=s,t.bindAll=g,t.browser=N,t.cacheEntryPossiblyAdded=function(t){++mt>ct&&(t.getActor().send("enforceCacheSizeLimit",lt),mt=0)},t.clamp=c,t.clearTileCache=function(t){var e=a.caches.delete("mapbox-tiles");t&&e.catch(t).then((function(){return t()}))},t.clipLine=Eu,t.clone=function(t){var e=new Is(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=x,t.clone$2=function(t){var e=new Is(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.collisionCircleLayout=Tc,t.config=B,t.create=function(){var t=new Is(16);return Is!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=function(){var t=new Is(9);return Is!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},t.create$2=function(){var t=new Is(4);return Is!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.createCommonjsModule=e,t.createExpression=Jr,t.createLayout=Dn,t.createStyleLayer=function(t){return"custom"===t.type?new up(t):new pp[t.type](t)},t.cross=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=r[0],s=r[1],l=r[2];return t[0]=n*l-o*s,t[1]=o*a-i*l,t[2]=i*s-n*a,t},t.deepEqual=function t(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(var i=0;i<e.length;i++)if(!t(e[i],r[i]))return!1;return!0}if("object"!=typeof e||null===e||null===r)return e===r;if("object"!=typeof r)return!1;if(Object.keys(e).length!==Object.keys(r).length)return!1;for(var n in e)if(!t(e[n],r[n]))return!1;return!0},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=l,t.emitValidationErrors=zi,t.endsWith=y,t.enforceCacheSizeLimit=function(t){ht(),Q&&Q.then((function(e){e.keys().then((function(r){for(var i=0;i<r.length-t;i++)e.delete(r[i])}))}))},t.evaluateSizeForFeature=yu,t.evaluateSizeForZoom=vu,t.evaluateVariableOffset=Bu,t.evented=un,t.extend=p,t.featureFilter=ui,t.filterObject=_,t.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=uu,t.getAnchorJustification=Fu,t.getArrayBuffer=St,t.getImage=Ct,t.getJSON=function(t,e){return wt(p(t,{type:"json"}),e)},t.getRTLTextPluginStatus=sn,t.getReferrer=xt,t.getVideo=function(t,e){var r,i,n=a.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(var o=0;o<t.length;o++){var s=a.document.createElement("source");r=t[o],i=void 0,(i=a.document.createElement("a")).href=r,i.protocol===a.document.location.protocol&&i.host===a.document.location.host||(n.crossOrigin="Anonymous"),s.src=t[o],n.appendChild(s)}return{cancel:function(){}}},t.identity=Cs,t.invert=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],p=e[9],h=e[10],d=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=r*s-i*a,_=r*l-n*a,x=r*c-o*a,b=i*l-n*s,w=i*c-o*s,S=n*c-o*l,T=u*m-p*f,E=u*g-h*f,I=u*y-d*f,C=p*g-h*m,A=p*y-d*m,k=h*y-d*g,P=v*k-_*A+x*C+b*I-w*E+S*T;return P?(t[0]=(s*k-l*A+c*C)*(P=1/P),t[1]=(n*A-i*k-o*C)*P,t[2]=(m*S-g*w+y*b)*P,t[3]=(h*w-p*S-d*b)*P,t[4]=(l*I-a*k-c*E)*P,t[5]=(r*k-n*I+o*E)*P,t[6]=(g*x-f*S-y*_)*P,t[7]=(u*S-h*x+d*_)*P,t[8]=(a*A-s*I+c*T)*P,t[9]=(i*I-r*A-o*T)*P,t[10]=(f*w-m*x+y*v)*P,t[11]=(p*x-u*w-d*v)*P,t[12]=(s*E-a*C-l*T)*P,t[13]=(r*C-i*E+n*T)*P,t[14]=(m*_-f*b-g*v)*P,t[15]=(u*b-p*_+h*v)*P,t):null},t.isChar=Xi,t.isMapboxURL=Z,t.keysDifference=function(t,e){var r=[];for(var i in t)i in e||r.push(i);return r},t.makeRequest=wt,t.mapObject=v,t.mercatorXfromLng=Ap,t.mercatorYfromLat=kp,t.mercatorZfromAltitude=Pp,t.mul=Os,t.multiply=As,t.mvt=Xl,t.normalize=function(t,e){var r=e[0],i=e[1],n=e[2],o=r*r+i*i+n*n;return 0<o&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},t.number=Ye,t.offscreenCanvasSupported=gt,t.ortho=function(t,e,r,i,n,o,a){var s=1/(e-r),l=1/(i-n),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(n+i)*l,t[14]=(a+o)*c,t[15]=1,t},t.parseGlyphPBF=function(t){return new kc(t).readFields(Wc,[])},t.pbf=kc,t.performSymbolLayout=function(t,e,r,i,n,o,a){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var s=t.layers[0].layout,l=t.layers[0]._unevaluatedLayout._values,c={};if("composite"===t.textSizeData.kind){var u=t.textSizeData,p=u.maxZoom;c.compositeTextSizes=[l["text-size"].possiblyEvaluate(new cn(u.minZoom),a),l["text-size"].possiblyEvaluate(new cn(p),a)]}if("composite"===t.iconSizeData.kind){var h=t.iconSizeData,d=h.maxZoom;c.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new cn(h.minZoom),a),l["icon-size"].possiblyEvaluate(new cn(d),a)]}c.layoutTextSize=l["text-size"].possiblyEvaluate(new cn(t.zoom+1),a),c.layoutIconSize=l["icon-size"].possiblyEvaluate(new cn(t.zoom+1),a),c.textMaxSize=l["text-size"].possiblyEvaluate(new cn(18));for(var f=24*s.get("text-line-height"),m="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement"),g=s.get("text-keep-upright"),y=s.get("text-size"),v=function(){var o=x[_],l=s.get("text-font").evaluate(o,{},a).join(","),u=y.evaluate(o,{},a),p=c.layoutTextSize.evaluate(o,{},a),h=c.layoutIconSize.evaluate(o,{},a),d={horizontal:{},vertical:void 0},v=o.text,b=[0,0];if(v){var S=v.toString(),T=24*s.get("text-letter-spacing").evaluate(o,{},a),E=function(){for(var t=0,e=S;t<e.length;t+=1)if(r=e[t].charCodeAt(0),Xi.Arabic(r)||Xi["Arabic Supplement"](r)||Xi["Arabic Extended-A"](r)||Xi["Arabic Presentation Forms-A"](r)||Xi["Arabic Presentation Forms-B"](r))return;var r;return 1}()?T:0,I=s.get("text-anchor").evaluate(o,{},a),C=s.get("text-variable-anchor");if(!C){var A=s.get("text-radial-offset").evaluate(o,{},a);b=A?Bu(I,[24*A,Nu]):s.get("text-offset").evaluate(o,{},a).map((function(t){return 24*t}))}var k=m?"center":s.get("text-justify").evaluate(o,{},a),P=s.get("symbol-placement"),O="point"===P?24*s.get("text-max-width").evaluate(o,{},a):0,M=function(){t.allowVerticalPlacement&&Yi(S)&&(d.vertical=iu(v,e,r,n,l,O,f,I,"left",E,b,eu.vertical,!0,P,p,u))};if(!m&&C){for(var L="auto"===k?C.map((function(t){return Fu(t)})):[k],D=!1,R=0;R<L.length;R++){var z=L[R];if(!d.horizontal[z])if(D)d.horizontal[z]=d.horizontal[0];else{var N=iu(v,e,r,n,l,O,f,"center",z,E,b,eu.horizontal,!1,P,p,u);N&&(D=1===(d.horizontal[z]=N).positionedLines.length)}}M()}else{"auto"===k&&(k=Fu(I));var B=iu(v,e,r,n,l,O,f,I,k,E,b,eu.horizontal,!1,P,p,u);B&&(d.horizontal[k]=B),M(),Yi(S)&&m&&g&&(d.vertical=iu(v,e,r,n,l,O,f,I,k,E,b,eu.vertical,!1,P,p,u))}}var F,j,U,V,q,G=void 0,Z=!1;if(o.icon&&o.icon.name){var H=i[o.icon.name];H&&(F=n[o.icon.name],j=s.get("icon-offset").evaluate(o,{},a),U=uu(s.get("icon-anchor").evaluate(o,{},a)),V=j[0]-F.displaySize[0]*U.horizontalAlign,q=j[1]-F.displaySize[1]*U.verticalAlign,G={image:F,top:q,bottom:q+F.displaySize[1],left:V,right:V+F.displaySize[0]},Z=H.sdf,void 0===t.sdfIcons?t.sdfIcons=H.sdf:t.sdfIcons!==H.sdf&&w("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),H.pixelRatio===t.pixelRatio&&0===s.get("icon-rotate").constantOr(1)||(t.iconsNeedLinear=!0))}var W=Uu(d.horizontal)||d.vertical;t.iconsInText=!!W&&W.iconsInText,(W||G)&&function(t,e,r,i,n,o,a,s,l,c,u){var p=o.textMaxSize.evaluate(e,{});void 0===p&&(p=a);var h,d,f,m,g,y,v,_,x,b,S,T,E,I,C=t.layers[0].layout,A=C.get("icon-offset").evaluate(e,{},u),k=Uu(r.horizontal),P=a/24,O=t.tilePixelRatio*P,M=t.tilePixelRatio*p/24,L=t.tilePixelRatio*s,D=t.tilePixelRatio*C.get("symbol-spacing"),R=C.get("text-padding")*t.tilePixelRatio,z=C.get("icon-padding")*t.tilePixelRatio,N=C.get("text-max-angle")/180*Math.PI,B="map"===C.get("text-rotation-alignment")&&"point"!==C.get("symbol-placement"),F="map"===C.get("icon-rotation-alignment")&&"point"!==C.get("symbol-placement"),j=C.get("symbol-placement"),U=D/2,V=C.get("icon-text-fit");function q(s,p){p.x<0||8192<=p.x||p.y<0||8192<=p.y||function(t,e,r,i,n,o,a,s,l,c,u,p,h,d,f,m,g,y,v,_,x,b,S,T,E){var I,C,A,k,P,O=t.addToLineVertexArray(e,r),M=0,L=0,D=0,R=0,z=-1,N=-1,B={},F=Sa(""),j=0,U=0;if(U=void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(j=(I=s.layout.get("text-offset").evaluate(x,{},T).map((function(t){return 24*t})))[0],I[1]):(j=24*s.layout.get("text-radial-offset").evaluate(x,{},T),Nu),t.allowVerticalPlacement&&i.vertical){var V=s.layout.get("text-rotate").evaluate(x,{},T)+90;k=new Ou(l,e,c,u,p,i.vertical,h,d,f,V),a&&(P=new Ou(l,e,c,u,p,a,g,y,f,V))}if(n){var q=s.layout.get("icon-rotate").evaluate(x,{}),G="none"!==s.layout.get("icon-text-fit"),Z=Iu(n,q,S,G),H=a?Iu(a,q,S,G):void 0;A=new Ou(l,e,c,u,p,n,g,y,!1,q),M=4*Z.length;var W=t.iconSizeData,K=null;"source"===W.kind?32640<(K=[128*s.layout.get("icon-size").evaluate(x,{})])[0]&&w(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===W.kind&&(32640<(K=[128*b.compositeIconSizes[0].evaluate(x,{},T),128*b.compositeIconSizes[1].evaluate(x,{},T)])[0]||32640<K[1])&&w(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),t.addSymbols(t.icon,Z,K,_,v,x,!1,e,O.lineStartIndex,O.lineLength,-1,T),z=t.icon.placedSymbolArray.length-1,H&&(L=4*H.length,t.addSymbols(t.icon,H,K,_,v,x,eu.vertical,e,O.lineStartIndex,O.lineLength,-1,T),N=t.icon.placedSymbolArray.length-1)}for(var X in i.horizontal){var Y=i.horizontal[X];if(!C){F=Sa(Y.text);var J=s.layout.get("text-rotate").evaluate(x,{},T);C=new Ou(l,e,c,u,p,Y,h,d,f,J)}var $=1===Y.positionedLines.length;if(D+=ju(t,e,Y,o,s,f,x,m,O,i.vertical?eu.horizontal:eu.horizontalOnly,$?Object.keys(i.horizontal):[X],B,z,b,T),$)break}function Q(t,e){return t&&t.circleDiameter?Math.max(t.circleDiameter,e):e}i.vertical&&(R+=ju(t,e,i.vertical,o,s,f,x,m,O,eu.vertical,["vertical"],B,N,b,T));var tt=C?C.boxStartIndex:t.collisionBoxArray.length,et=C?C.boxEndIndex:t.collisionBoxArray.length,rt=k?k.boxStartIndex:t.collisionBoxArray.length,it=k?k.boxEndIndex:t.collisionBoxArray.length,nt=A?A.boxStartIndex:t.collisionBoxArray.length,ot=A?A.boxEndIndex:t.collisionBoxArray.length,at=P?P.boxStartIndex:t.collisionBoxArray.length,st=P?P.boxEndIndex:t.collisionBoxArray.length,lt=-1,ct=-1<(lt=Q(P,lt=Q(A,lt=Q(k,lt=Q(C,lt)))))?1:0;ct&&(lt*=E/24),t.glyphOffsetArray.length>=Yu.MAX_GLYPHS&&w("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,x.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,0<=B.right?B.right:-1,0<=B.center?B.center:-1,0<=B.left?B.left:-1,B.vertical||-1,z,N,F,tt,et,rt,it,nt,ot,at,st,c,D,R,M,L,ct,0,h,j,U,lt)}(t,p,s,r,i,n,h,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,O,R,B,l,L,z,F,A,e,o,c,u,a)}if(i&&"none"!==V&&(t.allowVerticalPlacement&&r.vertical&&(h=hu(i,r.vertical,V,C.get("icon-text-fit-padding"),A,P)),k&&(i=hu(i,k,V,C.get("icon-text-fit-padding"),A,P))),"line"===j)for(var G=0,Z=Eu(e.geometry,0,0,8192,8192);G<Z.length;G+=1)for(var H=Z[G],W=0,K=(d=H,f=D,m=N,g=r.vertical||k,y=i,v=24,_=M,x=t.overscaling,b=8192,S=wu(g,v,_),T=Su(g,y),E=T*_,I=0===d[0].x||d[0].x===b||0===d[0].y||d[0].y===b,f-E<f/4&&(f=E+f/4),function t(e,r,i,n,o,a,s,l,c){for(var u=a/2,p=bu(e),h=0,d=r-i,f=[],m=0;m<e.length-1;m++){for(var g=e[m],y=e[m+1],v=g.dist(y),_=y.angleTo(g);d+i<h+v;){var x=((d+=i)-h)/v,b=Ye(g.x,y.x,x),w=Ye(g.y,y.y,x);if(0<=b&&b<c&&0<=w&&w<c&&0<=d-u&&d+u<=p){var S=new fu(b,w,_,m);S._round(),n&&!xu(e,S,a,n,o)||f.push(S)}}h+=v}return l||f.length||s||(f=t(e,h/2,i,n,o,a,s,!0,c)),f}(d,I?f/2*x%f:(T/2+2*v)*_*x%f,f,S,m,E,I,!1,b));W<K.length;W+=1){var X=K[W];k&&Vu(t,k.text,U,X)||q(H,X)}else if("line-center"===j)for(var Y=0,J=e.geometry;Y<J.length;Y+=1){var $=J[Y];if(1<$.length){var Q=Tu($,N,r.vertical||k,i,24,M);Q&&q($,Q)}}else if("Polygon"===e.type)for(var tt=0,et=Pl(e.geometry,0);tt<et.length;tt+=1){var rt=et[tt],it=Du(rt,16);q(rt[0],new fu(it.x,it.y,0))}else if("LineString"===e.type)for(var nt=0,ot=e.geometry;nt<ot.length;nt+=1){var at=ot[nt];q(at,new fu(at[0].x,at[0].y,0))}else if("Point"===e.type)for(var st=0,lt=e.geometry;st<lt.length;st+=1)for(var ct=0,ut=lt[st];ct<ut.length;ct+=1){var pt=ut[ct];q([pt],new fu(pt.x,pt.y,0))}}(t,o,d,G,i,c,p,h,b,Z,a)},_=0,x=t.features;_<x.length;_+=1)v();o&&t.generateCollisionDebugBuffers()},t.perspective=function(t,e,r,i,n){var o,a=1/Math.tan(e/2);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(t[10]=(n+i)*(o=1/(i-n)),t[14]=2*n*i*o):(t[10]=-1,t[14]=-2*i),t},t.pick=function(t,e){for(var r={},i=0;i<e.length;i++){var n=e[i];n in t&&(r[n]=t[n])}return r},t.plugin=pn,t.polygonIntersectsPolygon=hs,t.postMapLoadEvent=st,t.postTurnstileEvent=ot,t.potpack=Yc,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=Vi,t.registerForPluginStateChange=function(t){return t({pluginStatus:nn,pluginURL:on}),un.on("pluginStateChange",t),t},t.rotate=function(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=i*l+o*s,t[1]=n*l+a*s,t[2]=i*-s+o*l,t[3]=n*-s+a*l,t},t.rotateX=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],p=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+c*i,t[5]=a*n+u*i,t[6]=s*n+p*i,t[7]=l*n+h*i,t[8]=c*n-o*i,t[9]=u*n-a*i,t[10]=p*n-s*i,t[11]=h*n-l*i,t},t.rotateZ=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),o=e[0],a=e[1],s=e[2],l=e[3],c=e[4],u=e[5],p=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+c*i,t[1]=a*n+u*i,t[2]=s*n+p*i,t[3]=l*n+h*i,t[4]=c*n-o*i,t[5]=u*n-a*i,t[6]=p*n-s*i,t[7]=h*n-l*i,t},t.scale=function(t,e,r){var i=r[0],n=r[1],o=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$1=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},t.scale$2=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},t.setCacheLimits=function(t,e){lt=t,ct=e},t.setRTLTextPlugin=function(t,e,r){if(void 0===r&&(r=!1),"deferred"===nn||"loading"===nn||"loaded"===nn)throw new Error("setRTLTextPlugin cannot be called multiple times.");on=N.resolveURL(t),nn="deferred",rn=e,an(),r||ln()},t.sphericalToCartesian=function(t){var e=t[0],r=t[1],i=t[2];return r+=90,r*=Math.PI/180,i*=Math.PI/180,{x:e*Math.cos(r)*Math.sin(i),y:e*Math.sin(r)*Math.sin(i),z:e*Math.cos(i)}},t.sqrLen=function(t){var e=t[0],r=t[1];return e*e+r*r},t.styleSpec=Rt,t.sub=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},t.symbolSize=_u,t.transformMat3=function(t,e,r){var i=e[0],n=e[1],o=e[2];return t[0]=i*r[0]+n*r[3]+o*r[6],t[1]=i*r[1]+n*r[4]+o*r[7],t[2]=i*r[2]+n*r[5]+o*r[8],t},t.transformMat4=Ms,t.translate=function(t,e,r){var i,n,o,a,s,l,c,u,p,h,d,f,m=r[0],g=r[1],y=r[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],p=e[8],h=e[9],d=e[10],f=e[11],t[0]=i=e[0],t[1]=n,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=p,t[9]=h,t[10]=d,t[11]=f,t[12]=i*m+s*g+p*y+e[12],t[13]=n*m+l*g+h*y+e[13],t[14]=o*m+c*g+d*y+e[14],t[15]=a*m+u*g+f*y+e[15]),t},t.triggerPluginCompletionEvent=en,t.uniqueId=d,t.validateCustomStyleLayer=function(t){var e=[],r=t.id;return void 0===r&&e.push({message:"layers."+r+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+r+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),e},t.validateLight=Li,t.validateStyle=Mi,t.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},t.vectorTile=Xl,t.version="1.11.1",t.warnOnce=w,t.webpSupported=F,t.window=a,t.wrap=u})),r(0,(function(t){function e(t){var r=typeof t;if("number"==r||"boolean"==r||"string"==r||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var i="[",n=0,o=t;n<o.length;n+=1)i+=e(o[n])+",";return i+"]"}for(var a=Object.keys(t).sort(),s="{",l=0;l<a.length;l++)s+=JSON.stringify(a[l])+":"+e(t[a[l]])+",";return s+"}"}function r(r){for(var i="",n=0,o=t.refProperties;n<o.length;n+=1)i+="/"+e(r[o[n]]);return i}function i(t){this.keyCache={},t&&this.replace(t)}function n(e){var r={},i=[];for(var n in e){var o=e[n],a=r[n]={};for(var s in o){var l=o[+s];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var c={x:0,y:0,w:l.bitmap.width+2,h:l.bitmap.height+2};i.push(c),a[s]={rect:c,metrics:l.metrics}}}}var u=t.potpack(i),p=new t.AlphaImage({width:u.w||1,height:u.h||1});for(var h in e){var d=e[h];for(var f in d){var m=d[+f];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var g=r[h][f].rect;t.AlphaImage.copy(m.bitmap,p,{x:0,y:0},{x:g.x+1,y:g.y+1},m.bitmap)}}}this.image=p,this.positions=r}function o(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId}function a(e,r,i){for(var n=new t.EvaluationParameters(r),o=0,a=e;o<a.length;o+=1)a[o].recalculate(n,i)}function s(e,r){var i=t.getArrayBuffer(e.request,(function(e,i,n,o){e?r(e):i&&r(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(i)),rawData:i,cacheControl:n,expires:o})}));return function(){i.cancel(),r()}}function l(t,e,r,i){this.actor=t,this.layerIndex=e,this.availableImages=r,this.loadVectorData=i||s,this.loading={},this.loaded={}}function c(){this.loaded={}}i.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},i.prototype.update=function(e,i){for(var n=this,o=0,a=e;o<a.length;o+=1){var s=a[o];this._layerConfigs[s.id]=s;var l=this._layers[s.id]=t.createStyleLayer(s);l._featureFilter=t.featureFilter(l.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var c=0,u=i;c<u.length;c+=1){var p=u[c];delete this.keyCache[p],delete this._layerConfigs[p],delete this._layers[p]}this.familiesBySource={};for(var h=0,d=function(t,e){for(var i={},n=0;n<t.length;n++){var o=e&&e[t[n].id]||r(t[n]);e&&(e[t[n].id]=o);var a=i[o];(a=a||(i[o]=[])).push(t[n])}var s=[];for(var l in i)s.push(i[l]);return s}(t.values(this._layerConfigs),this.keyCache);h<d.length;h+=1){var f=d[h].map((function(t){return n._layers[t.id]})),m=f[0];if("none"!==m.visibility){var g=m.source||"",y=this.familiesBySource[g];y=y||(this.familiesBySource[g]={});var v=m.sourceLayer||"_geojsonTileLayer",_=y[v];(_=_||(y[v]=[])).push(f)}}},t.register("GlyphAtlas",n),o.prototype.parse=function(e,r,i,o,s){var l=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var c=new t.DictionaryCoder(Object.keys(e.layers).sort()),u=new t.FeatureIndex(this.tileID,this.promoteId);u.bucketLayerIDs=[];var p,h,d,f,m={},g={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:i},y=r.familiesBySource[this.source];for(var v in y){var _=e.layers[v];if(_){1===_.version&&t.warnOnce('Vector tile source "'+this.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var x=c.encode(v),b=[],w=0;w<_.length;w++){var S=_.feature(w),T=u.getId(S,v);b.push({feature:S,id:T,index:w,sourceLayerIndex:x})}for(var E=0,I=y[v];E<I.length;E+=1){var C=I[E],A=C[0];A.minzoom&&this.zoom<Math.floor(A.minzoom)||A.maxzoom&&this.zoom>=A.maxzoom||"none"!==A.visibility&&(a(C,this.zoom,i),(m[A.id]=A.createBucket({index:u.bucketLayerIDs.length,layers:C,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:x,sourceID:this.source})).populate(b,g,this.tileID.canonical),u.bucketLayerIDs.push(C.map((function(t){return t.id}))))}}}var k=t.mapObject(g.glyphDependencies,(function(t){return Object.keys(t).map(Number)}));Object.keys(k).length?o.send("getGlyphs",{uid:this.uid,stacks:k},(function(t,e){p||(p=t,h=e,M.call(l))})):h={};var P=Object.keys(g.iconDependencies);P.length?o.send("getImages",{icons:P,source:this.source,tileID:this.tileID,type:"icons"},(function(t,e){p||(p=t,d=e,M.call(l))})):d={};var O=Object.keys(g.patternDependencies);function M(){if(p)return s(p);if(h&&d&&f){var e=new n(h),r=new t.ImageAtlas(d,f);for(var o in m){var l=m[o];l instanceof t.SymbolBucket?(a(l.layers,this.zoom,i),t.performSymbolLayout(l,h,e.positions,d,r.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):l.hasPattern&&(l instanceof t.LineBucket||l instanceof t.FillBucket||l instanceof t.FillExtrusionBucket)&&(a(l.layers,this.zoom,i),l.addFeatures(g,this.tileID.canonical,r.patternPositions))}this.status="done",s(null,{buckets:t.values(m).filter((function(t){return!t.isEmpty()})),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:r,glyphMap:this.returnDependencies?h:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?e.positions:null})}}O.length?o.send("getImages",{icons:O,source:this.source,tileID:this.tileID,type:"patterns"},(function(t,e){p||(p=t,f=e,M.call(l))})):f={},M.call(this)},l.prototype.loadTile=function(e,r){var i=this,n=e.uid;this.loading||(this.loading={});var a=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request),s=this.loading[n]=new o(e);s.abort=this.loadVectorData(e,(function(e,o){if(delete i.loading[n],e||!o)return s.status="done",i.loaded[n]=s,r(e);var l=o.rawData,c={};o.expires&&(c.expires=o.expires),o.cacheControl&&(c.cacheControl=o.cacheControl);var u={};if(a){var p=a.finish();p&&(u.resourceTiming=JSON.parse(JSON.stringify(p)))}s.vectorTile=o.vectorTile,s.parse(o.vectorTile,i.layerIndex,i.availableImages,i.actor,(function(e,i){if(e||!i)return r(e);r(null,t.extend({rawTileData:l.slice(0)},i,c,u))})),i.loaded=i.loaded||{},i.loaded[n]=s}))},l.prototype.reloadTile=function(t,e){var r=this,i=this.loaded,n=t.uid,o=this;if(i&&i[n]){var a=i[n];a.showCollisionBoxes=t.showCollisionBoxes;var s=function(t,i){var n=a.reloadCallback;n&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,r.availableImages,o.actor,n)),e(t,i)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},l.prototype.abortTile=function(t,e){var r=this.loading,i=t.uid;r&&r[i]&&r[i].abort&&(r[i].abort(),delete r[i]),e()},l.prototype.removeTile=function(t,e){var r=this.loaded,i=t.uid;r&&r[i]&&delete r[i],e()};var u=t.window.ImageBitmap;function p(t,e){if(0!==t.length){h(t[0],e);for(var r=1;r<t.length;r++)h(t[r],!e)}}function h(t,e){for(var r=0,i=0,n=t.length,o=n-1;i<n;o=i++)r+=(t[i][0]-t[o][0])*(t[o][1]+t[i][1]);0<=r!=!!e&&t.reverse()}function d(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}c.prototype.loadTile=function(e,r){var i=e.uid,n=e.encoding,o=e.rawImageData,a=u&&o instanceof u?this.getImageData(o):o,s=new t.DEMData(i,a,n);this.loaded=this.loaded||{},r(null,this.loaded[i]=s)},c.prototype.getImageData=function(e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var r=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:r.width,height:r.height},r.data)},c.prototype.removeTile=function(t){var e=this.loaded,r=t.uid;e&&e[r]&&delete e[r]};var f=t.vectorTile.VectorTileFeature.prototype.toGeoJSON;d.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],r=0,i=this._feature.geometry;r<i.length;r+=1){var n=i[r];e.push([new t.Point$1(n[0],n[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var l=[],c=0,u=s[a];c<u.length;c+=1){var p=u[c];l.push(new t.Point$1(p[0],p[1]))}o.push(l)}return o},d.prototype.toGeoJSON=function(t,e,r){return f.call(this,t,e,r)};var m=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};m.prototype.feature=function(t){return new d(this._features[t])};var g=t.vectorTile.VectorTileFeature,y=v;function v(t,e){this.options=e||{},this.features=t,this.length=t.length}function _(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}v.prototype.feature=function(t){return new _(this.features[t],this.options.extent)},_.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var r=0;r<e.length;r++){for(var i=e[r],n=[],o=0;o<i.length;o++)n.push(new t.Point$1(i[o][0],i[o][1]));this.geometry.push(n)}return this.geometry},_.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,i=1/0,n=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),n=Math.max(n,l.y)}return[e,i,r,n]},_.prototype.toGeoJSON=g.prototype.toGeoJSON;var x=w,b=y;function w(e){var r=new t.pbf;return function(t,e){for(var r in t.layers)e.writeMessage(3,S,t.layers[r])}(e,r),r.finish()}function S(t,e){var r;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)i.feature=t.feature(r),e.writeMessage(2,T,i);var n=i.keys;for(r=0;r<n.length;r++)e.writeStringField(3,n[r]);var o=i.values;for(r=0;r<o.length;r++)e.writeMessage(4,k,o[r])}function T(t,e){var r=t.feature;void 0!==r.id&&e.writeVarintField(1,r.id),e.writeMessage(2,E,t),e.writeVarintField(3,r.type),e.writeMessage(4,A,r)}function E(t,e){var r=t.feature,i=t.keys,n=t.values,o=t.keycache,a=t.valuecache;for(var s in r.properties){var l=o[s];void 0===l&&(i.push(s),o[s]=l=i.length-1),e.writeVarint(l);var c=r.properties[s],u=typeof c;"string"!=u&&"boolean"!=u&&"number"!=u&&(c=JSON.stringify(c));var p=u+":"+c,h=a[p];void 0===h&&(n.push(c),a[p]=h=n.length-1),e.writeVarint(h)}}function I(t,e){return(e<<3)+(7&t)}function C(t){return t<<1^t>>31}function A(t,e){for(var r=t.loadGeometry(),i=t.type,n=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],c=1;1===i&&(c=l.length),e.writeVarint(I(1,c));for(var u=3===i?l.length-1:l.length,p=0;p<u;p++){1===p&&1!==i&&e.writeVarint(I(2,u-1));var h=l[p].x-n,d=l[p].y-o;e.writeVarint(C(h)),e.writeVarint(C(d)),n+=h,o+=d}3===i&&e.writeVarint(15)}}function k(t,e){var r=typeof t;"string"==r?e.writeStringField(1,t):"boolean"==r?e.writeBooleanField(7,t):"number"==r&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function P(t,e,r,i){O(t,r,i),O(e,2*r,2*i),O(e,2*r+1,2*i+1)}function O(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function M(t,e,r,i){var n=t-r,o=e-i;return n*n+o*o}function L(t){return t[0]}function D(t){return t[1]}function R(t,e,r,i,n){void 0===e&&(e=L),void 0===r&&(r=D),void 0===i&&(i=64),void 0===n&&(n=Float64Array),this.nodeSize=i;for(var o=(this.points=t).length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),s=this.coords=new n(2*t.length),l=0;l<t.length;l++)s[2*(a[l]=l)]=e(t[l]),s[2*l+1]=r(t[l]);!function t(e,r,i,n,o,a){if(!(o-n<=i)){var s=n+o>>1;!function t(e,r,i,n,o,a){for(;n<o;){if(600<o-n){var s=o-n+1,l=i-n+1,c=Math.log(s),u=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);t(e,r,i,Math.max(n,Math.floor(i-l*u/s+p)),Math.min(o,Math.floor(i+(s-l)*u/s+p)),a)}var h=r[2*i+a],d=n,f=o;for(P(e,r,n,i),r[2*o+a]>h&&P(e,r,n,o);d<f;){for(P(e,r,d,f),d++,f--;r[2*d+a]<h;)d++;for(;r[2*f+a]>h;)f--}r[2*n+a]===h?P(e,r,n,f):P(e,r,++f,o),f<=i&&(n=f+1),i<=f&&(o=f-1)}}(e,r,s,n,o,a%2),t(e,r,i,n,s-1,a+1),t(e,r,i,1+s,o,a+1)}}(a,s,i,0,a.length-1,0)}function z(t){this.options=V(Object.create(N),t),this.trees=new Array(this.options.maxZoom+1)}x.fromVectorTileJs=w,x.fromGeojsonVt=function(t,e){e=e||{};var r={};for(var i in t)r[i]=new y(t[i].features,e),r[i].name=i,r[i].version=e.version,r[i].extent=e.extent;return w({layers:r})},x.GeoJSONWrapper=b,R.prototype.range=function(t,e,r,i){return function(t,e,r,i,n,o,a){for(var s,l,c=[0,t.length-1,0],u=[];c.length;){var p=c.pop(),h=c.pop(),d=c.pop();if(h-d<=a)for(var f=d;f<=h;f++)l=e[2*f+1],(s=e[2*f])>=r&&s<=n&&i<=l&&l<=o&&u.push(t[f]);else{var m=Math.floor((d+h)/2);l=e[2*m+1],(s=e[2*m])>=r&&s<=n&&i<=l&&l<=o&&u.push(t[m]);var g=(p+1)%2;(0===p?r<=s:i<=l)&&(c.push(d),c.push(m-1),c.push(g)),(0===p?s<=n:l<=o)&&(c.push(m+1),c.push(h),c.push(g))}}return u}(this.ids,this.coords,t,e,r,i,this.nodeSize)};var N={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!(R.prototype.within=function(t,e,r){return function(t,e,r,i,n,o){for(var a=[0,t.length-1,0],s=[],l=n*n;a.length;){var c=a.pop(),u=a.pop(),p=a.pop();if(u-p<=o)for(var h=p;h<=u;h++)M(e[2*h],e[2*h+1],r,i)<=l&&s.push(t[h]);else{var d=Math.floor((p+u)/2),f=e[2*d],m=e[2*d+1];M(f,m,r,i)<=l&&s.push(t[d]);var g=(c+1)%2;(0===c?r-n<=f:i-n<=m)&&(a.push(p),a.push(d-1),a.push(g)),(0===c?f<=r+n:m<=i+n)&&(a.push(d+1),a.push(u),a.push(g))}}return s}(this.ids,this.coords,t,e,r,this.nodeSize)}),generateId:!1,reduce:null,map:function(t){return t}};function B(t){return{type:"Feature",id:t.id,properties:F(t),geometry:{type:"Point",coordinates:[360*(t.x-.5),(e=(180-360*t.y)*Math.PI/180,360*Math.atan(Math.exp(e))/Math.PI-90)]}};var e}function F(t){var e=t.numPoints,r=1e4<=e?Math.round(e/1e3)+"k":1e3<=e?Math.round(e/100)/10+"k":e;return V(V({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:r})}function j(t){return t/360+.5}function U(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:1<r?1:r}function V(t,e){for(var r in e)t[r]=e[r];return t}function q(t){return t.x}function G(t){return t.y}function Z(t,e,r,i,n,o){var a=n-r,s=o-i;if(0!==a||0!==s){var l=((t-r)*a+(e-i)*s)/(a*a+s*s);1<l?(r=n,i=o):0<l&&(r+=a*l,i+=s*l)}return(a=t-r)*a+(s=e-i)*s}function H(t,e,r,i){var n={id:void 0===t?null:t,type:e,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,r=t.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)W(t,e);else if("Polygon"===r||"MultiLineString"===r)for(var i=0;i<e.length;i++)W(t,e[i]);else if("MultiPolygon"===r)for(i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++)W(t,e[i][n])}(n),n}function W(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function K(t,e,r,i){if(e.geometry){var n=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=i||0),"Point"===o)X(n,s);else if("MultiPoint"===o)for(var c=0;c<n.length;c++)X(n[c],s);else if("LineString"===o)Y(n,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(c=0;c<n.length;c++)Y(n[c],s=[],a,!1),t.push(H(l,"LineString",s,e.properties));return}J(n,s,a,!1)}else if("Polygon"===o)J(n,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(c=0;c<e.geometry.geometries.length;c++)K(t,{id:l,geometry:e.geometry.geometries[c],properties:e.properties},r,i);return}for(c=0;c<n.length;c++){var u=[];J(n[c],u,a,!0),s.push(u)}}t.push(H(l,o,s,e.properties))}}function X(t,e){e.push($(t[0])),e.push(Q(t[1])),e.push(0)}function Y(t,e,r,i){for(var n,o,a=0,s=0;s<t.length;s++){var l=$(t[s][0]),c=Q(t[s][1]);e.push(l),e.push(c),e.push(0),0<s&&(a+=i?(n*c-l*o)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(c-o,2))),n=l,o=c}var u=e.length-3;e[2]=1,function t(e,r,i,n){for(var o,a=n,s=i-r>>1,l=i-r,c=e[r],u=e[r+1],p=e[i],h=e[i+1],d=r+3;d<i;d+=3){var f=Z(e[d],e[d+1],c,u,p,h);if(a<f)o=d,a=f;else if(f===a){var m=Math.abs(d-s);m<l&&(o=d,l=m)}}n<a&&(3<o-r&&t(e,r,o,n),e[o+2]=a,3<i-o&&t(e,o,i,n))}(e,0,u,r),e[2+u]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function J(t,e,r,i){for(var n=0;n<t.length;n++){var o=[];Y(t[n],o,r,i),e.push(o)}}function $(t){return t/360+.5}function Q(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:1<r?1:r}function tt(t,e,r,i,n,o,a,s){if(i/=e,o>=(r/=e)&&a<i)return t;if(a<r||i<=o)return null;for(var l=[],c=0;c<t.length;c++){var u=t[c],p=u.geometry,h=u.type,d=0===n?u.minX:u.minY,f=0===n?u.maxX:u.maxY;if(r<=d&&f<i)l.push(u);else if(!(f<r||i<=d)){var m=[];if("Point"===h||"MultiPoint"===h)et(p,m,r,i,n);else if("LineString"===h)rt(p,m,r,i,n,!1,s.lineMetrics);else if("MultiLineString"===h)nt(p,m,r,i,n,!1);else if("Polygon"===h)nt(p,m,r,i,n,!0);else if("MultiPolygon"===h)for(var g=0;g<p.length;g++){var y=[];nt(p[g],y,r,i,n,!0),y.length&&m.push(y)}if(m.length){if(s.lineMetrics&&"LineString"===h){for(g=0;g<m.length;g++)l.push(H(u.id,h,m[g],u.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===m.length?(h="LineString",m=m[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===m.length?"Point":"MultiPoint"),l.push(H(u.id,h,m,u.tags))}}}return l.length?l:null}function et(t,e,r,i,n){for(var o=0;o<t.length;o+=3){var a=t[o+n];r<=a&&a<=i&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function rt(t,e,r,i,n,o,a){for(var s,l,c=it(t),u=0===n?at:st,p=t.start,h=0;h<t.length-3;h+=3){var d=t[h],f=t[h+1],m=t[h+2],g=t[h+3],y=t[h+4],v=0===n?d:f,_=0===n?g:y,x=!1;a&&(s=Math.sqrt(Math.pow(d-g,2)+Math.pow(f-y,2))),v<r?r<_&&(l=u(c,d,f,g,y,r),a&&(c.start=p+s*l)):i<v?_<i&&(l=u(c,d,f,g,y,i),a&&(c.start=p+s*l)):ot(c,d,f,m),_<r&&r<=v&&(l=u(c,d,f,g,y,r),x=!0),i<_&&v<=i&&(l=u(c,d,f,g,y,i),x=!0),!o&&x&&(a&&(c.end=p+s*l),e.push(c),c=it(t)),a&&(p+=s)}var b=t.length-3;d=t[b],f=t[b+1],m=t[b+2],(v=0===n?d:f)>=r&&v<=i&&ot(c,d,f,m),b=c.length-3,o&&3<=b&&(c[b]!==c[0]||c[b+1]!==c[1])&&ot(c,c[0],c[1],c[2]),c.length&&e.push(c)}function it(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function nt(t,e,r,i,n,o){for(var a=0;a<t.length;a++)rt(t[a],e,r,i,n,o,!1)}function ot(t,e,r,i){t.push(e),t.push(r),t.push(i)}function at(t,e,r,i,n,o){var a=(o-e)/(i-e);return t.push(o),t.push(r+(n-r)*a),t.push(1),a}function st(t,e,r,i,n,o){var a=(o-r)/(n-r);return t.push(e+(i-e)*a),t.push(o),t.push(1),a}function lt(t,e){for(var r=[],i=0;i<t.length;i++){var n,o=t[i],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)n=ct(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){n=[];for(var s=0;s<o.geometry.length;s++)n.push(ct(o.geometry[s],e))}else if("MultiPolygon"===a)for(n=[],s=0;s<o.geometry.length;s++){for(var l=[],c=0;c<o.geometry[s].length;c++)l.push(ct(o.geometry[s][c],e));n.push(l)}r.push(H(o.id,a,n,o.tags))}return r}function ct(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var i=0;i<t.length;i+=3)r.push(t[i]+e,t[i+1],t[i+2]);return r}function ut(t,e){if(t.transformed)return t;var r,i,n,o=1<<t.z,a=t.x,s=t.y;for(r=0;r<t.features.length;r++){var l=t.features[r],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(i=0;i<c.length;i+=2)l.geometry.push(pt(c[i],c[i+1],e,o,a,s));else for(i=0;i<c.length;i++){var p=[];for(n=0;n<c[i].length;n+=2)p.push(pt(c[i][n],c[i][n+1],e,o,a,s));l.geometry.push(p)}}return t.transformed=!0,t}function pt(t,e,r,i,n,o){return[Math.round(r*(t*i-n)),Math.round(r*(e*i-o))]}function ht(t,e,r,i,n){for(var o=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,dt(a,t[s],o,n);var l=t[s].minX,c=t[s].minY,u=t[s].maxX,p=t[s].maxY;l<a.minX&&(a.minX=l),c<a.minY&&(a.minY=c),u>a.maxX&&(a.maxX=u),p>a.maxY&&(a.maxY=p)}return a}function dt(t,e,r,i){var n=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<n.length;s+=3)a.push(n[s]),a.push(n[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)ft(a,n,t,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<n.length;s++)ft(a,n[s],t,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<n.length;l++){var c=n[l];for(s=0;s<c.length;s++)ft(a,c[s],t,r,!0,0===s)}if(a.length){var u=e.tags||null;if("LineString"===o&&i.lineMetrics){for(var p in u={},e.tags)u[p]=e.tags[p];u.mapbox_clip_start=n.start/n.size,u.mapbox_clip_end=n.end/n.size}var h={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:u};null!==e.id&&(h.id=e.id),t.features.push(h)}}function ft(t,e,r,i,n,o){var a=i*i;if(0<i&&e.size<(n?a:i))r.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>a)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;n&&function(t,e){for(var r=0,i=0,n=t.length,o=n-2;i<n;o=i,i+=2)r+=(t[i]-t[o])*(t[i+1]+t[o+1]);if(0<r===e)for(i=0,n=t.length;i<n/2;i+=2){var a=t[i],s=t[i+1];t[i]=t[n-2-i],t[i+1]=t[n-1-i],t[n-2-i]=a,t[n-1-i]=s}}(s,o),t.push(s)}}function mt(t,e){var r=(e=this.options=function(t,e){for(var r in e)t[r]=e[r];return t}(Object.create(this.options),e)).debug;if(r&&console.time("preprocess data"),e.maxZoom<0||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i,n,o,a,s,l,c=function(t,e){var r=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)K(r,t.features[i],e,i);else K(r,"Feature"===t.type?t:{geometry:t},e);return r}(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=c,o=(n=e).buffer/n.extent,s=tt(a=i,1,-1-o,o,0,-1,2,n),l=tt(i,1,1-o,2+o,0,-1,2,n),(s||l)&&(a=tt(i,1,-o,1+o,0,-1,2,n)||[],s&&(a=lt(s,1).concat(a)),l&&(a=a.concat(lt(l,-1)))),(c=a).length&&this.splitTile(c,0,0,0),r&&(c.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function gt(t,e,r){return 32*((1<<t)*r+e)+t}function yt(t,e){var r=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var i=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!i)return e(null,null);var n=new m(i.features),o=x(n);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:n,rawData:o.buffer})}function vt(e){var r=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:xt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(r.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');r.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}}z.prototype.load=function(t){var e=this.options,r=e.log,i=e.minZoom,n=e.maxZoom,o=e.nodeSize;r&&console.time("total time");var a,s,l,c,u="prepare "+t.length+" points";r&&console.time(u),this.points=t;for(var p=[],h=0;h<t.length;h++)t[h].geometry&&p.push((a=t[h],s=h,l=a.geometry.coordinates,c=l[1],{x:j(l[0]),y:U(c),zoom:1/0,index:s,parentId:-1}));this.trees[n+1]=new R(p,q,G,o,Float32Array),r&&console.timeEnd(u);for(var d=n;i<=d;d--){var f=+Date.now();p=this._cluster(p,d),this.trees[d]=new R(p,q,G,o,Float32Array),r&&console.log("z%d: %d clusters in %dms",d,p.length,Date.now()-f)}return r&&console.timeEnd("total time"),this},z.prototype.getClusters=function(t,e){var r=((t[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[1])),n=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(360<=t[2]-t[0])r=-180,n=180;else if(n<r){var a=this.getClusters([r,i,180,o],e),s=this.getClusters([-180,i,n,o],e);return a.concat(s)}for(var l=this.trees[this._limitZoom(e)],c=[],u=0,p=l.range(j(r),U(o),j(n),U(i));u<p.length;u+=1){var h=l.points[p[u]];c.push(h.numPoints?B(h):this.points[h.index])}return c},z.prototype.getChildren=function(t){var e=this._getOriginId(t),r=this._getOriginZoom(t),i="No cluster with the specified id.",n=this.trees[r];if(!n)throw new Error(i);var o=n.points[e];if(!o)throw new Error(i);for(var a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=[],l=0,c=n.within(o.x,o.y,a);l<c.length;l+=1){var u=n.points[c[l]];u.parentId===t&&s.push(u.numPoints?B(u):this.points[u.index])}if(0===s.length)throw new Error(i);return s},z.prototype.getLeaves=function(t,e,r){var i=[];return this._appendLeaves(i,t,e=e||10,r=r||0,0),i},z.prototype.getTile=function(t,e,r){var i=this.trees[this._limitZoom(t)],n=Math.pow(2,t),o=this.options,a=o.radius/o.extent,s=(r-a)/n,l=(r+1+a)/n,c={features:[]};return this._addTileFeatures(i.range((e-a)/n,s,(e+1+a)/n,l),i.points,e,r,n,c),0===e&&this._addTileFeatures(i.range(1-a/n,s,1,l),i.points,n,r,n,c),e===n-1&&this._addTileFeatures(i.range(0,s,a/n,l),i.points,-1,r,n,c),c.features.length?c:null},z.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var r=this.getChildren(t);if(e++,1!==r.length)break;t=r[0].properties.cluster_id}return e},z.prototype._appendLeaves=function(t,e,r,i,n){for(var o=0,a=this.getChildren(e);o<a.length;o+=1){var s=a[o],l=s.properties;if(l&&l.cluster?n+l.point_count<=i?n+=l.point_count:n=this._appendLeaves(t,l.cluster_id,r,i,n):n<i?n++:t.push(s),t.length===r)break}return n},z.prototype._addTileFeatures=function(t,e,r,i,n,o){for(var a=0,s=t;a<s.length;a+=1){var l=e[s[a]],c=l.numPoints,u={type:1,geometry:[[Math.round(this.options.extent*(l.x*n-r)),Math.round(this.options.extent*(l.y*n-i))]],tags:c?F(l):this.points[l.index].properties},p=void 0;c?p=l.id:this.options.generateId?p=l.index:this.points[l.index].id&&(p=this.points[l.index].id),void 0!==p&&(u.id=p),o.features.push(u)}},z.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},z.prototype._cluster=function(t,e){for(var r=[],i=this.options,n=i.reduce,o=i.minPoints,a=i.radius/(i.extent*Math.pow(2,e)),s=0;s<t.length;s++){var l=t[s];if(!(l.zoom<=e)){l.zoom=e;for(var c=this.trees[e+1],u=c.within(l.x,l.y,a),p=l.numPoints||1,h=p,d=0,f=u;d<f.length;d+=1){var m=c.points[f[d]];m.zoom>e&&(h+=m.numPoints||1)}if(o<=h){for(var g=l.x*p,y=l.y*p,v=n&&1<p?this._map(l,!0):null,_=(s<<5)+(e+1)+this.points.length,x=0,b=u;x<b.length;x+=1){var w=c.points[b[x]];if(!(w.zoom<=e)){w.zoom=e;var S=w.numPoints||1;g+=w.x*S,y+=w.y*S,w.parentId=_,n&&n(v=v||this._map(l,!0),this._map(w))}}l.parentId=_,r.push({x:g/h,y:y/h,zoom:1/0,id:_,parentId:-1,numPoints:h,properties:v})}else if(r.push(l),1<h)for(var T=0,E=u;T<E.length;T+=1){var I=c.points[E[T]];I.zoom<=e||(I.zoom=e,r.push(I))}}}return r},z.prototype._getOriginId=function(t){return t-this.points.length>>5},z.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},mt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!(z.prototype._map=function(t,e){if(t.numPoints)return e?V({},t.properties):t.properties;var r=this.points[t.index].properties,i=this.options.map(r);return e&&i===r?V({},i):i}),promoteId:null,generateId:!1,debug:0},mt.prototype.splitTile=function(t,e,r,i,n,o,a){for(var s=[t,e,r,i],l=this.options,c=l.debug;s.length;){i=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var u=1<<e,p=gt(e,r,i),h=this.tiles[p];if(!h&&(1<c&&console.time("creation"),h=this.tiles[p]=ht(t,e,r,i,l),this.tileCoords.push({z:e,x:r,y:i}),c)){1<c&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,i,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(h.source=t,n){if(e===l.maxZoom||e===n)continue;var f=1<<n-e;if(r!==Math.floor(o/f)||i!==Math.floor(a/f))continue}else if(e===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==t.length){1<c&&console.time("clipping");var m,g,y,v,_,x,b=.5*l.buffer/l.extent,w=.5-b,S=.5+b,T=1+b;m=g=y=v=null,_=tt(t,u,r-b,r+S,0,h.minX,h.maxX,l),x=tt(t,u,r+w,r+T,0,h.minX,h.maxX,l),t=null,_&&(m=tt(_,u,i-b,i+S,1,h.minY,h.maxY,l),g=tt(_,u,i+w,i+T,1,h.minY,h.maxY,l),_=null),x&&(y=tt(x,u,i-b,i+S,1,h.minY,h.maxY,l),v=tt(x,u,i+w,i+T,1,h.minY,h.maxY,l),x=null),1<c&&console.timeEnd("clipping"),s.push(m||[],e+1,2*r,2*i),s.push(g||[],e+1,2*r,2*i+1),s.push(y||[],e+1,2*r+1,2*i),s.push(v||[],e+1,2*r+1,2*i+1)}}},mt.prototype.getTile=function(t,e,r){var i=this.options,n=i.extent,o=i.debug;if(t<0||24<t)return null;var a=1<<t,s=gt(t,e=(e%a+a)%a,r);if(this.tiles[s])return ut(this.tiles[s],n);1<o&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l,c=t,u=e,p=r;!l&&0<c;)c--,u=Math.floor(u/2),p=Math.floor(p/2),l=this.tiles[gt(c,u,p)];return l&&l.source?(1<o&&console.log("found parent tile z%d-%d-%d",c,u,p),1<o&&console.time("drilling down"),this.splitTile(l.source,c,u,p,t,e,r),1<o&&console.timeEnd("drilling down"),this.tiles[s]?ut(this.tiles[s],n):null):null};var _t,xt=(bt.__proto__=_t=l,((bt.prototype=Object.create(_t&&_t.prototype)).constructor=bt).prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},bt.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var r=this._pendingCallback,i=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var n=!!(i&&i.request&&i.request.collectResourceTiming)&&new t.RequestPerformance(i.request);this.loadGeoJSON(i,(function(o,a){if(o||!a)return r(o);if("object"!=typeof a)return r(new Error("Input data given to '"+i.source+"' is not a valid GeoJSON object."));!function t(e,r){var i,n=e&&e.type;if("FeatureCollection"===n)for(i=0;i<e.features.length;i++)t(e.features[i],r);else if("GeometryCollection"===n)for(i=0;i<e.geometries.length;i++)t(e.geometries[i],r);else if("Feature"===n)t(e.geometry,r);else if("Polygon"===n)p(e.coordinates,r);else if("MultiPolygon"===n)for(i=0;i<e.coordinates.length;i++)p(e.coordinates[i],r);return e}(a,!0);try{e._geoJSONIndex=i.cluster?new z(function(){var e=i.superclusterOptions,r=i.clusterProperties;if(!r||!e)return e;for(var n={},o={},a={accumulated:null,zoom:0},s={properties:null},l=Object.keys(r),c=0,u=l;c<u.length;c+=1){var p=u[c],h=r[p],d=h[0],f=t.createExpression(h[1]),m=t.createExpression("string"==typeof d?[d,["accumulated"],["get",p]]:d);n[p]=f.value,o[p]=m.value}return e.map=function(t){s.properties=t;for(var e={},r=0,i=l;r<i.length;r+=1){var o=i[r];e[o]=n[o].evaluate(a,s)}return e},e.reduce=function(t,e){s.properties=e;for(var r=0,i=l;r<i.length;r+=1){var n=i[r];a.accumulated=t[n],t[n]=o[n].evaluate(a,s)}},e}()).load(a.features):new mt(a,i.geojsonVtOptions)}catch(o){return r(o)}e.loaded={};var s={};if(n){var l=n.finish();l&&(s.resourceTiming={},s.resourceTiming[i.source]=JSON.parse(JSON.stringify(l)))}r(null,s)}))}},bt.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},bt.prototype.reloadTile=function(t,e){var r=this.loaded;return r&&r[t.uid]?_t.prototype.reloadTile.call(this,t,e):this.loadTile(t,e)},bt.prototype.loadGeoJSON=function(e,r){if(e.request)t.getJSON(e.request,r);else{if("string"!=typeof e.data)return r(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return r(null,JSON.parse(e.data))}catch(g){return r(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}},bt.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},bt.prototype.getClusterExpansionZoom=function(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}},bt.prototype.getClusterChildren=function(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}},bt.prototype.getClusterLeaves=function(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}},bt);function bt(t,e,r,i){_t.call(this,t,e,r,yt),i&&(this.loadGeoJSON=i)}return vt.prototype.setReferrer=function(t,e){this.referrer=e},vt.prototype.setImages=function(t,e,r){for(var i in this.availableImages[t]=e,this.workerSources[t]){var n=this.workerSources[t][i];for(var o in n)n[o].availableImages=e}r()},vt.prototype.setLayers=function(t,e,r){this.getLayerIndex(t).replace(e),r()},vt.prototype.updateLayers=function(t,e,r){this.getLayerIndex(t).update(e.layers,e.removedIds),r()},vt.prototype.loadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).loadTile(e,r)},vt.prototype.loadDEMTile=function(t,e,r){this.getDEMWorkerSource(t,e.source).loadTile(e,r)},vt.prototype.reloadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).reloadTile(e,r)},vt.prototype.abortTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).abortTile(e,r)},vt.prototype.removeTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).removeTile(e,r)},vt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},vt.prototype.removeSource=function(t,e,r){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var i=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,r):r()}},vt.prototype.loadWorkerSource=function(t,e,r){try{this.self.importScripts(e.url),r()}catch(t){r(t.toString())}},vt.prototype.syncRTLPluginState=function(e,r,i){try{t.plugin.setState(r);var n=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=n){this.self.importScripts(n);var o=t.plugin.isParsed();i(o?void 0:new Error("RTL Text Plugin failed to import scripts from "+n),o)}}catch(e){i(e.toString())}},vt.prototype.getAvailableImages=function(t){var e=this.availableImages[t];return e||[]},vt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(this.layerIndexes[t]=new i)},vt.prototype.getWorkerSource=function(t,e,r){var i=this;return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][r]||(this.workerSources[t][e][r]=new this.workerSourceTypes[e]({send:function(e,r,n){i.actor.send(e,r,n,t)}},this.getLayerIndex(t),this.getAvailableImages(t))),this.workerSources[t][e][r]},vt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new c),this.demWorkerSources[t][e]},vt.prototype.enforceCacheSizeLimit=function(e,r){t.enforceCacheSizeLimit(r)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new vt(self)),vt})),r(0,(function(t){var e=t.createCommonjsModule((function(t){function e(t){return!r(t)}function r(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if("Worker"in window&&"Blob"in window&&"URL"in window){var t,e,r=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(r);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t}}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(e){var r=e.getImageData(0,0,1,1);return r&&r.width===t.width}}()?(void 0===i[r=t&&t.failIfMajorPerformanceCaveat]&&(i[r]=function(){var t,i,n,o=(t=r,i=document.createElement("canvas"),(n=Object.create(e.webGLContextAttributes)).failIfMajorPerformanceCaveat=t,i.probablySupportsContext?i.probablySupportsContext("webgl",n)||i.probablySupportsContext("experimental-webgl",n):i.supportsContext?i.supportsContext("webgl",n)||i.supportsContext("experimental-webgl",n):i.getContext("webgl",n)||i.getContext("experimental-webgl",n));if(!o)return!1;var a=o.createShader(o.VERTEX_SHADER);return!(!a||o.isContextLost())&&(o.shaderSource(a,"void main() {}"),o.compileShader(a),!0===o.getShaderParameter(a,o.COMPILE_STATUS))}()),i[r]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var r}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e,window.mapboxgl.notSupportedReason=r);var i={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),r={create:function(e,r,i){var n=t.window.document.createElement(e);return void 0!==r&&(n.className=r),i&&i.appendChild(n),n},createNS:function(e,r){return t.window.document.createElementNS(e,r)}},i=t.window.document&&t.window.document.documentElement.style;function n(t){if(!i)return t[0];for(var e=0;e<t.length;e++)if(t[e]in i)return t[e];return t[0]}var o,a=n(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);r.disableDrag=function(){i&&a&&(o=i[a],i[a]="none")},r.enableDrag=function(){i&&a&&(i[a]=o)};var s=n(["transform","WebkitTransform"]),l=!(r.setTransform=function(t,e){t.style[s]=e});try{var c=Object.defineProperty({},"passive",{get:function(){l=!0}});t.window.addEventListener("test",c,c),t.window.removeEventListener("test",c,c)}catch(t){l=!1}r.addEventListener=function(t,e,r,i){void 0===i&&(i={}),t.addEventListener(e,r,"passive"in i&&l?i:i.capture)},r.removeEventListener=function(t,e,r,i){void 0===i&&(i={}),t.removeEventListener(e,r,"passive"in i&&l?i:i.capture)};var u=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",u,!0)};r.suppressClick=function(){t.window.addEventListener("click",u,!0),t.window.setTimeout((function(){t.window.removeEventListener("click",u,!0)}),0)},r.mousePos=function(e,r){var i=e.getBoundingClientRect();return new t.Point(r.clientX-i.left-e.clientLeft,r.clientY-i.top-e.clientTop)},r.touchPos=function(e,r){for(var i=e.getBoundingClientRect(),n=[],o=0;o<r.length;o++)n.push(new t.Point(r[o].clientX-i.left-e.clientLeft,r[o].clientY-i.top-e.clientTop));return n},r.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&0<=t.window.navigator.platform.toUpperCase().indexOf("MAC")?0:e.button},r.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var p,h=((p=t.Evented)&&(g.__proto__=p),((g.prototype=Object.create(p&&p.prototype)).constructor=g).prototype.isLoaded=function(){return this.loaded},g.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t)){for(var e=0,r=this.requestors;e<r.length;e+=1){var i=r[e];this._notify(i.ids,i.callback)}this.requestors=[]}},g.prototype.getImage=function(t){return this.images[t]},g.prototype.addImage=function(t,e){this._validate(t,e)&&(this.images[t]=e)},g.prototype._validate=function(e,r){var i=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchX" value'))),i=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchY" value'))),i=!1),this._validateContent(r.content,r)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "content" value'))),i=!1),i},g.prototype._validateStretch=function(t,e){if(!t)return!0;for(var r=0,i=0,n=t;i<n.length;i+=1){var o=n[i];if(o[0]<r||o[1]<o[0]||e<o[1])return!1;r=o[1]}return!0},g.prototype._validateContent=function(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))},g.prototype.updateImage=function(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0},g.prototype.removeImage=function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()},g.prototype.listImages=function(){return Object.keys(this.images)},g.prototype.getImages=function(t,e){var r=!0;if(!this.isLoaded())for(var i=0,n=t;i<n.length;i+=1)this.images[n[i]]||(r=!1);this.isLoaded()||r?this._notify(t,e):this.requestors.push({ids:t,callback:e})},g.prototype._notify=function(e,r){for(var i={},n=0,o=e;n<o.length;n+=1){var a=o[n];this.images[a]||this.fire(new t.Event("styleimagemissing",{id:a}));var s=this.images[a];s?i[a]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:t.warnOnce('Image "'+a+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}r(null,i)},g.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},g.prototype.getPattern=function(e){var r=this.patterns[e],i=this.getImage(e);if(!i)return null;if(r&&r.position.version===i.version)return r.position;if(r)r.position.version=i.version;else{var n={w:i.data.width+2,h:i.data.height+2,x:0,y:0},o=new t.ImagePosition(n,i);this.patterns[e]={bin:n,position:o}}return this._updatePatternAtlas(),this.patterns[e].position},g.prototype.bind=function(e){var r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)},g.prototype._updatePatternAtlas=function(){var e=[];for(var r in this.patterns)e.push(this.patterns[r].bin);var i=t.potpack(e),n=i.w,o=i.h,a=this.atlasImage;for(var s in a.resize({width:n||1,height:o||1}),this.patterns){var l=this.patterns[s].bin,c=l.x+1,u=l.y+1,p=this.images[s].data,h=p.width,d=p.height;t.RGBAImage.copy(p,a,{x:0,y:0},{x:c,y:u},{width:h,height:d}),t.RGBAImage.copy(p,a,{x:0,y:d-1},{x:c,y:u-1},{width:h,height:1}),t.RGBAImage.copy(p,a,{x:0,y:0},{x:c,y:u+d},{width:h,height:1}),t.RGBAImage.copy(p,a,{x:h-1,y:0},{x:c-1,y:u},{width:1,height:d}),t.RGBAImage.copy(p,a,{x:0,y:0},{x:c+h,y:u},{width:1,height:d})}this.dirty=!0},g.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},g.prototype.dispatchRenderCallbacks=function(t){for(var e=0,r=t;e<r.length;e+=1){var i=r[e];if(!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var n=this.images[i];a=void 0,(a=(o=n).userImage)&&a.render&&a.render()&&(o.data.replace(new Uint8Array(a.data.buffer)),1)&&this.updateImage(i,n)}}var o,a},g),d=y,f=y,m=1e20;function g(){p.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}function y(t,e,r,i,n,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=n||"sans-serif",this.fontWeight=o||"normal",this.radius=r||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(0<=navigator.userAgent.indexOf("Gecko/")?1.2:1))}function v(t,e,r,i,n,o,a){for(var s=0;s<e;s++){for(var l=0;l<r;l++)i[l]=t[l*e+s];for(_(i,n,o,a,r),l=0;l<r;l++)t[l*e+s]=n[l]}for(l=0;l<r;l++){for(s=0;s<e;s++)i[s]=t[l*e+s];for(_(i,n,o,a,e),s=0;s<e;s++)t[l*e+s]=Math.sqrt(n[s])}}function _(t,e,r,i,n){i[r[0]=0]=-m,i[1]=+m;for(var o=1,a=0;o<n;o++){for(var s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);s<=i[a];)a--,s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);r[++a]=o,i[a]=s,i[a+1]=+m}for(a=o=0;o<n;o++){for(;i[a+1]<o;)a++;e[o]=(o-r[a])*(o-r[a])+t[r[a]]}}function x(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}}function b(){this.specification=t.styleSpec.light.position}function w(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}y.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),r=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var n=e.data[4*i+3]/255;this.gridOuter[i]=1==n?0:0==n?m:Math.pow(Math.max(0,.5-n),2),this.gridInner[i]=1==n?m:0==n?0:Math.pow(Math.max(0,n-.5),2)}for(v(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),v(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++)r[i]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[i]-this.gridInner[i])/this.radius+this.cutoff))));return r},d.default=f,x.prototype.setURL=function(t){this.url=t},x.prototype.getGlyphs=function(e,r){var i=this,n=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1)n.push({stack:o,id:s[a]});t.asyncAll(n,(function(t,e){var r=t.stack,n=t.id,o=i.entries[r],a=(o=o||(i.entries[r]={glyphs:{},requests:{},ranges:{}})).glyphs[n];if(void 0===a){if(a=i._tinySDF(o,r,n))return o.glyphs[n]=a,void e(null,{stack:r,id:n,glyph:a});var s=Math.floor(n/256);if(65535<256*s)e(new Error("glyphs > 65535 not supported"));else if(o.ranges[s])e(null,{stack:r,id:n,glyph:a});else{var l=o.requests[s];l||(l=o.requests[s]=[],x.loadGlyphRange(r,s,i.url,i.requestManager,(function(t,e){if(e){for(var r in e)i._doesCharSupportLocalGlyph(+r)||(o.glyphs[+r]=e[+r]);o.ranges[s]=!0}for(var n=0,a=l;n<a.length;n+=1)(0,a[n])(t,e);delete o.requests[s]}))),l.push((function(t,i){t?e(t):i&&e(null,{stack:r,id:n,glyph:i[n]||null})}))}}else e(null,{stack:r,id:n,glyph:a})}),(function(t,e){if(t)r(t);else if(e){for(var i={},n=0,o=e;n<o.length;n+=1){var a=o[n],s=a.stack,l=a.id,c=a.glyph;(i[s]||(i[s]={}))[l]=c&&{id:c.id,bitmap:c.bitmap.clone(),metrics:c.metrics}}r(null,i)}}))},x.prototype._doesCharSupportLocalGlyph=function(e){return!!this.localIdeographFontFamily&&(t.isChar["CJK Unified Ideographs"](e)||t.isChar["Hangul Syllables"](e)||t.isChar.Hiragana(e)||t.isChar.Katakana(e))},x.prototype._tinySDF=function(e,r,i){var n=this.localIdeographFontFamily;if(n&&this._doesCharSupportLocalGlyph(i)){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(r)?a="900":/medium/i.test(r)?a="500":/light/i.test(r)&&(a="200"),o=e.tinySDF=new x.TinySDF(24,3,8,.25,n,a)}return{id:i,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},x.loadGlyphRange=function(e,r,i,n,o){var a=256*r,s=255+a,l=n.transformRequest(n.normalizeGlyphsURL(i).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(l,(function(e,r){if(e)o(e);else if(r){for(var i={},n=0,a=t.parseGlyphPBF(r);n<a.length;n+=1){var s=a[n];i[s.id]=s}o(null,i)}}))},x.TinySDF=d,b.prototype.possiblyEvaluate=function(e,r){return t.sphericalToCartesian(e.expression.evaluate(r))},b.prototype.interpolate=function(e,r,i){return{x:t.number(e.x,r.x,i),y:t.number(e.y,r.y,i),z:t.number(e.z,r.z,i)}};var S,T=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new b,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),E=((S=t.Evented)&&(I.__proto__=S),((I.prototype=Object.create(S&&S.prototype)).constructor=I).prototype.getLight=function(){return this._transitionable.serialize()},I.prototype.setLight=function(e,r){if(void 0===r&&(r={}),!this._validate(t.validateLight,e,r))for(var i in e){var n=e[i];t.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-"-transition".length),n):this._transitionable.setValue(i,n)}},I.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},I.prototype.hasTransition=function(){return this._transitioning.hasTransition()},I.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},I.prototype._validate=function(e,r,i){return(!i||!1!==i.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},I);function I(e){S.call(this),this._transitionable=new t.Transitionable(T),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}function C(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var i=this.workerPool.acquire(this.id),n=0;n<i.length;n++){var o=new C.Actor(i[n],r,this.id);o.name="Worker "+n,this.actors.push(o)}}function A(e,r,i){function n(n,o){if(n)return i(n);if(o){var a=t.pick(t.extend(o,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(a.vectorLayers=o.vector_layers,a.vectorLayerIds=a.vectorLayers.map((function(t){return t.id}))),a.tiles=r.canonicalizeTileset(a,e.url),i(null,a)}}return e.url?t.getJSON(r.transformRequest(r.normalizeSourceURL(e.url),t.ResourceType.Source),n):t.browser.frame((function(){return n(null,e)}))}function k(e,r,i){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=i||24}w.prototype.getDash=function(t,e){var r=t.join(",")+String(e);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(t,e)),this.dashEntry[r]},w.prototype.getDashRanges=function(t,e,r){var i=[],n=t.length%2==1?-t[t.length-1]*r:0,o=t[0]*r,a=!0;i.push({left:n,right:o,isDash:a,zeroLength:0===t[0]});for(var s=t[0],l=1;l<t.length;l++){var c=t[l];i.push({left:n=s*r,right:o=(s+=c)*r,isDash:a=!a,zeroLength:0===c})}return i},w.prototype.addRoundDash=function(t,e,r){for(var i=e/2,n=-r;n<=r;n++)for(var o=this.width*(this.nextRow+r+n),a=0,s=t[a],l=0;l<this.width;l++){1<l/s.right&&(s=t[++a]);var c=Math.abs(l-s.left),u=Math.abs(l-s.right),p=Math.min(c,u),h=void 0,d=n/r*(1+i);if(s.isDash){var f=i-Math.abs(d);h=Math.sqrt(p*p+f*f)}else h=i-Math.sqrt(p*p+d*d);this.data[o+l]=Math.max(0,Math.min(255,h+128))}},w.prototype.addRegularDash=function(t){for(var e=t.length-1;0<=e;--e){var r=t[e],i=t[e+1];r.zeroLength?t.splice(e,1):i&&i.isDash===r.isDash&&(i.left=r.left,t.splice(e,1))}var n=t[0],o=t[t.length-1];n.isDash===o.isDash&&(n.left=o.left-this.width,o.right=n.right+this.width);for(var a=this.width*this.nextRow,s=0,l=t[s],c=0;c<this.width;c++){1<c/l.right&&(l=t[++s]);var u=Math.abs(c-l.left),p=Math.abs(c-l.right),h=Math.min(u,p);this.data[a+c]=Math.max(0,Math.min(255,(l.isDash?h:-h)+128))}},w.prototype.addDash=function(e,r){var i=r?7:0,n=2*i+1;if(this.nextRow+n>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];if(0!==o){var s=this.width/o,l=this.getDashRanges(e,this.width,s);r?this.addRoundDash(l,s,i):this.addRegularDash(l)}var c={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:o};return this.nextRow+=n,this.dirty=!0,c},w.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))},C.prototype.broadcast=function(e,r,i){t.asyncAll(this.actors,(function(t,i){t.send(e,r,i)}),i=i||function(){})},C.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},C.prototype.remove=function(){this.actors.forEach((function(t){t.remove()})),this.actors=[],this.workerPool.release(this.id)},C.Actor=t.Actor,k.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},k.prototype.contains=function(e){var r=Math.pow(2,e.z),i=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*r),n=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*r),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*r),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*r);return e.x>=i&&e.x<o&&e.y>=n&&e.y<a};var P,O,M,L,D,R,z,N=((z=t.Evented)&&($.__proto__=z),(($.prototype=Object.create(z&&z.prototype)).constructor=$).prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=A(this._options,this.map._requestManager,(function(r,i){e._tileJSONRequest=null,e._loaded=!0,r?e.fire(new t.ErrorEvent(r)):i&&(t.extend(e,i),i.bounds&&(e.tileBounds=new k(i.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(i.tiles,e.map._requestManager._customAccessToken),t.postMapLoadEvent(i.tiles,e.map._getMapId(),e.map._requestManager._skuToken,e.map._requestManager._customAccessToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},$.prototype.loaded=function(){return this._loaded},$.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},$.prototype.onAdd=function(t){this.map=t,this.load()},$.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},$.prototype.serialize=function(){return t.extend({},this._options)},$.prototype.loadTile=function(e,r){var i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),n={request:this.map._requestManager.transformRequest(i,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function o(i,n){return delete e.request,e.aborted?r(null):i&&404!==i.status?r(i):(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&n&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}n.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=r:e.request=e.actor.send("reloadTile",n,o.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",n,o.bind(this)))},$.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)},$.prototype.unloadTile=function(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)},$.prototype.hasTransition=function(){return!1},$),B=((R=t.Evented)&&(J.__proto__=R),((J.prototype=Object.create(R&&R.prototype)).constructor=J).prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=A(this._options,this.map._requestManager,(function(r,i){e._tileJSONRequest=null,e._loaded=!0,r?e.fire(new t.ErrorEvent(r)):i&&(t.extend(e,i),i.bounds&&(e.tileBounds=new k(i.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(i.tiles),t.postMapLoadEvent(i.tiles,e.map._getMapId(),e.map._requestManager._skuToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},J.prototype.loaded=function(){return this._loaded},J.prototype.onAdd=function(t){this.map=t,this.load()},J.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},J.prototype.serialize=function(){return t.extend({},this._options)},J.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},J.prototype.loadTile=function(e,r){var i=this,n=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(n,t.ResourceType.Tile),(function(n,o){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(n)e.state="errored",r(n);else if(o){i.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=i.map.painter.context,s=a.gl;e.texture=i.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.Texture(a,o,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(i.dispatcher),r(null)}}))},J.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},J.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},J.prototype.hasTransition=function(){return!1},J),F=(Y.__proto__=D=B,((Y.prototype=Object.create(D&&D.prototype)).constructor=Y).prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},Y.prototype.loadTile=function(e,r){var i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),function(i,n){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(i)e.state="errored",r(i);else if(n){this.map._refreshExpiredTiles&&e.setExpiryData(n),delete n.cacheControl,delete n.expires;var o=t.window.ImageBitmap&&n instanceof t.window.ImageBitmap&&t.offscreenCanvasSupported()?n:t.browser.getImageData(n,1),a={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:o,encoding:this.encoding};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",a,function(t,i){t&&(e.state="errored",r(t)),i&&(e.dem=i,e.needsHillshadePrepare=!0,e.state="loaded",r(null))}.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},Y.prototype._getNeighboringTiles=function(e){var r=e.canonical,i=Math.pow(2,r.z),n=(r.x-1+i)%i,o=0===r.x?e.wrap-1:e.wrap,a=(r.x+1+i)%i,s=r.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,r.z,n,r.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},0<r.y&&(l[new t.OverscaledTileID(e.overscaledZ,o,r.z,n,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1}),r.y+1<i&&(l[new t.OverscaledTileID(e.overscaledZ,o,r.z,n,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1}),l},Y.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})},Y),j=((L=t.Evented)&&(X.__proto__=L),((X.prototype=Object.create(L&&L.prototype)).constructor=X).prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(r){if(r)e.fire(new t.ErrorEvent(r));else{var i={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&0<e._resourceTiming.length&&(i.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",i))}}))},X.prototype.onAdd=function(t){this.map=t,this.load()},X.prototype.setData=function(e){var r=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(e){if(e)r.fire(new t.ErrorEvent(e));else{var i={dataType:"source",sourceDataType:"content"};r._collectResourceTiming&&r._resourceTiming&&0<r._resourceTiming.length&&(i.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new t.Event("data",i))}})),this},X.prototype.getClusterExpansionZoom=function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this},X.prototype.getClusterChildren=function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this},X.prototype.getClusterLeaves=function(t,e,r,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:r},i),this},X.prototype._updateWorkerData=function(e){var r=this;this._loaded=!1;var i=t.extend({},this.workerOptions),n=this._data;"string"==typeof n?(i.request=this.map._requestManager.transformRequest(t.browser.resolveURL(n),t.ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(n),this.actor.send(this.type+".loadData",i,(function(t,n){r._removed||n&&n.abandoned||(r._loaded=!0,n&&n.resourceTiming&&n.resourceTiming[r.id]&&(r._resourceTiming=n.resourceTiming[r.id].slice(0)),r.actor.send(r.type+".coalesce",{source:i.source},null),e(t))}))},X.prototype.loaded=function(){return this._loaded},X.prototype.loadTile=function(e,r){var i=this,n=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(n,{type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(t,o){return delete e.request,e.unloadVectorData(),e.aborted?r(null):t?r(t):(e.loadVectorData(o,i.map.painter,"reloadTile"==n),r(null))}))},X.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0},X.prototype.unloadTile=function(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})},X.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},X.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},X.prototype.hasTransition=function(){return!1},X),U=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),V=((M=t.Evented)&&(K.__proto__=M),((K.prototype=Object.create(M&&M.prototype)).constructor=K).prototype.load=function(e,r){var i=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(function(n,o){i._loaded=!0,n?i.fire(new t.ErrorEvent(n)):o&&(i.image=o,e&&(i.coordinates=e),r&&r(),i._finishLoading())}))},K.prototype.loaded=function(){return this._loaded},K.prototype.updateImage=function(t){var e=this;return this.image&&t.url&&(this.options.url=t.url,this.load(t.coordinates,(function(){e.texture=null}))),this},K.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},K.prototype.onAdd=function(t){this.map=t,this.load()},K.prototype.setCoordinates=function(e){var r=this,i=(this.coordinates=e).map(t.MercatorCoordinate.fromLngLat);this.tileID=function(){for(var e=1/0,r=1/0,n=-1/0,o=-1/0,a=0,s=i;a<s.length;a+=1){var l=s[a];e=Math.min(e,l.x),r=Math.min(r,l.y),n=Math.max(n,l.x),o=Math.max(o,l.y)}var c=Math.max(n-e,o-r),u=Math.max(0,Math.floor(-Math.log(c)/Math.LN2)),p=Math.pow(2,u);return new t.CanonicalTileID(u,Math.floor((e+n)/2*p),Math.floor((r+o)/2*p))}(),this.minzoom=this.maxzoom=this.tileID.z;var n=i.map((function(t){return r.tileID.getTilePoint(t)._round()}));return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(n[0].x,n[0].y,0,0),this._boundsArray.emplaceBack(n[1].x,n[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(n[3].x,n[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(n[2].x,n[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},K.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,r=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,U.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var n=this.tiles[i];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},K.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t).buckets={}:t.state="errored",e(null)},K.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},K.prototype.hasTransition=function(){return!1},K),q=(W.__proto__=O=V,((W.prototype=Object.create(O&&O.prototype)).constructor=W).prototype.load=function(){var e=this;this._loaded=!1;var r=this.options;this.urls=[];for(var i=0,n=r.urls;i<n.length;i+=1)this.urls.push(this.map._requestManager.transformRequest(n[i],t.ResourceType.Source).url);t.getVideo(this.urls,(function(r,i){e._loaded=!0,r?e.fire(new t.ErrorEvent(r)):i&&(e.video=i,e.video.loop=!0,e.video.addEventListener("playing",(function(){e.map.triggerRepaint()})),e.map&&e.video.play(),e._finishLoading())}))},W.prototype.pause=function(){this.video&&this.video.pause()},W.prototype.play=function(){this.video&&this.video.play()},W.prototype.seek=function(e){if(this.video){var r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+r.start(0)+" and "+r.end(0)+"-second mark."))):this.video.currentTime=e}},W.prototype.getVideo=function(){return this.video},W.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},W.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,r=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,U.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var n=this.tiles[i];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},W.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},W.prototype.hasTransition=function(){return this.video&&!this.video.paused},W),G=(H.__proto__=P=V,((H.prototype=Object.create(P&&P.prototype)).constructor=H).prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},H.prototype.getCanvas=function(){return this.canvas},H.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},H.prototype.onRemove=function(){this.pause()},H.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var r=this.map.painter.context,i=r.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,U.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(r,this.canvas,i.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[n];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},H.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},H.prototype.hasTransition=function(){return this._playing},H.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var r=e[t];if(isNaN(r)||r<=0)return!0}return!1},H),Z={vector:N,raster:B,"raster-dem":F,geojson:j,video:q,image:V,canvas:G};function H(e,r,i,n){P.call(this,e,r,i,n),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((function(t){return!Array.isArray(t)||2!==t.length||t.some((function(t){return"number"!=typeof t}))}))||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+e,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}function W(t,e,r,i){O.call(this,t,e,r,i),this.roundZoom=!0,this.type="video",this.options=e}function K(t,e,r,i){M.call(this),this.id=t,this.dispatcher=r,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=e}function X(e,r,i,n){L.call(this),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(n),this._data=r.data,this._options=t.extend({},r),this._collectResourceTiming=r.collectResourceTiming,this._resourceTiming=[],void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;var o=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*o,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*o,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?Math.min(r.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:t.EXTENT,radius:(r.clusterRadius||50)*o,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties},r.workerOptions)}function Y(e,r,i,n){D.call(this,e,r,i,n),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}function J(e,r,i,n){R.call(this),this.id=e,this.dispatcher=i,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},r),t.extend(this,t.pick(r,["url","scheme","tileSize"]))}function $(e,r,i,n){if(z.call(this),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(r,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n)}function Q(e,r,i,n,o,a){var s,l,c,u=function(t,e,r){if(t)for(var i=0,n=t;i<n.length;i+=1){var o=e[n[i]];if(o&&o.source===r&&"fill-extrusion"===o.type)return!0}else for(var a in e){var s=e[a];if(s.source===r&&"fill-extrusion"===s.type)return!0}return!1}(o&&o.layers,r,e.id),p=a.maxPitchScaleFactor(),h=e.tilesIn(n,p,u);h.sort(tt);for(var d=[],f=0,m=h;f<m.length;f+=1){var g=m[f];d.push({wrappedTileID:g.tileID.wrapped().key,queryResults:g.tile.queryRenderedFeatures(r,i,e._state,g.queryGeometry,g.cameraQueryGeometry,g.scale,o,a,p,(s=e.transform,l=g.tileID,c=t.identity([]),t.translate(c,c,[1,1,0]),t.scale(c,c,[.5*s.width,.5*s.height,1]),t.multiply(c,c,s.calculatePosMatrix(l.toUnwrapped()))))})}var y=function(){for(var t={},e={},r=0,i=d;r<i.length;r+=1){var n=i[r],o=n.queryResults,a=n.wrappedTileID,s=e[a]=e[a]||{};for(var l in o)for(var c=o[l],u=s[l]=s[l]||{},p=t[l]=t[l]||[],h=0,f=c;h<f.length;h+=1){var m=f[h];u[m.featureIndex]||(u[m.featureIndex]=!0,p.push(m))}}return t}();for(var v in y)y[v].forEach((function(t){var r=t.feature,i=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=i}));return y}function tt(t,e){var r=t.tileID,i=e.tileID;return r.overscaledZ-i.overscaledZ||r.canonical.y-i.canonical.y||r.wrap-i.wrap||r.canonical.x-i.canonical.x}function et(t,e){this.max=t,this.onRemove=e,this.reset()}function rt(t,e,r){var i=(this.context=t).gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}function it(t,e,r,i){this.length=e.length,this.attributes=r,this.itemSize=e.bytesPerElement,this.dynamicDraw=i;var n=(this.context=t).gl;this.buffer=n.createBuffer(),t.bindVertexBuffer.set(this.buffer),n.bufferData(n.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}et.prototype.reset=function(){for(var t in this.data)for(var e=0,r=this.data[t];e<r.length;e+=1){var i=r[e];i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value)}return this.data={},this.order=[],this},et.prototype.add=function(t,e,r){var i=this,n=t.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);var o={value:e,timeout:void 0};if(void 0!==r&&(o.timeout=setTimeout((function(){i.remove(t,o)}),r)),this.data[n].push(o),this.order.push(n),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},et.prototype.has=function(t){return t.wrapped().key in this.data},et.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},et.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},et.prototype.getByKey=function(t){var e=this.data[t];return e?e[0].value:null},et.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},et.prototype.remove=function(t,e){if(!this.has(t))return this;var r=t.wrapped().key,i=void 0===e?0:this.data[r].indexOf(e),n=this.data[r][i];return this.data[r].splice(i,1),n.timeout&&clearTimeout(n.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(n.value),this.order.splice(this.order.indexOf(r),1),this},et.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this},et.prototype.filter=function(t){var e=[];for(var r in this.data)for(var i=0,n=this.data[r];i<n.length;i+=1){var o=n[i];t(o.value)||e.push(o)}for(var a=0,s=e;a<s.length;a+=1){var l=s[a];this.remove(l.value.tileID,l)}},rt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},rt.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},rt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var nt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};function ot(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}function at(t,e,r,i){this.context=t,this.width=e,this.height=r;var n=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new _e(t,n),i&&(this.depthAttachment=new xe(t,n))}it.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},it.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},it.prototype.enableAttributes=function(t,e){for(var r=0;r<this.attributes.length;r++){var i=e.attributes[this.attributes[r].name];void 0!==i&&t.enableVertexAttribArray(i)}},it.prototype.setVertexAttribPointers=function(t,e,r){for(var i=0;i<this.attributes.length;i++){var n=this.attributes[i],o=e.attributes[n.name];void 0!==o&&t.vertexAttribPointer(o,n.components,t[nt[n.type]],!1,this.itemSize,n.offset+this.itemSize*(r||0))}},it.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)},ot.prototype.get=function(){return this.current},ot.prototype.set=function(t){},ot.prototype.getDefault=function(){return this.default},ot.prototype.setDefault=function(){this.set(this.default)};var st,lt,ct,ut,pt,ht,dt,ft,mt,gt,yt,vt,_t,xt,bt,wt,St,Tt,Et,It,Ct,At,kt,Pt,Ot,Mt,Lt,Dt,Rt,zt,Nt,Bt,Ft,jt,Ut=(tr.__proto__=jt=ot,((tr.prototype=Object.create(jt&&jt.prototype)).constructor=tr).prototype.getDefault=function(){return t.Color.transparent},tr.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!this.dirty||(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},tr),Vt=(Qe.__proto__=Ft=ot,((Qe.prototype=Object.create(Ft&&Ft.prototype)).constructor=Qe).prototype.getDefault=function(){return 1},Qe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},Qe),qt=($e.__proto__=Bt=ot,(($e.prototype=Object.create(Bt&&Bt.prototype)).constructor=$e).prototype.getDefault=function(){return 0},$e.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},$e),Gt=(Je.__proto__=Nt=ot,((Je.prototype=Object.create(Nt&&Nt.prototype)).constructor=Je).prototype.getDefault=function(){return[!0,!0,!0,!0]},Je.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!this.dirty||(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},Je),Zt=(Ye.__proto__=zt=ot,((Ye.prototype=Object.create(zt&&zt.prototype)).constructor=Ye).prototype.getDefault=function(){return!0},Ye.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.depthMask(t),this.current=t,this.dirty=!1)},Ye),Ht=(Xe.__proto__=Rt=ot,((Xe.prototype=Object.create(Rt&&Rt.prototype)).constructor=Xe).prototype.getDefault=function(){return 255},Xe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},Xe),Wt=(Ke.__proto__=Dt=ot,((Ke.prototype=Object.create(Dt&&Dt.prototype)).constructor=Ke).prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},Ke.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask&&!this.dirty||(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},Ke),Kt=(We.__proto__=Lt=ot,((We.prototype=Object.create(Lt&&Lt.prototype)).constructor=We).prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},We.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&!this.dirty||(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},We),Xt=(He.__proto__=Mt=ot,((He.prototype=Object.create(Mt&&Mt.prototype)).constructor=He).prototype.getDefault=function(){return!1},He.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},He),Yt=(Ze.__proto__=Ot=ot,((Ze.prototype=Object.create(Ot&&Ot.prototype)).constructor=Ze).prototype.getDefault=function(){return[0,1]},Ze.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!this.dirty||(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},Ze),Jt=(Ge.__proto__=Pt=ot,((Ge.prototype=Object.create(Pt&&Pt.prototype)).constructor=Ge).prototype.getDefault=function(){return!1},Ge.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},Ge),$t=(qe.__proto__=kt=ot,((qe.prototype=Object.create(kt&&kt.prototype)).constructor=qe).prototype.getDefault=function(){return this.gl.LESS},qe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},qe),Qt=(Ve.__proto__=At=ot,((Ve.prototype=Object.create(At&&At.prototype)).constructor=Ve).prototype.getDefault=function(){return!1},Ve.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},Ve),te=(Ue.__proto__=Ct=ot,((Ue.prototype=Object.create(Ct&&Ct.prototype)).constructor=Ue).prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},Ue.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!this.dirty||(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},Ue),ee=(je.__proto__=It=ot,((je.prototype=Object.create(It&&It.prototype)).constructor=je).prototype.getDefault=function(){return t.Color.transparent},je.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!this.dirty||(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},je),re=(Fe.__proto__=Et=ot,((Fe.prototype=Object.create(Et&&Et.prototype)).constructor=Fe).prototype.getDefault=function(){return this.gl.FUNC_ADD},Fe.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},Fe),ie=(Be.__proto__=Tt=ot,((Be.prototype=Object.create(Tt&&Tt.prototype)).constructor=Be).prototype.getDefault=function(){return!1},Be.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},Be),ne=(Ne.__proto__=St=ot,((Ne.prototype=Object.create(St&&St.prototype)).constructor=Ne).prototype.getDefault=function(){return this.gl.BACK},Ne.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.cullFace(t),this.current=t,this.dirty=!1)},Ne),oe=(ze.__proto__=wt=ot,((ze.prototype=Object.create(wt&&wt.prototype)).constructor=ze).prototype.getDefault=function(){return this.gl.CCW},ze.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.frontFace(t),this.current=t,this.dirty=!1)},ze),ae=(Re.__proto__=bt=ot,((Re.prototype=Object.create(bt&&bt.prototype)).constructor=Re).prototype.getDefault=function(){return null},Re.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.useProgram(t),this.current=t,this.dirty=!1)},Re),se=(De.__proto__=xt=ot,((De.prototype=Object.create(xt&&xt.prototype)).constructor=De).prototype.getDefault=function(){return this.gl.TEXTURE0},De.prototype.set=function(t){t===this.current&&!this.dirty||(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},De),le=(Le.__proto__=_t=ot,((Le.prototype=Object.create(_t&&_t.prototype)).constructor=Le).prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},Le.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!this.dirty||(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},Le),ce=(Me.__proto__=vt=ot,((Me.prototype=Object.create(vt&&vt.prototype)).constructor=Me).prototype.getDefault=function(){return null},Me.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},Me),ue=(Oe.__proto__=yt=ot,((Oe.prototype=Object.create(yt&&yt.prototype)).constructor=Oe).prototype.getDefault=function(){return null},Oe.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},Oe),pe=(Pe.__proto__=gt=ot,((Pe.prototype=Object.create(gt&&gt.prototype)).constructor=Pe).prototype.getDefault=function(){return null},Pe.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},Pe),he=(ke.__proto__=mt=ot,((ke.prototype=Object.create(mt&&mt.prototype)).constructor=ke).prototype.getDefault=function(){return null},ke.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},ke),de=(Ae.__proto__=ft=ot,((Ae.prototype=Object.create(ft&&ft.prototype)).constructor=Ae).prototype.getDefault=function(){return null},Ae.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},Ae),fe=(Ce.__proto__=dt=ot,((Ce.prototype=Object.create(dt&&dt.prototype)).constructor=Ce).prototype.getDefault=function(){return null},Ce.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},Ce),me=(Ie.__proto__=ht=ot,((Ie.prototype=Object.create(ht&&ht.prototype)).constructor=Ie).prototype.getDefault=function(){return 4},Ie.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},Ie),ge=(Ee.__proto__=pt=ot,((Ee.prototype=Object.create(pt&&pt.prototype)).constructor=Ee).prototype.getDefault=function(){return!1},Ee.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},Ee),ye=(Te.__proto__=ut=ot,((Te.prototype=Object.create(ut&&ut.prototype)).constructor=Te).prototype.getDefault=function(){return!1},Te.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},Te),ve=(Se.__proto__=ct=ot,((Se.prototype=Object.create(ct&&ct.prototype)).constructor=Se).prototype.getDefault=function(){return null},Se),_e=(we.__proto__=lt=ve,((we.prototype=Object.create(lt&&lt.prototype)).constructor=we).prototype.setDirty=function(){this.dirty=!0},we.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},we),xe=(be.__proto__=st=ve,((be.prototype=Object.create(st&&st.prototype)).constructor=be).prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},be);function be(){st.apply(this,arguments)}function we(){lt.apply(this,arguments)}function Se(t,e){ct.call(this,t),this.context=t,this.parent=e}function Te(){ut.apply(this,arguments)}function Ee(){pt.apply(this,arguments)}function Ie(){ht.apply(this,arguments)}function Ce(t){dt.call(this,t),this.vao=t.extVertexArrayObject}function Ae(){ft.apply(this,arguments)}function ke(){mt.apply(this,arguments)}function Pe(){gt.apply(this,arguments)}function Oe(){yt.apply(this,arguments)}function Me(){vt.apply(this,arguments)}function Le(){_t.apply(this,arguments)}function De(){xt.apply(this,arguments)}function Re(){bt.apply(this,arguments)}function ze(){wt.apply(this,arguments)}function Ne(){St.apply(this,arguments)}function Be(){Tt.apply(this,arguments)}function Fe(){Et.apply(this,arguments)}function je(){It.apply(this,arguments)}function Ue(){Ct.apply(this,arguments)}function Ve(){At.apply(this,arguments)}function qe(){kt.apply(this,arguments)}function Ge(){Pt.apply(this,arguments)}function Ze(){Ot.apply(this,arguments)}function He(){Mt.apply(this,arguments)}function We(){Lt.apply(this,arguments)}function Ke(){Dt.apply(this,arguments)}function Xe(){Rt.apply(this,arguments)}function Ye(){zt.apply(this,arguments)}function Je(){Nt.apply(this,arguments)}function $e(){Bt.apply(this,arguments)}function Qe(){Ft.apply(this,arguments)}function tr(){jt.apply(this,arguments)}at.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){var r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r)}t.deleteFramebuffer(this.framebuffer)};var er=function(t,e,r){this.func=t,this.mask=e,this.range=r};er.ReadOnly=!1,er.ReadWrite=!0,er.disabled=new er(519,er.ReadOnly,[0,1]);var rr=function(t,e,r,i,n,o){this.test=t,this.ref=e,this.mask=r,this.fail=i,this.depthFail=n,this.pass=o};rr.disabled=new rr({func:519,mask:0},0,0,7680,7680,7680);var ir=function(t,e,r){this.blendFunction=t,this.blendColor=e,this.mask=r};ir.disabled=new ir(ir.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),ir.unblended=new ir(ir.Replace,t.Color.transparent,[!0,!0,!0,!0]),ir.alphaBlended=new ir([1,771],t.Color.transparent,[!0,!0,!0,!0]);var nr=function(t,e,r){this.enable=t,this.mode=e,this.frontFace=r};function or(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ut(this),this.clearDepth=new Vt(this),this.clearStencil=new qt(this),this.colorMask=new Gt(this),this.depthMask=new Zt(this),this.stencilMask=new Ht(this),this.stencilFunc=new Wt(this),this.stencilOp=new Kt(this),this.stencilTest=new Xt(this),this.depthRange=new Yt(this),this.depthTest=new Jt(this),this.depthFunc=new $t(this),this.blend=new Qt(this),this.blendFunc=new te(this),this.blendColor=new ee(this),this.blendEquation=new re(this),this.cullFace=new ie(this),this.cullFaceSide=new ne(this),this.frontFace=new oe(this),this.program=new ae(this),this.activeTexture=new se(this),this.viewport=new le(this),this.bindFramebuffer=new ce(this),this.bindRenderbuffer=new ue(this),this.bindTexture=new pe(this),this.bindVertexBuffer=new he(this),this.bindElementBuffer=new de(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new fe(this),this.pixelStoreUnpack=new me(this),this.pixelStoreUnpackPremultiplyAlpha=new ge(this),this.pixelStoreUnpackFlipY=new ye(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query")}nr.disabled=new nr(!1,1029,2305),nr.backCCW=new nr(!0,1029,2305),or.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},or.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},or.prototype.createIndexBuffer=function(t,e){return new rt(this,t,e)},or.prototype.createVertexBuffer=function(t,e,r){return new it(this,t,e,r)},or.prototype.createRenderbuffer=function(t,e,r){var i=this.gl,n=i.createRenderbuffer();return this.bindRenderbuffer.set(n),i.renderbufferStorage(i.RENDERBUFFER,t,e,r),this.bindRenderbuffer.set(null),n},or.prototype.createFramebuffer=function(t,e,r){return new at(this,t,e,r)},or.prototype.clear=function(t){var e=t.color,r=t.depth,i=this.gl,n=0;e&&(n|=i.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(n|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),i.clear(n)},or.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},or.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},or.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},or.prototype.setColorMode=function(e){t.deepEqual(e.blendFunction,ir.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},or.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ar,sr=((ar=t.Evented)&&(lr.__proto__=ar),((lr.prototype=Object.create(ar&&ar.prototype)).constructor=lr).prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},lr.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},lr.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},lr.prototype.getSource=function(){return this._source},lr.prototype.pause=function(){this._paused=!0},lr.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},lr.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},lr.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,(function(){}))},lr.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,(function(){}))},lr.prototype.serialize=function(){return this._source.serialize()},lr.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var r=this._tiles[e];r.upload(t),r.prepare(this.map.style.imageManager)}},lr.prototype.getIds=function(){return t.values(this._tiles).map((function(t){return t.tileID})).sort(cr).map((function(t){return t.key}))},lr.prototype.getRenderableIds=function(e){var r=this,i=[];for(var n in this._tiles)this._isIdRenderable(n,e)&&i.push(this._tiles[n]);return e?i.sort((function(e,i){var n=e.tileID,o=i.tileID,a=new t.Point(n.canonical.x,n.canonical.y)._rotate(r.transform.angle),s=new t.Point(o.canonical.x,o.canonical.y)._rotate(r.transform.angle);return n.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})).map((function(t){return t.tileID.key})):i.map((function(t){return t.tileID})).sort(cr).map((function(t){return t.key}))},lr.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},lr.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},lr.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},lr.prototype._reloadTile=function(t,e){var r=this._tiles[t];r&&("loading"!==r.state&&(r.state=e),this._loadTile(r,this._tileLoaded.bind(this,r,t,e)))},lr.prototype._tileLoaded=function(e,r,i,n){if(n)return e.state="errored",void(404!==n.status?this._source.fire(new t.ErrorEvent(n,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},lr.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),r=0;r<e.length;r++){var i=e[r];if(t.neighboringTiles&&t.neighboringTiles[i]){var n=this.getTileByID(i);o(t,n),o(n,t)}}function o(t,e){t.needsHillshadePrepare=!0;var r=e.tileID.canonical.x-t.tileID.canonical.x,i=e.tileID.canonical.y-t.tileID.canonical.y,n=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===r&&0==i||1<Math.abs(i)||(1<Math.abs(r)&&(1===Math.abs(r+n)?r+=n:1===Math.abs(r-n)&&(r-=n)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,r,i),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},lr.prototype.getTile=function(t){return this.getTileByID(t.key)},lr.prototype.getTileByID=function(t){return this._tiles[t]},lr.prototype._retainLoadedChildren=function(t,e,r,i){for(var n in this._tiles){var o=this._tiles[n];if(!(i[n]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>r)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var l=a;l.overscaledZ>e;)if(t[(l=l.scaledTo(l.overscaledZ-1)).key]){i[a.key]=a;break}}}},lr.prototype.findLoadedParent=function(t,e){if(t.key in this._loadedParentTiles){var r=this._loadedParentTiles[t.key];return r&&r.tileID.overscaledZ>=e?r:null}for(var i=t.overscaledZ-1;e<=i;i--){var n=t.scaledTo(i),o=this._getLoadedTile(n);if(o)return o}},lr.prototype._getLoadedTile=function(t){var e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)},lr.prototype.updateCacheSize=function(t){var e=Math.ceil(t.width/this._source.tileSize)+1,r=Math.ceil(t.height/this._source.tileSize)+1,i=Math.floor(e*r*5),n="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(n)},lr.prototype.handleWrapJump=function(t){var e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){var r={};for(var i in this._tiles){var n=this._tiles[i];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),r[n.tileID.key]=n}for(var o in this._tiles=r,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}},lr.prototype.update=function(e){var r=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(i=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter((function(t){return r._source.hasTile(t)})))):i=[];var n=e.coveringZoomLevel(this._source),o=Math.max(n-lr.maxOverzooming,this._source.minzoom),a=Math.max(n+lr.maxUnderzooming,this._source.minzoom),s=this._updateRetainedTiles(i,n);if(ur(this._source.type)){for(var l={},c={},u=0,p=Object.keys(s);u<p.length;u+=1){var h=p[u],d=s[h],f=this._tiles[h];if(f&&!(f.fadeEndTime&&f.fadeEndTime<=t.browser.now())){var m=this.findLoadedParent(d,o);m&&(this._addTile(m.tileID),l[m.tileID.key]=m.tileID),c[h]=d}}for(var g in this._retainLoadedChildren(c,n,a,s),l)s[g]||(this._coveredTiles[g]=!0,s[g]=l[g])}for(var y in s)this._tiles[y].clearFadeHold();for(var v=0,_=t.keysDifference(this._tiles,s);v<_.length;v+=1){var x=_[v],b=this._tiles[x];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(x)}this._updateLoadedParentTileCache()}},lr.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},lr.prototype._updateRetainedTiles=function(t,e){for(var r={},i={},n=Math.max(e-lr.maxOverzooming,this._source.minzoom),o=Math.max(e+lr.maxUnderzooming,this._source.minzoom),a={},s=0,l=t;s<l.length;s+=1){var c=l[s],u=this._addTile(c);r[c.key]=c,u.hasData()||e<this._source.maxzoom&&(a[c.key]=c)}this._retainLoadedChildren(a,e,o,r);for(var p=0,h=t;p<h.length;p+=1){var d=h[p],f=this._tiles[d.key];if(!f.hasData()){if(e+1>this._source.maxzoom){var m=d.children(this._source.maxzoom)[0],g=this.getTile(m);if(g&&g.hasData()){r[m.key]=m;continue}}else{var y=d.children(this._source.maxzoom);if(r[y[0].key]&&r[y[1].key]&&r[y[2].key]&&r[y[3].key])continue}for(var v=f.wasRequested(),_=d.overscaledZ-1;n<=_;--_){var x=d.scaledTo(_);if(i[x.key])break;if(i[x.key]=!0,!(f=this.getTile(x))&&v&&(f=this._addTile(x)),f&&(r[x.key]=x,v=f.wasRequested(),f.hasData()))break}}}return r},lr.prototype._updateLoadedParentTileCache=function(){for(var t in this._loadedParentTiles={},this._tiles){for(var e=[],r=void 0,i=this._tiles[t].tileID;0<i.overscaledZ;){if(i.key in this._loadedParentTiles){r=this._loadedParentTiles[i.key];break}e.push(i.key);var n=i.scaledTo(i.overscaledZ-1);if(r=this._getLoadedTile(n))break;i=n}for(var o=0,a=e;o<a.length;o+=1)this._loadedParentTiles[a[o]]=r}},lr.prototype._addTile=function(e){var r=this._tiles[e.key];if(r)return r;(r=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));var i=Boolean(r);return i||(r=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))),r?(r.uses++,this._tiles[e.key]=r,i||this._source.fire(new t.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null},lr.prototype._setTileReloadTimer=function(t,e){var r=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout((function(){r._reloadTile(t,"expired"),delete r._timers[t]}),i))},lr.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),0<e.uses||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},lr.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},lr.prototype.tilesIn=function(e,r,i){var n=this,o=[],a=this.transform;if(!a)return o;for(var s=i?a.getCameraQueryGeometry(e):e,l=e.map((function(t){return a.pointCoordinate(t)})),c=s.map((function(t){return a.pointCoordinate(t)})),u=this.getIds(),p=1/0,h=1/0,d=-1/0,f=-1/0,m=0,g=c;m<g.length;m+=1){var y=g[m];p=Math.min(p,y.x),h=Math.min(h,y.y),d=Math.max(d,y.x),f=Math.max(f,y.y)}for(var v=function(e){var i=n._tiles[u[e]];if(!i.holdingForFade()){var s=i.tileID,m=Math.pow(2,a.zoom-i.tileID.overscaledZ),g=r*i.queryPadding*t.EXTENT/i.tileSize/m,y=[s.getTilePoint(new t.MercatorCoordinate(p,h)),s.getTilePoint(new t.MercatorCoordinate(d,f))];if(y[0].x-g<t.EXTENT&&y[0].y-g<t.EXTENT&&0<=y[1].x+g&&0<=y[1].y+g){var v=l.map((function(t){return s.getTilePoint(t)})),_=c.map((function(t){return s.getTilePoint(t)}));o.push({tile:i,tileID:s,queryGeometry:v,cameraQueryGeometry:_,scale:m})}}},_=0;_<u.length;_++)v(_);return o},lr.prototype.getVisibleCoordinates=function(t){for(var e=this,r=this.getRenderableIds(t).map((function(t){return e._tiles[t].tileID})),i=0,n=r;i<n.length;i+=1){var o=n[i];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return r},lr.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ur(this._source.type))for(var e in this._tiles){var r=this._tiles[e];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=t.browser.now())return!0}return!1},lr.prototype.setFeatureState=function(t,e,r){this._state.updateState(t=t||"_geojsonTileLayer",e,r)},lr.prototype.removeFeatureState=function(t,e,r){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,r)},lr.prototype.getFeatureState=function(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)},lr.prototype.setDependencies=function(t,e,r){var i=this._tiles[t];i&&i.setDependencies(e,r)},lr.prototype.reloadTilesForDependencies=function(t,e){for(var r in this._tiles)this._tiles[r].hasDependency(t,e)&&this._reloadTile(r,"reloading");this._cache.filter((function(r){return!r.hasDependency(t,e)}))},lr);function lr(e,r,i){var n=this;ar.call(this),this.id=e,this.dispatcher=i,this.on("data",(function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(n._sourceLoaded=!0),n._sourceLoaded&&!n._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(n.reload(),n.transform&&n.update(n.transform))})),this.on("error",(function(){n._sourceErrored=!0})),this._source=function(e,i,n){var o=new Z[r.type](e,r,i,n);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o}(e,i,this),this._tiles={},this._cache=new et(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new t.SourceFeatureState}function cr(t,e){var r=Math.abs(2*t.wrap)-(t.wrap<0),i=Math.abs(2*e.wrap)-(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-r||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function ur(t){return"raster"===t||"image"===t||"video"===t}function pr(){return new t.window.Worker(La.workerUrl)}sr.maxOverzooming=10,sr.maxUnderzooming=3;var hr="mapboxgl_preloaded_worker_pool",dr=function(){this.active={}};dr.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<dr.workerCount;)this.workers.push(new pr);return this.active[t]=!0,this.workers.slice()},dr.prototype.release=function(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((function(t){t.terminate()})),this.workers=null)},dr.prototype.isPreloaded=function(){return!!this.active[hr]},dr.prototype.numActive=function(){return Object.keys(this.active).length};var fr,mr=Math.floor(t.browser.hardwareConcurrency/2);function gr(){return fr=fr||new dr}function yr(e,r){var i={};for(var n in e)"ref"!==n&&(i[n]=e[n]);return t.refProperties.forEach((function(t){t in r&&(i[t]=r[t])})),i}function vr(t){t=t.slice();for(var e=Object.create(null),r=0;r<t.length;r++)e[t[r].id]=t[r];for(var i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=yr(t[i],e[t[i].ref]));return t}dr.workerCount=Math.max(Math.min(mr,6),1);var _r={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function xr(t,e,r){r.push({command:_r.addSource,args:[t,e[t]]})}function br(t,e,r){e.push({command:_r.removeSource,args:[t]}),r[t]=!0}function wr(e,r,i){var n;for(n in e[i])if(e[i].hasOwnProperty(n)&&"data"!==n&&!t.deepEqual(e[i][n],r[i][n]))return;for(n in r[i])if(r[i].hasOwnProperty(n)&&"data"!==n&&!t.deepEqual(e[i][n],r[i][n]))return;return 1}function Sr(e,r,i,n,o,a){var s;for(s in r=r||{},e=e||{})e.hasOwnProperty(s)&&(t.deepEqual(e[s],r[s])||i.push({command:a,args:[n,s,r[s],o]}));for(s in r)r.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.deepEqual(e[s],r[s])||i.push({command:a,args:[n,s,r[s],o]}))}function Tr(t){return t.id}function Er(t,e){return t[e.id]=e,t}function Ir(t,e){this.reset(t,e)}function Cr(t,e,r){var i=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(t/r),this.yCellCount=Math.ceil(e/r);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}function Ar(e,r,i,n,o){var a=t.create();return r?(t.scale(a,a,[1/o,1/o,1]),i||t.rotateZ(a,a,n.angle)):t.multiply(a,n.labelPlaneMatrix,e),a}function kr(e,r,i,n,o){if(r){var a=t.clone(e);return t.scale(a,a,[o,o,1]),i||t.rotateZ(a,a,-n.angle),a}return n.glCoordMatrix}function Pr(e,r){var i=[e.x,e.y,0,1];jr(i,i,r);var n=i[3];return{point:new t.Point(i[0]/n,i[1]/n),signedDistanceFromCamera:n}}function Or(t,e){return.5+t/e*.5}function Mr(e,r,i,n,o,a,s,l){var c,u,p,h,d=n?e.textSizeData:e.iconSizeData,f=t.evaluateSizeForZoom(d,i.transform.zoom),m=[256/i.width*2+1,256/i.height*2+1],g=n?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;g.clear();for(var y=e.lineVertexArray,v=n?e.text.placedSymbolArray:e.icon.placedSymbolArray,_=i.transform.width/i.transform.height,x=!1,b=0;b<v.length;b++){var w=v.get(b);if(w.hidden||w.writingMode===t.WritingMode.vertical&&!x)Fr(w.numGlyphs,g);else{x=!1;var S=[w.anchorX,w.anchorY,0,1];if(t.transformMat4(S,S,r),u=m,p=(c=S)[0]/c[3],h=c[1]/c[3],p>=-u[0]&&p<=u[0]&&h>=-u[1]&&h<=u[1]){var T=Or(i.transform.cameraToCenterDistance,S[3]),E=t.evaluateSizeForFeature(d,f,w),I=s?E/T:E*T,C=new t.Point(w.anchorX,w.anchorY),A=Pr(C,o).point,k={},P=Rr(w,I,!1,l,r,o,a,e.glyphOffsetArray,y,g,A,C,k,_);x=P.useVertical,(P.notEnoughRoom||x||P.needsFlipping&&Rr(w,I,!0,l,r,o,a,e.glyphOffsetArray,y,g,A,C,k,_).notEnoughRoom)&&Fr(w.numGlyphs,g)}else Fr(w.numGlyphs,g)}}n?e.text.dynamicLayoutVertexBuffer.updateData(g):e.icon.dynamicLayoutVertexBuffer.updateData(g)}function Lr(t,e,r,i,n,o,a,s,l,c,u){var p=s.glyphStartIndex+s.numGlyphs,h=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,f=e.getoffsetX(s.glyphStartIndex),m=e.getoffsetX(p-1),g=Nr(t*f,r,i,n,o,a,s.segment,h,d,l,c,u);if(!g)return null;var y=Nr(t*m,r,i,n,o,a,s.segment,h,d,l,c,u);return y?{first:g,last:y}:null}function Dr(e,r,i,n){return e===t.WritingMode.horizontal&&Math.abs(i.y-r.y)>Math.abs(i.x-r.x)*n?{useVertical:!0}:(e===t.WritingMode.vertical?r.y<i.y:r.x>i.x)?{needsFlipping:!0}:null}function Rr(e,r,i,n,o,a,s,l,c,u,p,h,d,f){var m,g=r/24,y=e.lineOffsetX*g,v=e.lineOffsetY*g;if(1<e.numGlyphs){var _=e.glyphStartIndex+e.numGlyphs,x=e.lineStartIndex,b=e.lineStartIndex+e.lineLength,w=Lr(g,l,y,v,i,p,h,e,c,a,d);if(!w)return{notEnoughRoom:!0};var S=Pr(w.first.point,s).point,T=Pr(w.last.point,s).point;if(n&&!i){var E=Dr(e.writingMode,S,T,f);if(E)return E}m=[w.first];for(var I=e.glyphStartIndex+1;I<_-1;I++)m.push(Nr(g*l.getoffsetX(I),y,v,i,p,h,e.segment,x,b,c,a,d));m.push(w.last)}else{if(n&&!i){var C=Pr(h,o).point,A=e.lineStartIndex+e.segment+1,k=new t.Point(c.getx(A),c.gety(A)),P=Pr(k,o),O=0<P.signedDistanceFromCamera?P.point:zr(h,k,C,1,o),M=Dr(e.writingMode,C,O,f);if(M)return M}var L=Nr(g*l.getoffsetX(e.glyphStartIndex),y,v,i,p,h,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,a,d);if(!L)return{notEnoughRoom:!0};m=[L]}for(var D=0,R=m;D<R.length;D+=1){var z=R[D];t.addDynamicAttributes(u,z.point,z.angle)}return{}}function zr(t,e,r,i,n){var o=Pr(t.add(t.sub(e)._unit()),n).point,a=r.sub(o);return r.add(a._mult(i/a.mag()))}function Nr(e,r,i,n,o,a,s,l,c,u,p,h){var d=n?e-r:e+r,f=0<d?1:-1,m=0;n&&(f*=-1,m=Math.PI),f<0&&(m+=Math.PI);for(var g=0<f?l+s:l+s+1,y=o,v=o,_=0,x=0,b=Math.abs(d),w=[];_+x<=b;){if((g+=f)<l||c<=g)return null;if(v=y,w.push(y),void 0===(y=h[g])){var S=new t.Point(u.getx(g),u.gety(g)),T=Pr(S,p);if(0<T.signedDistanceFromCamera)y=h[g]=T.point;else{var E=g-f;y=zr(0===_?a:new t.Point(u.getx(E),u.gety(E)),S,v,b-_+1,p)}}_+=x,x=v.dist(y)}var I=(b-_)/x,C=y.sub(v),A=C.mult(I)._add(v);A._add(C._unit()._perp()._mult(i*f));var k=m+Math.atan2(y.y-v.y,y.x-v.x);return w.push(A),{point:A,angle:k,path:w}}Ir.prototype.reset=function(t,e){this.points=t||[],this._distances=[0];for(var r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ir.prototype.lerp=function(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);for(var r=1,i=this._distances[r],n=e*this.paddedLength+this.padding;i<n&&r<this._distances.length;)i=this._distances[++r];var o=r-1,a=this._distances[o],s=i-a,l=0<s?(n-a)/s:0;return this.points[o].mult(1-l).add(this.points[r].mult(l))},Cr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Cr.prototype.insert=function(t,e,r,i,n){this._forEachCell(e,r,i,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)},Cr.prototype.insertCircle=function(t,e,r,i){this._forEachCell(e-i,r-i,e+i,r+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(r),this.circles.push(i)},Cr.prototype._insertBoxCell=function(t,e,r,i,n,o){this.boxCells[n].push(o)},Cr.prototype._insertCircleCell=function(t,e,r,i,n,o){this.circleCells[n].push(o)},Cr.prototype._query=function(t,e,r,i,n,o){if(r<0||t>this.width||i<0||e>this.height)return!n&&[];var a=[];if(t<=0&&e<=0&&this.width<=r&&this.height<=i){if(n)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var c=this.circles[3*l],u=this.circles[3*l+1],p=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:c-p,y1:u-p,x2:c+p,y2:u+p})}return o?a.filter(o):a}return this._forEachCell(t,e,r,i,this._queryCell,a,{hitTest:n,seenUids:{box:{},circle:{}}},o),n?0<a.length:a},Cr.prototype._queryCircle=function(t,e,r,i,n){var o=t-r,a=t+r,s=e-r,l=e+r;if(a<0||o>this.width||l<0||s>this.height)return!i&&[];var c=[];return this._forEachCell(o,s,a,l,this._queryCellCircle,c,{hitTest:i,circle:{x:t,y:e,radius:r},seenUids:{box:{},circle:{}}},n),i?0<c.length:c},Cr.prototype.query=function(t,e,r,i,n){return this._query(t,e,r,i,!1,n)},Cr.prototype.hitTest=function(t,e,r,i,n){return this._query(t,e,r,i,!0,n)},Cr.prototype.hitTestCircle=function(t,e,r,i){return this._queryCircle(t,e,r,!0,i)},Cr.prototype._queryCell=function(t,e,r,i,n,o,a,s){var l=a.seenUids,c=this.boxCells[n];if(null!==c)for(var u=this.bboxes,p=0,h=c;p<h.length;p+=1){var d=h[p];if(!l.box[d]){l.box[d]=!0;var f=4*d;if(t<=u[2+f]&&e<=u[3+f]&&r>=u[0+f]&&i>=u[1+f]&&(!s||s(this.boxKeys[d]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:u[f],y1:u[1+f],x2:u[2+f],y2:u[3+f]})}}}var m=this.circleCells[n];if(null!==m)for(var g=this.circles,y=0,v=m;y<v.length;y+=1){var _=v[y];if(!l.circle[_]){l.circle[_]=!0;var x=3*_;if(this._circleAndRectCollide(g[x],g[1+x],g[2+x],t,e,r,i)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var b=g[x],w=g[1+x],S=g[2+x];o.push({key:this.circleKeys[_],x1:b-S,y1:w-S,x2:b+S,y2:w+S})}}}},Cr.prototype._queryCellCircle=function(t,e,r,i,n,o,a,s){var l=a.circle,c=a.seenUids,u=this.boxCells[n];if(null!==u)for(var p=this.bboxes,h=0,d=u;h<d.length;h+=1){var f=d[h];if(!c.box[f]){c.box[f]=!0;var m=4*f;if(this._circleAndRectCollide(l.x,l.y,l.radius,p[0+m],p[1+m],p[2+m],p[3+m])&&(!s||s(this.boxKeys[f])))return o.push(!0),!0}}var g=this.circleCells[n];if(null!==g)for(var y=this.circles,v=0,_=g;v<_.length;v+=1){var x=_[v];if(!c.circle[x]){c.circle[x]=!0;var b=3*x;if(this._circlesCollide(y[b],y[1+b],y[2+b],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[x])))return o.push(!0),!0}}},Cr.prototype._forEachCell=function(t,e,r,i,n,o,a,s){for(var l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(r),p=this._convertToYCellCoord(i),h=l;h<=u;h++)for(var d=c;d<=p;d++)if(n.call(this,t,e,r,i,this.xCellCount*d+h,o,a,s))return},Cr.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},Cr.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},Cr.prototype._circlesCollide=function(t,e,r,i,n,o){var a=i-t,s=n-e,l=r+o;return a*a+s*s<l*l},Cr.prototype._circleAndRectCollide=function(t,e,r,i,n,o,a){var s=(o-i)/2,l=Math.abs(t-(i+s));if(s+r<l)return!1;var c=(a-n)/2,u=Math.abs(e-(n+c));if(c+r<u)return!1;if(l<=s||u<=c)return!0;var p=l-s,h=u-c;return p*p+h*h<=r*r};var Br=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Fr(t,e){for(var r=0;r<t;r++){var i=e.length;e.resize(i+4),e.float32.set(Br,3*i)}}function jr(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t[3]=r[3]*i+r[7]*n+r[15],t}function Ur(t,e,r){void 0===e&&(e=new Cr(t.width+200,t.height+200,25)),void 0===r&&(r=new Cr(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=r,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200}function Vr(e,r,i){return r*(t.EXTENT/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ)))}function qr(t,e,r,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&r?1:0,this.placed=r}function Gr(t,e,r,i,n){this.text=new qr(t?t.text:null,e,r,n),this.icon=new qr(t?t.icon:null,e,i,n)}function Zr(t,e,r){this.text=t,this.icon=e,this.skipFade=r}function Hr(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]}function Wr(t,e,r,i,n){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=r,this.bucketIndex=i,this.tileID=n}function Kr(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}function Xr(e,r,i,n,o){var a=t.getAnchorAlignment(e),s=-(a.horizontalAlign-.5)*r,l=-(a.verticalAlign-.5)*i,c=t.evaluateVariableOffset(e,n);return new t.Point(s+c[0]*o,l+c[1]*o)}function Yr(e,r,i,n,o,a){var s=e.x1,l=e.x2,c=e.y1,u=e.y2,p=e.anchorPointX,h=e.anchorPointY,d=new t.Point(r,i);return n&&d._rotate(o?a:-a),{x1:s+d.x,y1:c+d.y,x2:l+d.x,y2:u+d.y,anchorPointX:p,anchorPointY:h}}function Jr(t,e,r,i){this.transform=t.clone(),this.collisionIndex=new Ur(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new Kr(r),this.collisionCircleArrays={},(this.prevPlacement=i)&&(i.prevPlacement=void 0),this.placedOrientations={}}function $r(t,e,r,i,n){t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0),t.emplaceBack(e?1:0,r?1:0,i||0,n||0)}Ur.prototype.placeCollisionBox=function(t,e,r,i,n){var o=this.projectAndGetPerspectiveRatio(i,t.anchorPointX,t.anchorPointY),a=r*o.perspectiveRatio,s=t.x1*a+o.point.x,l=t.y1*a+o.point.y,c=t.x2*a+o.point.x,u=t.y2*a+o.point.y;return!this.isInsideGrid(s,l,c,u)||!e&&this.grid.hitTest(s,l,c,u,n)?{box:[],offscreen:!1}:{box:[s,l,c,u],offscreen:this.isOffscreen(s,l,c,u)}},Ur.prototype.placeCollisionCircles=function(e,r,i,n,o,a,s,l,c,u,p,h,d){var f=[],m=new t.Point(r.anchorX,r.anchorY),g=Pr(m,a),y=Or(this.transform.cameraToCenterDistance,g.signedDistanceFromCamera),v=(u?o/y:o*y)/t.ONE_EM,_=Pr(m,s).point,x=Lr(v,n,r.lineOffsetX*v,r.lineOffsetY*v,!1,_,m,r,i,s,{}),b=!1,w=!1,S=!0;if(x){for(var T=.5*h*y+d,E=new t.Point(-100,-100),I=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),C=new Ir,A=x.first,k=x.last,P=[],O=A.path.length-1;1<=O;O--)P.push(A.path[O]);for(var M=1;M<k.path.length;M++)P.push(k.path[M]);var L=2.5*T;if(l){var D=P.map((function(t){return Pr(t,l)}));P=D.some((function(t){return t.signedDistanceFromCamera<=0}))?[]:D.map((function(t){return t.point}))}var R=[];if(0<P.length){for(var z=P[0].clone(),N=P[0].clone(),B=1;B<P.length;B++)z.x=Math.min(z.x,P[B].x),z.y=Math.min(z.y,P[B].y),N.x=Math.max(N.x,P[B].x),N.y=Math.max(N.y,P[B].y);R=z.x>=E.x&&N.x<=I.x&&z.y>=E.y&&N.y<=I.y?[P]:N.x<E.x||z.x>I.x||N.y<E.y||z.y>I.y?[]:t.clipLine([P],E.x,E.y,I.x,I.y)}for(var F=0,j=R;F<j.length;F+=1){var U;C.reset(j[F],.25*T),U=C.length<=.5*T?1:Math.ceil(C.paddedLength/L)+1;for(var V=0;V<U;V++){var q=V/Math.max(U-1,1),G=C.lerp(q),Z=G.x+100,H=G.y+100;f.push(Z,H,T,0);var W=Z-T,K=H-T,X=Z+T,Y=H+T;if(S=S&&this.isOffscreen(W,K,X,Y),w=w||this.isInsideGrid(W,K,X,Y),!e&&this.grid.hitTestCircle(Z,H,T,p)&&(b=!0,!c))return{circles:[],offscreen:!1,collisionDetected:b}}}}return{circles:!c&&b||!w?[]:f,offscreen:S,collisionDetected:b}},Ur.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var r=[],i=1/0,n=1/0,o=-1/0,a=-1/0,s=0,l=e;s<l.length;s+=1){var c=l[s],u=new t.Point(c.x+100,c.y+100);i=Math.min(i,u.x),n=Math.min(n,u.y),o=Math.max(o,u.x),a=Math.max(a,u.y),r.push(u)}for(var p={},h={},d=0,f=this.grid.query(i,n,o,a).concat(this.ignoredGrid.query(i,n,o,a));d<f.length;d+=1){var m=f[d],g=m.key;if(void 0===p[g.bucketInstanceId]&&(p[g.bucketInstanceId]={}),!p[g.bucketInstanceId][g.featureIndex]){var y=[new t.Point(m.x1,m.y1),new t.Point(m.x2,m.y1),new t.Point(m.x2,m.y2),new t.Point(m.x1,m.y2)];t.polygonIntersectsPolygon(r,y)&&(p[g.bucketInstanceId][g.featureIndex]=!0,void 0===h[g.bucketInstanceId]&&(h[g.bucketInstanceId]=[]),h[g.bucketInstanceId].push(g.featureIndex))}}return h},Ur.prototype.insertCollisionBox=function(t,e,r,i,n){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:i,collisionGroupID:n},t[0],t[1],t[2],t[3])},Ur.prototype.insertCollisionCircles=function(t,e,r,i,n){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:r,featureIndex:i,collisionGroupID:n},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},Ur.prototype.projectAndGetPerspectiveRatio=function(e,r,i){var n=[r,i,0,1];return jr(n,n,e),{point:new t.Point((n[0]/n[3]+1)/2*this.transform.width+100,(-n[1]/n[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/n[3]*.5}},Ur.prototype.isOffscreen=function(t,e,r,i){return r<100||t>=this.screenRightBoundary||i<100||e>this.screenBottomBoundary},Ur.prototype.isInsideGrid=function(t,e,r,i){return 0<=r&&t<this.gridRightBoundary&&0<=i&&e<this.gridBottomBoundary},Ur.prototype.getViewportMatrix=function(){var e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e},qr.prototype.isHidden=function(){return 0===this.opacity&&!this.placed},Gr.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()},Kr.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]},Jr.prototype.getBucketParts=function(e,r,i,n){var o=i.getBucket(r),a=i.latestFeatureIndex;if(o&&a&&r.id===o.layerIds[0]){var s=i.collisionBoxArray,l=o.layers[0].layout,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),u=i.tileSize/t.EXTENT,p=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),h="map"===l.get("text-pitch-alignment"),d="map"===l.get("text-rotation-alignment"),f=Vr(i,1,this.transform.zoom),m=Ar(p,h,d,this.transform,f),g=null;if(h){var y=kr(p,h,d,this.transform,f);g=t.multiply([],this.transform.labelPlaneMatrix,y)}this.retainedQueryData[o.bucketInstanceId]=new Wr(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,i.tileID);var v={bucket:o,layout:l,posMatrix:p,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:c,textPixelRatio:u,holdingForFade:i.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(n)for(var _=0,x=o.sortKeyRanges;_<x.length;_+=1){var b=x[_];e.push({sortKey:b.sortKey,symbolInstanceStart:b.symbolInstanceStart,symbolInstanceEnd:b.symbolInstanceEnd,parameters:v})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:v})}},Jr.prototype.attemptAnchorPlacement=function(t,e,r,i,n,o,a,s,l,c,u,p,h,d,f){var m,g=[p.textOffset0,p.textOffset1],y=Xr(t,r,i,g,n),v=this.collisionIndex.placeCollisionBox(Yr(e,y.x,y.y,o,a,this.transform.angle),u,s,l,c.predicate);if(!f||0!==this.collisionIndex.placeCollisionBox(Yr(f,y.x,y.y,o,a,this.transform.angle),u,s,l,c.predicate).box.length)return 0<v.box.length?(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(m=this.prevPlacement.variableOffsets[p.crossTileID].anchor),this.variableOffsets[p.crossTileID]={textOffset:g,width:r,height:i,anchor:t,textBoxScale:n,prevAnchor:m},this.markUsedJustification(h,t,p,d),h.allowVerticalPlacement&&(this.markUsedOrientation(h,d,p),this.placedOrientations[p.crossTileID]=d),{shift:y,placedGlyphBoxes:v}):void 0},Jr.prototype.placeLayerBucketPart=function(e,r,i){var n=this,o=e.parameters,a=o.bucket,s=o.layout,l=o.posMatrix,c=o.textLabelPlaneMatrix,u=o.labelToScreenMatrix,p=o.textPixelRatio,h=o.holdingForFade,d=o.collisionBoxArray,f=o.partiallyEvaluatedTextSize,m=o.collisionGroup,g=s.get("text-optional"),y=s.get("icon-optional"),v=s.get("text-allow-overlap"),_=s.get("icon-allow-overlap"),x="map"===s.get("text-rotation-alignment"),b="map"===s.get("text-pitch-alignment"),w="none"!==s.get("icon-text-fit"),S="viewport-y"===s.get("symbol-z-order"),T=v&&(_||!a.hasIconData()||y),E=_&&(v||!a.hasTextData()||g);function I(e,o){if(!r[e.crossTileID])if(h)n.placements[e.crossTileID]=new Zr(!1,!1,!1);else{var d,S=!1,I=!1,C=!0,A=null,k={box:null,offscreen:null},P={box:null,offscreen:null},O=null,M=null,L=0,D=0,R=0;o.textFeatureIndex?L=o.textFeatureIndex:e.useRuntimeCollisionCircles&&(L=e.featureIndex),o.verticalTextFeatureIndex&&(D=o.verticalTextFeatureIndex);var z=o.textBox;if(z){var N=function(r){var i=t.WritingMode.horizontal;if(a.allowVerticalPlacement&&!r&&n.prevPlacement){var o=n.prevPlacement.placedOrientations[e.crossTileID];o&&(n.placedOrientations[e.crossTileID]=o,n.markUsedOrientation(a,i=o,e))}return i},B=function(r,i){if(a.allowVerticalPlacement&&0<e.numVerticalGlyphVertices&&o.verticalTextBox)for(var n=0,s=a.writingModes;n<s.length&&(s[n]===t.WritingMode.vertical?(k=i(),P=k):k=r(),!(k&&k.box&&k.box.length));n+=1);else k=r()};if(s.get("text-variable-anchor")){var F=s.get("text-variable-anchor");if(n.prevPlacement&&n.prevPlacement.variableOffsets[e.crossTileID]){var j=n.prevPlacement.variableOffsets[e.crossTileID];0<F.indexOf(j.anchor)&&(F=F.filter((function(t){return t!==j.anchor}))).unshift(j.anchor)}var U=function(t,r,i){for(var o=t.x2-t.x1,s=t.y2-t.y1,c=e.textBoxScale,u=w&&!_?r:null,h={box:[],offscreen:!1},d=v?2*F.length:F.length,f=0;f<d;++f){var g=n.attemptAnchorPlacement(F[f%F.length],t,o,s,c,x,b,p,l,m,f>=F.length,e,a,i,u);if(g&&(h=g.placedGlyphBoxes)&&h.box&&h.box.length){S=!0,A=g.shift;break}}return h};B((function(){return U(z,o.iconBox,t.WritingMode.horizontal)}),(function(){var r=o.verticalTextBox;return a.allowVerticalPlacement&&!(k&&k.box&&k.box.length)&&0<e.numVerticalGlyphVertices&&r?U(r,o.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),k&&(S=k.box,C=k.offscreen);var V=N(k&&k.box);if(!S&&n.prevPlacement){var q=n.prevPlacement.variableOffsets[e.crossTileID];q&&(n.variableOffsets[e.crossTileID]=q,n.markUsedJustification(a,q.anchor,e,V))}}else{var G=function(t,r){var i=n.collisionIndex.placeCollisionBox(t,v,p,l,m.predicate);return i&&i.box&&i.box.length&&(n.markUsedOrientation(a,r,e),n.placedOrientations[e.crossTileID]=r),i};B((function(){return G(z,t.WritingMode.horizontal)}),(function(){var r=o.verticalTextBox;return a.allowVerticalPlacement&&0<e.numVerticalGlyphVertices&&r?G(r,t.WritingMode.vertical):{box:null,offscreen:null}})),N(k&&k.box&&k.box.length)}}if(S=(d=k)&&d.box&&0<d.box.length,C=d&&d.offscreen,e.useRuntimeCollisionCircles){var Z=a.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),H=t.evaluateSizeForFeature(a.textSizeData,f,Z),W=s.get("text-padding");O=n.collisionIndex.placeCollisionCircles(v,Z,a.lineVertexArray,a.glyphOffsetArray,H,l,c,u,i,b,m.predicate,e.collisionCircleDiameter,W),S=v||0<O.circles.length&&!O.collisionDetected,C=C&&O.offscreen}if(o.iconFeatureIndex&&(R=o.iconFeatureIndex),o.iconBox){var K=function(t){var e=w&&A?Yr(t,A.x,A.y,x,b,n.transform.angle):t;return n.collisionIndex.placeCollisionBox(e,_,p,l,m.predicate)};I=P&&P.box&&P.box.length&&o.verticalIconBox?0<(M=K(o.verticalIconBox)).box.length:0<(M=K(o.iconBox)).box.length,C=C&&M.offscreen}var X=g||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,Y=y||0===e.numIconVertices;if(X||Y?Y?X||(I=I&&S):S=I&&S:I=S=I&&S,S&&d&&d.box&&n.collisionIndex.insertCollisionBox(d.box,s.get("text-ignore-placement"),a.bucketInstanceId,P&&P.box&&D?D:L,m.ID),I&&M&&n.collisionIndex.insertCollisionBox(M.box,s.get("icon-ignore-placement"),a.bucketInstanceId,R,m.ID),O&&(S&&n.collisionIndex.insertCollisionCircles(O.circles,s.get("text-ignore-placement"),a.bucketInstanceId,L,m.ID),i)){var J=a.bucketInstanceId,$=n.collisionCircleArrays[J];void 0===$&&($=n.collisionCircleArrays[J]=new Hr);for(var Q=0;Q<O.circles.length;Q+=4)$.circles.push(O.circles[Q+0]),$.circles.push(O.circles[Q+1]),$.circles.push(O.circles[Q+2]),$.circles.push(O.collisionDetected?1:0)}n.placements[e.crossTileID]=new Zr(S||T,I||E,C||a.justReloaded),r[e.crossTileID]=!0}}if(!a.collisionArrays&&d&&a.deserializeCollisionBoxes(d),S)for(var C=a.getSortedSymbolIndexes(this.transform.angle),A=C.length-1;0<=A;--A){var k=C[A];I(a.symbolInstances.get(k),a.collisionArrays[k])}else for(var P=e.symbolInstanceStart;P<e.symbolInstanceEnd;P++)I(a.symbolInstances.get(P),a.collisionArrays[P]);if(i&&a.bucketInstanceId in this.collisionCircleArrays){var O=this.collisionCircleArrays[a.bucketInstanceId];t.invert(O.invProjMatrix,l),O.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1},Jr.prototype.markUsedJustification=function(e,r,i,n){var o;o=n===t.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(r)];for(var a=0,s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];a<s.length;a+=1){var l=s[a];0<=l&&(e.text.placedSymbolArray.get(l).crossTileID=0<=o&&l!==o?0:i.crossTileID)}},Jr.prototype.markUsedOrientation=function(e,r,i){for(var n=r===t.WritingMode.horizontal||r===t.WritingMode.horizontalOnly?r:0,o=r===t.WritingMode.vertical?r:0,a=0,s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];a<s.length;a+=1)e.text.placedSymbolArray.get(s[a]).placedOrientation=n;i.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=o)},Jr.prototype.commit=function(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;var e=this.prevPlacement,r=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;var i=e?e.symbolFadeChange(t):1,n=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],c=n[s];r=c?(this.opacities[s]=new Gr(c,i,l.text,l.icon),r||l.text!==c.text.placed||l.icon!==c.icon.placed):(this.opacities[s]=new Gr(null,i,l.text,l.icon,l.skipFade),r||l.text||l.icon)}for(var u in n){var p=n[u];if(!this.opacities[u]){var h=new Gr(p,i,!1,!1);h.isHidden()||(this.opacities[u]=h,r=r||p.text.placed||p.icon.placed)}}for(var d in o)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=o[d]);for(var f in a)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=a[f]);r?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},Jr.prototype.updateLayerOpacities=function(t,e){for(var r={},i=0,n=e;i<n.length;i+=1){var o=n[i],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,r,o.collisionBoxArray)}},Jr.prototype.updateBucketOpacities=function(e,r,i){var n=this;e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();var o=e.layers[0].layout,a=new Gr(null,0,!1,!1,!0),s=o.get("text-allow-overlap"),l=o.get("icon-allow-overlap"),c=o.get("text-variable-anchor"),u="map"===o.get("text-rotation-alignment"),p="map"===o.get("text-pitch-alignment"),h="none"!==o.get("icon-text-fit"),d=new Gr(null,0,s&&(l||!e.hasIconData()||o.get("icon-optional")),l&&(s||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);for(var f=function(t,e,r){for(var i=0;i<e/4;i++)t.opacityVertexArray.emplaceBack(r)},m=function(i){var o=e.symbolInstances.get(i),s=o.numHorizontalGlyphVertices,l=o.numVerticalGlyphVertices,m=o.crossTileID,g=n.opacities[m];r[m]?g=a:g||(n.opacities[m]=g=d),r[m]=!0;var y=0<o.numIconVertices,v=n.placedOrientations[o.crossTileID],_=v===t.WritingMode.vertical,x=v===t.WritingMode.horizontal||v===t.WritingMode.horizontalOnly;if(0<s||0<l){var b=ai(g.text);f(e.text,s,_?li:b),f(e.text,l,x?li:b);var w=g.text.isHidden();[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(t){0<=t&&(e.text.placedSymbolArray.get(t).hidden=w||_?1:0)})),0<=o.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).hidden=w||x?1:0);var S=n.variableOffsets[o.crossTileID];S&&n.markUsedJustification(e,S.anchor,o,v);var T=n.placedOrientations[o.crossTileID];T&&(n.markUsedJustification(e,"left",o,T),n.markUsedOrientation(e,T,o))}if(y){var E=ai(g.icon),I=!(h&&o.verticalPlacedIconSymbolIndex&&_);0<=o.placedIconSymbolIndex&&(f(e.icon,o.numIconVertices,I?E:li),e.icon.placedSymbolArray.get(o.placedIconSymbolIndex).hidden=g.icon.isHidden()),0<=o.verticalPlacedIconSymbolIndex&&(f(e.icon,o.numVerticalIconVertices,I?li:E),e.icon.placedSymbolArray.get(o.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){var C=e.collisionArrays[i];if(C){var A=new t.Point(0,0);if(C.textBox||C.verticalTextBox){var k=!0;if(c){var P=n.variableOffsets[m];P?(A=Xr(P.anchor,P.width,P.height,P.textOffset,P.textBoxScale),u&&A._rotate(p?n.transform.angle:-n.transform.angle)):k=!1}C.textBox&&$r(e.textCollisionBox.collisionVertexArray,g.text.placed,!k||_,A.x,A.y),C.verticalTextBox&&$r(e.textCollisionBox.collisionVertexArray,g.text.placed,!k||x,A.x,A.y)}var O=Boolean(!x&&C.verticalIconBox);C.iconBox&&$r(e.iconCollisionBox.collisionVertexArray,g.icon.placed,O,h?A.x:0,h?A.y:0),C.verticalIconBox&&$r(e.iconCollisionBox.collisionVertexArray,g.icon.placed,!O,h?A.x:0,h?A.y:0)}}},g=0;g<e.symbolInstances.length;g++)m(g);if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){var y=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=y.invProjMatrix,e.placementViewportMatrix=y.viewportMatrix,e.collisionCircleArray=y.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}},Jr.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Jr.prototype.zoomAdjustment=function(t){return Math.max(0,(this.transform.zoom-t)/1.5)},Jr.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},Jr.prototype.stillRecent=function(t,e){var r=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*r>t},Jr.prototype.setStale=function(){this.stale=!0};var Qr=Math.pow(2,25),ti=Math.pow(2,24),ei=Math.pow(2,17),ri=Math.pow(2,16),ii=Math.pow(2,9),ni=Math.pow(2,8),oi=Math.pow(2,1);function ai(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,r=Math.floor(127*t.opacity);return r*Qr+e*ti+r*ei+e*ri+r*ii+e*ni+r*oi+e}function si(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}var li=0;function ci(t,e,r,i,n,o,a){this.placement=new Jr(t,n,o,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=i,this._done=!1}function ui(t,e,r){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var i=0;i<e.length;i++){var n=e.get(i),o=n.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:n.crossTileID,coord:this.getScaledCoordinates(n,t)})}}si.prototype.continuePlacement=function(t,e,r,i,n){for(var o=this._bucketParts;this._currentTileIndex<t.length;)if(e.getBucketParts(o,i,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,n())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((function(t,e){return t.sortKey-e.sortKey})));this._currentPartIndex<o.length;)if(e.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,n())return!0;return!1},ci.prototype.isDone=function(){return this._done},ci.prototype.continuePlacement=function(e,r,i){for(var n=this,o=t.browser.now(),a=function(){var e=t.browser.now()-o;return!n._forceFullPlacement&&2<e};0<=this._currentPlacementIndex;){var s=r[e[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new si(s)),this._inProgressLayer.continuePlacement(i[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ci.prototype.commit=function(t){return this.placement.commit(t),this.placement};var pi=512/t.EXTENT/2;function hi(){this.maxCrossTileID=0}function di(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}function fi(){this.layerIndexes={},this.crossTileIDs=new hi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}function mi(e,r){return t.emitValidationErrors(e,r&&r.filter((function(t){return"source.canvas"!==t.identifier})))}ui.prototype.getScaledCoordinates=function(e,r){var i=pi/Math.pow(2,r.canonical.z-this.tileID.canonical.z);return{x:Math.floor((r.canonical.x*t.EXTENT+e.anchorX)*i),y:Math.floor((r.canonical.y*t.EXTENT+e.anchorY)*i)}},ui.prototype.findMatches=function(t,e,r){for(var i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),n=0;n<t.length;n++){var o=t.get(n);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,e),l=0,c=a;l<c.length;l+=1){var u=c[l];if(Math.abs(u.coord.x-s.x)<=i&&Math.abs(u.coord.y-s.y)<=i&&!r[u.crossTileID]){r[u.crossTileID]=!0,o.crossTileID=u.crossTileID;break}}}}},hi.prototype.generate=function(){return++this.maxCrossTileID},di.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var r in this.indexes){var i=this.indexes[r],n={};for(var o in i){var a=i[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),n[a.tileID.key]=a}this.indexes[r]=n}this.lng=t},di.prototype.addBucket=function(t,e,r){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var i=0;i<e.symbolInstances.length;i++)e.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var n=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var l=a[s];l.tileID.isChildOf(t)&&l.findMatches(e.symbolInstances,t,n)}else{var c=a[t.scaledTo(Number(o)).key];c&&c.findMatches(e.symbolInstances,t,n)}}for(var u=0;u<e.symbolInstances.length;u++){var p=e.symbolInstances.get(u);p.crossTileID||(p.crossTileID=r.generate(),n[p.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ui(t,e.symbolInstances,e.bucketInstanceId),!0},di.prototype.removeBucketCrossTileIDs=function(t,e){for(var r in e.indexedSymbolInstances)for(var i=0,n=e.indexedSymbolInstances[r];i<n.length;i+=1)delete this.usedCrossTileIDs[t][n[i].crossTileID]},di.prototype.removeStaleBuckets=function(t){var e=!1;for(var r in this.indexes){var i=this.indexes[r];for(var n in i)t[i[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,i[n]),delete i[n],e=!0)}return e},fi.prototype.addLayer=function(t,e,r){var i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new di);var n=!1,o={};i.handleWrapJump(r);for(var a=0,s=e;a<s.length;a+=1){var l=s[a],c=l.getBucket(t);c&&t.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(l.tileID,c,this.crossTileIDs)&&(n=!0),o[c.bucketInstanceId]=!0)}return i.removeStaleBuckets(o)&&(n=!0),n},fi.prototype.pruneUnusedLayers=function(t){var e={};for(var r in t.forEach((function(t){e[t]=!0})),this.layerIndexes)e[r]||delete this.layerIndexes[r]};var gi,yi=t.pick(_r,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),vi=t.pick(_r,["setCenter","setZoom","setBearing","setPitch"]),_i=function(){var e={},r=t.styleSpec.$version;for(var i in t.styleSpec.$root){var n,o=t.styleSpec.$root[i];o.required&&null!=(n="version"===i?r:"array"===o.type?[]:{})&&(e[i]=n)}return e}(),xi=((gi=t.Evented)&&(bi.__proto__=gi),((bi.prototype=Object.create(gi&&gi.prototype)).constructor=bi).prototype.loadURL=function(e,r){var i=this;void 0===r&&(r={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var n="boolean"==typeof r.validate?r.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,r.accessToken);var o=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,(function(e,r){i._request=null,e?i.fire(new t.ErrorEvent(e)):r&&i._load(r,n)}))},bi.prototype.loadJSON=function(e,r){var i=this;void 0===r&&(r={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame((function(){i._request=null,i._load(e,!1!==r.validate)}))},bi.prototype.loadEmpty=function(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(_i,!1)},bi.prototype._load=function(e,r){if(!r||!mi(this,t.validateStyle(e))){for(var i in this._loaded=!0,(this.stylesheet=e).sources)this.addSource(i,e.sources[i],{validate:!1});e.sprite?this._loadSprite(e.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var n=vr(this.stylesheet.layers);this._order=n.map((function(t){return t.id})),this._layers={},this._serializedLayers={};for(var o=0,a=n;o<a.length;o+=1){var s=a[o];(s=t.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new E(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},bi.prototype._loadSprite=function(e){var r,i,n,o,a,s,l,c,u,p=this;function h(){if(s)n(s);else if(o&&a){var e=t.browser.getImageData(a),r={};for(var i in o){var l=o[i],c=l.width,u=l.height,p=l.x,h=l.y,d=l.sdf,f=l.pixelRatio,m=l.stretchX,g=l.stretchY,y=l.content,v=new t.RGBAImage({width:c,height:u});t.RGBAImage.copy(e,v,{x:p,y:h},{x:0,y:0},{width:c,height:u}),r[i]={data:v,pixelRatio:f,sdf:d,stretchX:m,stretchY:g,content:y}}n(null,r)}}this._spriteRequest=(r=e,i=this.map._requestManager,n=function(e,r){if(p._spriteRequest=null,e)p.fire(new t.ErrorEvent(e));else if(r)for(var i in r)p.imageManager.addImage(i,r[i]);p.imageManager.setLoaded(!0),p._availableImages=p.imageManager.listImages(),p.dispatcher.broadcast("setImages",p._availableImages),p.fire(new t.Event("data",{dataType:"style"}))},l=1<t.browser.devicePixelRatio?"@2x":"",c=t.getJSON(i.transformRequest(i.normalizeSpriteURL(r,l,".json"),t.ResourceType.SpriteJSON),(function(t,e){c=null,s||(s=t,o=e,h())})),u=t.getImage(i.transformRequest(i.normalizeSpriteURL(r,l,".png"),t.ResourceType.SpriteImage),(function(t,e){u=null,s||(s=t,a=e,h())})),{cancel:function(){c&&(c.cancel(),c=null),u&&(u.cancel(),u=null)}})},bi.prototype._validateLayer=function(e){var r=this.sourceCaches[e.source];if(r){var i=e.sourceLayer;if(i){var n=r.getSource();("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(i))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+i+'" does not exist on source "'+n.id+'" as specified by style layer "'+e.id+'"')))}}},bi.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},bi.prototype._serializeLayers=function(t){for(var e=[],r=0,i=t;r<i.length;r+=1){var n=this._layers[i[r]];"custom"!==n.type&&e.push(n.serialize())}return e},bi.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},bi.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},bi.prototype.update=function(e){if(this._loaded){var r=this._changed;if(this._changed){var i=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);for(var o in(i.length||n.length)&&this._updateWorkerLayers(i,n),this._updatedSources){var a=this._updatedSources[o];"reload"===a?this._reloadSource(o):"clear"===a&&this._clearSource(o)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}for(var l in this.sourceCaches)this.sourceCaches[l].used=!1;for(var c=0,u=this._order;c<u.length;c+=1){var p=this._layers[u[c]];p.recalculate(e,this._availableImages),!p.isHidden(e.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}this.light.recalculate(e),this.z=e.zoom,r&&this.fire(new t.Event("data",{dataType:"style"}))}},bi.prototype._updateTilesForChangedImages=function(){var t=Object.keys(this._changedImages);if(t.length){for(var e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}},bi.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},bi.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},bi.prototype.setState=function(e){var r=this;if(this._checkLoaded(),mi(this,t.validateStyle(e)))return!1;(e=t.clone$1(e)).layers=vr(e.layers);var i=function(e,r){if(!e)return[{command:_r.setStyle,args:[r]}];var i=[];try{if(!t.deepEqual(e.version,r.version))return[{command:_r.setStyle,args:[r]}];t.deepEqual(e.center,r.center)||i.push({command:_r.setCenter,args:[r.center]}),t.deepEqual(e.zoom,r.zoom)||i.push({command:_r.setZoom,args:[r.zoom]}),t.deepEqual(e.bearing,r.bearing)||i.push({command:_r.setBearing,args:[r.bearing]}),t.deepEqual(e.pitch,r.pitch)||i.push({command:_r.setPitch,args:[r.pitch]}),t.deepEqual(e.sprite,r.sprite)||i.push({command:_r.setSprite,args:[r.sprite]}),t.deepEqual(e.glyphs,r.glyphs)||i.push({command:_r.setGlyphs,args:[r.glyphs]}),t.deepEqual(e.transition,r.transition)||i.push({command:_r.setTransition,args:[r.transition]}),t.deepEqual(e.light,r.light)||i.push({command:_r.setLight,args:[r.light]});var n={},o=[];!function(e,r,i,n){var o,a,s,l;for(o in r=r||{},e=e||{})e.hasOwnProperty(o)&&(r.hasOwnProperty(o)||br(o,i,n));for(o in r)r.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.deepEqual(e[o],r[o])||("geojson"===e[o].type&&"geojson"===r[o].type&&wr(e,r,o)?i.push({command:_r.setGeoJSONSourceData,args:[o,r[o].data]}):(s=r,br(a=o,l=i,n),xr(a,s,l))):xr(o,r,i))}(e.sources,r.sources,o,n);var a=[];e.layers&&e.layers.forEach((function(t){n[t.source]?i.push({command:_r.removeLayer,args:[t.id]}):a.push(t)})),i=i.concat(o),function(e,r,i){r=r||[];var n,o,a,s,l,c,u,p=(e=e||[]).map(Tr),h=r.map(Tr),d=e.reduce(Er,{}),f=r.reduce(Er,{}),m=p.slice(),g=Object.create(null);for(o=n=0;n<p.length;n++)f.hasOwnProperty(a=p[n])?o++:(i.push({command:_r.removeLayer,args:[a]}),m.splice(m.indexOf(a,o),1));for(o=n=0;n<h.length;n++)m[m.length-1-n]!==(a=h[h.length-1-n])&&(d.hasOwnProperty(a)?(i.push({command:_r.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-o),1)):o++,i.push({command:_r.addLayer,args:[f[a],c=m[m.length-n]]}),m.splice(m.length-n,0,a),g[a]=!0);for(n=0;n<h.length;n++)if(s=d[a=h[n]],l=f[a],!g[a]&&!t.deepEqual(s,l))if(t.deepEqual(s.source,l.source)&&t.deepEqual(s["source-layer"],l["source-layer"])&&t.deepEqual(s.type,l.type)){for(u in Sr(s.layout,l.layout,i,a,null,_r.setLayoutProperty),Sr(s.paint,l.paint,i,a,null,_r.setPaintProperty),t.deepEqual(s.filter,l.filter)||i.push({command:_r.setFilter,args:[a,l.filter]}),t.deepEqual(s.minzoom,l.minzoom)&&t.deepEqual(s.maxzoom,l.maxzoom)||i.push({command:_r.setLayerZoomRange,args:[a,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Sr(s[u],l[u],i,a,u.slice(6),_r.setPaintProperty):t.deepEqual(s[u],l[u])||i.push({command:_r.setLayerProperty,args:[a,u,l[u]]}));for(u in l)l.hasOwnProperty(u)&&!s.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Sr(s[u],l[u],i,a,u.slice(6),_r.setPaintProperty):t.deepEqual(s[u],l[u])||i.push({command:_r.setLayerProperty,args:[a,u,l[u]]}))}else i.push({command:_r.removeLayer,args:[a]}),c=m[m.lastIndexOf(a)+1],i.push({command:_r.addLayer,args:[l,c]})}(a,r.layers,i)}catch(e){console.warn("Unable to compute style diff:",e),i=[{command:_r.setStyle,args:[r]}]}return i}(this.serialize(),e).filter((function(t){return!(t.command in vi)}));if(0===i.length)return!1;var n=i.filter((function(t){return!(t.command in yi)}));if(0<n.length)throw new Error("Unimplemented: "+n.map((function(t){return t.command})).join(", ")+".");return i.forEach((function(t){"setTransition"!==t.command&&r[t.command].apply(r,t.args)})),this.stylesheet=e,!0},bi.prototype.addImage=function(e,r){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,r),this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},bi.prototype.updateImage=function(t,e){this.imageManager.updateImage(t,e)},bi.prototype.getImage=function(t){return this.imageManager.getImage(t)},bi.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},bi.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},bi.prototype.addSource=function(e,r,i){var n=this;if(void 0===i&&(i={}),this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(r).join(", ")+".");if(!(0<=["vector","raster","geojson","video","image"].indexOf(r.type)&&this._validate(t.validateStyle.source,"sources."+e,r,null,i))){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var o=this.sourceCaches[e]=new sr(e,r,this.dispatcher);o.style=this,o.setEventedParent(this,(function(){return{isSourceLoaded:n.loaded(),source:o.serialize(),sourceId:e}})),o.onAdd(this.map),this._changed=!0}},bi.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var r in this._layers)if(this._layers[r].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+r+'" is using it.')));var i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.clearTiles(),i.onRemove&&i.onRemove(this.map),this._changed=!0},bi.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},bi.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},bi.prototype.addLayer=function(e,r,i){void 0===i&&(i={}),this._checkLoaded();var n=e.id;if(this.getLayer(n))this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" already exists on this map')));else{var o;if("custom"===e.type){if(mi(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(n,e.source),e=t.clone$1(e),e=t.extend(e,{source:n})),this._validate(t.validateStyle.layer,"layers."+n,e,{arrayIndex:-1},i))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:n}}),this._serializedLayers[o.id]=o.serialize()}var a=r?this._order.indexOf(r):this._order.length;if(r&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.')));else{if(this._order.splice(a,0,n),this._layerOrderChanged=!0,this._layers[n]=o,this._removedLayers[n]&&o.source&&"custom"!==o.type){var s=this._removedLayers[n];delete this._removedLayers[n],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},bi.prototype.moveLayer=function(e,r){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==r){var i=this._order.indexOf(e);this._order.splice(i,1);var n=r?this._order.indexOf(r):this._order.length;r&&-1===n?this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.'))):(this._order.splice(n,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},bi.prototype.removeLayer=function(e){this._checkLoaded();var r=this._layers[e];if(r){r.setEventedParent(null);var i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},bi.prototype.getLayer=function(t){return this._layers[t]},bi.prototype.hasLayer=function(t){return t in this._layers},bi.prototype.setLayerZoomRange=function(e,r,i){this._checkLoaded();var n=this.getLayer(e);n?n.minzoom===r&&n.maxzoom===i||(null!=r&&(n.minzoom=r),null!=i&&(n.maxzoom=i),this._updateLayer(n)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},bi.prototype.setFilter=function(e,r,i){void 0===i&&(i={}),this._checkLoaded();var n=this.getLayer(e);if(n){if(!t.deepEqual(n.filter,r))return null==r?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(t.validateStyle.filter,"layers."+n.id+".filter",r,null,i)||(n.filter=t.clone$1(r),this._updateLayer(n)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},bi.prototype.getFilter=function(e){return t.clone$1(this.getLayer(e).filter)},bi.prototype.setLayoutProperty=function(e,r,i,n){void 0===n&&(n={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getLayoutProperty(r),i)||(o.setLayoutProperty(r,i,n),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},bi.prototype.getLayoutProperty=function(e,r){var i=this.getLayer(e);if(i)return i.getLayoutProperty(r);this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style.")))},bi.prototype.setPaintProperty=function(e,r,i,n){void 0===n&&(n={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getPaintProperty(r),i)||(o.setPaintProperty(r,i,n)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},bi.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},bi.prototype.setFeatureState=function(e,r){this._checkLoaded();var i=e.source,n=e.sourceLayer,o=this.sourceCaches[i];if(void 0!==o){var a=o.getSource().type;"geojson"===a&&n?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||n?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),o.setFeatureState(n,e.id,r)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},bi.prototype.removeFeatureState=function(e,r){this._checkLoaded();var i=e.source,n=this.sourceCaches[i];if(void 0!==n){var o=n.getSource().type,a="vector"===o?e.sourceLayer:void 0;"vector"!==o||a?r&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):n.removeFeatureState(a,e.id,r):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},bi.prototype.getFeatureState=function(e){this._checkLoaded();var r=e.source,i=e.sourceLayer,n=this.sourceCaches[r];if(void 0!==n){if("vector"!==n.getSource().type||i)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),n.getFeatureState(i,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},bi.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},bi.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(function(t){return t.serialize()})),layers:this._serializeLayers(this._order)},(function(t){return void 0!==t}))},bi.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},bi.prototype._flattenAndSortRenderedFeatures=function(t){for(var e=this,r=function(t){return"fill-extrusion"===e._layers[t].type},i={},n=[],o=this._order.length-1;0<=o;o--){var a=this._order[o];if(r(a)){i[a]=o;for(var s=0,l=t;s<l.length;s+=1){var c=l[s][a];if(c)for(var u=0,p=c;u<p.length;u+=1)n.push(p[u])}}}n.sort((function(t,e){return e.intersectionZ-t.intersectionZ}));for(var h=[],d=this._order.length-1;0<=d;d--){var f=this._order[d];if(r(f))for(var m=n.length-1;0<=m;m--){var g=n[m].feature;if(i[g.layer.id]<d)break;h.push(g),n.pop()}else for(var y=0,v=t;y<v.length;y+=1){var _=v[y][f];if(_)for(var x=0,b=_;x<b.length;x+=1)h.push(b[x].feature)}}return h},bi.prototype.queryRenderedFeatures=function(e,r,i){r&&r.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",r.filter,null,r);var n={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=r.layers;o<a.length;o+=1){var s=a[o],l=this._layers[s];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];n[l.source]=!0}}var c=[];for(var u in r.availableImages=this._availableImages,this.sourceCaches)r.layers&&!n[u]||c.push(Q(this.sourceCaches[u],this._layers,this._serializedLayers,e,r,i));return this.placement&&c.push(function(t,e,r,i,n,o,a){for(var s={},l=o.queryRenderedSymbols(i),c=[],u=0,p=Object.keys(l).map(Number);u<p.length;u+=1)c.push(a[p[u]]);c.sort(tt);for(var h=function(){var r=f[d],i=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],e,r.bucketIndex,r.sourceLayerIndex,n.filter,n.layers,n.availableImages,t);for(var o in i){var a=s[o]=s[o]||[],c=i[o];c.sort((function(t,e){var i=r.featureSortOrder;if(i){var n=i.indexOf(t.featureIndex);return i.indexOf(e.featureIndex)-n}return e.featureIndex-t.featureIndex}));for(var u=0,p=c;u<p.length;u+=1)a.push(p[u])}},d=0,f=c;d<f.length;d+=1)h();function m(e){s[e].forEach((function(i){var n=i.feature,o=r[t[e].source].getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=o}))}for(var g in s)m(g);return s}(this._layers,this._serializedLayers,this.sourceCaches,e,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)},bi.prototype.querySourceFeatures=function(e,r){r&&r.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",r.filter,null,r);var i=this.sourceCaches[e];return i?function(t,e){for(var r=t.getRenderableIds().map((function(e){return t.getTileByID(e)})),i=[],n={},o=0;o<r.length;o++){var a=r[o],s=a.tileID.canonical.key;n[s]||(n[s]=!0,a.querySourceFeatures(i,e))}return i}(i,r):[]},bi.prototype.addSourceType=function(t,e,r){return bi.getSourceType(t)?r(new Error('A source type called "'+t+'" already exists.')):(bi.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},r):r(null,null))},bi.prototype.getLight=function(){return this.light.getLight()},bi.prototype.setLight=function(e,r){void 0===r&&(r={}),this._checkLoaded();var i=this.light.getLight(),n=!1;for(var o in e)if(!t.deepEqual(e[o],i[o])){n=!0;break}if(n){var a={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(a)}},bi.prototype._validate=function(e,r,i,n,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&mi(this,e.call(t.validateStyle,t.extend({key:r,style:this.serialize(),value:i,styleSpec:t.styleSpec},n)))},bi.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[e].setEventedParent(null);for(var r in this.sourceCaches)this.sourceCaches[r].clearTiles(),this.sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},bi.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},bi.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},bi.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},bi.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},bi.prototype._updatePlacement=function(e,r,i,n,o){void 0===o&&(o=!1);for(var a=!1,s=!1,l={},c=0,u=this._order;c<u.length;c+=1){var p=this._layers[u[c]];if("symbol"===p.type){if(!l[p.source]){var h=this.sourceCaches[p.source];l[p.source]=h.getRenderableIds(!0).map((function(t){return h.getTileByID(t)})).sort((function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)}))}var d=this.crossTileSymbolIndex.addLayer(p,l[p.source],e.center.lng);a=a||d}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((o=o||this._layerOrderChanged||0===i)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now(),e.zoom))&&(this.pauseablePlacement=new ci(e,this._order,o,r,i,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.browser.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(var f=0,m=this._order;f<m.length;f+=1){var g=this._layers[m[f]];"symbol"===g.type&&this.placement.updateLayerOpacities(g,l[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},bi.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},bi.prototype.getImages=function(t,e,r){this.imageManager.getImages(e.icons,r),this._updateTilesForChangedImages();var i=this.sourceCaches[e.source];i&&i.setDependencies(e.tileID.key,e.type,e.icons)},bi.prototype.getGlyphs=function(t,e,r){this.glyphManager.getGlyphs(e.stacks,r)},bi.prototype.getResource=function(e,r,i){return t.makeRequest(r,i)},bi);function bi(e,r){var i=this;void 0===r&&(r={}),gi.call(this),this.map=e,this.dispatcher=new C(gr(),this),this.imageManager=new h,this.imageManager.setEventedParent(this),this.glyphManager=new x(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new w(256,512),this.crossTileSymbolIndex=new fi,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());var n=this;this._rtlTextPluginCallback=bi.registerForPluginStateChange((function(e){n.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(function(e,r){if(t.triggerPluginCompletionEvent(e),r&&r.every((function(t){return t})))for(var i in n.sourceCaches)n.sourceCaches[i].reload()}))})),this.on("data",(function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=i.sourceCaches[t.sourceId];if(e){var r=e.getSource();if(r&&r.vectorLayerIds)for(var n in i._layers){var o=i._layers[n];o.source===r.id&&i._validateLayer(o)}}}}))}xi.getSourceType=function(t){return Z[t]},xi.setSourceType=function(t,e){Z[t]=e},xi.registerForPluginStateChange=t.registerForPluginStateChange;var wi=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Si=Xi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Ti=Xi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ei=Xi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ii=Xi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ci=Xi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ai=Xi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),ki=Xi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Pi=Xi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Oi=Xi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Mi=Xi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Li=Xi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Di=Xi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ri=Xi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),zi=Xi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Ni=Xi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Bi=Xi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Fi=Xi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ji=Xi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ui=Xi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Vi=Xi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),qi=Xi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Gi=Xi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Zi=Xi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Hi=Xi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Wi=Xi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Ki=Xi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Xi(t,e){var r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=e.match(/attribute ([\w]+) ([\w]+)/g),n=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=o?o.concat(n):n,s={};return{fragmentSource:t=t.replace(r,(function(t,e,r,i,n){return s[n]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+n+"\nvarying "+r+" "+i+" "+n+";\n#else\nuniform "+r+" "+i+" u_"+n+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+n+"\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n"})),vertexSource:e=e.replace(r,(function(t,e,r,i,n){var o="float"===i?"vec2":"vec4",a=n.match(/color/)?"color":o;return s[n]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+n+"\nuniform lowp float u_"+n+"_t;\nattribute "+r+" "+o+" a_"+n+";\nvarying "+r+" "+i+" "+n+";\n#else\nuniform "+r+" "+i+" u_"+n+";\n#endif\n":"vec4"==a?"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+n+" = a_"+n+";\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+n+" = unpack_mix_"+a+"(a_"+n+", u_"+n+"_t);\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+n+"\nuniform lowp float u_"+n+"_t;\nattribute "+r+" "+o+" a_"+n+";\n#else\nuniform "+r+" "+i+" u_"+n+";\n#endif\n":"vec4"==a?"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+r+" "+i+" "+n+" = a_"+n+";\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+r+" "+i+" "+n+" = unpack_mix_"+a+"(a_"+n+", u_"+n+"_t);\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n"})),staticAttributes:i,staticUniforms:a}}function Yi(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}var Ji=Object.freeze({__proto__:null,prelude:Si,background:Ti,backgroundPattern:Ei,circle:Ii,clippingMask:Ci,heatmap:Ai,heatmapTexture:ki,collisionBox:Pi,collisionCircle:Oi,debug:Mi,fill:Li,fillOutline:Di,fillOutlinePattern:Ri,fillPattern:zi,fillExtrusion:Ni,fillExtrusionPattern:Bi,hillshadePrepare:Fi,hillshade:ji,line:Ui,lineGradient:Vi,linePattern:qi,lineSDF:Gi,raster:Zi,symbolIcon:Hi,symbolSDF:Wi,symbolTextAndIcon:Ki});function $i(t){for(var e=[],r=0;r<t.length;r++)if(null!==t[r]){var i=t[r].split(" ");e.push(i.pop())}return e}function Qi(t,e,r,i,n,o){var a=t.gl;this.program=a.createProgram();for(var s=$i(r.staticAttributes),l=i?i.getBinderAttributes():[],c=s.concat(l),u=r.staticUniforms?$i(r.staticUniforms):[],p=i?i.getBinderUniforms():[],h=[],d=0,f=u.concat(p);d<f.length;d+=1){var m=f[d];h.indexOf(m)<0&&h.push(m)}var g=i?i.defines():[];o&&g.push("#define OVERDRAW_INSPECTOR;");var y=g.concat(Si.fragmentSource,r.fragmentSource).join("\n"),v=g.concat(Si.vertexSource,r.vertexSource).join("\n"),_=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(_,y),a.compileShader(_),a.attachShader(this.program,_);var x=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(x,v),a.compileShader(x),a.attachShader(this.program,x),this.attributes={};var b={};this.numAttributes=c.length;for(var w=0;w<this.numAttributes;w++)c[w]&&(a.bindAttribLocation(this.program,w,c[w]),this.attributes[c[w]]=w);a.linkProgram(this.program),a.deleteShader(x),a.deleteShader(_);for(var S=0;S<h.length;S++){var T=h[S];if(T&&!b[T]){var E=a.getUniformLocation(this.program,T);E&&(b[T]=E)}}this.fixedUniforms=n(t,b),this.binderUniforms=i?i.getUniforms(t,b):[]}}}function tn(t,e,r){var i=1/Vr(r,1,e.transform.tileZoom),n=Math.pow(2,r.tileID.overscaledZ),o=r.tileSize*Math.pow(2,e.transform.tileZoom)/n,a=o*(r.tileID.canonical.x+r.tileID.wrap*n),s=o*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[i,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}function en(e,r,i,n){var o=r.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],l=t.create$1();"viewport"===o.properties.get("anchor")&&t.fromRotation(l,-r.transform.angle),t.transformMat3(s,s,l);var c=o.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+i,u_opacity:n}}function rn(t){return{u_matrix:t}}function nn(e,r,i,n){return t.extend(rn(e),tn(i,r,n))}function on(e,r,i,n){var o,a,s=e.transform;if("map"===n.paint.get("circle-pitch-alignment")){var l=Vr(i,1,s.zoom);o=!0,a=[l,l]}else o=!1,a=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(r.posMatrix,i,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_device_pixel_ratio:t.browser.devicePixelRatio,u_extrude_scale:a}}function an(t){return{u_matrix:t}}function sn(e,r,i){var n=e.transform;return{u_matrix:un(e,r,i),u_ratio:1/Vr(r,1,n.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}}Yi.prototype.bind=function(t,e,r,i,n,o,a,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==i.length,c=0;!l&&c<i.length;c++)this.boundPaintVertexBuffers[c]!==i[c]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===r&&!l&&this.boundIndexBuffer===n&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s?(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),n&&n.dynamicDraw&&n.bind(),s&&s.bind()):this.freshBind(e,r,i,n,o,a,s)},Yi.prototype.freshBind=function(t,e,r,i,n,o,a){var s,l=t.numAttributes,c=this.context,u=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=i,this.boundVertexOffset=n,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=c.currentNumAttributes||0;for(var p=l;p<s;p++)u.disableVertexAttribArray(p)}e.enableAttributes(u,t);for(var h=0,d=r;h<d.length;h+=1)d[h].enableAttributes(u,t);o&&o.enableAttributes(u,t),a&&a.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,n);for(var f=0,m=r;f<m.length;f+=1){var g=m[f];g.bind(),g.setVertexAttribPointers(u,t,n)}o&&(o.bind(),o.setVertexAttribPointers(u,t,n)),i&&i.bind(),a&&(a.bind(),a.setVertexAttribPointers(u,t,n)),c.currentNumAttributes=l},Yi.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)},Qi.prototype.draw=function(t,e,r,i,n,o,a,s,l,c,u,p,h,d,f,m){var g,y=t.gl;if(!this.failedToCreate){for(var v in t.program.set(this.program),t.setDepthMode(r),t.setStencilMode(i),t.setColorMode(n),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[v].set(a[v]);d&&d.setUniforms(t,this.binderUniforms,p,{zoom:h});for(var _=((g={})[y.LINES]=2,g[y.TRIANGLES]=3,g[y.LINE_STRIP]=1,g[e]),x=0,b=u.get();x<b.length;x+=1){var w=b[x],S=w.vaos||(w.vaos={});(S[s]||(S[s]=new Yi)).bind(t,this,l,d?d.getPaintVertexBuffers():[],c,w.vertexOffset,f,m),y.drawElements(e,w.primitiveLength*_,y.UNSIGNED_SHORT,w.primitiveOffset*_*2)}}};var ln=function(t,e,r){return void 0===r&&(r=1),{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:r}};function cn(t,e){return 1/Vr(t,1,e.tileZoom)}function un(t,e,r){return t.translatePosMatrix(e.tileID.posMatrix,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}function pn(t,e,r,i,n){return{u_matrix:t,u_tl_parent:e,u_scale_parent:r,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:0<(a=n.paint.get("raster-saturation"))?1-1/(1.001-a):-a,u_contrast_factor:0<(o=n.paint.get("raster-contrast"))?1/(1-o):1+o,u_spin_weights:function(t){t*=Math.PI/180;var e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}(n.paint.get("raster-hue-rotate"))};var o,a}function hn(t,e,r,i,n,o,a,s,l,c){var u=n.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:u.cameraToCenterDistance,u_pitch:u.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:u.width/u.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+i,u_texsize:c,u_texture:0}}function dn(e,r,i,n,o,a,s,l,c,u,p){var h=o.transform;return t.extend(hn(e,r,i,n,o,a,s,l,c,u),{u_gamma_scale:n?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_device_pixel_ratio:t.browser.devicePixelRatio,u_is_halo:+p})}var fn,mn={fillExtrusion:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_lightpos:new t.Uniform3f(e,r.u_lightpos),u_lightintensity:new t.Uniform1f(e,r.u_lightintensity),u_lightcolor:new t.Uniform3f(e,r.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,r.u_vertical_gradient),u_opacity:new t.Uniform1f(e,r.u_opacity)}},fillExtrusionPattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_lightpos:new t.Uniform3f(e,r.u_lightpos),u_lightintensity:new t.Uniform1f(e,r.u_lightintensity),u_lightcolor:new t.Uniform3f(e,r.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,r.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,r.u_height_factor),u_image:new t.Uniform1i(e,r.u_image),u_texsize:new t.Uniform2f(e,r.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade),u_opacity:new t.Uniform1f(e,r.u_opacity)}},fill:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}},fillPattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_image:new t.Uniform1i(e,r.u_image),u_texsize:new t.Uniform2f(e,r.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}},fillOutline:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world)}},fillOutlinePattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world),u_image:new t.Uniform1i(e,r.u_image),u_texsize:new t.Uniform2f(e,r.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}},circle:function(e,r){return{u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,r.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,r.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}},collisionBox:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,r.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,r.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,r.u_overscale_factor)}},collisionCircle:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,r.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,r.u_viewport_size)}},debug:function(e,r){return{u_color:new t.UniformColor(e,r.u_color),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_overlay:new t.Uniform1i(e,r.u_overlay),u_overlay_scale:new t.Uniform1f(e,r.u_overlay_scale)}},clippingMask:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}},heatmap:function(e,r){return{u_extrude_scale:new t.Uniform1f(e,r.u_extrude_scale),u_intensity:new t.Uniform1f(e,r.u_intensity),u_matrix:new t.UniformMatrix4f(e,r.u_matrix)}},heatmapTexture:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_world:new t.Uniform2f(e,r.u_world),u_image:new t.Uniform1i(e,r.u_image),u_color_ramp:new t.Uniform1i(e,r.u_color_ramp),u_opacity:new t.Uniform1f(e,r.u_opacity)}},hillshade:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_image:new t.Uniform1i(e,r.u_image),u_latrange:new t.Uniform2f(e,r.u_latrange),u_light:new t.Uniform2f(e,r.u_light),u_shadow:new t.UniformColor(e,r.u_shadow),u_highlight:new t.UniformColor(e,r.u_highlight),u_accent:new t.UniformColor(e,r.u_accent)}},hillshadePrepare:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_image:new t.Uniform1i(e,r.u_image),u_dimension:new t.Uniform2f(e,r.u_dimension),u_zoom:new t.Uniform1f(e,r.u_zoom),u_maxzoom:new t.Uniform1f(e,r.u_maxzoom),u_unpack:new t.Uniform4f(e,r.u_unpack)}},line:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ratio:new t.Uniform1f(e,r.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,r.u_units_to_pixels)}},lineGradient:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ratio:new t.Uniform1f(e,r.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,r.u_units_to_pixels),u_image:new t.Uniform1i(e,r.u_image)}},linePattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_texsize:new t.Uniform2f(e,r.u_texsize),u_ratio:new t.Uniform1f(e,r.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_image:new t.Uniform1i(e,r.u_image),u_units_to_pixels:new t.Uniform2f(e,r.u_units_to_pixels),u_scale:new t.Uniform3f(e,r.u_scale),u_fade:new t.Uniform1f(e,r.u_fade)}},lineSDF:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_ratio:new t.Uniform1f(e,r.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,r.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,r.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,r.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,r.u_sdfgamma),u_image:new t.Uniform1i(e,r.u_image),u_tex_y_a:new t.Uniform1f(e,r.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,r.u_tex_y_b),u_mix:new t.Uniform1f(e,r.u_mix)}},raster:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_tl_parent:new t.Uniform2f(e,r.u_tl_parent),u_scale_parent:new t.Uniform1f(e,r.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,r.u_buffer_scale),u_fade_t:new t.Uniform1f(e,r.u_fade_t),u_opacity:new t.Uniform1f(e,r.u_opacity),u_image0:new t.Uniform1i(e,r.u_image0),u_image1:new t.Uniform1i(e,r.u_image1),u_brightness_low:new t.Uniform1f(e,r.u_brightness_low),u_brightness_high:new t.Uniform1f(e,r.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,r.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,r.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,r.u_spin_weights)}},symbolIcon:function(e,r){return{u_is_size_zoom_constant:new t.Uniform1i(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,r.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,r.u_size_t),u_size:new t.Uniform1f(e,r.u_size),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,r.u_pitch),u_rotate_symbol:new t.Uniform1i(e,r.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,r.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,r.u_fade_change),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,r.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,r.u_coord_matrix),u_is_text:new t.Uniform1i(e,r.u_is_text),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_texsize:new t.Uniform2f(e,r.u_texsize),u_texture:new t.Uniform1i(e,r.u_texture)}},symbolSDF:function(e,r){return{u_is_size_zoom_constant:new t.Uniform1i(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,r.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,r.u_size_t),u_size:new t.Uniform1f(e,r.u_size),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,r.u_pitch),u_rotate_symbol:new t.Uniform1i(e,r.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,r.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,r.u_fade_change),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,r.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,r.u_coord_matrix),u_is_text:new t.Uniform1i(e,r.u_is_text),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_texsize:new t.Uniform2f(e,r.u_texsize),u_texture:new t.Uniform1i(e,r.u_texture),u_gamma_scale:new t.Uniform1f(e,r.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,r.u_is_halo)}},symbolTextAndIcon:function(e,r){return{u_is_size_zoom_constant:new t.Uniform1i(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,r.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,r.u_size_t),u_size:new t.Uniform1f(e,r.u_size),u_camera_to_center_distance:new t.Uniform1f(e,r.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,r.u_pitch),u_rotate_symbol:new t.Uniform1i(e,r.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,r.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,r.u_fade_change),u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,r.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,r.u_coord_matrix),u_is_text:new t.Uniform1i(e,r.u_is_text),u_pitch_with_map:new t.Uniform1i(e,r.u_pitch_with_map),u_texsize:new t.Uniform2f(e,r.u_texsize),u_texsize_icon:new t.Uniform2f(e,r.u_texsize_icon),u_texture:new t.Uniform1i(e,r.u_texture),u_texture_icon:new t.Uniform1i(e,r.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,r.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,r.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,r.u_is_halo)}},background:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_opacity:new t.Uniform1f(e,r.u_opacity),u_color:new t.UniformColor(e,r.u_color)}},backgroundPattern:function(e,r){return{u_matrix:new t.UniformMatrix4f(e,r.u_matrix),u_opacity:new t.Uniform1f(e,r.u_opacity),u_image:new t.Uniform1i(e,r.u_image),u_pattern_tl_a:new t.Uniform2f(e,r.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,r.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,r.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,r.u_pattern_br_b),u_texsize:new t.Uniform2f(e,r.u_texsize),u_mix:new t.Uniform1f(e,r.u_mix),u_pattern_size_a:new t.Uniform2f(e,r.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,r.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,r.u_scale_a),u_scale_b:new t.Uniform1f(e,r.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,r.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,r.u_tile_units_to_pixels)}}};function gn(e,r,i,n,o,a,s){for(var l=e.context,c=l.gl,u=e.useProgram("collisionBox"),p=[],h=0,d=0,f=0;f<n.length;f++){var m=n[f],g=r.getTile(m),y=g.getBucket(i);if(y){var v=m.posMatrix;0===o[0]&&0===o[1]||(v=e.translatePosMatrix(m.posMatrix,g,o,a));var _=s?y.textCollisionBox:y.iconCollisionBox,x=y.collisionCircleArray;if(0<x.length){var b=t.create(),w=v;t.mul(b,y.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul(b,b,y.placementViewportMatrix),p.push({circleArray:x,circleOffset:d,transform:w,invTransform:b}),d=h+=x.length/4}_&&u.draw(l,c.LINES,er.disabled,rr.disabled,e.colorModeForRenderPass(),nr.disabled,(S=v,T=e.transform,I=Vr(E=g,1,T.zoom),C=Math.pow(2,T.zoom-E.tileID.overscaledZ),A=E.tileID.overscaleFactor(),{u_matrix:S,u_camera_to_center_distance:T.cameraToCenterDistance,u_pixels_to_tile_units:I,u_extrude_scale:[T.pixelsToGLUnits[0]/(I*C),T.pixelsToGLUnits[1]/(I*C)],u_overscale_factor:A}),i.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,null,_.collisionVertexBuffer)}}var S,T,E,I,C,A,k,P,O;if(s&&p.length){var M=e.useProgram("collisionCircle"),L=new t.StructArrayLayout2f1f2i16;L.resize(4*h),L._trim();for(var D=0,R=0,z=p;R<z.length;R+=1)for(var N=z[R],B=0;B<N.circleArray.length/4;B++){var F=4*B,j=N.circleArray[0+F],U=N.circleArray[1+F],V=N.circleArray[2+F],q=N.circleArray[3+F];L.emplace(D++,j,U,V,q,0),L.emplace(D++,j,U,V,q,1),L.emplace(D++,j,U,V,q,2),L.emplace(D++,j,U,V,q,3)}(!fn||fn.length<2*h)&&(fn=function(){var e=2*h,r=new t.StructArrayLayout3ui6;r.resize(e),r._trim();for(var i=0;i<e;i++){var n=6*i;r.uint16[0+n]=4*i+0,r.uint16[1+n]=4*i+1,r.uint16[2+n]=4*i+2,r.uint16[3+n]=4*i+2,r.uint16[4+n]=4*i+3,r.uint16[5+n]=4*i+0}return r}());for(var G=l.createIndexBuffer(fn,!0),Z=l.createVertexBuffer(L,t.collisionCircleLayout.members,!0),H=0,W=p;H<W.length;H+=1){var K=W[H],X=(k=K.transform,P=K.invTransform,O=e.transform,{u_matrix:k,u_inv_matrix:P,u_camera_to_center_distance:O.cameraToCenterDistance,u_viewport_size:[O.width,O.height]});M.draw(l,c.TRIANGLES,er.disabled,rr.disabled,e.colorModeForRenderPass(),nr.disabled,X,i.id,Z,G,t.SegmentVector.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,e.transform.zoom,null,null,null)}Z.destroy(),G.destroy()}}var yn=t.identity(new Float32Array(16));function vn(e,r,i,n,o,a,s,l,c,u,p){var h,d,f,m,g,y,v,_,x,b,w=e.text.placedSymbolArray,S=e.text.dynamicLayoutVertexArray,T=e.icon.dynamicLayoutVertexArray,E={};S.clear();for(var I=0;I<w.length;I++){var C=w.get(I),A=C.hidden||!C.crossTileID||e.allowVerticalPlacement&&!C.placedOrientation?null:n[C.crossTileID];if(A){var k=new t.Point(C.anchorX,C.anchorY),P=Pr(k,i?l:s),O=Or(a.cameraToCenterDistance,P.signedDistanceFromCamera),M=o.evaluateSizeForFeature(e.textSizeData,u,C)*O/t.ONE_EM;i&&(M*=e.tilePixelRatio/c);for(var L=(h=A.anchor,d=A.width,f=A.height,m=A.textOffset,g=A.textBoxScale,y=M,v=t.getAnchorAlignment(h),_=-(v.horizontalAlign-.5)*d,x=-(v.verticalAlign-.5)*f,b=t.evaluateVariableOffset(h,m),new t.Point((_/g+b[0])*y,(x/g+b[1])*y)),D=i?Pr(k.add(L),s).point:P.point.add(r?L.rotate(-a.angle):L),R=e.allowVerticalPlacement&&C.placedOrientation===t.WritingMode.vertical?Math.PI/2:0,z=0;z<C.numGlyphs;z++)t.addDynamicAttributes(S,D,R);p&&0<=C.associatedIconIndex&&(E[C.associatedIconIndex]={shiftedAnchor:D,angle:R})}else Fr(C.numGlyphs,S)}if(p){T.clear();for(var N=e.icon.placedSymbolArray,B=0;B<N.length;B++){var F=N.get(B);if(F.hidden)Fr(F.numGlyphs,T);else{var j=E[B];if(j)for(var U=0;U<F.numGlyphs;U++)t.addDynamicAttributes(T,j.shiftedAnchor,j.angle);else Fr(F.numGlyphs,T)}}e.icon.dynamicLayoutVertexBuffer.updateData(T)}e.text.dynamicLayoutVertexBuffer.updateData(S)}function _n(e,r,i,n,o,a,s,l,c,u,p,h){for(var d=e.context,f=d.gl,m=e.transform,g="map"===l,y="map"===c,v=g&&"point"!==i.layout.get("symbol-placement"),_=g&&!y&&!v,x=void 0!==i.layout.get("symbol-sort-key").constantOr(1),b=e.depthModeForSublayer(0,er.ReadOnly),w=i.layout.get("text-variable-anchor"),S=[],T=0,E=n;T<E.length;T+=1){var I=E[T],C=r.getTile(I),A=C.getBucket(i);if(A){var k=o?A.text:A.icon;if(k&&k.segments.get().length){var P=k.programConfigurations.get(i.id),O=o||A.sdfIcons,M=o?A.textSizeData:A.iconSizeData,L=y||0!==m.pitch,D=e.useProgram((ht=O,dt=o,A.iconsInText&&dt?"symbolTextAndIcon":ht?"symbolSDF":"symbolIcon"),P),R=t.evaluateSizeForZoom(M,m.zoom),z=void 0,N=[0,0],B=void 0,F=void 0,j=null,U=void 0;if(o)B=C.glyphAtlasTexture,F=f.LINEAR,z=C.glyphAtlasTexture.size,A.iconsInText&&(N=C.imageAtlasTexture.size,j=C.imageAtlasTexture,U=L||e.options.rotating||e.options.zooming||"composite"===M.kind||"camera"===M.kind?f.LINEAR:f.NEAREST);else{var V=1!==i.layout.get("icon-size").constantOr(0)||A.iconsNeedLinear;B=C.imageAtlasTexture,F=O||e.options.rotating||e.options.zooming||V||L?f.LINEAR:f.NEAREST,z=C.imageAtlasTexture.size}var q=Vr(C,1,e.transform.zoom),G=Ar(I.posMatrix,y,g,e.transform,q),Z=kr(I.posMatrix,y,g,e.transform,q),H=w&&A.hasTextData(),W="none"!==i.layout.get("icon-text-fit")&&H&&A.hasIconData();v&&Mr(A,I.posMatrix,e,o,G,Z,y,u);var K=e.translatePosMatrix(I.posMatrix,C,a,s),X=v||o&&w||W?yn:G,Y=e.translatePosMatrix(Z,C,a,s,!0),J=O&&0!==i.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),$={program:D,buffers:k,uniformValues:O?A.iconsInText?(rt=M.kind,it=R,nt=_,ot=y,at=e,st=K,lt=X,ct=Y,ut=z,pt=N,t.extend(dn(rt,it,nt,ot,at,st,lt,ct,!0,ut,!0),{u_texsize_icon:pt,u_texture_icon:1})):dn(M.kind,R,_,y,e,K,X,Y,o,z,!0):hn(M.kind,R,_,y,e,K,X,Y,o,z),atlasTexture:B,atlasTextureIcon:j,atlasInterpolation:F,atlasInterpolationIcon:U,isSDF:O,hasHalo:J};if(x)for(var Q=0,tt=k.segments.get();Q<tt.length;Q+=1){var et=tt[Q];S.push({segments:new t.SegmentVector([et]),sortKey:et.sortKey,state:$})}else S.push({segments:k.segments,sortKey:0,state:$})}}}var rt,it,nt,ot,at,st,lt,ct,ut,pt,ht,dt;x&&S.sort((function(t,e){return t.sortKey-e.sortKey}));for(var ft=0,mt=S;ft<mt.length;ft+=1){var gt=mt[ft],yt=gt.state;if(d.activeTexture.set(f.TEXTURE0),yt.atlasTexture.bind(yt.atlasInterpolation,f.CLAMP_TO_EDGE),yt.atlasTextureIcon&&(d.activeTexture.set(f.TEXTURE1),yt.atlasTextureIcon&&yt.atlasTextureIcon.bind(yt.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),yt.isSDF){var vt=yt.uniformValues;yt.hasHalo&&(vt.u_is_halo=1,xn(yt.buffers,gt.segments,i,e,yt.program,b,p,h,vt)),vt.u_is_halo=0}xn(yt.buffers,gt.segments,i,e,yt.program,b,p,h,yt.uniformValues)}}function xn(t,e,r,i,n,o,a,s,l){var c=i.context;n.draw(c,c.gl.TRIANGLES,o,a,s,nr.disabled,l,r.id,t.layoutVertexBuffer,t.indexBuffer,e,r.paint,i.transform.zoom,t.programConfigurations.get(r.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function bn(e,r,i,n,o,a,s){var l,c,u,p,h,d,f,m,g,y,v=e.context.gl,_=i.paint.get("fill-pattern"),x=_&&_.constantOr(1),b=i.getCrossfadeParameters();l=s?(c=x&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",v.LINES):(c=x?"fillPattern":"fill",v.TRIANGLES);for(var w=0,S=n;w<S.length;w+=1){var T=S[w],E=r.getTile(T);if(!x||E.patternsLoaded()){var I=E.getBucket(i);if(I){var C=I.programConfigurations.get(i.id),A=e.useProgram(c,C);x&&(e.context.activeTexture.set(v.TEXTURE0),E.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),C.updatePaintBuffers(b));var k=_.constantOr(null);if(k&&E.imageAtlas){var P=E.imageAtlas,O=P.patternPositions[k.to.toString()],M=P.patternPositions[k.from.toString()];O&&M&&C.setConstantPatternPositions(O,M)}var L=e.translatePosMatrix(T.posMatrix,E,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(s){p=I.indexBuffer2,h=I.segments2;var D=[v.drawingBufferWidth,v.drawingBufferHeight];u="fillOutlinePattern"===c&&x?(d=L,f=e,m=b,g=E,y=D,t.extend(nn(d,f,m,g),{u_world:y})):{u_matrix:L,u_world:D}}else p=I.indexBuffer,h=I.segments,u=x?nn(L,e,b,E):rn(L);A.draw(e.context,l,o,e.stencilModeForClipping(T),a,nr.disabled,u,i.id,I.layoutVertexBuffer,p,h,i.paint,e.transform.zoom,C)}}}}function wn(e,r,i,n,o,a,s){for(var l=e.context,c=l.gl,u=i.paint.get("fill-extrusion-pattern"),p=u.constantOr(1),h=i.getCrossfadeParameters(),d=i.paint.get("fill-extrusion-opacity"),f=0,m=n;f<m.length;f+=1){var g=m[f],y=r.getTile(g),v=y.getBucket(i);if(v){var _=v.programConfigurations.get(i.id),x=e.useProgram(p?"fillExtrusionPattern":"fillExtrusion",_);p&&(e.context.activeTexture.set(c.TEXTURE0),y.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),_.updatePaintBuffers(h));var b=u.constantOr(null);if(b&&y.imageAtlas){var w=y.imageAtlas,S=w.patternPositions[b.to.toString()],T=w.patternPositions[b.from.toString()];S&&T&&_.setConstantPatternPositions(S,T)}var E=e.translatePosMatrix(g.posMatrix,y,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),I=i.paint.get("fill-extrusion-vertical-gradient"),C=p?(A=E,k=e,P=I,O=d,M=g,L=h,D=y,t.extend(en(A,k,P,O),tn(L,k,D),{u_height_factor:-Math.pow(2,M.overscaledZ)/D.tileSize/8})):en(E,e,I,d);x.draw(l,l.gl.TRIANGLES,o,a,s,nr.backCCW,C,i.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,i.paint,e.transform.zoom,_)}}var A,k,P,O,M,L,D}function Sn(e,r,i,n,o,a){var s=e.context,l=s.gl,c=r.fbo;if(c){var u=e.useProgram("hillshade");s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get());var p=function(e,r,i){var n=i.paint.get("hillshade-shadow-color"),o=i.paint.get("hillshade-highlight-color"),a=i.paint.get("hillshade-accent-color"),s=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);var l,c,u,p=!e.options.moving;return{u_matrix:e.transform.calculatePosMatrix(r.tileID.toUnwrapped(),p),u_image:0,u_latrange:(l=r.tileID,c=Math.pow(2,l.canonical.z),u=l.canonical.y,[new t.MercatorCoordinate(0,u/c).toLngLat().lat,new t.MercatorCoordinate(0,(u+1)/c).toLngLat().lat]),u_light:[i.paint.get("hillshade-exaggeration"),s],u_shadow:n,u_highlight:o,u_accent:a}}(e,r,i);u.draw(s,l.TRIANGLES,n,o,a,nr.disabled,p,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}function Tn(e,r,i,n,o,a,s){var l,c,u,p,h,d=e.context,f=d.gl,m=r.dem;if(m&&m.data){var g=m.dim,y=m.stride,v=m.getPixels();if(d.activeTexture.set(f.TEXTURE1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||e.getTileTexture(y),r.demTexture){var _=r.demTexture;_.update(v,{premultiply:!1}),_.bind(f.NEAREST,f.CLAMP_TO_EDGE)}else r.demTexture=new t.Texture(d,v,f.RGBA,{premultiply:!1}),r.demTexture.bind(f.NEAREST,f.CLAMP_TO_EDGE);d.activeTexture.set(f.TEXTURE0);var x=r.fbo;if(!x){var b=new t.Texture(d,{width:g,height:g,data:null},f.RGBA);b.bind(f.LINEAR,f.CLAMP_TO_EDGE),(x=r.fbo=d.createFramebuffer(g,g,!0)).colorAttachment.set(b.texture)}d.bindFramebuffer.set(x.framebuffer),d.viewport.set([0,0,g,g]),e.useProgram("hillshadePrepare").draw(d,f.TRIANGLES,o,a,s,nr.disabled,(l=r.tileID,u=n,p=(c=m).stride,h=t.create(),t.ortho(h,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(h,h,[0,-t.EXTENT,0]),{u_matrix:h,u_image:1,u_dimension:[p,p],u_zoom:l.overscaledZ,u_maxzoom:u,u_unpack:c.getUnpackVector()}),i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function En(e,r,i,n,o){var a=n.paint.get("raster-fade-duration");if(0<a){var s=t.browser.now(),l=(s-e.timeAdded)/a,c=r?(s-r.timeAdded)/a:-1,u=i.getSource(),p=o.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),h=!r||Math.abs(r.tileID.overscaledZ-p)>Math.abs(e.tileID.overscaledZ-p),d=h&&e.refreshedUponExpiration?1:t.clamp(h?l:1-c,0,1);return e.refreshedUponExpiration&&1<=l&&(e.refreshedUponExpiration=!1),r?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}var In=new t.Color(1,0,0,1),Cn=new t.Color(0,1,0,1),An=new t.Color(0,0,1,1),kn=new t.Color(1,0,1,1),Pn=new t.Color(0,1,1,1);function On(t,e,r,i){Ln(t,0,e+r/2,t.transform.width,r,i)}function Mn(t,e,r,i){Ln(t,e-r/2,0,r,t.transform.height,i)}function Ln(e,r,i,n,o,a){var s=e.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(r*t.browser.devicePixelRatio,i*t.browser.devicePixelRatio,n*t.browser.devicePixelRatio,o*t.browser.devicePixelRatio),s.clear({color:a}),l.disable(l.SCISSOR_TEST)}function Dn(e,r,i){var n=e.context,o=n.gl,a=i.posMatrix,s=e.useProgram("debug"),l=er.disabled,c=rr.disabled,u=e.colorModeForRenderPass();n.activeTexture.set(o.TEXTURE0),e.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),s.draw(n,o.LINE_STRIP,l,c,u,nr.disabled,ln(a,t.Color.red),"$debug",e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);var p=r.getTileByID(i.key).latestRawTileData,h=Math.floor((p&&p.byteLength||0)/1024),d=r.getTile(i).tileSize,f=512/Math.min(d,512)*(i.overscaledZ/e.transform.zoom)*.5,m=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(m+=" => "+i.overscaledZ),function(t,e){t.initDebugOverlayCanvas();var r=t.debugOverlayCanvas,i=t.context.gl,n=t.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,r.width,r.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),t.debugOverlayTexture.update(r),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(e,m+" "+h+"kb"),s.draw(n,o.TRIANGLES,l,c,ir.alphaBlended,nr.disabled,ln(a,t.Color.transparent,f),"$debug",e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}function Rn(t,e){this.context=new or(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=sr.maxUnderzooming+sr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fi,this.gpuTimers={}}var zn={symbol:function(e,r,i,n,o){if("translucent"===e.renderPass){var a=rr.disabled,s=e.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(e,r,i,n,o,a,s){for(var l=r.transform,c="map"===o,u="map"===a,p=0,h=e;p<h.length;p+=1){var d=h[p],f=n.getTile(d),m=f.getBucket(i);if(m&&m.text&&m.text.segments.get().length){var g=t.evaluateSizeForZoom(m.textSizeData,l.zoom),y=Vr(f,1,r.transform.zoom),v=Ar(d.posMatrix,u,c,r.transform,y),_="none"!==i.layout.get("icon-text-fit")&&m.hasIconData();if(g){var x=Math.pow(2,l.zoom-f.tileID.overscaledZ);vn(m,c,u,s,t.symbolSize,l,v,d.posMatrix,x,g,_)}}}}(n,e,i,r,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),o),0!==i.paint.get("icon-opacity").constantOr(1)&&_n(e,r,i,n,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),a,s),0!==i.paint.get("text-opacity").constantOr(1)&&_n(e,r,i,n,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),a,s),r.map.showCollisionBoxes&&(gn(e,r,i,n,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),gn(e,r,i,n,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(e,r,i,n){if("translucent"===e.renderPass){var o=i.paint.get("circle-opacity"),a=i.paint.get("circle-stroke-width"),s=i.paint.get("circle-stroke-opacity"),l=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==s.constantOr(1)){for(var c=e.context,u=c.gl,p=e.depthModeForSublayer(0,er.ReadOnly),h=rr.disabled,d=e.colorModeForRenderPass(),f=[],m=0;m<n.length;m++){var g=n[m],y=r.getTile(g),v=y.getBucket(i);if(v){var _=v.programConfigurations.get(i.id),x={programConfiguration:_,program:e.useProgram("circle",_),layoutVertexBuffer:v.layoutVertexBuffer,indexBuffer:v.indexBuffer,uniformValues:on(e,g,y,i)};if(l)for(var b=0,w=v.segments.get();b<w.length;b+=1){var S=w[b];f.push({segments:new t.SegmentVector([S]),sortKey:S.sortKey,state:x})}else f.push({segments:v.segments,sortKey:0,state:x})}}l&&f.sort((function(t,e){return t.sortKey-e.sortKey}));for(var T=0,E=f;T<E.length;T+=1){var I=E[T],C=I.state;C.program.draw(c,u.TRIANGLES,p,h,d,nr.disabled,C.uniformValues,i.id,C.layoutVertexBuffer,C.indexBuffer,I.segments,i.paint,e.transform.zoom,C.programConfiguration)}}}},heatmap:function(e,r,i,n){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,s=rr.disabled,l=new ir([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,r){var i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var n,o,a,s=r.heatmapFbo;if(s)i.bindTexture(i.TEXTURE_2D,s.colorAttachment.get()),t.bindFramebuffer.set(s.framebuffer);else{var l=i.createTexture();i.bindTexture(i.TEXTURE_2D,l),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),s=r.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),n=l,o=s,(a=t.gl).texImage2D(a.TEXTURE_2D,0,a.RGBA,e.width/4,e.height/4,0,a.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:a.UNSIGNED_BYTE,null),o.colorAttachment.set(n)}}(o,e,i),o.clear({color:t.Color.transparent});for(var c=0;c<n.length;c++){var u=n[c];if(!r.hasRenderableParent(u)){var p=r.getTile(u),h=p.getBucket(i);if(h){var d=h.programConfigurations.get(i.id);e.useProgram("heatmap",d).draw(o,a.TRIANGLES,er.disabled,s,l,nr.disabled,(f=u.posMatrix,m=p,g=e.transform.zoom,y=i.paint.get("heatmap-intensity"),{u_matrix:f,u_extrude_scale:Vr(m,1,g),u_intensity:y}),i.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,i.paint,e.transform.zoom,d)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,r){var i=e.context,n=i.gl,o=r.heatmapFbo;if(o){i.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(n.TEXTURE1);var a=r.colorRampTexture;(a=a||(r.colorRampTexture=new t.Texture(i,r.colorRamp,n.RGBA))).bind(n.LINEAR,n.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(i,n.TRIANGLES,er.disabled,rr.disabled,e.colorModeForRenderPass(),nr.disabled,function(e,r){var i=t.create();t.ortho(i,0,e.width,e.height,0,0,1);var n=e.context.gl;return{u_matrix:i,u_world:[n.drawingBufferWidth,n.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:r.paint.get("heatmap-opacity")}}(e,r),r.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,r.paint,e.transform.zoom)}}(e,i));var f,m,g,y},line:function(e,r,i,n){if("translucent"===e.renderPass){var o=i.paint.get("line-opacity"),a=i.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=e.depthModeForSublayer(0,er.ReadOnly),l=e.colorModeForRenderPass(),c=i.paint.get("line-dasharray"),u=i.paint.get("line-pattern"),p=u.constantOr(1),h=i.paint.get("line-gradient"),d=i.getCrossfadeParameters(),f=p?"linePattern":c?"lineSDF":h?"lineGradient":"line",m=e.context,g=m.gl,y=!0;if(h){m.activeTexture.set(g.TEXTURE0);var v=i.gradientTexture;if(!i.gradient)return;(v=v||(i.gradientTexture=new t.Texture(m,i.gradient,g.RGBA))).bind(g.LINEAR,g.CLAMP_TO_EDGE)}for(var _=0,x=n;_<x.length;_+=1){var b=x[_],w=r.getTile(b);if(!p||w.patternsLoaded()){var S=w.getBucket(i);if(S){var T=S.programConfigurations.get(i.id),E=e.context.program.get(),I=e.useProgram(f,T),C=y||I.program!==E,A=u.constantOr(null);if(A&&w.imageAtlas){var k=w.imageAtlas,P=k.patternPositions[A.to.toString()],O=k.patternPositions[A.from.toString()];P&&O&&T.setConstantPatternPositions(P,O)}var M=p?(X=w,Y=i,J=d,$=(K=e).transform,Q=cn(X,$),{u_matrix:un(K,X,Y),u_texsize:X.imageAtlasTexture.size,u_ratio:1/Vr(X,1,$.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_image:0,u_scale:[Q,J.fromScale,J.toScale],u_fade:J.t,u_units_to_pixels:[1/$.pixelsToGLUnits[0],1/$.pixelsToGLUnits[1]]}):c?(N=w,B=i,F=c,j=d,U=void 0,U=(z=e).lineAtlas,V=cn(N,z.transform),q="round"===B.layout.get("line-cap"),G=U.getDash(F.from,q),Z=U.getDash(F.to,q),H=G.width*j.fromScale,W=Z.width*j.toScale,t.extend(sn(z,N,B),{u_patternscale_a:[V/H,-G.height/2],u_patternscale_b:[V/W,-Z.height/2],u_sdfgamma:U.width/(256*Math.min(H,W)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:G.y,u_tex_y_b:Z.y,u_mix:j.t})):h?(L=e,D=w,R=i,t.extend(sn(L,D,R),{u_image:0})):sn(e,w,i);p?(m.activeTexture.set(g.TEXTURE0),w.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),T.updatePaintBuffers(d)):c&&(C||e.lineAtlas.dirty)&&(m.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(m)),I.draw(m,g.TRIANGLES,s,e.stencilModeForClipping(b),l,nr.disabled,M,i.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,i.paint,e.transform.zoom,T),y=!1}}}}}var L,D,R,z,N,B,F,j,U,V,q,G,Z,H,W,K,X,Y,J,$,Q},fill:function(e,r,i,n){var o=i.paint.get("fill-color"),a=i.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){var u=e.depthModeForSublayer(1,"opaque"===e.renderPass?er.ReadWrite:er.ReadOnly);bn(e,r,i,n,u,s,!1)}if("translucent"===e.renderPass&&i.paint.get("fill-antialias")){var p=e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,er.ReadOnly);bn(e,r,i,n,p,s,!0)}}},"fill-extrusion":function(t,e,r,i){var n=r.paint.get("fill-extrusion-opacity");if(0!==n&&"translucent"===t.renderPass){var o=new er(t.context.gl.LEQUAL,er.ReadWrite,t.depthRangeFor3D);if(1!==n||r.paint.get("fill-extrusion-pattern").constantOr(1))wn(t,e,r,i,o,rr.disabled,ir.disabled),wn(t,e,r,i,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var a=t.colorModeForRenderPass();wn(t,e,r,i,o,rr.disabled,a)}}},hillshade:function(t,e,r,i){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var n=t.context,o=e.getSource().maxzoom,a=t.depthModeForSublayer(0,er.ReadOnly),s=t.colorModeForRenderPass(),l="translucent"===t.renderPass?t.stencilConfigForOverlap(i):[{},i],c=l[0],u=0,p=l[1];u<p.length;u+=1){var h=p[u],d=e.getTile(h);d.needsHillshadePrepare&&"offscreen"===t.renderPass?Tn(t,d,r,o,a,rr.disabled,s):"translucent"===t.renderPass&&Sn(t,d,r,a,c[h.overscaledZ],s)}n.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,r,i){if("translucent"===t.renderPass&&0!==r.paint.get("raster-opacity")&&i.length)for(var n=t.context,o=n.gl,a=e.getSource(),s=t.useProgram("raster"),l=t.colorModeForRenderPass(),c=a instanceof V?[{},i]:t.stencilConfigForOverlap(i),u=c[0],p=c[1],h=p[p.length-1].overscaledZ,d=!t.options.moving,f=0,m=p;f<m.length;f+=1){var g=m[f],y=t.depthModeForSublayer(g.overscaledZ-h,1===r.paint.get("raster-opacity")?er.ReadWrite:er.ReadOnly,o.LESS),v=e.getTile(g),_=t.transform.calculatePosMatrix(g.toUnwrapped(),d);v.registerFadeDuration(r.paint.get("raster-fade-duration"));var x=e.findLoadedParent(g,0),b=En(v,x,e,r,t.transform),w=void 0,S=void 0,T="nearest"===r.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;n.activeTexture.set(o.TEXTURE0),v.texture.bind(T,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(o.TEXTURE1),x?(x.texture.bind(T,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,x.tileID.overscaledZ-v.tileID.overscaledZ),S=[v.tileID.canonical.x*w%1,v.tileID.canonical.y*w%1]):v.texture.bind(T,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var E=pn(_,S||[0,0],w||1,b,r);a instanceof V?s.draw(n,o.TRIANGLES,y,rr.disabled,l,nr.disabled,E,r.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):s.draw(n,o.TRIANGLES,y,u[g.overscaledZ],l,nr.disabled,E,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(e,r,i){var n,o,a,s,l,c,u,p,h,d,f,m,g,y,v,_,x,b,w,S=i.paint.get("background-color"),T=i.paint.get("background-opacity");if(0!==T){var E=e.context,I=E.gl,C=e.transform,A=C.tileSize,k=i.paint.get("background-pattern");if(!e.isPatternMissing(k)){var P=!k&&1===S.a&&1===T&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass===P){var O=rr.disabled,M=e.depthModeForSublayer(0,"opaque"==P?er.ReadWrite:er.ReadOnly),L=e.colorModeForRenderPass(),D=e.useProgram(k?"backgroundPattern":"background"),R=C.coveringTiles({tileSize:A});k&&(E.activeTexture.set(I.TEXTURE0),e.imageManager.bind(e.context));for(var z=i.getCrossfadeParameters(),N=0,B=R;N<B.length;N+=1){var F=B[N],j=e.transform.calculatePosMatrix(F.toUnwrapped()),U=k?(n=j,o=T,a=e,s=k,l={tileID:F,tileSize:A},c=z,w=b=x=_=v=y=g=m=f=d=h=p=u=void 0,t.extend((u=s,p=c,d=l,f=(h=a).imageManager.getPattern(u.from.toString()),m=h.imageManager.getPattern(u.to.toString()),g=h.imageManager.getPixelSize(),y=g.width,v=g.height,_=Math.pow(2,d.tileID.overscaledZ),x=d.tileSize*Math.pow(2,h.transform.tileZoom)/_,b=x*(d.tileID.canonical.x+d.tileID.wrap*_),w=x*d.tileID.canonical.y,{u_image:0,u_pattern_tl_a:f.tl,u_pattern_br_a:f.br,u_pattern_tl_b:m.tl,u_pattern_br_b:m.br,u_texsize:[y,v],u_mix:p.t,u_pattern_size_a:f.displaySize,u_pattern_size_b:m.displaySize,u_scale_a:p.fromScale,u_scale_b:p.toScale,u_tile_units_to_pixels:1/Vr(d,1,h.transform.tileZoom),u_pixel_coord_upper:[b>>16,w>>16],u_pixel_coord_lower:[65535&b,65535&w]}),{u_matrix:n,u_opacity:o})):{u_matrix:j,u_opacity:T,u_color:S};D.draw(E,I.TRIANGLES,M,O,L,nr.disabled,U,i.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}}}},debug:function(t,e,r){for(var i=0;i<r.length;i++)Dn(t,e,r[i])},custom:function(t,e,r){var i=t.context,n=r.implementation;if("offscreen"===t.renderPass){var o=n.prerender;o&&(t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),o.call(n,i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),i.setStencilMode(rr.disabled);var a="3d"===n.renderingMode?new er(t.context.gl.LEQUAL,er.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,er.ReadOnly);i.setDepthMode(a),n.render(i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState(),i.bindFramebuffer.set(null)}}};function Nn(t,e){this.points=t,this.planes=e}function Bn(e,r){this.min=e,this.max=r,this.center=t.scale$2([],t.add([],this.min,this.max),.5)}function Fn(t,e,r,i){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=0),isNaN(t)||t<0||isNaN(e)||e<0||isNaN(r)||r<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=r,this.right=i}function jn(e,r,i,n,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=e||0,this._maxZoom=r||22,this._minPitch=null==i?0:i,this._maxPitch=null==n?60:n,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Fn,this._posMatrixCache={},this._alignedPosMatrixCache={}}Rn.prototype.resize=function(e,r){if(this.width=e*t.browser.devicePixelRatio,this.height=r*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,n=this.style._order;i<n.length;i+=1)this.style._layers[n[i]].resize()},Rn.prototype.setup=function(){var e=this.context,r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(r,wi.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var i=new t.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(t.EXTENT,0),i.emplaceBack(0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(i,wi.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var n=new t.StructArrayLayout4i8;n.emplaceBack(0,0,0,0),n.emplaceBack(t.EXTENT,0,t.EXTENT,0),n.emplaceBack(0,t.EXTENT,0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(n,U.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,wi.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);var s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA);var l=this.context.gl;this.stencilClearMode=new rr({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)},Rn.prototype.clearStencil=function(){var e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var i=t.create();t.ortho(i,0,this.width,this.height,0,0,1),t.scale(i,i,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,r.TRIANGLES,er.disabled,this.stencilClearMode,ir.disabled,nr.disabled,an(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Rn.prototype._renderTileClippingMasks=function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var r=this.context,i=r.gl;256<this.nextStencilID+e.length&&this.clearStencil(),r.setColorMode(ir.disabled),r.setDepthMode(er.disabled);var n=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,a=e;o<a.length;o+=1){var s=a[o],l=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;n.draw(r,i.TRIANGLES,er.disabled,new rr({func:i.ALWAYS,mask:0},l,255,i.KEEP,i.KEEP,i.REPLACE),ir.disabled,nr.disabled,an(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Rn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,256<this.nextStencilID+1&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new rr({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)},Rn.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new rr({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},Rn.prototype.stencilConfigForOverlap=function(t){var e,r=this.context.gl,i=t.sort((function(t,e){return e.overscaledZ-t.overscaledZ})),n=i[i.length-1].overscaledZ,o=i[0].overscaledZ-n+1;if(1<o){this.currentStencilSource=void 0,256<this.nextStencilID+o&&this.clearStencil();for(var a={},s=0;s<o;s++)a[s+n]=new rr({func:r.GEQUAL,mask:255},s+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=o,[a,i]}return[((e={})[n]=rr.disabled,e),i]},Rn.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new ir([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ir.unblended:ir.alphaBlended},Rn.prototype.depthModeForSublayer=function(t,e,r){if(!this.opaquePassEnabledForLayer())return er.disabled;var i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new er(r||this.context.gl.LEQUAL,e,[i,i])},Rn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Rn.prototype.render=function(e,r){var i=this;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now()),this.imageManager.beginFrame();var n=this.style._order,o=this.style.sourceCaches;for(var a in o){var s=o[a];s.used&&s.prepare(this.context)}var l,c,u={},p={},h={};for(var d in o){var f=o[d];u[d]=f.getVisibleCoordinates(),p[d]=u[d].slice().reverse(),h[d]=f.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var m=0;m<n.length;m++)if(this.style._layers[n[m]].is3D()){this.opaquePassCutoff=m;break}this.renderPass="offscreen";for(var g=0,y=n;g<y.length;g+=1){var v=this.style._layers[y[g]];if(v.hasOffscreenPass()&&!v.isHidden(this.transform.zoom)){var _=p[v.source];"custom"!==v.type&&!_.length||this.renderLayer(this,o[v.source],v,_)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=n.length-1;0<=this.currentLayer;this.currentLayer--){var x=this.style._layers[n[this.currentLayer]],b=o[x.source],w=u[x.source];this._renderTileClippingMasks(x,w),this.renderLayer(this,b,x,w)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){var S=this.style._layers[n[this.currentLayer]],T=o[S.source],E=("symbol"===S.type?h:p)[S.source];this._renderTileClippingMasks(S,u[S.source]),this.renderLayer(this,T,S,E)}this.options.showTileBoundaries&&(t.values(this.style._layers).forEach((function(t){t.source&&!t.isHidden(i.transform.zoom)&&(t.source!==(c&&c.id)&&(c=i.style.sourceCaches[t.source]),(!l||l.getSource().maxzoom<c.getSource().maxzoom)&&(l=c))})),l&&zn.debug(this,l,l.getVisibleCoordinates())),this.options.showPadding&&function(t){var e=t.transform.padding;On(t,t.transform.height-(e.top||0),3,In),On(t,e.bottom||0,3,Cn),Mn(t,e.left||0,3,An),Mn(t,t.transform.width-(e.right||0),3,kn);var r,i,n,o,a=t.transform.centerPoint;r=t,i=a.x,n=t.transform.height-a.y,Ln(r,i-1,n-10,2,20,o=Pn),Ln(r,i-10,n-1,20,2,o)}(this),this.context.setDefault()},Rn.prototype.renderLayer=function(t,e,r,i){r.isHidden(this.transform.zoom)||"background"!==r.type&&"custom"!==r.type&&!i.length||(this.id=r.id,this.gpuTimingStart(r),zn[r.type](t,e,r,i,this.style.placement.variableOffsets),this.gpuTimingEnd())},Rn.prototype.gpuTimingStart=function(t){if(this.options.gpuTiming){var e=this.context.extTimerQuery,r=this.gpuTimers[t.id];(r=r||(this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()})).calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,r.query)}},Rn.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}},Rn.prototype.collectGpuTimers=function(){var t=this.gpuTimers;return this.gpuTimers={},t},Rn.prototype.queryGpuTimers=function(t){var e={};for(var r in t){var i=t[r],n=this.context.extTimerQuery,o=n.getQueryObjectEXT(i.query,n.QUERY_RESULT_EXT)/1e6;n.deleteQueryEXT(i.query),e[r]=o}return e},Rn.prototype.translatePosMatrix=function(e,r,i,n,o){if(!i[0]&&!i[1])return e;var a=o?"map"===n?this.transform.angle:0:"viewport"===n?-this.transform.angle:0;if(a){var s=Math.sin(a),l=Math.cos(a);i=[i[0]*l-i[1]*s,i[0]*s+i[1]*l]}var c=[o?i[0]:Vr(r,i[0],this.transform.zoom),o?i[1]:Vr(r,i[1],this.transform.zoom),0],u=new Float32Array(16);return t.translate(u,e,c),u},Rn.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},Rn.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&0<e.length?e.pop():null},Rn.prototype.isPatternMissing=function(t){if(!t)return!1;if(!t.from||!t.to)return!0;var e=this.imageManager.getPattern(t.from.toString()),r=this.imageManager.getPattern(t.to.toString());return!e||!r},Rn.prototype.useProgram=function(t,e){this.cache=this.cache||{};var r=""+t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new Qi(this.context,0,Ji[t],e,mn[t],this._showOverdrawInspector)),this.cache[r]},Rn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Rn.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)},Rn.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Rn.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()},Nn.fromInvProjectionMatrix=function(e,r,i){var n=Math.pow(2,i),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(r){return t.transformMat4([],r,e)})).map((function(e){return t.scale$1([],e,1/e[3]/r*n)})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(e){var r=t.sub([],o[e[0]],o[e[1]]),i=t.sub([],o[e[2]],o[e[1]]),n=t.normalize([],t.cross([],r,i)),a=-t.dot(n,o[e[1]]);return n.concat(a)}));return new Nn(o,a)},Bn.prototype.quadrant=function(e){for(var r=[e%2==0,e<2],i=t.clone$2(this.min),n=t.clone$2(this.max),o=0;o<r.length;o++)i[o]=r[o]?this.min[o]:this.center[o],n[o]=r[o]?this.center[o]:this.max[o];return n[2]=this.max[2],new Bn(i,n)},Bn.prototype.distanceX=function(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]},Bn.prototype.distanceY=function(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]},Bn.prototype.intersects=function(e){for(var r=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,n=0;n<e.planes.length;n++){for(var o=e.planes[n],a=0,s=0;s<r.length;s++)a+=0<=t.dot$1(o,r[s]);if(0===a)return 0;a!==r.length&&(i=!1)}if(i)return 2;for(var l=0;l<3;l++){for(var c=Number.MAX_VALUE,u=-Number.MAX_VALUE,p=0;p<e.points.length;p++){var h=e.points[p][l]-this.min[l];c=Math.min(c,h),u=Math.max(u,h)}if(u<0||c>this.max[l]-this.min[l])return 0}return 1},Fn.prototype.interpolate=function(e,r,i){return null!=r.top&&null!=e.top&&(this.top=t.number(e.top,r.top,i)),null!=r.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,r.bottom,i)),null!=r.left&&null!=e.left&&(this.left=t.number(e.left,r.left,i)),null!=r.right&&null!=e.right&&(this.right=t.number(e.right,r.right,i)),this},Fn.prototype.getCenter=function(e,r){var i=t.clamp((this.left+e-this.right)/2,0,e),n=t.clamp((this.top+r-this.bottom)/2,0,r);return new t.Point(i,n)},Fn.prototype.equals=function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right},Fn.prototype.clone=function(){return new Fn(this.top,this.bottom,this.left,this.right)},Fn.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Un={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};function Vn(e){var r,i,n,o;this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(r=this._updateHashUnthrottled.bind(this),i=!1,n=null,o=function(){n=null,i&&(r(),n=setTimeout(o,300),i=!1)},function(){return i=!0,n||o(),n})}function qn(t){this._map=t,this.clear()}jn.prototype.clone=function(){var t=new jn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t},Un.minZoom.get=function(){return this._minZoom},Un.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Un.maxZoom.get=function(){return this._maxZoom},Un.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Un.minPitch.get=function(){return this._minPitch},Un.minPitch.set=function(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))},Un.maxPitch.get=function(){return this._maxPitch},Un.maxPitch.set=function(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))},Un.renderWorldCopies.get=function(){return this._renderWorldCopies},Un.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Un.worldSize.get=function(){return this.tileSize*this.scale},Un.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Un.size.get=function(){return new t.Point(this.width,this.height)},Un.bearing.get=function(){return-this.angle/Math.PI*180},Un.bearing.set=function(e){var r=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=t.create$2(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Un.pitch.get=function(){return this._pitch/Math.PI*180},Un.pitch.set=function(e){var r=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())},Un.fov.get=function(){return this._fov/Math.PI*180},Un.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Un.zoom.get=function(){return this._zoom},Un.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Un.center.get=function(){return this._center},Un.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Un.padding.get=function(){return this._edgeInsets.toJSON()},Un.padding.set=function(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())},Un.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},jn.prototype.isPaddingEqual=function(t){return this._edgeInsets.equals(t)},jn.prototype.interpolatePadding=function(t,e,r){this._unmodified=!1,this._edgeInsets.interpolate(t,e,r),this._constrain(),this._calcMatrices()},jn.prototype.coveringZoomLevel=function(t){var e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)},jn.prototype.getVisibleUnwrappedCoordinates=function(e){var r=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new t.Point(0,0)),n=this.pointCoordinate(new t.Point(this.width,0)),o=this.pointCoordinate(new t.Point(this.width,this.height)),a=this.pointCoordinate(new t.Point(0,this.height)),s=Math.floor(Math.min(i.x,n.x,o.x,a.x)),l=Math.floor(Math.max(i.x,n.x,o.x,a.x)),c=s-1;c<=l+1;c++)0!==c&&r.push(new t.UnwrappedTileID(c,e));return r},jn.prototype.coveringTiles=function(e){var r=this.coveringZoomLevel(e),i=r;if(void 0!==e.minzoom&&r<e.minzoom)return[];void 0!==e.maxzoom&&r>e.maxzoom&&(r=e.maxzoom);var n=t.MercatorCoordinate.fromLngLat(this.center),o=Math.pow(2,r),a=[o*n.x,o*n.y,0],s=Nn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r),l=e.minzoom||0;function c(t){return{aabb:new Bn([t*o,0,0],[(t+1)*o,o,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}}this.pitch<=60&&this._edgeInsets.top<.1&&(l=r);var u=[],p=[],h=r,d=e.reparseOverscaled?i:r;if(this._renderWorldCopies)for(var f=1;f<=3;f++)u.push(c(-f)),u.push(c(f));for(u.push(c(0));0<u.length;){var m=u.pop(),g=m.x,y=m.y,v=m.fullyVisible;if(!v){var _=m.aabb.intersects(s);if(0===_)continue;v=2===_}var x=m.aabb.distanceX(a),b=m.aabb.distanceY(a),w=Math.max(Math.abs(x),Math.abs(b));if(m.zoom===h||w>3+(1<<h-m.zoom)-2&&m.zoom>=l)p.push({tileID:new t.OverscaledTileID(m.zoom===h?d:m.zoom,m.wrap,m.zoom,g,y),distanceSq:t.sqrLen([a[0]-.5-g,a[1]-.5-y])});else for(var S=0;S<4;S++){var T=(g<<1)+S%2,E=(y<<1)+(S>>1);u.push({aabb:m.aabb.quadrant(S),zoom:m.zoom+1,x:T,y:E,wrap:m.wrap,fullyVisible:v})}}return p.sort((function(t,e){return t.distanceSq-e.distanceSq})).map((function(t){return t.tileID}))},jn.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Un.unmodified.get=function(){return this._unmodified},jn.prototype.zoomScale=function(t){return Math.pow(2,t)},jn.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},jn.prototype.project=function(e){var r=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.Point(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(r)*this.worldSize)},jn.prototype.unproject=function(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()},Un.point.get=function(){return this.project(this.center)},jn.prototype.setLocationAtPoint=function(e,r){var i=this.pointCoordinate(r),n=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),a=new t.MercatorCoordinate(o.x-(i.x-n.x),o.y-(i.y-n.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},jn.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},jn.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},jn.prototype.locationCoordinate=function(e){return t.MercatorCoordinate.fromLngLat(e)},jn.prototype.coordinateLocation=function(t){return t.toLngLat()},jn.prototype.pointCoordinate=function(e){var r=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.transformMat4(r,r,this.pixelMatrixInverse),t.transformMat4(i,i,this.pixelMatrixInverse);var n=r[3],o=i[3],a=r[1]/n,s=i[1]/o,l=r[2]/n,c=i[2]/o,u=l==c?0:(0-l)/(c-l);return new t.MercatorCoordinate(t.number(r[0]/n,i[0]/o,u)/this.worldSize,t.number(a,s,u)/this.worldSize)},jn.prototype.coordinatePoint=function(e){var r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(r,r,this.pixelMatrix),new t.Point(r[0]/r[3],r[1]/r[3])},jn.prototype.getBounds=function(){return(new t.LngLatBounds).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},jn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},jn.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},jn.prototype.calculatePosMatrix=function(e,r){void 0===r&&(r=!1);var i=e.key,n=r?this._alignedPosMatrixCache:this._posMatrixCache;if(n[i])return n[i];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[s*a,o.y*a,0]),t.scale(l,l,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(l,r?this.alignedProjMatrix:this.projMatrix,l),n[i]=new Float32Array(l),n[i]},jn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},jn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,r,i,n,o=-90,a=90,s=-180,l=180,c=this.size,u=this._unmodified;if(this.latRange){var p=this.latRange;o=t.mercatorYfromLat(p[1])*this.worldSize,e=(a=t.mercatorYfromLat(p[0])*this.worldSize)-o<c.y?c.y/(a-o):0}if(this.lngRange){var h=this.lngRange;s=t.mercatorXfromLng(h[0])*this.worldSize,r=(l=t.mercatorXfromLng(h[1])*this.worldSize)-s<c.x?c.x/(l-s):0}var d=this.point,f=Math.max(r||0,e||0);if(f)return this.center=this.unproject(new t.Point(r?(l+s)/2:d.x,e?(a+o)/2:d.y)),this.zoom+=this.scaleZoom(f),this._unmodified=u,void(this._constraining=!1);if(this.latRange){var m=d.y,g=c.y/2;m-g<o&&(n=o+g),a<m+g&&(n=a-g)}if(this.lngRange){var y=d.x,v=c.x/2;y-v<s&&(i=s+v),l<y+v&&(i=l-v)}void 0===i&&void 0===n||(this.center=this.unproject(new t.Point(void 0!==i?i:d.x,void 0!==n?n:d.y))),this._unmodified=u,this._constraining=!1}},jn.prototype._calcMatrices=function(){if(this.height){var e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var r=Math.PI/2+this._pitch,i=this._fov*(.5+e.y/this.height),n=Math.sin(i)*this.cameraToCenterDistance/Math.sin(t.clamp(Math.PI-r-i,.01,Math.PI-.01)),o=this.point,a=o.x,s=o.y,l=1.01*(Math.cos(Math.PI/2-this._pitch)*n+this.cameraToCenterDistance),c=this.height/50,u=new Float64Array(16);t.perspective(u,this._fov,this.width/this.height,c,l),u[8]=2*-e.x/this.width,u[9]=2*e.y/this.height,t.scale(u,u,[1,-1,1]),t.translate(u,u,[0,0,-this.cameraToCenterDistance]),t.rotateX(u,u,this._pitch),t.rotateZ(u,u,this.angle),t.translate(u,u,[-a,-s,0]),this.mercatorMatrix=t.scale([],u,[this.worldSize,this.worldSize,this.worldSize]),t.scale(u,u,[1,1,t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=u,this.invProjMatrix=t.invert([],this.projMatrix);var p=this.width%2/2,h=this.height%2/2,d=Math.cos(this.angle),f=Math.sin(this.angle),m=a-Math.round(a)+d*p+f*h,g=s-Math.round(s)+d*h+f*p,y=new Float64Array(u);if(t.translate(y,y,[.5<m?m-1:m,.5<g?g-1:g,0]),this.alignedProjMatrix=y,u=t.create(),t.scale(u,u,[this.width/2,-this.height/2,1]),t.translate(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=t.create(),t.scale(u,u,[1,-1,1]),t.translate(u,u,[-1,-1,0]),t.scale(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(u=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=u,this._posMatrixCache={},this._alignedPosMatrixCache={}}},jn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance},jn.prototype.getCameraPoint=function(){var e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,e))},jn.prototype.getCameraQueryGeometry=function(e){var r=this.getCameraPoint();if(1===e.length)return[e[0],r];for(var i=r.x,n=r.y,o=r.x,a=r.y,s=0,l=e;s<l.length;s+=1){var c=l[s];i=Math.min(i,c.x),n=Math.min(n,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}return[new t.Point(i,n),new t.Point(o,n),new t.Point(o,a),new t.Point(i,a),new t.Point(i,n)]},Object.defineProperties(jn.prototype,Un),Vn.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Vn.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Vn.prototype.getHashString=function(e){var r=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,n=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,n),a=Math.round(r.lng*o)/o,s=Math.round(r.lat*o)/o,l=this._map.getBearing(),c=this._map.getPitch(),u="";if(u+=e?"/"+a+"/"+s+"/"+i:i+"/"+s+"/"+a,(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+="/"+Math.round(c)),this._hashName){var p=this._hashName,h=!1,d=t.window.location.hash.slice(1).split("&").map((function(t){var e=t.split("=")[0];return e===p?(h=!0,e+"="+u):t})).filter((function(t){return t}));return h||d.push(p+"="+u),"#"+d.join("&")}return"#"+u},Vn.prototype._getCurrentHash=function(){var e,r=this,i=t.window.location.hash.replace("#","");return this._hashName?(i.split("&").map((function(t){return t.split("=")})).forEach((function(t){t[0]===r._hashName&&(e=t)})),(e&&e[1]||"").split("/")):i.split("/")},Vn.prototype._onHashChange=function(){var t=this._getCurrentHash();if(3<=t.length&&!t.some((function(t){return isNaN(t)}))){var e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},Vn.prototype._updateHashUnthrottled=function(){var e=this.getHashString();try{t.window.history.replaceState(t.window.history.state,"",e)}catch(e){}};var Gn={linearity:.3,easing:t.bezier(0,0,.3,1)},Zn=t.extend({deceleration:2500,maxSpeed:1400},Gn),Hn=t.extend({deceleration:20,maxSpeed:1400},Gn),Wn=t.extend({deceleration:1e3,maxSpeed:360},Gn),Kn=t.extend({deceleration:1e3,maxSpeed:90},Gn);function Xn(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Yn(e,r,i){var n=i.maxSpeed,o=i.linearity,a=i.deceleration,s=t.clamp(e*o/(r/1e3),-n,n),l=Math.abs(s)/(a*o);return{easing:i.easing,duration:1e3*l,amount:s*(l/2)}}function Jn(t,e){this._map=t,this._clickTolerance=e.clickTolerance}qn.prototype.clear=function(){this._inertiaBuffer=[]},qn.prototype.record=function(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.browser.now(),settings:e})},qn.prototype._drainInertiaBuffer=function(){for(var e=this._inertiaBuffer,r=t.browser.now();0<e.length&&160<r-e[0].time;)e.shift()},qn.prototype._onMoveEnd=function(e){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var r={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0},i=0,n=this._inertiaBuffer;i<n.length;i+=1){var o=n[i].settings;r.zoom+=o.zoomDelta||0,r.bearing+=o.bearingDelta||0,r.pitch+=o.pitchDelta||0,o.panDelta&&r.pan._add(o.panDelta),o.around&&(r.around=o.around),o.pinchAround&&(r.pinchAround=o.pinchAround)}var a=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(r.pan.mag()){var l=Yn(r.pan.mag(),a,t.extend({},Zn,e||{}));s.offset=r.pan.mult(l.amount/r.pan.mag()),s.center=this._map.transform.center,Xn(s,l)}if(r.zoom){var c=Yn(r.zoom,a,Hn);s.zoom=this._map.transform.zoom+c.amount,Xn(s,c)}if(r.bearing){var u=Yn(r.bearing,a,Wn);s.bearing=this._map.transform.bearing+t.clamp(u.amount,-179,179),Xn(s,u)}if(r.pitch){var p=Yn(r.pitch,a,Kn);s.pitch=this._map.transform.pitch+p.amount,Xn(s,p)}if(s.zoom||s.bearing){var h=void 0===r.pinchAround?r.around:r.pinchAround;s.around=h?this._map.unproject(h):this._map.getCenter()}return this.clear(),t.extend(s,{noMoveStart:!0})}};var $n=function(e){function i(i,n,o,a){void 0===a&&(a={});var s=r.mousePos(n.getCanvasContainer(),o),l=n.unproject(s);e.call(this,i,t.extend({point:s,lngLat:l,originalEvent:o},a)),this._defaultPrevented=!1,this.target=n}e&&(i.__proto__=e);var n={defaultPrevented:{configurable:!0}};return((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(t.Event),Qn=function(e){function i(i,n,o){var a="touchend"===i?o.changedTouches:o.touches,s=r.touchPos(n.getCanvasContainer(),a),l=s.map((function(t){return n.unproject(t)})),c=s.reduce((function(t,e,r,i){return t.add(e.div(i.length))}),new t.Point(0,0)),u=n.unproject(c);e.call(this,i,{points:s,point:c,lngLats:l,lngLat:u,originalEvent:o}),this._defaultPrevented=!1}e&&(i.__proto__=e);var n={defaultPrevented:{configurable:!0}};return((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(t.Event),to=function(t){function e(e,r,i){t.call(this,e,{originalEvent:i}),this._defaultPrevented=!1}t&&(e.__proto__=t);var r={defaultPrevented:{configurable:!0}};return((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,r),e}(t.Event);function eo(t){this._map=t}function ro(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}function io(t,e){for(var r={},i=0;i<t.length;i++)r[t[i].identifier]=e[i];return r}function no(t){this.reset(),this.numTouches=t.numTouches}function oo(t){this.singleTap=new no(t),this.numTaps=t.numTaps,this.reset()}function ao(){this._zoomIn=new oo({numTouches:1,numTaps:2}),this._zoomOut=new oo({numTouches:2,numTaps:1}),this.reset()}function so(t){this.reset(),this._clickTolerance=t.clickTolerance||1}Jn.prototype.reset=function(){delete this._mousedownPos},Jn.prototype.wheel=function(t){return this._firePreventable(new to(t.type,this._map,t))},Jn.prototype.mousedown=function(t,e){return this._mousedownPos=e,this._firePreventable(new $n(t.type,this._map,t))},Jn.prototype.mouseup=function(t){this._map.fire(new $n(t.type,this._map,t))},Jn.prototype.click=function(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new $n(t.type,this._map,t))},Jn.prototype.dblclick=function(t){return this._firePreventable(new $n(t.type,this._map,t))},Jn.prototype.mouseover=function(t){this._map.fire(new $n(t.type,this._map,t))},Jn.prototype.mouseout=function(t){this._map.fire(new $n(t.type,this._map,t))},Jn.prototype.touchstart=function(t){return this._firePreventable(new Qn(t.type,this._map,t))},Jn.prototype.touchmove=function(t){this._map.fire(new Qn(t.type,this._map,t))},Jn.prototype.touchend=function(t){this._map.fire(new Qn(t.type,this._map,t))},Jn.prototype.touchcancel=function(t){this._map.fire(new Qn(t.type,this._map,t))},Jn.prototype._firePreventable=function(t){if(this._map.fire(t),t.defaultPrevented)return{}},Jn.prototype.isEnabled=function(){return!0},Jn.prototype.isActive=function(){return!1},Jn.prototype.enable=function(){},Jn.prototype.disable=function(){},eo.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},eo.prototype.mousemove=function(t){this._map.fire(new $n(t.type,this._map,t))},eo.prototype.mousedown=function(){this._delayContextMenu=!0},eo.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $n("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},eo.prototype.contextmenu=function(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new $n(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()},eo.prototype.isEnabled=function(){return!0},eo.prototype.isActive=function(){return!1},eo.prototype.enable=function(){},eo.prototype.disable=function(){},ro.prototype.isEnabled=function(){return!!this._enabled},ro.prototype.isActive=function(){return!!this._active},ro.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ro.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ro.prototype.mousedown=function(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(r.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)},ro.prototype.mousemoveWindow=function(t,e){if(this._active){var i=e;if(!(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)){var n=this._startPos;this._lastPos=i,this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var o=Math.min(n.x,i.x),a=Math.max(n.x,i.x),s=Math.min(n.y,i.y),l=Math.max(n.y,i.y);r.setTransform(this._box,"translate("+o+"px,"+s+"px)"),this._box.style.width=a-o+"px",this._box.style.height=l-s+"px"}}},ro.prototype.mouseupWindow=function(e,i){var n=this;if(this._active&&0===e.button){var o=this._startPos,a=i;if(this.reset(),r.suppressClick(),o.x!==a.x||o.y!==a.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:function(t){return t.fitScreenCoordinates(o,a,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",e)}},ro.prototype.keydown=function(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))},ro.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(r.remove(this._box),this._box=null),r.enableDrag(),delete this._startPos,delete this._lastPos},ro.prototype._fireEvent=function(e,r){return this._map.fire(new t.Event(e,{originalEvent:r}))},no.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},no.prototype.touchstart=function(e,r,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(e){for(var r=new t.Point(0,0),i=0,n=e;i<n.length;i+=1)r._add(n[i]);return r.div(e.length)}(r),this.touches=io(i,r)))},no.prototype.touchmove=function(t,e,r){if(!this.aborted&&this.centroid){var i=io(r,e);for(var n in this.touches){var o=i[n];(!o||30<o.dist(this.touches[n]))&&(this.aborted=!0)}}},no.prototype.touchend=function(t,e,r){if((!this.centroid||500<t.timeStamp-this.startTime)&&(this.aborted=!0),0===r.length){var i=!this.aborted&&this.centroid;if(this.reset(),i)return i}},oo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},oo.prototype.touchstart=function(t,e,r){this.singleTap.touchstart(t,e,r)},oo.prototype.touchmove=function(t,e,r){this.singleTap.touchmove(t,e,r)},oo.prototype.touchend=function(t,e,r){var i=this.singleTap.touchend(t,e,r);if(i){var n=t.timeStamp-this.lastTime<500,o=!this.lastTap||this.lastTap.dist(i)<30;if(n&&o||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}},ao.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ao.prototype.touchstart=function(t,e,r){this._zoomIn.touchstart(t,e,r),this._zoomOut.touchstart(t,e,r)},ao.prototype.touchmove=function(t,e,r){this._zoomIn.touchmove(t,e,r),this._zoomOut.touchmove(t,e,r)},ao.prototype.touchend=function(t,e,r){var i=this,n=this._zoomIn.touchend(t,e,r),o=this._zoomOut.touchend(t,e,r);return n?(this._active=!0,t.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(n)},{originalEvent:t})}}):o?(this._active=!0,t.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(o)},{originalEvent:t})}}):void 0},ao.prototype.touchcancel=function(){this.reset()},ao.prototype.enable=function(){this._enabled=!0},ao.prototype.disable=function(){this._enabled=!1,this.reset()},ao.prototype.isEnabled=function(){return this._enabled},ao.prototype.isActive=function(){return this._active};var lo={0:1,2:2};function co(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()}so.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},so.prototype._correctButton=function(t,e){return!1},so.prototype._move=function(t,e){return{}},so.prototype.mousedown=function(t,e){if(!this._lastPoint){var i=r.mouseButton(t);this._correctButton(t,i)&&(this._lastPoint=e,this._eventButton=i)}},so.prototype.mousemoveWindow=function(t,e){var r,i,n=this._lastPoint;if(n)if(t.preventDefault(),r=this._eventButton,i=lo[r],void 0===t.buttons||(t.buttons&i)!==i)this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)},so.prototype.mouseupWindow=function(t){this._lastPoint&&r.mouseButton(t)===this._eventButton&&(this._moved&&r.suppressClick(),this.reset())},so.prototype.enable=function(){this._enabled=!0},so.prototype.disable=function(){this._enabled=!1,this.reset()},so.prototype.isEnabled=function(){return this._enabled},so.prototype.isActive=function(){return this._active};var uo,po,ho,fo=(_o.__proto__=ho=so,((_o.prototype=Object.create(ho&&ho.prototype)).constructor=_o).prototype.mousedown=function(t,e){ho.prototype.mousedown.call(this,t,e),this._lastPoint&&(this._active=!0)},_o.prototype._correctButton=function(t,e){return 0===e&&!t.ctrlKey},_o.prototype._move=function(t,e){return{around:e,panDelta:e.sub(t)}},_o),mo=(vo.__proto__=po=so,((vo.prototype=Object.create(po&&po.prototype)).constructor=vo).prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},vo.prototype._move=function(t,e){var r=.8*(e.x-t.x);if(r)return this._active=!0,{bearingDelta:r}},vo.prototype.contextmenu=function(t){t.preventDefault()},vo),go=(yo.__proto__=uo=so,((yo.prototype=Object.create(uo&&uo.prototype)).constructor=yo).prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},yo.prototype._move=function(t,e){var r=-.5*(e.y-t.y);if(r)return this._active=!0,{pitchDelta:r}},yo.prototype.contextmenu=function(t){t.preventDefault()},yo);function yo(){uo.apply(this,arguments)}function vo(){po.apply(this,arguments)}function _o(){ho.apply(this,arguments)}function xo(){this.reset()}function bo(t,e,r){for(var i=0;i<t.length;i++)if(t[i].identifier===r)return e[i]}function wo(t,e){return Math.log(t/e)/Math.LN2}co.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)},co.prototype.touchstart=function(t,e,r){return this._calculateTransform(t,e,r)},co.prototype.touchmove=function(t,e,r){if(this._active)return t.preventDefault(),this._calculateTransform(t,e,r)},co.prototype.touchend=function(t,e,r){this._calculateTransform(t,e,r),this._active&&r.length<this._minTouches&&this.reset()},co.prototype.touchcancel=function(){this.reset()},co.prototype._calculateTransform=function(e,r,i){0<i.length&&(this._active=!0);var n=io(i,r),o=new t.Point(0,0),a=new t.Point(0,0),s=0;for(var l in n){var c=n[l],u=this._touches[l];u&&(o._add(c),a._add(c.sub(u)),s++,n[l]=c)}if(this._touches=n,!(s<this._minTouches)&&a.mag()){var p=a.div(s);if(this._sum._add(p),!(this._sum.mag()<this._clickTolerance))return{around:o.div(s),panDelta:p}}},co.prototype.enable=function(){this._enabled=!0},co.prototype.disable=function(){this._enabled=!1,this.reset()},co.prototype.isEnabled=function(){return this._enabled},co.prototype.isActive=function(){return this._active},xo.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},xo.prototype._start=function(t){},xo.prototype._move=function(t,e,r){return{}},xo.prototype.touchstart=function(t,e,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([e[0],e[1]]))},xo.prototype.touchmove=function(t,e,r){if(this._firstTwoTouches){t.preventDefault();var i=this._firstTwoTouches,n=i[1],o=bo(r,e,i[0]),a=bo(r,e,n);if(o&&a){var s=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],s,t)}}},xo.prototype.touchend=function(t,e,i){if(this._firstTwoTouches){var n=this._firstTwoTouches,o=n[1],a=bo(i,e,n[0]),s=bo(i,e,o);a&&s||(this._active&&r.suppressClick(),this.reset())}},xo.prototype.touchcancel=function(){this.reset()},xo.prototype.enable=function(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around},xo.prototype.disable=function(){this._enabled=!1,this.reset()},xo.prototype.isEnabled=function(){return this._enabled},xo.prototype.isActive=function(){return this._active};var So,To=(Eo.__proto__=So=xo,((Eo.prototype=Object.create(So&&So.prototype)).constructor=Eo).prototype.reset=function(){So.prototype.reset.call(this),delete this._distance,delete this._startDistance},Eo.prototype._start=function(t){this._startDistance=this._distance=t[0].dist(t[1])},Eo.prototype._move=function(t,e){var r=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(wo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wo(this._distance,r),pinchAround:e}},Eo);function Eo(){So.apply(this,arguments)}function Io(t,e){return 180*t.angleWith(e)/Math.PI}var Co,Ao=(ko.__proto__=Co=xo,((ko.prototype=Object.create(Co&&Co.prototype)).constructor=ko).prototype.reset=function(){Co.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},ko.prototype._start=function(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])},ko.prototype._move=function(t,e){var r=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Io(this._vector,r),pinchAround:e}},ko.prototype._isBelowThreshold=function(t){this._minDiameter=Math.min(this._minDiameter,t.mag());var e=25/(Math.PI*this._minDiameter)*360,r=Io(t,this._startVector);return Math.abs(r)<e},ko);function ko(){Co.apply(this,arguments)}function Po(t){return Math.abs(t.y)>Math.abs(t.x)}function Oo(){var t=Do;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep}var Mo,Lo=(Ro.__proto__=Mo=xo,((Ro.prototype=Object.create(Mo&&Mo.prototype)).constructor=Ro).prototype.reset=function(){Mo.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},Ro.prototype._start=function(t){Po((this._lastPoints=t)[0].sub(t[1]))&&(this._valid=!1)},Ro.prototype._move=function(t,e,r){var i=t[0].sub(this._lastPoints[0]),n=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(i,n,r.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(i.y+n.y)/2*-.5}},Ro.prototype.gestureBeginsVertically=function(t,e,r){if(void 0!==this._valid)return this._valid;var i=2<=t.mag(),n=2<=e.mag();if(i||n){if(!i||!n)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;var o=0<t.y==0<e.y;return Po(t)&&Po(e)&&o}},Ro),Do={panStep:100,bearingStep:15,pitchStep:10};function Ro(){Mo.apply(this,arguments)}function zo(t){return t*(2-t)}function No(e,r){this._map=e,this._el=e.getCanvasContainer(),this._handler=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)}function Bo(t,e){this._clickZoom=t,this._tapZoom=e}function Fo(){this.reset()}function jo(){this._tap=new oo({numTouches:1,numTaps:1}),this.reset()}function Uo(t,e,r){this._el=t,this._mousePan=e,this._touchPan=r}function Vo(t,e,r){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=r}function qo(t,e,r,i){this._el=t,this._touchZoom=e,this._touchRotate=r,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}function Go(t){return t.zoom||t.drag||t.pitch||t.rotate}Oo.prototype.reset=function(){this._active=!1},Oo.prototype.keydown=function(t){var e=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var r=0,i=0,n=0,o=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),o=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),o=1);break;case 38:t.shiftKey?n=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?n=-1:(t.preventDefault(),a=1);break;default:return}return{cameraAnimation:function(s){var l=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:zo,zoom:r?Math.round(l)+r*(t.shiftKey?2:1):l,bearing:s.getBearing()+i*e._bearingStep,pitch:s.getPitch()+n*e._pitchStep,offset:[-o*e._panStep,-a*e._panStep],center:s.getCenter()},{originalEvent:t})}}}},Oo.prototype.enable=function(){this._enabled=!0},Oo.prototype.disable=function(){this._enabled=!1,this.reset()},Oo.prototype.isEnabled=function(){return this._enabled},Oo.prototype.isActive=function(){return this._active},No.prototype.setZoomRate=function(t){this._defaultZoomRate=t},No.prototype.setWheelZoomRate=function(t){this._wheelZoomRate=t},No.prototype.isEnabled=function(){return!!this._enabled},No.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},No.prototype.isZooming=function(){return!!this._zooming},No.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},No.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},No.prototype.wheel=function(e){if(this.isEnabled()){var r=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,i=t.browser.now(),n=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":400<n?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}},No.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},No.prototype._start=function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var i=r.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(i)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},No.prototype.renderFrame=function(){return this._onScrollFrame()},No.prototype._onScrollFrame=function(){var e=this;if(this._frameId&&(this._frameId=null,this.isActive())){var r=this._map.transform;if(0!==this._delta){var i="wheel"===this._type&&4.000244140625<Math.abs(this._delta)?this._wheelZoomRate:this._defaultZoomRate,n=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&0!==n&&(n=1/n);var o="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(o*n))),"wheel"===this._type&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a,s="number"==typeof this._targetZoom?this._targetZoom:r.zoom,l=this._startZoom,c=this._easing,u=!1;if("wheel"===this._type&&l&&c){var p=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),h=c(p);a=t.number(l,s,h),p<1?this._frameId||(this._frameId=!0):u=!0}else a=s,u=!0;return this._active=!0,u&&(this._active=!1,this._finishTimeout=setTimeout((function(){e._zooming=!1,e._handler._triggerRenderFrame(),delete e._targetZoom,delete e._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!u,zoomDelta:a-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},No.prototype._smoothOutEasing=function(e){var r=t.ease;if(this._prevEase){var i=this._prevEase,n=(t.browser.now()-i.start)/i.duration,o=i.easing(.01+n)-i.easing(n),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);r=t.bezier(a,s,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:r},r},No.prototype.reset=function(){this._active=!1},Bo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Bo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Bo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Bo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()},Fo.prototype.reset=function(){this._active=!1},Fo.prototype.dblclick=function(t,e){return t.preventDefault(),{cameraAnimation:function(r){r.easeTo({duration:300,zoom:r.getZoom()+(t.shiftKey?-1:1),around:r.unproject(e)},{originalEvent:t})}}},Fo.prototype.enable=function(){this._enabled=!0},Fo.prototype.disable=function(){this._enabled=!1,this.reset()},Fo.prototype.isEnabled=function(){return this._enabled},Fo.prototype.isActive=function(){return this._active},jo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},jo.prototype.touchstart=function(t,e,r){this._swipePoint||(this._tapTime&&500<t.timeStamp-this._tapTime&&this.reset(),this._tapTime?0<r.length&&(this._swipePoint=e[0],this._swipeTouch=r[0].identifier):this._tap.touchstart(t,e,r))},jo.prototype.touchmove=function(t,e,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;var i=e[0],n=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:n/128}}}else this._tap.touchmove(t,e,r)},jo.prototype.touchend=function(t,e,r){this._tapTime?this._swipePoint&&0===r.length&&this.reset():this._tap.touchend(t,e,r)&&(this._tapTime=t.timeStamp)},jo.prototype.touchcancel=function(){this.reset()},jo.prototype.enable=function(){this._enabled=!0},jo.prototype.disable=function(){this._enabled=!1,this.reset()},jo.prototype.isEnabled=function(){return this._enabled},jo.prototype.isActive=function(){return this._active},Uo.prototype.enable=function(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Uo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Uo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Uo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()},Vo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Vo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Vo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Vo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()},qo.prototype.enable=function(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},qo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},qo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},qo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},qo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},qo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Zo,Ho=((Zo=t.Event)&&(Wo.__proto__=Zo),(Wo.prototype=Object.create(Zo&&Zo.prototype)).constructor=Wo);function Wo(){Zo.apply(this,arguments)}function Ko(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}function Xo(e,i){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qn(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i),t.bindAll(["handleEvent","handleWindowEvent"],this);var n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[t.window,"blur",void 0]];for(var o=0,a=this._listeners;o<a.length;o+=1){var s=a[o],l=s[0];r.addEventListener(l,s[1],l===t.window.document?this.handleWindowEvent:this.handleEvent,s[2])}}function Yo(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)}Xo.prototype.destroy=function(){for(var e=0,i=this._listeners;e<i.length;e+=1){var n=i[e],o=n[0];r.removeEventListener(o,n[1],o===t.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},Xo.prototype._addDefaultHandlers=function(t){var e=this._map,r=e.getCanvasContainer();this._add("mapEvent",new Jn(e,t));var i=e.boxZoom=new ro(e,t);this._add("boxZoom",i);var n=new ao,o=new Fo;e.doubleClickZoom=new Bo(o,n),this._add("tapZoom",n),this._add("clickZoom",o);var a=new jo;this._add("tapDragZoom",a);var s=e.touchPitch=new Lo;this._add("touchPitch",s);var l=new mo(t),c=new go(t);e.dragRotate=new Vo(t,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);var u=new fo(t),p=new co(t);e.dragPan=new Uo(r,u,p),this._add("mousePan",u),this._add("touchPan",p,["touchZoom","touchRotate"]);var h=new Ao,d=new To;e.touchZoomRotate=new qo(r,d,h,a),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]);var f=e.scrollZoom=new No(e,this);this._add("scrollZoom",f,["mousePan"]);var m=e.keyboard=new Oo;this._add("keyboard",m),this._add("blockableMapEvent",new eo(e));for(var g=0,y=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];g<y.length;g+=1){var v=y[g];t.interactive&&t[v]&&e[v].enable(t[v])}},Xo.prototype._add=function(t,e,r){this._handlers.push({handlerName:t,handler:e,allowed:r}),this._handlersById[t]=e},Xo.prototype.stop=function(){if(!this._updatingCamera){for(var t=0,e=this._handlers;t<e.length;t+=1)e[t].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Xo.prototype.isActive=function(){for(var t=0,e=this._handlers;t<e.length;t+=1)if(e[t].handler.isActive())return!0;return!1},Xo.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Xo.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Xo.prototype.isMoving=function(){return Boolean(Go(this._eventsInProgress))||this.isZooming()},Xo.prototype._blockedByActive=function(t,e,r){for(var i in t)if(i!==r&&(!e||e.indexOf(i)<0))return!0;return!1},Xo.prototype.handleWindowEvent=function(t){this.handleEvent(t,t.type+"Window")},Xo.prototype._getMapTouches=function(t){for(var e=[],r=0,i=t;r<i.length;r+=1){var n=i[r];this._el.contains(n.target)&&e.push(n)}return e},Xo.prototype.handleEvent=function(t,e){if("blur"!==t.type){this._updatingCamera=!0;for(var i="renderFrame"===t.type?void 0:t,n={needsRenderFrame:!1},o={},a={},s=t.touches?this._getMapTouches(t.touches):void 0,l=s?r.touchPos(this._el,s):r.mousePos(this._el,t),c=0,u=this._handlers;c<u.length;c+=1){var p=u[c],h=p.handlerName,d=p.handler,f=p.allowed;if(d.isEnabled()){var m=void 0;this._blockedByActive(a,f,h)?d.reset():d[e||t.type]&&(m=d[e||t.type](t,l,s),this.mergeHandlerResult(n,o,m,h,i),m&&m.needsRenderFrame&&this._triggerRenderFrame()),(m||d.isActive())&&(a[h]=d)}}var g={};for(var y in this._previousActiveHandlers)a[y]||(g[y]=i);this._previousActiveHandlers=a,(Object.keys(g).length||Ko(n))&&(this._changes.push([n,o,g]),this._triggerRenderFrame()),(Object.keys(a).length||Ko(n))&&this._map._stop(!0),this._updatingCamera=!1;var v=n.cameraAnimation;v&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],v(this._map))}else this.stop()},Xo.prototype.mergeHandlerResult=function(e,r,i,n,o){if(i){t.extend(e,i);var a={handlerName:n,originalEvent:i.originalEvent||o};void 0!==i.zoomDelta&&(r.zoom=a),void 0!==i.panDelta&&(r.drag=a),void 0!==i.pitchDelta&&(r.pitch=a),void 0!==i.bearingDelta&&(r.rotate=a)}},Xo.prototype._applyChanges=function(){for(var e={},r={},i={},n=0,o=this._changes;n<o.length;n+=1){var a=o[n],s=a[0],l=a[1],c=a[2];s.panDelta&&(e.panDelta=(e.panDelta||new t.Point(0,0))._add(s.panDelta)),s.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(e.around=s.around),void 0!==s.pinchAround&&(e.pinchAround=s.pinchAround),s.noInertia&&(e.noInertia=s.noInertia),t.extend(r,l),t.extend(i,c)}this._updateMapTransform(e,r,i),this._changes=[]},Xo.prototype._updateMapTransform=function(t,e,r){var i=this._map,n=i.transform;if(!Ko(t))return this._fireEvents(e,r);var o=t.panDelta,a=t.zoomDelta,s=t.bearingDelta,l=t.pitchDelta,c=t.around,u=t.pinchAround;void 0!==u&&(c=u),i._stop(!0),c=c||i.transform.centerPoint;var p=n.pointLocation(o?c.sub(o):c);s&&(n.bearing+=s),l&&(n.pitch+=l),a&&(n.zoom+=a),n.setLocationAtPoint(p,c),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,r)},Xo.prototype._fireEvents=function(e,r){var i=this,n=Go(this._eventsInProgress),o=Go(e),a={};for(var s in e)this._eventsInProgress[s]||(a[s+"start"]=e[s].originalEvent),this._eventsInProgress[s]=e[s];for(var l in!n&&o&&this._fireEvent("movestart",o.originalEvent),a)this._fireEvent(l,a[l]);for(var c in e.rotate&&(this._bearingChanged=!0),o&&this._fireEvent("move",o.originalEvent),e)this._fireEvent(c,e[c].originalEvent);var u,p={};for(var h in this._eventsInProgress){var d=this._eventsInProgress[h],f=d.handlerName,m=d.originalEvent;this._handlersById[f].isActive()||(delete this._eventsInProgress[h],p[h+"end"]=u=r[f]||m)}for(var g in p)this._fireEvent(g,p[g]);var y=Go(this._eventsInProgress);if((n||o)&&!y){this._updatingCamera=!0;var v=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=function(t){return 0!==t&&-i._bearingSnap<t&&t<i._bearingSnap};v?(_(v.bearing||this._map.getBearing())&&(v.bearing=0),this._map.easeTo(v,{originalEvent:u})):(this._map.fire(new t.Event("moveend",{originalEvent:u})),_(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Xo.prototype._fireEvent=function(e,r){this._map.fire(new t.Event(e,r?{originalEvent:r}:{}))},Xo.prototype._requestFrame=function(){var t=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(e){delete t._frameId,t.handleEvent(new Ho("renderFrame",{timeStamp:e})),t._applyChanges()}))},Xo.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var Jo,$o=((Jo=t.Evented)&&(Qo.__proto__=Jo),((Qo.prototype=Object.create(Jo&&Jo.prototype)).constructor=Qo).prototype.getCenter=function(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)},Qo.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},Qo.prototype.panBy=function(e,r,i){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},r),i)},Qo.prototype.panTo=function(e,r,i){return this.easeTo(t.extend({center:e},r),i)},Qo.prototype.getZoom=function(){return this.transform.zoom},Qo.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},Qo.prototype.zoomTo=function(e,r,i){return this.easeTo(t.extend({zoom:e},r),i)},Qo.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},Qo.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},Qo.prototype.getBearing=function(){return this.transform.bearing},Qo.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},Qo.prototype.getPadding=function(){return this.transform.padding},Qo.prototype.setPadding=function(t,e){return this.jumpTo({padding:t},e),this},Qo.prototype.rotateTo=function(e,r,i){return this.easeTo(t.extend({bearing:e},r),i)},Qo.prototype.resetNorth=function(e,r){return this.rotateTo(0,t.extend({duration:1e3},e),r),this},Qo.prototype.resetNorthPitch=function(e,r){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),r),this},Qo.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},Qo.prototype.getPitch=function(){return this.transform.pitch},Qo.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},Qo.prototype.cameraForBounds=function(e,r){return e=t.LngLatBounds.convert(e),this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),0,r)},Qo.prototype._cameraForBoxAndBearing=function(e,r,i,n){var o={top:0,bottom:0,right:0,left:0};if("number"==typeof(n=t.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding){var a=n.padding;n.padding={top:a,bottom:a,right:a,left:a}}n.padding=t.extend(o,n.padding);var s=this.transform,l=s.padding,c=s.project(t.LngLat.convert(e)),u=s.project(t.LngLat.convert(r)),p=c.rotate(-i*Math.PI/180),h=u.rotate(-i*Math.PI/180),d=new t.Point(Math.max(p.x,h.x),Math.max(p.y,h.y)),f=new t.Point(Math.min(p.x,h.x),Math.min(p.y,h.y)),m=d.sub(f),g=(s.width-(l.left+l.right+n.padding.left+n.padding.right))/m.x,y=(s.height-(l.top+l.bottom+n.padding.top+n.padding.bottom))/m.y;if(!(y<0||g<0)){var v=Math.min(s.scaleZoom(s.scale*Math.min(g,y)),n.maxZoom),_=t.Point.convert(n.offset),x=new t.Point(_.x+(n.padding.left-n.padding.right)/2,_.y+(n.padding.top-n.padding.bottom)/2).mult(s.scale/s.zoomScale(v));return{center:s.unproject(c.add(u).div(2).sub(x)),zoom:v,bearing:i}}t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},Qo.prototype.fitBounds=function(t,e,r){return this._fitInternal(this.cameraForBounds(t,e),e,r)},Qo.prototype.fitScreenCoordinates=function(e,r,i,n,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(r)),i,n),n,o)},Qo.prototype._fitInternal=function(e,r,i){return e?(delete(r=t.extend(e,r)).padding,r.linear?this.easeTo(r,i):this.flyTo(r,i)):this},Qo.prototype.jumpTo=function(e,r){this.stop();var i=this.transform,n=!1,o=!1,a=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(n=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=t.LngLat.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(o=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(a=!0,i.pitch=+e.pitch),null==e.padding||i.isPaddingEqual(e.padding)||(i.padding=e.padding),this.fire(new t.Event("movestart",r)).fire(new t.Event("move",r)),n&&this.fire(new t.Event("zoomstart",r)).fire(new t.Event("zoom",r)).fire(new t.Event("zoomend",r)),o&&this.fire(new t.Event("rotatestart",r)).fire(new t.Event("rotate",r)).fire(new t.Event("rotateend",r)),a&&this.fire(new t.Event("pitchstart",r)).fire(new t.Event("pitch",r)).fire(new t.Event("pitchend",r)),this.fire(new t.Event("moveend",r))},Qo.prototype.easeTo=function(e,r){var i=this;this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.browser.prefersReducedMotion)&&(e.duration=0);var n=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l=this.getPadding(),c="zoom"in e?+e.zoom:o,u="bearing"in e?this._normalizeBearing(e.bearing,a):a,p="pitch"in e?+e.pitch:s,h="padding"in e?e.padding:n.padding,d=t.Point.convert(e.offset),f=n.centerPoint.add(d),m=n.pointLocation(f),g=t.LngLat.convert(e.center||m);this._normalizeCenter(g);var y,v,_=n.project(m),x=n.project(g).sub(_),b=n.zoomScale(c-o);e.around&&(y=t.LngLat.convert(e.around),v=n.locationPoint(y));var w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||c!==o,this._rotating=this._rotating||a!==u,this._pitching=this._pitching||p!==s,this._padding=!n.isPaddingEqual(h),this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,w),clearTimeout(this._easeEndTimeoutID),this._ease((function(e){if(i._zooming&&(n.zoom=t.number(o,c,e)),i._rotating&&(n.bearing=t.number(a,u,e)),i._pitching&&(n.pitch=t.number(s,p,e)),i._padding&&(n.interpolatePadding(l,h,e),f=n.centerPoint.add(d)),y)n.setLocationAtPoint(y,v);else{var m=n.zoomScale(n.zoom-o),g=o<c?Math.min(2,b):Math.max(.5,b),w=Math.pow(g,1-e),S=n.unproject(_.add(x.mult(e*w)).mult(m));n.setLocationAtPoint(n.renderWorldCopies?S.wrap():S,f)}i._fireMoveEvents(r)}),(function(t){i._afterEase(r,t)}),e),this},Qo.prototype._prepareEase=function(e,r,i){void 0===i&&(i={}),this._moving=!0,r||i.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!i.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new t.Event("pitchstart",e))},Qo.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},Qo.prototype._afterEase=function(e,r){if(!this._easeId||!r||this._easeId!==r){delete this._easeId;var i=this._zooming,n=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new t.Event("zoomend",e)),n&&this.fire(new t.Event("rotateend",e)),o&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}},Qo.prototype.flyTo=function(e,r){var i=this;if(!e.essential&&t.browser.prefersReducedMotion){var n=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(n,r)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var o=this.transform,a=this.getZoom(),s=this.getBearing(),l=this.getPitch(),c=this.getPadding(),u="zoom"in e?t.clamp(+e.zoom,o.minZoom,o.maxZoom):a,p="bearing"in e?this._normalizeBearing(e.bearing,s):s,h="pitch"in e?+e.pitch:l,d="padding"in e?e.padding:o.padding,f=o.zoomScale(u-a),m=t.Point.convert(e.offset),g=o.centerPoint.add(m),y=o.pointLocation(g),v=t.LngLat.convert(e.center||y);this._normalizeCenter(v);var _=o.project(y),x=o.project(v).sub(_),b=e.curve,w=Math.max(o.width,o.height),S=w/f,T=x.mag();if("minZoom"in e){var E=t.clamp(Math.min(e.minZoom,a,u),o.minZoom,o.maxZoom),I=w/o.zoomScale(E-a);b=Math.sqrt(I/T*2)}var C=b*b;function A(t){var e=(S*S-w*w+(t?-1:1)*C*C*T*T)/(2*(t?S:w)*C*T);return Math.log(Math.sqrt(e*e+1)-e)}function k(t){return(Math.exp(t)-Math.exp(-t))/2}function P(t){return(Math.exp(t)+Math.exp(-t))/2}var O=A(0),M=function(t){return P(O)/P(O+b*t)},L=function(t){return w*((P(O)*(k(e=O+b*t)/P(e))-k(O))/C)/T;var e},D=(A(1)-O)/b;if(Math.abs(T)<1e-6||!isFinite(D)){if(Math.abs(w-S)<1e-6)return this.easeTo(e,r);var R=S<w?-1:1;D=Math.abs(Math.log(S/w))/b,L=function(){return 0},M=function(t){return Math.exp(R*b*t)}}return e.duration="duration"in e?+e.duration:1e3*D/("screenSpeed"in e?e.screenSpeed/b:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==p,this._pitching=h!==l,this._padding=!o.isPaddingEqual(d),this._prepareEase(r,!1),this._ease((function(e){var n=e*D,f=1/M(n);o.zoom=1===e?u:a+o.scaleZoom(f),i._rotating&&(o.bearing=t.number(s,p,e)),i._pitching&&(o.pitch=t.number(l,h,e)),i._padding&&(o.interpolatePadding(c,d,e),g=o.centerPoint.add(m));var y=1===e?v:o.unproject(_.add(x.mult(L(n))).mult(f));o.setLocationAtPoint(o.renderWorldCopies?y.wrap():y,g),i._fireMoveEvents(r)}),(function(){return i._afterEase(r)}),e),this},Qo.prototype.isEasing=function(){return!!this._easeFrameId},Qo.prototype.stop=function(){return this._stop()},Qo.prototype._stop=function(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,e)}if(!t){var i=this.handlers;i&&i.stop()}return this},Qo.prototype._ease=function(e,r,i){!1===i.animate||0===i.duration?(e(1),r()):(this._easeStart=t.browser.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},Qo.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},Qo.prototype._normalizeBearing=function(e,r){e=t.wrap(e,-180,180);var i=Math.abs(e-r);return Math.abs(e-360-r)<i&&(e-=360),Math.abs(e+360-r)<i&&(e+=360),e},Qo.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var r=t.lng-e.center.lng;t.lng+=180<r?-360:r<-180?360:0}},Qo);function Qo(e,r){Jo.call(this),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=r.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}function ta(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)}function ea(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}Yo.prototype.getDefaultPosition=function(){return"bottom-right"},Yo.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=r.create("div","mapboxgl-ctrl-attrib-inner",this._container),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Yo.prototype.onRemove=function(){r.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Yo.prototype._updateEditLink=function(){var e=this._editLink;e=e||(this._editLink=this._container.querySelector(".mapbox-improve-map"));var r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){var i=r.reduce((function(t,e,i){return e.value&&(t+=e.key+"="+e.value+(i<r.length-1?"&":"")),t}),"?");e.href=t.config.FEEDBACK_URL+"/"+i+(this._map._hash?this._map._hash.getHashString(!0):""),e.rel="noopener nofollow"}},Yo.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},Yo.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((function(t){return"string"!=typeof t?"":t}))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var r=this._map.style.sourceCaches;for(var i in r){var n=r[i];if(n.used){var o=n.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}t.sort((function(t,e){return t.length-e.length}));var a=(t=t.filter((function(e,r){for(var i=r+1;i<t.length;i++)if(0<=t[i].indexOf(e))return!1;return!0}))).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,t.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Yo.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")},ta.prototype.onAdd=function(t){this._map=t,this._container=r.create("div","mapboxgl-ctrl");var e=r.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ta.prototype.onRemove=function(){r.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ta.prototype.getDefaultPosition=function(){return"bottom-left"},ta.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},ta.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},ta.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}},ea.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},ea.prototype.remove=function(t){for(var e=this._currentlyRunning,r=0,i=e?this._queue.concat(e):this._queue;r<i.length;r+=1){var n=i[r];if(n.id===t)return void(n.cancelled=!0)}},ea.prototype.run=function(t){void 0===t&&(t=0);var e=this._currentlyRunning=this._queue;this._queue=[];for(var r=0,i=e;r<i.length;r+=1){var n=i[r];if(!n.cancelled&&(n.callback(t),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ea.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ra={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ia=t.window.HTMLImageElement,na=t.window.HTMLElement,oa=t.window.ImageBitmap,aa={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},sa=function(i){function n(e){var r=this;if(null!=(e=t.extend({},aa,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&60<e.maxPitch)throw new Error("maxPitch must be less than or equal to 60");var n=new jn(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(i.call(this,n,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new ea,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},ra,e.locale),this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken),"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof na))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return r._update(!1)})),this.on("moveend",(function(){return r._update(!1)})),this.on("zoom",(function(){return r._update(!0)})),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Xo(this,e),this._hash=e.hash&&new Vn("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Yo({customAttribution:e.customAttribution})),this.addControl(new ta,e.logoPosition),this.on("style.load",(function(){r.transform.unmodified&&r.jumpTo(r.style.stylesheet)})),this.on("data",(function(e){r._update("style"===e.dataType),r.fire(new t.Event(e.dataType+"data",e))})),this.on("dataloading",(function(e){r.fire(new t.Event(e.dataType+"dataloading",e))}))}i&&(n.__proto__=i);var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return((n.prototype=Object.create(i&&i.prototype)).constructor=n).prototype._getMapId=function(){return this._mapId},n.prototype.addControl=function(e,r){if(void 0===r&&e.getDefaultPosition&&(r=e.getDefaultPosition()),void 0===r&&(r="top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var i=e.onAdd(this);this._controls.push(e);var n=this._controlPositions[r];return-1!==r.indexOf("bottom")?n.insertBefore(i,n.firstChild):n.appendChild(i),this},n.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var r=this._controls.indexOf(e);return-1<r&&this._controls.splice(r,1),e.onRemove(this),this},n.prototype.resize=function(e){var r=this._containerDimensions(),i=r[0],n=r[1];this._resizeCanvas(i,n),this.transform.resize(i,n),this.painter.resize(i,n);var o=!this._moving;return o&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),o&&this.fire(new t.Event("moveend",e)),this},n.prototype.getBounds=function(){return this.transform.getBounds()},n.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},n.prototype.setMaxBounds=function(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()},n.prototype.setMinZoom=function(t){if(-2<=(t=null==t?-2:t)&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},n.prototype.getMinZoom=function(){return this.transform.minZoom},n.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},n.prototype.getMaxZoom=function(){return this.transform.maxZoom},n.prototype.setMinPitch=function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(0<=t&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},n.prototype.getMinPitch=function(){return this.transform.minPitch},n.prototype.setMaxPitch=function(t){if(60<(t=null==t?60:t))throw new Error("maxPitch must be less than or equal to 60");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")},n.prototype.getMaxPitch=function(){return this.transform.maxPitch},n.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},n.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},n.prototype.project=function(e){return this.transform.locationPoint(t.LngLat.convert(e))},n.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},n.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},n.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},n.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},n.prototype._createDelegatedListener=function(t,e,r){var i,n=this;if("mouseenter"===t||"mouseover"===t){var o=!1;return{layer:e,listener:r,delegates:{mousemove:function(i){var a=n.getLayer(e)?n.queryRenderedFeatures(i.point,{layers:[e]}):[];a.length?o||(o=!0,r.call(n,new $n(t,n,i.originalEvent,{features:a}))):o=!1},mouseout:function(){o=!1}}}}if("mouseleave"!==t&&"mouseout"!==t)return{layer:e,listener:r,delegates:((i={})[t]=function(t){var i=n.getLayer(e)?n.queryRenderedFeatures(t.point,{layers:[e]}):[];i.length&&(t.features=i,r.call(n,t),delete t.features)},i)};var a=!1;return{layer:e,listener:r,delegates:{mousemove:function(i){(n.getLayer(e)?n.queryRenderedFeatures(i.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,r.call(n,new $n(t,n,i.originalEvent)))},mouseout:function(e){a&&(a=!1,r.call(n,new $n(t,n,e.originalEvent)))}}}},n.prototype.on=function(t,e,r){if(void 0===r)return i.prototype.on.call(this,t,e);var n=this._createDelegatedListener(t,e,r);for(var o in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(n),n.delegates)this.on(o,n.delegates[o]);return this},n.prototype.once=function(t,e,r){if(void 0===r)return i.prototype.once.call(this,t,e);var n=this._createDelegatedListener(t,e,r);for(var o in n.delegates)this.once(o,n.delegates[o]);return this},n.prototype.off=function(t,e,r){var n=this;return void 0===r?i.prototype.off.call(this,t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&function(i){for(var o=i[t],a=0;a<o.length;a++){var s=o[a];if(s.layer===e&&s.listener===r){for(var l in s.delegates)n.off(l,s.delegates[l]);return o.splice(a,1)}}}(this._delegatedListeners),this)},n.prototype.queryRenderedFeatures=function(e,r){if(!this.style)return[];var i;if(void 0!==r||void 0===e||e instanceof t.Point||Array.isArray(e)||(r=e,e=void 0),r=r||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])i=[t.Point.convert(e)];else{var n=t.Point.convert(e[0]),o=t.Point.convert(e[1]);i=[n,new t.Point(o.x,n.y),o,new t.Point(n.x,o.y),n]}return this.style.queryRenderedFeatures(i,r,this.transform)},n.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},n.prototype.setStyle=function(e,r){return!1!==(r=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(e,r))},n.prototype._getUIString=function(t){var e=this._locale[t];if(null==e)throw new Error("Missing UI string '"+t+"'");return e},n.prototype._updateStyle=function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new xi(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)):delete this.style,this},n.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new xi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},n.prototype._diffStyle=function(e,r){var i=this;if("string"==typeof e){var n=this._requestManager.normalizeStyleURL(e),o=this._requestManager.transformRequest(n,t.ResourceType.Style);t.getJSON(o,(function(e,n){e?i.fire(new t.ErrorEvent(e)):n&&i._updateDiff(n,r)}))}else"object"==typeof e&&this._updateDiff(e,r)},n.prototype._updateDiff=function(e,r){try{this.style.setState(e)&&this._update(!0)}catch(n){t.warnOnce("Unable to perform style diff: "+(n.message||n.error||n)+".  Rebuilding the style from scratch."),this._updateStyle(e,r)}},n.prototype.getStyle=function(){if(this.style)return this.style.serialize()},n.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},n.prototype.addSource=function(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)},n.prototype.isSourceLoaded=function(e){var r=this.style&&this.style.sourceCaches[e];if(void 0!==r)return r.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},n.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var r=t[e]._tiles;for(var i in r){var n=r[i];if("loaded"!==n.state&&"errored"!==n.state)return!1}}return!0},n.prototype.addSourceType=function(t,e,r){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,r)},n.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},n.prototype.getSource=function(t){return this.style.getSource(t)},n.prototype.addImage=function(e,r,i){void 0===i&&(i={});var n=i.pixelRatio;void 0===n&&(n=1);var o=i.sdf;void 0===o&&(o=!1);var a=i.stretchX,s=i.stretchY,l=i.content;if(this._lazyInitEmptyStyle(),r instanceof ia||oa&&r instanceof oa){var c=t.browser.getImageData(r);this.style.addImage(e,{data:new t.RGBAImage({width:c.width,height:c.height},c.data),pixelRatio:n,stretchX:a,stretchY:s,content:l,sdf:o,version:0})}else{if(void 0===r.width||void 0===r.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var u=r;this.style.addImage(e,{data:new t.RGBAImage({width:r.width,height:r.height},new Uint8Array(r.data)),pixelRatio:n,stretchX:a,stretchY:s,content:l,sdf:o,version:0,userImage:u}),u.onAdd&&u.onAdd(this,e)}},n.prototype.updateImage=function(e,r){var i=this.style.getImage(e);if(!i)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var n=r instanceof ia||oa&&r instanceof oa?t.browser.getImageData(r):r,o=n.width,a=n.height,s=n.data;return void 0===o||void 0===a?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==i.data.width||a!==i.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(i.data.replace(s,!(r instanceof ia||oa&&r instanceof oa)),void this.style.updateImage(e,i))},n.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},n.prototype.removeImage=function(t){this.style.removeImage(t)},n.prototype.loadImage=function(e,r){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),r)},n.prototype.listImages=function(){return this.style.listImages()},n.prototype.addLayer=function(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)},n.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},n.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},n.prototype.getLayer=function(t){return this.style.getLayer(t)},n.prototype.setLayerZoomRange=function(t,e,r){return this.style.setLayerZoomRange(t,e,r),this._update(!0)},n.prototype.setFilter=function(t,e,r){return void 0===r&&(r={}),this.style.setFilter(t,e,r),this._update(!0)},n.prototype.getFilter=function(t){return this.style.getFilter(t)},n.prototype.setPaintProperty=function(t,e,r,i){return void 0===i&&(i={}),this.style.setPaintProperty(t,e,r,i),this._update(!0)},n.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},n.prototype.setLayoutProperty=function(t,e,r,i){return void 0===i&&(i={}),this.style.setLayoutProperty(t,e,r,i),this._update(!0)},n.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},n.prototype.setLight=function(t,e){return void 0===e&&(e={}),this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)},n.prototype.getLight=function(){return this.style.getLight()},n.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},n.prototype.removeFeatureState=function(t,e){return this.style.removeFeatureState(t,e),this._update()},n.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},n.prototype.getContainer=function(){return this._container},n.prototype.getCanvasContainer=function(){return this._canvasContainer},n.prototype.getCanvas=function(){return this._canvas},n.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},n.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},n.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=r.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=r.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=r.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);var n=this._controlContainer=r.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(t){o[t]=r.create("div","mapboxgl-ctrl-"+t,n)}))},n.prototype._resizeCanvas=function(e,r){var i=t.browser.devicePixelRatio||1;this._canvas.width=i*e,this._canvas.height=i*r,this._canvas.style.width=e+"px",this._canvas.style.height=r+"px"},n.prototype._setupPainter=function(){var r=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);i?(this.painter=new Rn(i,this.transform),t.webpSupported.testSupport(i)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},n.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},n.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},n.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},n.prototype._update=function(t){return this.style&&(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint()),this},n.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},n.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},n.prototype._render=function(e){var r,i=this,n=0,o=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(r=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,r),n=t.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),!this._removed){var a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var s=this.transform.zoom,l=t.browser.now();this.style.zoomHistory.update(s,l);var c=new t.EvaluationParameters(s,{now:l,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),u=c.crossFadingFactor();1===u&&u===this._crossFadingFactor||(a=!0,this._crossFadingFactor=u),this.style.update(c)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var p=t.browser.now()-n;o.endQueryEXT(o.TIME_ELAPSED_EXT,r),setTimeout((function(){var e=o.getQueryObjectEXT(r,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(r),i.fire(new t.Event("gpu-timing-frame",{cpuTime:p,gpuTime:e}))}),50)}if(this.listens("gpu-timing-layer")){var h=this.painter.collectGpuTimers();setTimeout((function(){var e=i.painter.queryGpuTimers(h);i.fire(new t.Event("gpu-timing-layer",{layerTimes:e}))}),50)}var d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0),this}},n.prototype.remove=function(){this._hash&&this._hash.remove();for(var e=0,r=this._controls;e<r.length;e+=1)r[e].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));var i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),la(this._canvasContainer),la(this._controlContainer),la(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new t.Event("remove"))},n.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame((function(t){e._frame=null,e._render(t)})))},n.prototype._onWindowOnline=function(){this._update()},n.prototype._onWindowResize=function(t){this._trackResize&&this.resize({originalEvent:t})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(t){this._showPadding!==t&&(this._showPadding=t,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&((this._showCollisionBoxes=t)?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(t){this._vertices=t,this._update()},n.prototype._setCacheLimits=function(e,r){t.setCacheLimits(e,r)},o.version.get=function(){return t.version},Object.defineProperties(n.prototype,o),n}($o);function la(t){t.parentNode&&t.parentNode.removeChild(t)}function ca(e){var i=this;this.options=t.extend({},ua,e),this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(t){return i._map.zoomIn({},{originalEvent:t})})),r.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(t){return i._map.zoomOut({},{originalEvent:t})})),r.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(t){i.options.visualizePitch?i._map.resetNorthPitch({},{originalEvent:t}):i._map.resetNorth({},{originalEvent:t})})),this._compassIcon=r.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}var ua={showCompass:!0,showZoom:!0,visualizePitch:!1};ca.prototype._updateZoomButtons=function(){var t=this._map.getZoom();this._zoomInButton.disabled=t===this._map.getMaxZoom(),this._zoomOutButton.disabled=t===this._map.getMinZoom()},ca.prototype._rotateCompassArrow=function(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=t},ca.prototype.onAdd=function(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pa(this._map,this._compass,this.options.visualizePitch)),this._container},ca.prototype.onRemove=function(){r.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ca.prototype._createButton=function(t,e){var i=r.create("button",t,this._container);return i.type="button",i.addEventListener("click",e),i},ca.prototype._setButtonTitle=function(t,e){var r=this._map._getUIString("NavigationControl."+e);t.title=r,t.setAttribute("aria-label",r)};var pa=function(e,i,n){void 0===n&&(n=!1),this._clickTolerance=10,this.element=i,this.mouseRotate=new mo({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,n&&(this.mousePitch=new go({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener(i,"mousedown",this.mousedown),r.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),r.addEventListener(i,"touchmove",this.touchmove),r.addEventListener(i,"touchend",this.touchend),r.addEventListener(i,"touchcancel",this.reset)};function ha(e,r,i){if(e=new t.LngLat(e.lng,e.lat),r){var n=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=i.locationPoint(e).distSqr(r);i.locationPoint(n).distSqr(r)<a?e=n:i.locationPoint(o).distSqr(r)<a&&(e=o)}for(;180<Math.abs(e.lng-i.center.lng);){var s=i.locationPoint(e);if(0<=s.x&&0<=s.y&&s.x<=i.width&&s.y<=i.height)break;e.lng>i.center.lng?e.lng-=360:e.lng+=360}return e}pa.prototype.down=function(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),r.disableDrag()},pa.prototype.move=function(t,e){var r=this.map,i=this.mouseRotate.mousemoveWindow(t,e);if(i&&i.bearingDelta&&r.setBearing(r.getBearing()+i.bearingDelta),this.mousePitch){var n=this.mousePitch.mousemoveWindow(t,e);n&&n.pitchDelta&&r.setPitch(r.getPitch()+n.pitchDelta)}},pa.prototype.off=function(){var t=this.element;r.removeEventListener(t,"mousedown",this.mousedown),r.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),r.removeEventListener(t,"touchmove",this.touchmove),r.removeEventListener(t,"touchend",this.touchend),r.removeEventListener(t,"touchcancel",this.reset),this.offTemp()},pa.prototype.offTemp=function(){r.enableDrag(),r.removeEventListener(t.window,"mousemove",this.mousemove),r.removeEventListener(t.window,"mouseup",this.mouseup)},pa.prototype.mousedown=function(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:function(){return e.preventDefault()}}),r.mousePos(this.element,e)),r.addEventListener(t.window,"mousemove",this.mousemove),r.addEventListener(t.window,"mouseup",this.mouseup)},pa.prototype.mousemove=function(t){this.move(t,r.mousePos(this.element,t))},pa.prototype.mouseup=function(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()},pa.prototype.touchstart=function(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=r.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return t.preventDefault()}},this._startPos))},pa.prototype.touchmove=function(t){1!==t.targetTouches.length?this.reset():(this._lastPos=r.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:function(){return t.preventDefault()}},this._lastPos))},pa.prototype.touchend=function(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},pa.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var da={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function fa(t,e,r){var i=t.classList;for(var n in da)i.remove("mapboxgl-"+r+"-anchor-"+n);i.add("mapboxgl-"+r+"-anchor-"+e)}function ma(e){this.options=t.extend({},Ta,e),t.bindAll(["_onMove","setUnit"],this)}var ga,ya,va,_a=((va=t.Evented)&&(Ia.__proto__=va),((Ia.prototype=Object.create(va&&va.prototype)).constructor=Ia).prototype.addTo=function(t){return this.remove(),(this._map=t).getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},Ia.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),r.remove(this._element),this._popup&&this._popup.remove(),this},Ia.prototype.getLngLat=function(){return this._lngLat},Ia.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},Ia.prototype.getElement=function(){return this._element},Ia.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},Ia.prototype._onKeyPress=function(t){var e=t.code,r=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==r&&13!==r||this.togglePopup()},Ia.prototype._onMapClick=function(t){var e=t.originalEvent.target,r=this._element;this._popup&&(e===r||r.contains(e))&&this.togglePopup()},Ia.prototype.getPopup=function(){return this._popup},Ia.prototype.togglePopup=function(){var t=this._popup;return t&&(t.isOpen()?t.remove():t.addTo(this._map)),this},Ia.prototype._update=function(t){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(e="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i="rotateX("+this._map.getPitch()+"deg)"),t&&"moveend"!==t.type||(this._pos=this._pos.round()),r.setTransform(this._element,da[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+i+" "+e)}},Ia.prototype.getOffset=function(){return this._offset},Ia.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},Ia.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},Ia.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},Ia.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},Ia.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},Ia.prototype.isDraggable=function(){return this._draggable},Ia.prototype.setRotation=function(t){return this._rotation=t||0,this._update(),this},Ia.prototype.getRotation=function(){return this._rotation},Ia.prototype.setRotationAlignment=function(t){return this._rotationAlignment=t||"auto",this._update(),this},Ia.prototype.getRotationAlignment=function(){return this._rotationAlignment},Ia.prototype.setPitchAlignment=function(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this},Ia.prototype.getPitchAlignment=function(){return this._pitchAlignment},Ia),xa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ba=0,wa=!1,Sa=((ya=t.Evented)&&(Ea.__proto__=ya),((Ea.prototype=Object.create(ya&&ya.prototype)).constructor=Ea).prototype.onAdd=function(e){var i;return this._map=e,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,void 0!==ga?i(ga):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((function(t){i(ga="denied"!==t.state)})):i(ga=!!t.window.navigator.geolocation),this._container},Ea.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),r.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ba=0,wa=!1},Ea.prototype._isOutOfMapMaxBounds=function(t){var e=this._map.getMaxBounds(),r=t.coords;return e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())},Ea.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},Ea.prototype._onSuccess=function(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}},Ea.prototype._updateCamera=function(e){var r=new t.LngLat(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,n=this._map.getBearing(),o=t.extend({bearing:n},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(i),o,{geolocateSource:!0})},Ea.prototype._updateMarker=function(e){if(e){var r=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},Ea.prototype._updateCircleRadius=function(){var t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),r=this._map.unproject([1,t]),i=e.distanceTo(r),n=Math.ceil(2*this._accuracy/i);this._circleElement.style.width=n+"px",this._circleElement.style.height=n+"px"},Ea.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},Ea.prototype._onError=function(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&wa)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}},Ea.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},Ea.prototype._setupUI=function(e){var i=this;if(this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._geolocateButton=r.create("button","mapboxgl-ctrl-geolocate",this._container),r.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),!(this._geolocateButton.type="button")===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{var o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=r.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new _a(this._dotElement),this._circleElement=r.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _a({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(e){e.geolocateSource||"ACTIVE_LOCK"!==i._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(i._watchState="BACKGROUND",i._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),i._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),i.fire(new t.Event("trackuserlocationend")))}))},Ea.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ba--,wa=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),wa=1<++ba?(e={maximumAge:6e5,timeout:0},!0):(e=this.options.positionOptions,!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},Ea.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},Ea),Ta={maxWidth:100,unit:"metric"};function Ea(e){ya.call(this),this.options=t.extend({},xa,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}function Ia(e,i){var n=this;if(va.call(this),(e instanceof t.window.HTMLElement||i)&&(e=t.extend({element:e},i)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,e&&e.element)this._element=e.element,this._offset=t.Point.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=r.create("div"),this._element.setAttribute("aria-label","Map marker");var o=r.createNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height","41px"),o.setAttributeNS(null,"width","27px"),o.setAttributeNS(null,"viewBox","0 0 27 41");var a=r.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");var s=r.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");var l=r.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");for(var c=0,u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];c<u.length;c+=1){var p=u[c],h=r.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04"),h.setAttributeNS(null,"cx","10.5"),h.setAttributeNS(null,"cy","5.80029008"),h.setAttributeNS(null,"rx",p.rx),h.setAttributeNS(null,"ry",p.ry),l.appendChild(h)}var d=r.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var f=r.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(f);var m=r.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"fill","#000000");var g=r.createNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),m.appendChild(g);var y=r.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),y.setAttributeNS(null,"fill","#FFFFFF");var v=r.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(8.0, 8.0)");var _=r.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#000000"),_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962");var x=r.createNS("http://www.w3.org/2000/svg","circle");x.setAttributeNS(null,"fill","#FFFFFF"),x.setAttributeNS(null,"cx","5.5"),x.setAttributeNS(null,"cy","5.5"),x.setAttributeNS(null,"r","5.4999962"),v.appendChild(_),v.appendChild(x),s.appendChild(l),s.appendChild(d),s.appendChild(m),s.appendChild(y),s.appendChild(v),o.appendChild(s),o.setAttributeNS(null,"height",41*this._scale+"px"),o.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(o),this._offset=t.Point.convert(e&&e.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(t){t.preventDefault()})),this._element.addEventListener("mousedown",(function(t){t.preventDefault()})),this._element.addEventListener("focus",(function(){var t=n._map.getContainer();t.scrollTop=0,t.scrollLeft=0})),fa(this._element,this._anchor,"marker"),this._popup=null}function Ca(t,e,r){var i=r&&r.maxWidth||100,n=t._container.clientHeight/2,o=t.unproject([0,n]),a=t.unproject([i,n]),s=o.distanceTo(a);if(r&&"imperial"===r.unit){var l=3.2808*s;5280<l?Aa(e,i,l/5280,t._getUIString("ScaleControl.Miles")):Aa(e,i,l,t._getUIString("ScaleControl.Feet"))}else r&&"nautical"===r.unit?Aa(e,i,s/1852,t._getUIString("ScaleControl.NauticalMiles")):1e3<=s?Aa(e,i,s/1e3,t._getUIString("ScaleControl.Kilometers")):Aa(e,i,s,t._getUIString("ScaleControl.Meters"))}function Aa(t,e,r,i){var n,o,a,s,l,c=(n=r,(o=Math.pow(10,(""+Math.floor(n)).length-1))*(a=10<=(a=n/o)?10:5<=a?5:3<=a?3:2<=a?2:1<=a?1:(s=a,l=Math.pow(10,Math.ceil(-Math.log(s)/Math.LN10)),Math.round(s*l)/l)));t.style.width=e*(c/r)+"px",t.innerHTML=c+"&nbsp;"+i}function ka(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange")}ma.prototype.getDefaultPosition=function(){return"bottom-left"},ma.prototype._onMove=function(){Ca(this._map,this._container,this.options)},ma.prototype.onAdd=function(t){return this._map=t,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ma.prototype.onRemove=function(){r.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ma.prototype.setUnit=function(t){this.options.unit=t,Ca(this._map,this._container,this.options)},ka.prototype.onAdd=function(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ka.prototype.onRemove=function(){r.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ka.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},ka.prototype._setupUI=function(){var e=this._fullscreenButton=r.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);r.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ka.prototype._updateTitle=function(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t},ka.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ka.prototype._isFullscreen=function(){return this._fullscreen},ka.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ka.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Pa,Oa={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Ma=((Pa=t.Evented)&&(Da.__proto__=Pa),((Da.prototype=Object.create(Pa&&Pa.prototype)).constructor=Da).prototype.addTo=function(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this},Da.prototype.isOpen=function(){return!!this._map},Da.prototype.remove=function(){return this._content&&r.remove(this._content),this._container&&(r.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this},Da.prototype.getLngLat=function(){return this._lngLat},Da.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},Da.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},Da.prototype.getElement=function(){return this._container},Da.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},Da.prototype.setHTML=function(e){var r,i=t.window.document.createDocumentFragment(),n=t.window.document.createElement("body");for(n.innerHTML=e;r=n.firstChild;)i.appendChild(r);return this.setDOMContent(i)},Da.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},Da.prototype.setMaxWidth=function(t){return this.options.maxWidth=t,this._update(),this},Da.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},Da.prototype.addClassName=function(t){this._container&&this._container.classList.add(t)},Da.prototype.removeClassName=function(t){this._container&&this._container.classList.remove(t)},Da.prototype.toggleClassName=function(t){if(this._container)return this._container.classList.toggle(t)},Da.prototype._createContent=function(){this._content&&r.remove(this._content),this._content=r.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=r.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},Da.prototype._onMouseUp=function(t){this._update(t.point)},Da.prototype._onMouseMove=function(t){this._update(t.point)},Da.prototype._onDrag=function(t){this._update(t.point)},Da.prototype._update=function(e){var i=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=r.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=r.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(t){return i._container.classList.add(t)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e)){var n=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),o=this.options.anchor,a=function e(r){if(r){if("number"==typeof r){var i=Math.round(Math.sqrt(.5*Math.pow(r,2)));return{center:new t.Point(0,0),top:new t.Point(0,r),"top-left":new t.Point(i,i),"top-right":new t.Point(-i,i),bottom:new t.Point(0,-r),"bottom-left":new t.Point(i,-i),"bottom-right":new t.Point(-i,-i),left:new t.Point(r,0),right:new t.Point(-r,0)}}if(r instanceof t.Point||Array.isArray(r)){var n=t.Point.convert(r);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:t.Point.convert(r.center||[0,0]),top:t.Point.convert(r.top||[0,0]),"top-left":t.Point.convert(r["top-left"]||[0,0]),"top-right":t.Point.convert(r["top-right"]||[0,0]),bottom:t.Point.convert(r.bottom||[0,0]),"bottom-left":t.Point.convert(r["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(r["bottom-right"]||[0,0]),left:t.Point.convert(r.left||[0,0]),right:t.Point.convert(r.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!o){var s,l=this._container.offsetWidth,c=this._container.offsetHeight;s=n.y+a.bottom.y<c?["top"]:n.y>this._map.transform.height-c?["bottom"]:[],n.x<l/2?s.push("left"):n.x>this._map.transform.width-l/2&&s.push("right"),o=0===s.length?"bottom":s.join("-")}var u=n.add(a[o]).round();r.setTransform(this._container,da[o]+" translate("+u.x+"px,"+u.y+"px)"),fa(this._container,o,"popup")}},Da.prototype._onClose=function(){this.remove()},Da),La={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:sa,NavigationControl:ca,GeolocateControl:Sa,AttributionControl:Yo,ScaleControl:ma,FullscreenControl:ka,Popup:Ma,Marker:_a,Style:xi,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,config:t.config,prewarm:function(){gr().acquire(hr)},clearPrewarmedResources:function(){var t=fr;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(hr),fr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return dr.workerCount},set workerCount(t){dr.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(e){t.clearTileCache(e)},workerUrl:""};function Da(e){Pa.call(this),this.options=t.extend(Object.create(Oa),e),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return La})),o)})),o=(n.Map,n.setRTLTextPlugin),a=(n.supported,n.Marker),s="atlas.microsoft.com",l="atlas.microsoft.com",c="styles/definitions/2019-10-16.json",u="e96cb745-c6f5-409c-a775-c4313e468c1d",p="https://login.microsoftonline.com/",h="Authorization",d="Bearer ",f="{azMapsDomain}",m="Map-Agent",g="x-ms-client-id",y="Ms-Am-Request-Origin",v="MapControl",_="https://atlas.microsoft.com/",x="Session-Id",b=function(t,e){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function w(t,e){function r(){this.constructor=t}b(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var S=function(){return(S=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function T(t,e,r,i){return new(r=r||Promise)((function(n,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){t.done?n(t.value):new r((function(e){e(t.value)})).then(a,s)}l((i=i.apply(t,e||[])).next())}))}function E(t,e){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=0<(n=a.trys).length&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var I=(C.prototype.merge=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var i=0,n=e;i<n.length;i++){var o=n[i];if(o)for(var a in o)o.hasOwnProperty(a)&&this.hasOwnProperty(a)&&(void 0!==o[a]&&null!=o[a]?this[a]instanceof C?this[a].merge(o[a]):this[a]=o[a]:(t=t||new(Object.getPrototypeOf(this).constructor),this[a]=t[a]))}return this},C);function C(){}var A,k=(w(P,A=I),P);function P(){var t=null!==A&&A.apply(this,arguments)||this;return t.domain=void 0,t.headers={},t.path="",t.protocol="https",t.queryParams={},t.subdomain="",t}var O=(M.prototype.get=function(){return fetch(this.toString(),{method:"GET",mode:"cors",headers:new Headers(this.options.headers)}).then((function(t){if(t.ok)return t.json();throw new Error("HTTP "+t.status+": "+t.statusText)}))},M.prototype.toString=function(){var t=Object.entries(this.options.queryParams).map((function(t){return t[0]+"="+t[1]})).join("&"),e=[],r=this.options.path||"";return M.protoRegEx.test(r)?e.push(r):(this.options.domain&&(M.protoRegEx.test(this.options.domain)||(e.push(this.options.protocol+"://"),e.push(this.options.subdomain?this.options.subdomain+".":"")),e.push(this.options.domain)),e.push(this.options.path?"/"+r:"")),e.push(t?"?"+t:""),e.join("")},M.protoRegEx=new RegExp(/^(file|http|https|blob:http|blob:https):\/\//i),M);function M(t){this.options=(new k).merge(t)}var L,D="2.0.32",R=(z.getFullVersion=function(){return D},z.getEndpointVersion=function(){var t=D.indexOf(".");return-1===(t=D.indexOf(".",t+1))?D:D.substring(0,t)},z);function z(){}(L=e.ControlPosition||(e.ControlPosition={})).TopLeft="top-left",L.TopRight="top-right",L.BottomLeft="bottom-left",L.BottomRight="bottom-right",L.NonFixed="non-fixed";var N,B=(w(F,N=I),F);function F(){var t=null!==N&&N.apply(this,arguments)||this;return t.position=e.ControlPosition.NonFixed,t}var j,U=(V.prototype.getLuminosity=function(){for(var t=[this.r,this.g,this.b],e=[],r=0;r<t.length;r++){var i=t[r]/255;e[r]=i<=.03928?i/12.92:Math.pow((.055+i)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},V.prototype.getRBGA=function(t){var e=document.createElement("canvas").getContext("2d");e.globalAlpha=1,e.fillStyle=t,e.fillRect(0,0,1,1);var r=e.getImageData(0,0,1,1).data;return[r[0],r[1],r[2],r[3]]},V);function V(t){if(t){var e=void 0;3<=(e="string"==typeof t?this.getRBGA(t):t).length&&(this.r=e[0],this.g=e[1],this.b=e[2],3<e.length&&(this.a=e[3]))}}(j=e.ControlStyle||(e.ControlStyle={})).light="light",j.dark="dark",j.auto="auto";var q=(G.prototype.onRemove=function(){this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.events.remove("styledata",this._onStyleChange),delete this._map),this._observer&&(this._observer.disconnect(),delete this._observer),delete this._theme},G.prototype.buildContainer=function(t,r,i,n){var o=this;return this._map=t,this._container=document.createElement(n||"div"),this._container.classList.add("azure-maps-control-container"),"string"==typeof i&&this._container.setAttribute("aria-label",i),r.toLowerCase()===e.ControlStyle.auto?this._map.styles.initialize().then((function(){o._onStyleChange(),o._map.events.add("styledata",o._onStyleChange)})):this._container.classList.add(r),this._container},G.prototype._setTheme=function(t){this._theme!==t&&(this._container.classList.remove(this._theme),this._container.classList.add(t),this._theme=t)},G.activateClickDelay=100,G);function G(){var t=this;this._onStyleChange=function(){if(t._map.getStyle().style.toLowerCase().startsWith("blank"))t._observer||(t._onBackgroundChange(),t._observer=new MutationObserver(t._onBackgroundChange),t._observer.observe(t._map.getMapContainer(),{attributes:!0,attributeFilter:["style"]}));else{t._observer&&(t._observer.disconnect(),delete t._observer);var e=t._map.styles.getTheme(t._map.getStyle());t._setTheme(e)}},this._onBackgroundChange=function(){var r=new U(t._map.getMapContainer().style.backgroundColor).getLuminosity(),i=isNaN(r)||.5<r?e.ControlStyle.light:e.ControlStyle.dark;t._setTheme(i)}}var Z,H=(w(W,Z=I),W);function W(){var t=null!==Z&&Z.apply(this,arguments)||this;return t.rotationDegreesDelta=15,t.style=e.ControlStyle.light,t}var K,X=(w(Y,K=q),Y.prototype.onAdd=function(t,e){var r=this,i=this.buildContainer(t,this.options.style,"Rotation Control"),n=this.constructRotationButton(t),o=this.constructRotationGrid(t,e);return i.addEventListener("mouseover",(function(t){r.lastActiveTime=r.lastActiveTime||t.timeStamp,r.hasMouse=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element")})),i.addEventListener("focusin",(function(t){r.lastActiveTime=r.lastActiveTime||t.timeStamp,r.hasFocus=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element")})),i.addEventListener("mouseleave",(function(){r.hasMouse=!1,r.hasFocus||(delete r.lastActiveTime,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element"))})),i.addEventListener("focusout",(function(t){t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(r.hasFocus=!1,r.hasMouse||(delete r.lastActiveTime,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element")))})),e&&Y.InvertOrderPositions.includes(e.position)?(i.appendChild(o),i.appendChild(n)):(i.appendChild(n),i.appendChild(o)),i},Y.prototype.constructRotationGrid=function(t,e){var r=document.createElement("div");r.classList.add("sub-container"),r.classList.add("hidden-accessible-element");var i=this.constructRightRotationButton(t),n=this.constructLeftRotationButton(t);return e&&Y.InvertOrderPositions.includes(e.position)?(r.appendChild(i),r.appendChild(n)):(r.appendChild(n),r.appendChild(i)),r},Y.prototype.constructRotationButton=function(t){var e=this,r=document.createElement("button");r.classList.add("azure-maps-control-button"),r.classList.add("rotation"),r.setAttribute("title","Reset to Default Rotation"),r.setAttribute("alt","Reset to Default Rotation"),r.setAttribute("type","button");var i=document.createElement("div");return r.appendChild(i),r.addEventListener("click",(function(r){r.timeStamp-e.lastActiveTime>q.activateClickDelay&&t.setCamera({bearing:Y.DefaultRotation},!0)})),t.events.add("rotate",(function(t){i.style.transform="rotate("+-t.map.getCamera().bearing+"deg)"})),r},Y.prototype.constructRightRotationButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("rotation-right"),r.setAttribute("title","Rotate Right"),r.setAttribute("alt","Rotate Right"),r.setAttribute("type","button"),r.addEventListener("click",(function(){t.setCamera({bearing:t.getCamera().bearing+e.options.rotationDegreesDelta,duration:Y.RotationDuration,type:"ease"},!0)})),r},Y.prototype.constructLeftRotationButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("rotation-left"),r.setAttribute("title","Rotate Left"),r.setAttribute("alt","Rotate Left"),r.setAttribute("type","button"),r.addEventListener("click",(function(){t.setCamera({bearing:t.getCamera().bearing-e.options.rotationDegreesDelta,duration:Y.RotationDuration,type:"ease"},!0)})),r},Y.DefaultRotation=0,Y.RotationDuration=100,Y.InvertOrderPositions=[e.ControlPosition.BottomRight,e.ControlPosition.TopRight],Y);function Y(t){var e=K.call(this)||this;return e.hasMouse=!1,e.hasFocus=!1,e.options=(new H).merge(t),e}var J,$=(w(Q,J=I),Q);function Q(){var t=null!==J&&J.apply(this,arguments)||this;return t.pitchDegreesDelta=10,t.style=e.ControlStyle.light,t}var tt,et=(w(rt,tt=q),rt.prototype.onAdd=function(t,e){var r=this,i=this.buildContainer(t,this.options.style,"Pitch Control"),n=this.constructPitchButton(t),o=this.constructPitchGrid(t,e);return i.addEventListener("mouseover",(function(t){r.lastActiveTime=r.lastActiveTime||t.timeStamp,r.hasMouse=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element")})),i.addEventListener("focusin",(function(t){r.lastActiveTime=r.lastActiveTime||t.timeStamp,r.hasFocus=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element")})),i.addEventListener("mouseleave",(function(){r.hasMouse=!1,r.hasFocus||(delete r.lastActiveTime,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element"))})),i.addEventListener("focusout",(function(t){t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(r.hasFocus=!1,r.hasMouse||(delete r.lastActiveTime,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element")))})),e&&rt.INVERT_ORDER_POSITIONS.includes(e.position)?(i.appendChild(o),i.appendChild(n)):(i.appendChild(n),i.appendChild(o)),i},rt.prototype.constructPitchGrid=function(t,e){var r=document.createElement("div");r.classList.add("sub-container"),r.classList.add("hidden-accessible-element");var i=this.constructPitchIncrementButton(t),n=this.constructPitchDecrementButton(t);return e&&rt.INVERT_ORDER_POSITIONS.includes(e.position)?(r.appendChild(n),r.appendChild(i)):(r.appendChild(i),r.appendChild(n)),r},rt.prototype.constructPitchButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("pitch"),r.setAttribute("title","Reset to Default Pitch"),r.setAttribute("alt","Reset to Default Pitch"),r.setAttribute("type","button"),r.addEventListener("click",(function(){event.timeStamp-e.lastActiveTime>q.activateClickDelay&&t.setCamera({pitch:rt.DEFAULT_PITCH},!0)})),r},rt.prototype.constructPitchDecrementButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("pitch-down"),r.setAttribute("title","Decrease Pitch"),r.setAttribute("alt","Decrease Pitch"),r.setAttribute("type","button"),r.addEventListener("click",(function(){t.setCamera({pitch:t.getCamera().pitch-e.options.pitchDegreesDelta,duration:rt.PITCH_DURATION_MS,type:"ease"},!0)})),r},rt.prototype.constructPitchIncrementButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("pitch-up"),r.setAttribute("title","Increase Pitch"),r.setAttribute("alt","Increase Pitch"),r.setAttribute("type","button"),r.addEventListener("click",(function(){t.setCamera({pitch:t.getCamera().pitch+e.options.pitchDegreesDelta,duration:rt.PITCH_DURATION_MS,type:"ease"},!0)})),r},rt.PITCH_DURATION_MS=100,rt.DEFAULT_PITCH=0,rt.INVERT_ORDER_POSITIONS=[e.ControlPosition.BottomRight,e.ControlPosition.TopRight],rt);function rt(t){var e=tt.call(this)||this;return e.hasMouse=!1,e.hasFocus=!1,e.options=(new $).merge(t),e}function it(){this.__data__=[],this.size=0}var nt=function(t,e){return t===e||t!=t&&e!=e},ot=function(t,e){for(var r=t.length;r--;)if(nt(t[r][0],e))return r;return-1},at=Array.prototype.splice;function st(t){var e=this.__data__,r=ot(e,t);return!(r<0)&&(r==e.length-1?e.pop():at.call(e,r,1),--this.size,!0)}function lt(t){var e=this.__data__,r=ot(e,t);return r<0?void 0:e[r][1]}function ct(t){return-1<ot(this.__data__,t)}function ut(t,e){var r=this.__data__,i=ot(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}function pt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}pt.prototype.clear=it,pt.prototype.delete=st,pt.prototype.get=lt,pt.prototype.has=ct,pt.prototype.set=ut;var ht=pt;function dt(){this.__data__=new ht,this.size=0}function ft(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function mt(t){return this.__data__.get(t)}function gt(t){return this.__data__.has(t)}var yt,vt="object"==typeof r&&r&&r.Object===Object&&r,_t="object"==typeof self&&self&&self.Object===Object&&self,xt=vt||_t||Function("return this")(),bt=xt.Symbol,wt=Object.prototype,St=wt.hasOwnProperty,Tt=wt.toString,Et=bt?bt.toStringTag:void 0,It=function(t){var e=St.call(t,Et),r=t[Et];try{var i=!(t[Et]=void 0)}catch(t){}var n=Tt.call(t);return i&&(e?t[Et]=r:delete t[Et]),n},Ct=Object.prototype.toString,At=function(t){return Ct.call(t)},kt=bt?bt.toStringTag:void 0,Pt=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(kt&&kt in Object(t)?It:At)(t)},Ot=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},Mt=function(t){if(!Ot(t))return!1;var e=Pt(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Lt=xt["__core-js_shared__"],Dt=(yt=/[^.]+$/.exec(Lt&&Lt.keys&&Lt.keys.IE_PROTO||""))?"Symbol(src)_1."+yt:"",Rt=function(t){return!!Dt&&Dt in t},zt=Function.prototype.toString,Nt=function(t){if(null!=t){try{return zt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Bt=/^\[object .+?Constructor\]$/,Ft=Function.prototype,jt=Object.prototype,Ut=Ft.toString,Vt=jt.hasOwnProperty,qt=RegExp("^"+Ut.call(Vt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gt=function(t){return!(!Ot(t)||Rt(t))&&(Mt(t)?qt:Bt).test(Nt(t))},Zt=function(t,e){return null==t?void 0:t[e]},Ht=function(t,e){var r=Zt(t,e);return Gt(r)?r:void 0},Wt=Ht(xt,"Map"),Kt=Ht(Object,"create");function Xt(){this.__data__=Kt?Kt(null):{},this.size=0}function Yt(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Jt=Object.prototype.hasOwnProperty;function $t(t){var e=this.__data__;if(Kt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return Jt.call(e,t)?e[t]:void 0}var Qt=Object.prototype.hasOwnProperty;function te(t){var e=this.__data__;return Kt?void 0!==e[t]:Qt.call(e,t)}function ee(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Kt&&void 0===e?"__lodash_hash_undefined__":e,this}function re(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}re.prototype.clear=Xt,re.prototype.delete=Yt,re.prototype.get=$t,re.prototype.has=te,re.prototype.set=ee;var ie=re,ne=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t},oe=function(t,e){var r=t.__data__;return ne(e)?r["string"==typeof e?"string":"hash"]:r.map};function ae(t){var e=oe(this,t).delete(t);return this.size-=e?1:0,e}function se(t){return oe(this,t).get(t)}function le(t){return oe(this,t).has(t)}function ce(t,e){var r=oe(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}function ue(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}ue.prototype.clear=function(){this.size=0,this.__data__={hash:new ie,map:new(Wt||ht),string:new ie}},ue.prototype.delete=ae,ue.prototype.get=se,ue.prototype.has=le,ue.prototype.set=ce;var pe=ue;function he(t,e){var r=this.__data__;if(r instanceof ht){var i=r.__data__;if(!Wt||i.length<199)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new pe(i)}return r.set(t,e),this.size=r.size,this}function de(t){var e=this.__data__=new ht(t);this.size=e.size}de.prototype.clear=dt,de.prototype.delete=ft,de.prototype.get=mt,de.prototype.has=gt,de.prototype.set=he;var fe=de,me=function(t,e){for(var r=-1,i=null==t?0:t.length;++r<i&&!1!==e(t[r],r,t););return t},ge=function(){try{var t=Ht(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),ye=function(t,e,r){"__proto__"==e&&ge?ge(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},ve=Object.prototype.hasOwnProperty,_e=function(t,e,r){var i=t[e];ve.call(t,e)&&nt(i,r)&&(void 0!==r||e in t)||ye(t,e,r)},xe=function(t,e,r,i){var n=!r;r=r||{};for(var o=-1,a=e.length;++o<a;){var s=e[o],l=i?i(r[s],t[s],s,r,t):void 0;void 0===l&&(l=t[s]),(n?ye:_e)(r,s,l)}return r},be=function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i},we=function(t){return null!=t&&"object"==typeof t},Se=function(t){return we(t)&&"[object Arguments]"==Pt(t)},Te=Object.prototype,Ee=Te.hasOwnProperty,Ie=Te.propertyIsEnumerable,Ce=Se(function(){return arguments}())?Se:function(t){return we(t)&&Ee.call(t,"callee")&&!Ie.call(t,"callee")},Ae=Array.isArray;function ke(){return!1}var Pe=i((function(t,e){var r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,n=i&&i.exports===r?xt.Buffer:void 0,o=(n?n.isBuffer:void 0)||ke;t.exports=o})),Oe=/^(?:0|[1-9]\d*)$/,Me=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Oe.test(t))&&-1<t&&t%1==0&&t<e},Le=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991},De={};function Re(t){return we(t)&&Le(t.length)&&!!De[Pt(t)]}De["[object Float32Array]"]=De["[object Float64Array]"]=De["[object Int8Array]"]=De["[object Int16Array]"]=De["[object Int32Array]"]=De["[object Uint8Array]"]=De["[object Uint8ClampedArray]"]=De["[object Uint16Array]"]=De["[object Uint32Array]"]=!0,De["[object Arguments]"]=De["[object Array]"]=De["[object ArrayBuffer]"]=De["[object Boolean]"]=De["[object DataView]"]=De["[object Date]"]=De["[object Error]"]=De["[object Function]"]=De["[object Map]"]=De["[object Number]"]=De["[object Object]"]=De["[object RegExp]"]=De["[object Set]"]=De["[object String]"]=De["[object WeakMap]"]=!1;var ze=function(t){return function(e){return t(e)}},Ne=i((function(t,e){var r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,n=i&&i.exports===r&&vt.process,o=function(){try{var t=i&&i.require&&i.require("util").types;return t||n&&n.binding&&n.binding("util")}catch(t){}}();t.exports=o})),Be=Ne&&Ne.isTypedArray,Fe=Be?ze(Be):Re,je=Object.prototype.hasOwnProperty,Ue=function(t,e){var r=Ae(t),i=!r&&Ce(t),n=!r&&!i&&Pe(t),o=!r&&!i&&!n&&Fe(t),a=r||i||n||o,s=a?be(t.length,String):[],l=s.length;for(var c in t)!e&&!je.call(t,c)||a&&("length"==c||n&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Me(c,l))||s.push(c);return s},Ve=Object.prototype,qe=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ve)},Ge=function(t,e){return function(r){return t(e(r))}},Ze=Ge(Object.keys,Object),He=Object.prototype.hasOwnProperty,We=function(t){if(!qe(t))return Ze(t);var e=[];for(var r in Object(t))He.call(t,r)&&"constructor"!=r&&e.push(r);return e},Ke=function(t){return null!=t&&Le(t.length)&&!Mt(t)},Xe=function(t){return(Ke(t)?Ue:We)(t)},Ye=function(t,e){return t&&xe(e,Xe(e),t)},Je=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},$e=Object.prototype.hasOwnProperty,Qe=function(t){if(!Ot(t))return Je(t);var e=qe(t),r=[];for(var i in t)("constructor"!=i||!e&&$e.call(t,i))&&r.push(i);return r},tr=function(t){return Ke(t)?Ue(t,!0):Qe(t)},er=function(t,e){return t&&xe(e,tr(e),t)},rr=i((function(t,e){var r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,n=i&&i.exports===r?xt.Buffer:void 0,o=n?n.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,i=o?o(r):new t.constructor(r);return t.copy(i),i}})),ir=function(t,e){var r=-1,i=t.length;for(e=e||Array(i);++r<i;)e[r]=t[r];return e},nr=function(t,e){for(var r=-1,i=null==t?0:t.length,n=0,o=[];++r<i;){var a=t[r];e(a,r,t)&&(o[n++]=a)}return o};function or(){return[]}var ar=Object.prototype.propertyIsEnumerable,sr=Object.getOwnPropertySymbols,lr=sr?function(t){return null==t?[]:(t=Object(t),nr(sr(t),(function(e){return ar.call(t,e)})))}:or,cr=function(t,e){return xe(t,lr(t),e)},ur=function(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t},pr=Ge(Object.getPrototypeOf,Object),hr=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)ur(e,lr(t)),t=pr(t);return e}:or,dr=function(t,e){return xe(t,hr(t),e)},fr=function(t,e,r){var i=e(t);return Ae(t)?i:ur(i,r(t))},mr=function(t){return fr(t,Xe,lr)},gr=function(t){return fr(t,tr,hr)},yr=Ht(xt,"DataView"),vr=Ht(xt,"Promise"),_r=Ht(xt,"Set"),xr=Ht(xt,"WeakMap"),br="[object Map]",wr="[object Promise]",Sr="[object Set]",Tr="[object WeakMap]",Er="[object DataView]",Ir=Nt(yr),Cr=Nt(Wt),Ar=Nt(vr),kr=Nt(_r),Pr=Nt(xr),Or=Pt;(yr&&Or(new yr(new ArrayBuffer(1)))!=Er||Wt&&Or(new Wt)!=br||vr&&Or(vr.resolve())!=wr||_r&&Or(new _r)!=Sr||xr&&Or(new xr)!=Tr)&&(Or=function(t){var e=Pt(t),r="[object Object]"==e?t.constructor:void 0,i=r?Nt(r):"";if(i)switch(i){case Ir:return Er;case Cr:return br;case Ar:return wr;case kr:return Sr;case Pr:return Tr}return e});var Mr=Or,Lr=Object.prototype.hasOwnProperty,Dr=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Lr.call(t,"index")&&(r.index=t.index,r.input=t.input),r},Rr=xt.Uint8Array,zr=function(t){var e=new t.constructor(t.byteLength);return new Rr(e).set(new Rr(t)),e},Nr=function(t,e){var r=e?zr(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},Br=/\w*$/,Fr=function(t){var e=new t.constructor(t.source,Br.exec(t));return e.lastIndex=t.lastIndex,e},jr=bt?bt.prototype:void 0,Ur=jr?jr.valueOf:void 0,Vr=function(t){return Ur?Object(Ur.call(t)):{}},qr=function(t,e){var r=e?zr(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)},Gr=function(t,e,r){var i=t.constructor;switch(e){case"[object ArrayBuffer]":return zr(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return Nr(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return qr(t,r);case"[object Map]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return Fr(t);case"[object Set]":return new i;case"[object Symbol]":return Vr(t)}},Zr=Object.create;function Hr(){}var Wr=function(t){if(!Ot(t))return{};if(Zr)return Zr(t);Hr.prototype=t;var e=new Hr;return Hr.prototype=void 0,e},Kr=function(t){return"function"!=typeof t.constructor||qe(t)?{}:Wr(pr(t))};function Xr(t){return we(t)&&"[object Map]"==Mr(t)}var Yr=Ne&&Ne.isMap,Jr=Yr?ze(Yr):Xr;function $r(t){return we(t)&&"[object Set]"==Mr(t)}var Qr=Ne&&Ne.isSet,ti=Qr?ze(Qr):$r,ei=1,ri=2,ii=4,ni="[object Arguments]",oi="[object Function]",ai="[object GeneratorFunction]",si="[object Object]",li={};li[ni]=li["[object Array]"]=li["[object ArrayBuffer]"]=li["[object DataView]"]=li["[object Boolean]"]=li["[object Date]"]=li["[object Float32Array]"]=li["[object Float64Array]"]=li["[object Int8Array]"]=li["[object Int16Array]"]=li["[object Int32Array]"]=li["[object Map]"]=li["[object Number]"]=li[si]=li["[object RegExp]"]=li["[object Set]"]=li["[object String]"]=li["[object Symbol]"]=li["[object Uint8Array]"]=li["[object Uint8ClampedArray]"]=li["[object Uint16Array]"]=li["[object Uint32Array]"]=!0,li["[object Error]"]=li[oi]=li["[object WeakMap]"]=!1;var ci,ui=function t(e,r,i,n,o,a){var s,l=r&ei,c=r&ri,u=r&ii;if(i&&(s=o?i(e,n,o,a):i(e)),void 0!==s)return s;if(!Ot(e))return e;var p=Ae(e);if(p){if(s=Dr(e),!l)return ir(e,s)}else{var h=Mr(e),d=h==oi||h==ai;if(Pe(e))return rr(e,l);if(h==si||h==ni||d&&!o){if(s=c||d?{}:Kr(e),!l)return c?dr(e,er(s,e)):cr(e,Ye(s,e))}else{if(!li[h])return o?e:{};s=Gr(e,h,l)}}var f=(a=a||new fe).get(e);if(f)return f;a.set(e,s),ti(e)?e.forEach((function(n){s.add(t(n,r,i,n,e,a))})):Jr(e)&&e.forEach((function(n,o){s.set(o,t(n,r,i,o,e,a))}));var m=u?c?gr:mr:c?keysIn:Xe,g=p?void 0:m(e);return me(g||e,(function(n,o){g&&(n=e[o=n]),_e(s,o,t(n,r,i,o,e,a))})),s},pi=function(t){return ui(t,5)},hi=Map,di=(w(fi,ci=I),fi);function fi(){var t=null!==ci&&ci.apply(this,arguments)||this;return t.layout="icons",t.mapStyles=["road","grayscale_light","grayscale_dark","night","road_shaded_relief"],t.style=e.ControlStyle.light,t}var mi,gi=(w(yi,mi=q),yi.prototype.onAdd=function(t,e){var r=this;this.map=t;var i=this.buildContainer(t,this.options.style,"Map Style Control"),n=this.buildStyleOpsGrid(i),o=this.buildCurrStyleBtn(i,n);return i.addEventListener("mouseover",(function(){r.hasMouse=!0,i.classList.add(yi.Css.inUse),n.classList.remove("hidden-accessible-element")})),i.addEventListener("focusin",(function(){r.hasFocus=!0,i.classList.add(yi.Css.inUse),n.classList.remove("hidden-accessible-element")})),i.addEventListener("mouseleave",(function(){r.hasMouse=!1,r.hasFocus||(i.classList.remove(yi.Css.inUse),n.classList.add("hidden-accessible-element"))})),i.addEventListener("focusout",(function(t){t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(r.hasFocus=!1,r.hasMouse||(i.classList.remove(yi.Css.inUse),n.classList.add("hidden-accessible-element")))})),e&&yi.InvertOrderPositions.includes(e.position)?(i.appendChild(n),i.appendChild(o)):(i.appendChild(o),i.appendChild(n)),i},yi.prototype.onRemove=function(){mi.prototype.onRemove.call(this),this.map.events.remove("styledata",this.onStyleChange)},yi.prototype.buildSelectStyleBtn=function(t,e){var r=this,i=document.createElement("button"),n=this.mapToFriendlyStyleName(t);i.setAttribute("title",n),i.setAttribute("alt",n),i.setAttribute("type","button");var o=new Image;return o.src=e,o.alt=n,i.appendChild(o),"icons"===this.options.layout?i.classList.add(yi.Css.button):i.appendChild(document.createTextNode(n)),i.addEventListener("click",(function(){r.map.setStyle({style:t})})),i},yi.prototype.buildCurrStyleBtn=function(t,e){var r=document.createElement("button");r.classList.add(yi.Css.button),r.classList.add(yi.Css.currentStyle),r.setAttribute("title","Select Style"),r.setAttribute("alt","Select Style"),r.setAttribute("type","button"),this.currStyleImage=new Image,r.appendChild(this.currStyleImage);var i=document.createElement("div");return i.classList.add("icon"),r.appendChild(i),r},yi.prototype.buildStyleOpsGrid=function(t){var e=this,r=document.createElement("div");return r.classList.add(yi.Css.styleOptions),r.classList.add(this.options.layout),r.setAttribute("aria-label","Style Options"),r.classList.add("hidden-accessible-element"),this.map.styles.initialize().then((function(){for(var t=e.map.styles.getDef(),i=e.map.getStyle().style,n=0,o=t.styles;n<o.length;n++){var a=o[n],s=new O({domain:t.domain,path:a.iconPath}).toString();e.styleIcons.set(a.name,s),a.name===i&&(e.currStyleImage.src=s,e.currStyleImage.alt=e.mapToFriendlyStyleName(a.name))}"all"===e.options.mapStyles?e.styleIcons.forEach((function(t,i){var n=e.buildSelectStyleBtn(i,t);r.appendChild(n)})):e.options.mapStyles.filter((function(t){return e.styleIcons.has(t)})).forEach((function(t){var i=e.styleIcons.get(t),n=e.buildSelectStyleBtn(t,i);r.appendChild(n)})),e.map.events.add("styledata",e.onStyleChange)})),r},yi.prototype.mapToFriendlyStyleName=function(t){return yi.StyleNamesMap[t]?yi.StyleNamesMap[t]:t},yi.InvertOrderPositions=[e.ControlPosition.TopRight,e.ControlPosition.BottomRight],yi.Css={button:"azure-maps-control-button",currentStyle:"curr-style",inUse:"in-use",styleOptions:"style-options"},yi.StyleNamesMap={road:"Road",satellite:"Satellite",satellite_road_labels:"Hybrid",grayscale_dark:"Grayscale (Dark)",grayscale_light:"Grayscale (Light)",night:"Night",road_shaded_relief:"Terra",blank:"Blank",blank_accessible:"Blank (Accessible)",high_contrast_dark:"High contrast"},yi);function yi(t){var e=mi.call(this)||this;return e.hasMouse=!1,e.hasFocus=!1,e.styleIcons=new hi,e.onStyleChange=function(){var t=e.map.getStyle().style;e.styleIcons.has(t)&&(e.currStyleImage.src=e.styleIcons.get(t),e.currStyleImage.alt=e.mapToFriendlyStyleName(t))},e.options=(new di).merge(pi(t)),e}var vi,_i=(w(xi,vi=I),xi);function xi(){var t=null!==vi&&vi.apply(this,arguments)||this;return t.flow="relative",t.incidents=!0,t.isActive=!1,t.style=e.ControlStyle.light,t}var bi,wi=(w(Si,bi=q),Si.prototype.onAdd=function(t){this.container=this.buildContainer(t,this.options.style,"Traffic Control"),this.container.style.flexDirection="column";var e=this.constructTrafficButton(t);return this.container.appendChild(e),this.container},Si.prototype.getOptions=function(){return pi(this.options)},Si.prototype.constructTrafficButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("traffic"),r.setAttribute("title","toggle traffic display"),r.setAttribute("alt","toggle traffic display"),r.setAttribute("type","button"),r.addEventListener("click",(function(){var r=t.getTraffic();e.options.isActive=!("none"!==r.flow||r.incidents),e.options.isActive?(t.setTraffic({flow:e.options.flow,incidents:e.options.incidents}),e.container.classList.add("in-use")):(t.setTraffic({flow:"none",incidents:!1}),e.container.classList.remove("in-use"))})),t.events.add("ready",(function(){e.options.isActive&&r.dispatchEvent(new Event("click"))})),r},Si);function Si(t){var e=bi.call(this)||this;return e.hasMouse=!1,e.hasFocus=!1,e.options=(new _i).merge(t),e}var Ti,Ei=(w(Ii,Ti=q),Ii.prototype.onAdd=function(t){var r=this.buildContainer(t,e.ControlStyle.auto,"Traffic Legend"),i=this.buildTrafficLegendDiv(t);return r.appendChild(i),r},Ii.prototype.buildTrafficLegendDiv=function(t){var e=document.createElement("div");e.classList.add("traffic-legend","hidden"),e.setAttribute("title","Traffic Legend"),e.setAttribute("alt","Traffic Legend");var r=document.createElement("table"),i=document.createElement("tr"),n=document.createElement("td");n.setAttribute("title","Traffic"),n.setAttribute("alt","Traffic"),n.appendChild(document.createTextNode("Traffic")),n.classList.add("traffic-legend-title"),n.colSpan=6,i.appendChild(n),r.appendChild(i);for(var o=document.createElement("tr"),a=0,s=this.table;a<s.length;a++){var l=s[a],c=document.createElement("td");if("Fast"===l||"Slow"===l)c.setAttribute("title",l),c.setAttribute("alt",l),c.appendChild(document.createTextNode(l)),c.classList.add("traffic-legend-text");else{c.classList.add("traffic-legend-colors");for(var u=0,p=l;u<p.length;u++){var h=p[u],d=document.createElement("div");d.classList.add(h),c.appendChild(d)}}o.appendChild(c)}return r.appendChild(o),e.appendChild(r),t.events.add("sourceadded",(function(t){"vectorTilesTraffic"===t.getId()&&e.classList.remove("hidden")})),t.events.add("sourceremoved",(function(t){"vectorTilesTraffic"===t.getId()&&e.classList.add("hidden")})),e},Ii);function Ii(){var t=Ti.call(this)||this;return t.table=["Fast",["green","yellow","red","dark-red"],"Slow"],t}var Ci,Ai=(w(ki,Ci=I),ki);function ki(){var t=null!==Ci&&Ci.apply(this,arguments)||this;return t.zoomDelta=1,t.style=e.ControlStyle.light,t}var Pi,Oi=(w(Mi,Pi=q),Mi.prototype.onAdd=function(t){var e=this.buildContainer(t,this.options.style,"Zoom Control");e.style.flexDirection="column";var r=this.constructZoomInButton(t),i=this.constructZoomOutButton(t);return e.appendChild(r),e.appendChild(i),e},Mi.prototype.constructZoomInButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("zoom-in"),r.setAttribute("title","Zoom In"),r.setAttribute("alt","Zoom In"),r.setAttribute("type","button"),r.addEventListener("click",(function(){t.setCamera({zoom:t.getCamera().zoom+e.options.zoomDelta,duration:Mi.ZOOM_DURATION_MS,type:"ease"},!0)})),r},Mi.prototype.constructZoomOutButton=function(t){var e=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("zoom-out"),r.setAttribute("title","Zoom Out"),r.setAttribute("alt","Zoom Out"),r.setAttribute("type","button"),r.addEventListener("click",(function(){t.setCamera({zoom:t.getCamera().zoom-e.options.zoomDelta,duration:Mi.ZOOM_DURATION_MS,type:"ease"},!0)})),r},Mi.ZOOM_DURATION_MS=200,Mi);function Mi(t){var e=Pi.call(this)||this;return e.options=(new Ai).merge(t),e}var Li=Object.freeze({__proto__:null,PitchControl:et,CompassControl:X,ZoomControl:Oi,StyleControl:gi,TrafficControl:wi,TrafficLegendControl:Ei});function Di(t){return this.__data__.has(t)}function Ri(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new pe;++e<r;)this.add(t[e])}Ri.prototype.add=Ri.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Ri.prototype.has=Di;var zi=Ri,Ni=function(t,e){for(var r=-1,i=null==t?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1},Bi=function(t,e){return t.has(e)},Fi=function(t,e,r,i,n,o){var a=1&r,s=t.length,l=e.length;if(s!=l&&!(a&&s<l))return!1;var c=o.get(t);if(c&&o.get(e))return c==e;var u=-1,p=!0,h=2&r?new zi:void 0;for(o.set(t,e),o.set(e,t);++u<s;){var d=t[u],f=e[u];if(i)var m=a?i(f,d,u,e,t,o):i(d,f,u,t,e,o);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!Ni(e,(function(t,e){if(!Bi(h,e)&&(d===t||n(d,t,r,i,o)))return h.push(e)}))){p=!1;break}}else if(d!==f&&!n(d,f,r,i,o)){p=!1;break}}return o.delete(t),o.delete(e),p};function ji(t){var e=-1,r=Array(t.size);return t.forEach((function(t,i){r[++e]=[i,t]})),r}function Ui(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var Vi,qi=bt?bt.prototype:void 0,Gi=qi?qi.valueOf:void 0,Zi=function(t,e,r,i,n,o,a){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new Rr(t),new Rr(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return nt(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=ji;case"[object Set]":var l=1&i;if(s=s||Ui,t.size!=e.size&&!l)return!1;var c=a.get(t);if(c)return c==e;i|=2,a.set(t,e);var u=Fi(s(t),s(e),i,n,o,a);return a.delete(t),u;case"[object Symbol]":if(Gi)return Gi.call(t)==Gi.call(e)}return!1},Hi=Object.prototype.hasOwnProperty,Wi=function(t,e,r,i,n,o){var a=1&r,s=mr(t),l=s.length;if(l!=mr(e).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in e:Hi.call(e,u)))return!1}var p=o.get(t);if(p&&o.get(e))return p==e;var h=!0;o.set(t,e),o.set(e,t);for(var d=a;++c<l;){var f=t[u=s[c]],m=e[u];if(i)var g=a?i(m,f,u,e,t,o):i(f,m,u,t,e,o);if(!(void 0===g?f===m||n(f,m,r,i,o):g)){h=!1;break}d=d||"constructor"==u}if(h&&!d){var y=t.constructor,v=e.constructor;y!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v)&&(h=!1)}return o.delete(t),o.delete(e),h},Ki="[object Arguments]",Xi="[object Array]",Yi="[object Object]",Ji=Object.prototype.hasOwnProperty,$i=function(t,e,r,i,n,o){var a=Ae(t),s=Ae(e),l=a?Xi:Mr(t),c=s?Xi:Mr(e),u=(l=l==Ki?Yi:l)==Yi,p=(c=c==Ki?Yi:c)==Yi,h=l==c;if(h&&Pe(t)){if(!Pe(e))return!1;u=!(a=!0)}if(h&&!u)return o=o||new fe,a||Fe(t)?Fi(t,e,r,i,n,o):Zi(t,e,l,r,i,n,o);if(!(1&r)){var d=u&&Ji.call(t,"__wrapped__"),f=p&&Ji.call(e,"__wrapped__");if(d||f)return n(d?t.value():t,f?e.value():e,r,i,o=o||new fe)}return h&&(o=o||new fe,Wi(t,e,r,i,n,o))},Qi=function t(e,r,i,n,o){return e===r||(null==e||null==r||!we(e)&&!we(r)?e!=e&&r!=r:$i(e,r,i,n,t,o))},tn=function(t,e){return Qi(t,e)},en=(Vi=Object.freeze({__proto__:null,default:{}}))&&Vi.default||Vi,rn=i((function(t){!function(){var e,r,i,n=0,o=[];for(s.BUFFER_SIZE=512,s.bin=a,s.test=function(t){if("string"==typeof t)return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/.test(t)},r=0;r<256;r++)o[r]=(r+256).toString(16).substr(1);function a(){var t=function(t){var o,a,l;if(void 0!==i){if(void 0===e||s.BUFFER_SIZE<n+t)if(n=0,i.getRandomValues)e=new Uint8Array(s.BUFFER_SIZE),i.getRandomValues(e);else{if(!i.randomBytes)throw new Error("Non-standard crypto library");e=i.randomBytes(s.BUFFER_SIZE)}return e.slice(n,n+=t)}for(o=[],r=0;r<t;r++)o.push((a=0,l=255,Math.floor(Math.random()*(l-a))+a));return o}(16);return t[6]=15&t[6]|64,t[8]=63&t[8]|128,t}function s(){var t=a();return o[t[0]]+o[t[1]]+o[t[2]]+o[t[3]]+"-"+o[t[4]]+o[t[5]]+"-"+o[t[6]]+o[t[7]]+"-"+o[t[8]]+o[t[9]]+"-"+o[t[10]]+o[t[11]]+o[t[12]]+o[t[13]]+o[t[14]]+o[t[15]]}"undefined"!=typeof crypto?i=crypto:"undefined"!=typeof window&&void 0!==window.msCrypto&&(i=window.msCrypto),i=i||en,t.exports=s}()})),nn=(on.TYPE="Feature",on);function on(t,e,r,i){this.type="Feature",this.type=on.TYPE,this.properties=e||{},this.id=r,this.geometry=t,this.bbox=i}var an,sn=(w(ln,an=Array),ln.fromData=function(t){var e=NaN,r=NaN,i=new Set(["y"]),n=new Set(["x"]);return Object.keys(t).forEach((function(o){var a=o.toLowerCase();isNaN(e)&&i.has(a)&&"number"==typeof t[o]?e=t[o]:isNaN(r)&&n.has(a)&&"number"==typeof t[o]&&(r=t[o])})),isNaN(e)||isNaN(r)?null:new ln(e,r)},ln.getX=function(t){return 0<t.length?t[0]:NaN},ln.getY=function(t){return 1<t.length?t[1]:NaN},ln.getDestination=function(t,e,r){return new ln(ln.getX(t)+r*Math.cos((e+270)*Math.PI/180),ln.getY(t)+r*Math.sin((e+270)*Math.PI/180))},ln.getDistance=function(t,e){var r=ln.getX(t)-ln.getX(e),i=ln.getY(t)-ln.getY(e);return Math.sqrt(r*r+i*i)},ln.getHeading=function(t,e){var r=ln.getX(e)-ln.getX(t),i=ln.getY(t)-ln.getY(e);return 180*(2.5*Math.PI-Math.atan2(i,r))/Math.PI%360},ln);function ln(t,e){return an.call(this,t,e)||this}var cn=(un.TYPE="Point",un);function un(t){this.type="Point",this.type=un.TYPE,this.coordinates=t}var pn,hn,dn,fn,mn,gn,yn,vn,_n,xn,bn=6378137,wn=Math.PI/180,Sn=180/Math.PI,Tn=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function En(t){return t*wn}function In(t){return t*Sn}function Cn(t,e,r){return Math.min(Math.max(t,e),r)}function An(t,e){var r=En(e[1]-t[1]),i=En(e[0]-t[0]),n=Math.pow(Math.sin(r/2),2)+Math.cos(En(t[1]))*Math.cos(En(e[1]))*Math.pow(Math.sin(i/2),2),o=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n));return Math.round(bn*o*100)/100}function kn(t){if(t)switch(t.toLowerCase()){case"feet":case"foot":case"ft":return dn.feet;case"kilometers":case"kilometer":case"kilometres":case"kilometre":case"km":case"kms":return dn.kilometers;case"miles":case"mile":case"mi":return dn.miles;case"nauticalmiles":case"nauticalmile":case"nms":case"nm":return dn.nauticalMiles;case"yards":case"yard":case"yds":case"yrd":case"yrds":return dn.yards;case"meters":case"metres":case"m":default:return dn.meters}return dn.meters}function Pn(t){if(t)switch(t.toLowerCase()){case"milespersecondsquared":case"milepersecondsquared":case"mi/s^2":case"mi/s2":return _n.milesPerSecondSquared;case"kilometerspersecondsquared":case"kilometrespersecondsquared":case"kilometerpersecondsquared":case"kilometrepersecondsquared":case"km/s^2":case"km/s2":return _n.kilometersPerSecondSquared;case"knotspersecond":case"knotpersecond":case"knts/s":case"kn/s":case"kt/s":return _n.knotsPerSecond;case"standardgravity":case"g":return _n.standardGravity;case"feetpersecondsquared":case"footpersecondsquared":case"ft/s^2":case"ft/s2":return _n.feetPerSecondSquared;case"yardspersecondsquared":case"yardpersecondsquared":case"yds/s^2":case"yds/s2":case"yd/s^2":case"yd/s2":return _n.yardsPerSecondSquared;case"milesperhoursecond":case"mileperhoursecond":case"milesperhourseconds":case"mileperhourseconds":case"mi/h/s":return _n.milesPerHourSecond;case"kilometersperhoursecond":case"kilometrespersoursecond":case"kilometerperhoursecond":case"kilometrepersoursecond":case"kilometersperhourssecond":case"kilometrespersourssecond":case"kilometerperhourssecond":case"kilometrepersourssecond":case"kmhs":case"km/h/s":return _n.kilometersPerHourSecond;case"meterspersecondsquared":case"metrespersecondsquared":case"meterpersecondsquared":case"metrepersecondsquared":case"m/s^2":case"m/s2":default:return _n.metersPerSecondSquared}return _n.metersPerSecondSquared}function On(t){if(t)switch(t){case"acres":case"ac":return pn.acres;case"hectares":case"ha":return pn.hectares;case"squareFeet":case"ft^2":case"ft2":return pn.squareFeet;case"squareYards":case"squareYard":case"yds^2":case"yds2":case"yd^2":case"yd2":return pn.squareYards;case"squareKilometers":case"squareKilometres":case"squareKilometer":case"squareKilometre":case"km^2":case"km2":return pn.squareKilometers;case"squareMiles":case"squareMile":case"mi^2":case"mi2":return pn.squareMiles;case"squareMeters":case"squareMetres":case"squareMeter":case"squareMetre":case"m^2":case"m2":default:return pn.squareMeters}return pn.squareMeters}function Mn(t){if(t)switch(t.toLowerCase()){case"feetpersecond":case"footsecond":case"ftps":case"ft/s":return yn.feetPerSecond;case"milesperhour":case"mileperhour":case"mph":case"mi/hr":case"mi/h":return yn.milesPerHour;case"knots":case"knot":case"knts":case"knt":case"kn":case"kt":return yn.knots;case"mach":case"m":return yn.mach;case"kilometersperhour":case"kilometresperhour":case"kmperhour":case"kmph":case"km/hr":case"km/h":return yn.kilometersPerHour;case"meterspersecond":case"metrespersecond":case"mps":case"ms":case"m/s":default:return yn.metersPerSecond}return yn.metersPerSecond}function Ln(t){if(t)switch(t.toLowerCase()){case"milliseconds":case"ms":return mn.ms;case"minutes":case"minute":case"mins":case"min":return mn.minutes;case"hours":case"hour":case"hr":case"h":return mn.hours;case"days":case"day":case"d":return mn.days;case"seconds":case"second":case"secs":case"sec":case"s":default:return mn.seconds}return mn.seconds}function Dn(t){var e=0;if(t&&0<t.length){e=Math.abs(Rn(t[0]));for(var r=1,i=t.length;r<i;r++)e-=Math.abs(Rn(t[r]))}return e}function Rn(t){var e=0;if(3<=t.length){for(var r=void 0,i=void 0,n=0,o=t.length;n<o;n++)e+=(En(t[n===o-2?(r=o-2,i=o-1,0):n===o-1?(r=o-1,i=0,1):(i=(r=n)+1,n+2)][0])-En(t[r][0]))*Math.sin(En(t[i][1]));e=e*bn*bn/2}return e}function zn(t,e,r){return(t[0]-r[0])*(e[1]-r[1])-(t[1]-r[1])*(e[0]-r[0])}function Nn(t,e,r){if(2<=r.length){for(var i=1/0,n=void 0,o=null,a=$n(r,22),s=void 0,l=0,c=a.length-1;l<c;l++)s=Bn(e,a[l],a[l+1]),(n=sn.getDistance(e,s))<i&&(i=n,o=s);if(o){var u=Jn([o],22)[0];return new nn(new cn(u),{distance:Vn(t,u)})}}else if(1===r.length)return new nn(new cn(r[0]),{distance:Vn(t,r[0])});return null}function Bn(t,e,r){if(e[0]===r[0]&&e[1]===r[1])return e;var i=t[0]-e[0],n=t[1]-e[1],o=r[0]-e[0],a=r[1]-e[1],s=(o*i+a*n)/(o*o+a*a);return s<0?e:1<s?r:[e[0]+o*s,e[1]+a*s]}function Fn(t,e){if(!isNaN(t)&&"number"==typeof e&&0<=e){var r=void 0;r=e<Tn.length?Tn[e]:Math.pow(10,e),t=Math.round(t*r)/r}return t}function jn(t,e,r,i){switch(kn(e)){case dn.meters:t/=1e3;break;case dn.feet:t/=3280.8399;break;case dn.miles:t/=.62137119;break;case dn.yards:t/=1093.6133;break;case dn.nauticalMiles:t/=.5399568;break;case dn.kilometers:}switch(kn(r)){case dn.meters:t*=1e3;break;case dn.feet:t*=3280.8399;break;case dn.miles:t*=.62137119;break;case dn.yards:t*=1093.6133;break;case dn.nauticalMiles:t*=.5399568;break;case dn.kilometers:}if("number"==typeof i&&0<=i){var n=Math.pow(10,i);t=Math.round(t*n)/n}return t}function Un(t,e,r,i){i=i||"meters",t=lo(t);var n=qn(i),o=En(t[1]),a=En(t[0]),s=En(e),l=r/n,c=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(s)),u=a+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(c)),p=Cn(Kn(In(c)),-85,85);return[Xn(In(u)),p]}function Vn(t,e,r){var i=An(t=lo(t),e=lo(e));return"meters"===r?i:jn(i,"meters",r||"meters")}function qn(t){var e=kn(t);return jn(bn,dn.meters,e)}function Gn(t,e){if(t=lo(t),e=lo(e),t&&2<=t.length&&e&&2<=e.length){var r=En(t[1]),i=En(e[1]),n=En(e[0]-t[0]),o=Math.sin(n)*Math.cos(i),a=Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(n);return(In(Math.atan2(o,a))+360)%360}return NaN}function Zn(t,e){var r,i=0;Array.isArray(t)?r=t:t.type&&"LineString"===t.type&&(r=t.coordinates);for(var n=0,o=r.length-1;n<o;n++)i+=An(r[n],r[n+1]);return jn(i,"meters",e||"meters")}function Hn(t,e,r){r=r||"meters";var i,n,o=0;if(Array.isArray(t)?n=t:t.type&&"LineString"===t.type&&(n=t.coordinates),2<=n.length){for(var a=n.length,s=1;s<a;s++){if(e<=o+(i=Vn(n[s-1],n[s],r))){var l=Gn(n[s-1],n[s]);return Un(n[s-1],l,e-o,r)}o+=i}return o<=e?n[a-1]:n[0]}return null}function Wn(t,e,r,i,n){i=i||"meters",n=n||0,t=lo(t);for(var o=[],a=360/r,s=0;s<=r;s++)o.push(Un(t,(s*a+n)%360,e,i));return o}function Kn(t){return 90<t?180<(t=(t+90)%360)?90-(t-180):t-90:t<-90?(t=(t-90)%360)<-180?-90-(t+180):t+90:t}function Xn(t){return 180<t?(t+180)%360-180:t<-180?(t-180)%360+180:t}function Yn(t,e,r){if(0===r)return Object.assign({},t);e=lo(e);for(var i,n,o=[],a=0,s=t.length;a<s;a++)i=Vn(e,t[a]),n=Gn(e,t[a]),o.push(Un(e,n+r,i));return o}function Jn(t,e){for(var r,i,n=512*Math.pow(2,e),o=[],a=0,s=t.length;a<s;a++)r=t[a][0]/n-.5,i=.5-t[a][1]/n,o.push([360*r,90-360*Math.atan(Math.exp(2*-i*Math.PI))/Math.PI]);return o}function $n(t,e){for(var r,i,n,o=512*Math.pow(2,e),a=[],s=0,l=t.length;s<l;s++)n=Math.sin(t[s][1]*Math.PI/180),r=(t[s][0]+180)/360,i=.5-Math.log((1+n)/(1-n))/(4*Math.PI),a.push([Math.round(r*o),Math.round(i*o)]);return a}function Qn(t,e,r,i){switch(Pn(e)){case _n.kilometersPerHourSecond:t/=3.6;break;case _n.milesPerHourSecond:t/=2.236936292054;break;case _n.knotsPerSecond:t/=1.943844492441;break;case _n.standardGravity:t/=.1019716212978;break;case _n.kilometersPerSecondSquared:t/=.001;break;case _n.milesPerSecondSquared:t/=.000621371192;break;case _n.feetPerSecondSquared:t/=3.280839895012;break;case _n.yardsPerSecondSquared:t/=1.093613298338;break;case _n.metersPerSecondSquared:}switch(Pn(r)){case _n.kilometersPerHourSecond:t*=3.6;break;case _n.milesPerHourSecond:t*=2.236936292054;break;case _n.knotsPerSecond:t*=1.943844492441;break;case _n.standardGravity:t*=.1019716212978;break;case _n.kilometersPerSecondSquared:t*=.001;break;case _n.milesPerSecondSquared:t*=.000621371192;break;case _n.feetPerSecondSquared:t*=3.280839895012;break;case _n.yardsPerSecondSquared:t*=1.093613298338;break;case _n.metersPerSecondSquared:}return Fn(t,i)}function to(t,e,r,i){switch(On(e)){case pn.acres:t*=4046.8564224;break;case pn.hectares:t*=1e4;break;case pn.squareFeet:t*=.09290304;break;case pn.squareKilometers:t*=1e6;break;case pn.squareMiles:t*=259e4;break;case pn.squareYards:t*=.83612736;break;case pn.squareMeters:}switch(On(r)){case pn.acres:t/=4046.8564224;break;case pn.hectares:t/=1e4;break;case pn.squareFeet:t/=.09290304;break;case pn.squareKilometers:t/=1e6;break;case pn.squareMiles:t/=259e4;break;case pn.squareYards:t/=.83612736;break;case pn.squareMeters:}return Fn(t,i)}function eo(t,e,r,i){switch(Mn(e)){case yn.feetPerSecond:t*=1.09728;break;case yn.milesPerHour:t*=1.6093;break;case yn.knots:t*=1.852;break;case yn.metersPerSecond:t*=3.6;break;case yn.mach:t*=1234.8;break;case yn.kilometersPerHour:}switch(Mn(r)){case yn.feetPerSecond:t/=1.09728;break;case yn.milesPerHour:t/=1.6093;break;case yn.knots:t/=1.852;break;case yn.metersPerSecond:t/=3.6;break;case yn.mach:t/=1234.8;break;case yn.kilometersPerHour:}return Fn(t,i)}function ro(t,e,r,i){switch(Ln(e)){case mn.ms:t/=1e3;break;case mn.hours:t*=3600;break;case mn.minutes:t*=60;break;case mn.days:t*=86400;break;case mn.seconds:}switch(Ln(r)){case mn.ms:t*=1e3;break;case mn.hours:t/=3600;break;case mn.minutes:t/=60;break;case mn.days:t/=86400;break;case mn.seconds:}return Fn(t,i)}function io(t,e,r,i,n,o,a,s){var l=jn(e,n,dn.meters),c=ro(r,o,mn.seconds);return Qn(2*(l-eo(t,i,yn.metersPerSecond)*c)/(c*c),_n.metersPerSecondSquared,a,s)}function no(t,e,r,i,n,o,a){var s=eo(t,i,yn.metersPerSecond);return Qn((eo(e,i,yn.metersPerSecond)-s)/ro(r,n,mn.seconds),_n.metersPerSecondSquared,o,a)}function oo(t,e,r,i){var n=ao(t),o=ao(e);return null!=n&&null!=o?ro(o.getTime()-n.getTime(),mn.ms,r,i):NaN}function ao(t){if("[object Date]"===Object.prototype.toString.call(t))return t;if("string"==typeof t){var e=Date.parse(t);if(!isNaN(e))return new Date(e);if(0<=t.indexOf("Date(")){var r=0;return r=0<(t=t.replace("/Date(","").replace(")/","")).indexOf("+")?parseInt(t.substr(0,t.indexOf("+")),10):0<t.indexOf("-")?parseInt(t.substr(0,t.indexOf("-")),10):parseInt(t,10),new Date(r)}}else if("number"==typeof t)return new Date(t);return null}function so(t){var e=[],r=null,i=null;if(Array.isArray(t)&&0<t.length)if(Array.isArray(t[0])&&"number"==typeof t[0][0])e=t;else for(var n=t.length,o=0;o<n;o++)e=e.concat(so(t[o]));else if(t.type)switch(t.type){case"Point":e=[t.coordinates];break;case"LineString":e=t.coordinates;break;case"Polygon":r=t.coordinates;break;case"MultiPoint":e=t.coordinates;break;case"MultiLineString":r=t.coordinates;break;case"MultiPolygon":i=t.coordinates;break;case"Feature":var a=t;e=To._isCircle(a)?To._getCirclePositions(a):so(a.geometry);break;case"FeatureCollection":e=so(t.features);break;case"GeometryCollection":e=so(t.geometries)}else if(t instanceof To)return so(t.toJson());if(r)for(n=r.length,o=0;o<n;o++)e=e.concat(r[o]);else if(i){var s=i.length;for(o=0;o<s;o++)for(var l=i[o].length,c=0;c<l;c++)e=e.concat(i[o][c])}return e}function lo(t){if(Array.isArray(t)&&"number"==typeof t[0])return t;if(t.type){if("Point"===t.type)return t.coordinates;if("Feature"===t.type&&"Point"===t.geometry.type)return t.geometry.coordinates}else if(t instanceof To&&"Point"===t.getType())return t.getCoordinates();return null}function co(t,e,r){r=r||"meters";var i,n,o=0;if(Array.isArray(t)?n=t:t.type&&"LineString"===t.type&&(n=t.coordinates),2<=n.length){for(var a=n.length,s=1;s<a;s++){if(e<=o+(i=Vn(n[s-1],n[s],r))){var l=Gn(n[s-1],n[s]),c=Un(n[s-1],l,e-o,r);return new nn(new cn(c),{heading:l})}o+=i}return o<=e?new nn(new cn(n[a-1]),{heading:Gn(n[a-2],n[a-1])}):new nn(new cn(n[0]),{heading:Gn(n[0],n[1])})}return null}function uo(t,e,r,i){var n,o=lo(t),a=$n([o],22)[0],s=null,l=1/0;switch((e=e instanceof To?e.toJson():e).type){case"Feature":return uo(t,e.geometry,r);case"Point":n=[[e.coordinates]];break;case"MultiPoint":for(var c=void 0,u=e.coordinates,p=0,h=u.length;p<h;p++)(c=Vn(o,u[p]))<l&&(l=c,s=new nn(new cn(u[p]),{distance:c}));break;case"LineString":n=[e.coordinates];break;case"Polygon":case"MultiLineString":n=e.coordinates;break;case"MultiPolygon":var d=e.coordinates;if(0<d.length)for(n=d[0],p=1,h=d.length;p<h;p++)n=n.concat(d[p])}if(n){var f=void 0;for(p=0,h=n.length;p<h;p++)(f=Nn(o,a,n[p]))&&f.properties.distance<l&&(l=f.properties.distance,s=f)}return s&&(s.properties.distance=jn(s.properties.distance,"meters",r,i)),s}(hn=pn=pn||{}).squareMeters="squareMeters",hn.acres="acres",hn.hectares="hectares",hn.squareFeet="squareFeet",hn.squareKilometers="squareKilometers",hn.squareMiles="squareMiles",hn.squareYards="squareYards",(fn=dn=dn||{}).meters="meters",fn.kilometers="kilometers",fn.feet="feet",fn.miles="miles",fn.nauticalMiles="nauticalMiles",fn.yards="yards",(gn=mn=mn||{}).seconds="seconds",gn.hours="hours",gn.ms="ms",gn.minutes="minutes",gn.days="days",(vn=yn=yn||{}).metersPerSecond="metersPerSecond",vn.kilometersPerHour="kilometersPerHour",vn.feetPerSecond="feetPerSecond",vn.milesPerHour="milesPerHour",vn.knots="knots",vn.mach="mach",(xn=_n=_n||{}).milesPerSecondSquared="milesPerSecondSquared",xn.kilometersPerSecondSquared="kilometersPerSecondSquared",xn.knotsPerSecond="knotsPerSecond",xn.standardGravity="standardGravity",xn.feetPerSecondSquared="feetPerSecondSquared",xn.yardsPerSecondSquared="yardsPerSecondSquared",xn.milesPerHourSecond="milesPerHourSecond",xn.kilometersPerHourSecond="kilometersPerHourSecond",xn.metersPerSecondSquared="metersPerSecondSquared";var po,ho=(w(fo,po=Array),fo.fromPosition=function(t){return 2===t.length?new fo(t[0],t[1]):2<t.length?new fo(t[0],t[1],t[2]):null},fo.areEqual=function(t,e,r){if(void 0===r&&(r=6),t&&2<=t.length&&e&&2<=e.length){var i=Math.pow(10,r),n=Kn(t[1]),o=Kn(e[1]),a=Xn(t[0]),s=Xn(e[0]);if(0!=Math.round((n-o)*i)/i)return!1;var l=Math.round((a-s)*i)/i;return 0==l||360==l}return!1},fo.fromLatLng=function(t,e,r){var i=[];if("number"==typeof t)i.push(t),"number"==typeof e&&i.push(e),"number"==typeof r&&i.push(r);else if(Array.isArray(t))2<=t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(3<=t.length&&"number"==typeof t[2]?i.push(t[0],t[1],t[2]):i.push(t[0],t[1]));else if("object"==typeof t){var n=["lat","latitude","y"],o=["lng","longitude","lon","x"],a=["elv","elevation","alt","altitude","z"],s=NaN,l=NaN,c=NaN;Object.keys(t).forEach((function(e,r,i){var u=e.toLowerCase();isNaN(s)&&0<=n.indexOf(u)&&"number"==typeof t[e]?s=t[e]:isNaN(l)&&0<=o.indexOf(u)&&"number"==typeof t[e]?l=t[e]:isNaN(c)&&0<=a.indexOf(u)&&"number"==typeof t[e]&&(c=t[e])})),isNaN(s)||isNaN(l)||(i.push(l,s),isNaN(c)||i.push(c))}return 2<=i.length?i:null},fo.fromLatLngs=function(t){var e=[];if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var n=fo.fromLatLng(t[r]);n&&e.push(n)}return e},fo._getDimensions=function(t){for(var e=0;Array.isArray(t);)t=t[0],e++;return"number"==typeof t&&e--,e},fo);function fo(t,e,r){return r?po.call(this,t,e,r)||this:po.call(this,t,e)||this}var mo=(go.TYPE="Polygon",go);function go(t,e){this.type="Polygon",this.type=go.TYPE,1===ho._getDimensions(t)?this.coordinates=[t]:this.coordinates=t,this.bbox=e}var yo=(vo.prototype._addEventListener=function(t,e,r){this.listeners.has(t)||this.listeners.set(t,new hi),this.listeners.get(t).set(e,r)},vo.prototype._removeEventListener=function(t,e){this.listeners.has(t)&&this.listeners.get(t).delete(e)},vo.prototype._invokeEvent=function(t,e){var r=this;this.listeners.has(t)&&this.listeners.get(t).forEach((function(i,n){i&&r._removeEventListener(t,n);try{n(e)}catch(i){console.error(i)}}))},vo);function vo(){this.listeners=new hi}var _o=Object.freeze({__proto__:null,EventEmitter:yo}),xo=(bo.prototype.toTarget=function(t,e){return this.transformArray(t,this.M,e)},bo.prototype.toSource=function(t,e){return this.transformArray(t,this.inverseM,e)},bo.prototype.transformArray=function(t,e,r){if(t&&Array.isArray(t)&&Array.isArray(t[0])){for(var i=[],n=0,o=t;n<o.length;n++){var a=o[n];i.push(this.transform(a,e,r))}return i}return null},bo.prototype.transform=function(t,e,r){var i=t[0]*e[0][3]+t[1]*e[1][3]+e[2][3],n=t[0]*e[0][4]+t[1]*e[1][4]+e[2][4];return"number"==typeof r&&0<=r?[Fn(i,r),Fn(n,r)]:[Fn(i,6),Fn(n,6)]},bo._calculateAffineTransform=function(t,e){if(t.length!==e.length||t.length<1)throw new Error("Error: source and target arrays must have the same length.");var r=Math.min(t[0].length,e[0].length),i=r+1;if(t.length<r)throw new Error("Erorr: At least "+r+" reference points required.");for(var n=[],o=[],a=0;a<i;a++){o[a]=[];for(var s=0;s<i;s++){s<r&&(n[s]=0);for(var l=o[a][s]=0;l<t.length;l++)s<r&&(n[s]+=a<r?t[l][a]*e[l][s]:e[l][s]),o[a][s]+=r<=a&&r<=s?1:r<=a?t[l][s]:r<=s?t[l][a]:t[l][a]*t[l][s]}o[a]=o[a].concat(n)}if(!this._gaussJordanElimination(o))throw new Error("Error: Singular matrix. Points are likely coplanar.");return o},bo._gaussJordanElimination=function(t){for(var e,r,i=t.length,n=2*i-1,o=0;o<i;o++){for(var a=o,s=o+1;s<i;s++)Math.abs(t[s][o])>Math.abs(t[a][o])&&(a=s);if(r=t[a],t[a]=t[o],t[o]=r,Math.abs(t[o][o])<=1e-10)return!1;for(var l=o+1;l<i;l++){e=t[l][o]/t[o][o];for(var c=o;c<n;c++)t[l][c]-=t[o][c]*e}}for(o=i-1;-1<o;o--){for(e=t[o][o],s=0;s<o;s++)for(var u=n-1;o-1<u;u--)t[s][u]-=t[o][u]*t[s][o]/e;t[o][o]/=e;for(var p=i;p<n;p++)t[o][p]/=e}return!0},bo);function bo(t,e){this.M=bo._calculateAffineTransform(t,e),this.inverseM=bo._calculateAffineTransform(e,t)}var wo,So=Object.freeze({__proto__:null,AffineTransform:xo,_precision:Fn,get AreaUnits(){return pn},get DistanceUnits(){return dn},get TimeUnits(){return mn},get SpeedUnits(){return yn},get AccelerationUnits(){return _n},boundingBoxToPolygon:function(t){var e=Xn(Co.getWest(t)),r=Xn(Co.getEast(t)),i=Kn(Co.getNorth(t)),n=Kn(Co.getSouth(t)),o=Co.getCenter(t),a=[[e,i],[e,n],[o[0],n],[r,n],[r,i],[o[0],i],[e,i]];return new mo([a])},convertDistance:jn,getCardinalSpline:function(t,e,r,i){var n;if(!t||t.length<=2)return n;"number"!=typeof e&&(e=.5),("number"!=typeof r||r<=0)&&(r=15);var o=t.length;n=t.slice(0),i?(ho.areEqual(n[0],n[o-1])&&(n.pop(),o--),n.unshift(t[o-1]),n.push(t[0]),n.push(t[1]),o++):(n.unshift(t[0]),n.push(t[o-1]));var a,s,l,c=[];c.push([1,0,0,0]);for(var u=1;u<r-1;u++)l=(a=u/r)*(s=a*a),c.push([2*l-3*s+1,-2*l+3*s,l-2*s+a,l-s]);c.push([0,1,0,0]);var p,h,d,f,m,g,y,v=[];for(u=1;u<o;u++)for(h=e*(n[u+1][0]-n[u-1][0]),d=e*(n[u+1][1]-n[u-1][1]),f=e*(n[u+2][0]-n[u][0]),m=e*(n[u+2][1]-n[u][1]),a=0;a<r;a++)y=(p=c[a])[0]*n[u][0]+p[1]*n[u+1][0]+p[2]*h+p[3]*f,g=Cn(g=p[0]*n[u][1]+p[1]*n[u+1][1]+p[2]*d+p[3]*m,-85,85),v.push([y,g]);return v},getDestination:Un,getDistanceTo:Vn,getEarthRadius:qn,getGeodesicPath:function(t,e){var r;(!e||e<=0)&&(e=15),Array.isArray(t)?r=t:t.type&&"LineString"===t.type&&(r=t.coordinates);for(var i=r.length-1,n=[],o=0;o<i;o++)for(var a=En(r[o][1]),s=En(r[o][0]),l=En(r[o+1][1]),c=En(r[o+1][0]),u=2*Math.asin(Math.sqrt(Math.pow(Math.sin((a-l)/2),2)+Math.cos(a)*Math.cos(l)*Math.pow(Math.sin((s-c)/2),2))),p=0;p<=e;p++){var h=p/e,d=Math.sin((1-h)*u)/Math.sin(u),f=Math.sin(h*u)/Math.sin(u),m=d*Math.cos(a)*Math.cos(s)+f*Math.cos(l)*Math.cos(c),g=d*Math.cos(a)*Math.sin(s)+f*Math.cos(l)*Math.sin(c),y=d*Math.sin(a)+f*Math.sin(l),v=Math.atan2(y,Math.sqrt(Math.pow(m,2)+Math.pow(g,2))),_=Math.atan2(g,m);v=Cn(In(v),-85,85),_=In(_),n.push([_,v])}return n},getHeading:Gn,getLengthOfPath:Zn,getPositionAlongPath:Hn,getRegularPolygonPath:Wn,interpolate:function(t,e,r){r=void 0===r?.5:r;var i=Vn(t=lo(t),e=lo(e),"kilometers");return Un(t,Gn(t,e),i*r,"kilometers")},normalizeLatitude:Kn,normalizeLongitude:Xn,rotatePositions:Yn,getPixelHeading:function(t,e){var r=$n([t=lo(t),e=lo(e)],21),i=r[0],n=r[1],o=n[0]-i[0],a=i[1]-n[1];return(2.5*Math.PI-Math.atan2(a,o))*Sn%360},mercatorPixelsToPositions:Jn,mercatorPositionsToPixels:$n,convertAcceleration:Qn,convertArea:to,convertSpeed:eo,convertTimespan:ro,getAcceleration:io,getAccelerationFromSpeeds:no,getAccelerationFromFeatures:function(t,e,r,i,n,o,a){if("string"==typeof r&&"Feature"===t.type&&"Point"===t.geometry.type&&"Feature"===e.type&&"Point"===e.geometry.type){var s=oo(t.properties[r],e.properties[r],mn.seconds);if(!isNaN(s)){var l=0;if(i&&"string"==typeof i){var c=t.properties[i],u=e.properties[i];if("number"==typeof c&&(l=c,"number"==typeof u))return no(c,u,s,n,mn.seconds,o,a)}return io(l,Vn(t.geometry.coordinates,e.geometry.coordinates,dn.meters),s,n,dn.meters,mn.seconds,o,a)}}return NaN},getArea:function t(e,r,i){if(e){var n=0;switch((e=e instanceof To?e.toJson():e).type){case"Feature":if(e.geometry)return t(e.geometry,r,i);break;case"Polygon":e.coordinates&&(n=Dn(e.coordinates));break;case"MultiPolygon":var o=e;if(o.coordinates)for(var a=0,s=o.coordinates.length;a<s;a++)n+=Dn(o.coordinates[a])}return to(n,pn.squareMeters,r,i)}return 0},getSpeed:function(t,e,r,i,n,o){var a=lo(t),s=lo(e);if(a&&s){var l=ro(r,i,mn.seconds);return eo(Vn(a,s,dn.meters)/l,yn.metersPerSecond,n,o)}return 0},getSpeedFromFeatures:function(t,e,r,i,n){if("string"==typeof r&&"Feature"===t.type&&"Point"===t.geometry.type&&"Feature"===e.type&&"Point"===e.geometry.type){var o=this.getTimespan(t.properties[r],e.properties[r],mn.seconds);if(!isNaN(o)){var a=this.getDistanceTo(t.geometry.coordinates,e.geometry.coordinates,dn.meters);return this.convertSpeed(a/o,yn.metersPerSecond,i,n)}}return NaN},getTimespan:oo,getTravelDistance:function(t,e,r,i,n,o,a,s){e=this.convertTimespan(e,n,mn.seconds);var l=(r=this.convertSpeed(r,o,yn.metersPerSecond))*e;return"number"==typeof i&&(l+=.5*this.convertAcceleration(i,a,_n.metersPerSecondSquared)*e*e),this.convertDistance(l,dn.meters,t,s)},parseTimestamp:ao,getConvexHull:function(t){var e=so(t).map((function(t){return[Xn(t[0]),Kn(t[1])]}));e.sort((function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}));for(var r=[],i=0,n=e;i<n.length;i++){for(var o=n[i];2<=r.length&&zn(r[r.length-2],r[r.length-1],o)<=0;)r.pop();r.push(o)}for(var a=[],s=e.length-1;0<=s;s--){for(;2<=a.length&&zn(a[a.length-2],a[a.length-1],e[s])<=0;)a.pop();a.push(e[s])}return new mo([r.concat(a)])},getPositions:so,getPosition:lo,getPositionsAlongPath:function(t,e){if(e<2)return[];for(var r=[],i=Zn(t,dn.meters)/(e-1),n=0;n<e;n++){var o=Hn(t,i*n,dn.meters);null!=o&&r.push(o)}return r},getPointWithHeadingAlongPath:co,getPointsWithHeadingsAlongPath:function(t,e){if(e<=0)return[];for(var r=[],i=Zn(t,dn.meters)/(e-1),n=0;n<e;n++){var o=co(t,i*n,dn.meters);null!=o&&r.push(o)}return r},getClosestPointOnGeometry:uo}),To=(w(Eo,wo=yo),Eo.prototype.addProperty=function(t,e){tn(this.data.properties[t],e)||(this.data.properties[t]=pi(e),"subType"!==t&&"radius"!==t||this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Eo.prototype.getBounds=function(){var t,e=this.getCoordinates(),r=this.getType();if("Point"===r)if(this.circlePolygon){var i=this.circlePolygon.geometry.coordinates;t=Co.fromPositions(i[0])}else t=new Co(i=e,i);else if("MultiPoint"===r||"LineString"===r)i=e,t=Co.fromPositions(i);else if("Polygon"===r)i=e,t=Co.fromPositions(i[0]);else if("MultiLineString"===r)for(var n=0,o=i=e;n<o.length;n++){var a=o[n];t=Co.merge(t,Co.fromPositions(a))}else if("MultiPolygon"===r)for(var s=0,l=i=e;s<l.length;s++){var c=l[s];t=Co.merge(t,Co.fromPositions(c[0]))}return t},Eo.prototype.getCoordinates=function(){return pi(this.data.geometry.coordinates)},Eo.prototype.getCircleCoordinates=function(){return this.circlePolygon?pi(this.circlePolygon.geometry.coordinates[0]):null},Eo.prototype.getId=function(){return this.data.id},Eo.prototype.getProperties=function(){return pi(this.data.properties)},Eo.prototype.getType=function(){return this.data.geometry.type},Eo.prototype.isCircle=function(){return Eo._isCircle(this.data)},Eo.prototype.isRectangle=function(){return Eo._isRectangle(this.data)},Eo.prototype.setCoordinates=function(t){var e;e="Polygon"===this.getType()&&1===ho._getDimensions(t)?[t]:t,tn(this.data.geometry.coordinates,e)||(this.data.geometry.coordinates=pi(e),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Eo.prototype.setProperties=function(t){t[Eo._shapeIdPropName]=this.data.id,tn(this.data.properties,t)||(this.data.properties=pi(t),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Eo.prototype.toJson=function(){return JSON.parse(JSON.stringify(this.data))},Eo.prototype._toJson=function(){return this.circlePolygon||this.data},Eo.prototype._setDataSource=function(t){void 0===t||null==t?delete this.dataSource:this.dataSource=t},Eo.prototype._handleCircle=function(){if(this.isCircle()){var t=Eo._getCirclePositions(this.data);this.circlePolygon=new nn(new mo([t]),this.data.properties,this.data.id),this.data.properties.subType="Circle"}else delete this.circlePolygon},Eo._isCircle=function(t){return t&&t.geometry&&"Point"===t.geometry.type&&t.geometry.coordinates&&t.properties&&"string"==typeof t.properties.subType&&"circle"===t.properties.subType.toLowerCase()&&"number"==typeof t.properties.radius},Eo._isRectangle=function(t){if("Polygon"===t.geometry.type&&t.geometry.coordinates&&"string"==typeof t.properties.subType&&"rectangle"===t.properties.subType.toLowerCase()){var e=t.geometry.coordinates;if(1===e.length){var r=e[0];if(5===r.length)return r[0][0]===r[4][0]&&r[0][1]===r[4][1];if(4===r.length)return!0}}return!1},Eo._getCirclePositions=function(t){return Wn(t.geometry.coordinates,t.properties.radius,72,"meters")},Eo._shapeIdPropName="_azureMapsShapeId",Eo);function Eo(t,e,r){var i,n=wo.call(this)||this;if("Feature"===t.type){var o=t;i=pi(o.geometry),r=o.properties?pi(o.properties):{},e=null==o.id||""===o.id?rn():o.id}else i=pi(t),e=null==e||""===e?rn():e,r=r?pi(r):{};return r[Eo._shapeIdPropName]=e,n.data=new nn(i,r,e),n._handleCircle(),n}var Io,Co=(w(Ao,Io=Array),Ao.fromBoundingBox=function(t){var e=Ao.getWest(t),r=Ao.getSouth(t),i=Ao.getEast(t),n=Ao.getNorth(t);return new Ao([e,r,i,n])},Ao.fromDimensions=function(t,e,r){var i=t[0],n=t[1],o=Math.min(Math.max(n+r/2,-85.5),85.5),a=Math.min(Math.max(n-r/2,-85.5),85.5),s=Xn(i+e/2);return new Ao([Xn(i-e/2),a,s,o])},Ao.fromEdges=function(t,e,r,i){return new Ao([t,e,r,i])},Ao.containsPosition=function(t,e){var r=Ao.getCenter(t),i=Math.abs(r[1]-e[1]),n=Math.abs(r[0]-e[0]);180<n&&(n=360-n);var o=Ao.getHeight(t),a=Ao.getWidth(t);return i<=o/2+1e-8&&n<=a/2+1e-8},Ao.crossesAntimeridian=function(t){return Xn(Ao.getEast(t))-Xn(Ao.getWest(t))<0},Ao.getCenter=function(t){var e=Xn(Ao.getEast(t)),r=Xn(Ao.getWest(t));e<r&&(e+=360);var i=Xn((r+e)/2),n=Kn(Ao.getSouth(t)),o=Kn(Ao.getNorth(t));return[i,Kn((n+o)/2)]},Ao.getHeight=function(t){var e=Kn(Ao.getNorth(t))-Kn(Ao.getSouth(t));return isNaN(e)?0:e},Ao.getWidth=function(t){var e=Xn(Ao.getEast(t))-Xn(Ao.getWest(t));return isNaN(e)?0:e<0?e+=360:e},Ao.getSouthWest=function(t){var e=this.getSouth(t),r=this.getWest(t);return isNaN(e)||isNaN(r)?null:[r,e]},Ao.getNorthEast=function(t){var e=this.getNorth(t),r=this.getEast(t);return isNaN(e)||isNaN(r)?null:[r,e]},Ao.getNorthWest=function(t){var e=this.getNorth(t),r=this.getWest(t);return isNaN(e)||isNaN(r)?null:[r,e]},Ao.getSouthEast=function(t){var e=this.getSouth(t),r=this.getEast(t);return isNaN(e)||isNaN(r)?null:[r,e]},Ao.getSouth=function(t){return t&&4<=t.length?Number(t[1]):NaN},Ao.getWest=function(t){return t&&4<=t.length?Number(t[0]):NaN},Ao.getNorth=function(t){if(t){if(4===t.length)return Number(t[3]);if(6===t.length)return Number(t[4])}return NaN},Ao.getEast=function(t){if(t){if(4===t.length)return Number(t[2]);if(6===t.length)return Number(t[3])}return NaN},Ao.intersect=function(t,e){var r=Ao.getCenter(t),i=Ao.getCenter(e),n=Math.abs(r[1]-i[1]),o=Math.abs(r[0]-i[0]);180<o&&(o=360-o);var a=Ao.getHeight(t),s=Ao.getWidth(t),l=Ao.getHeight(e),c=Ao.getWidth(e);return n<=a/2+l/2&&o<=s/2+c/2},Ao.merge=function(t,e){var r=t&&4===t.length,i=e&&4===e.length;if(r&&!i)return t;if(i&&!r)return e;if(!r&&!i)return null;var n=Math.max(Kn(Ao.getNorth(t)),Kn(Ao.getNorth(e))),o=Math.min(Kn(Ao.getSouth(t)),Kn(Ao.getSouth(e))),a=[t,e],s=[],l=0;for(l=0;l<a.length;l++){var c=a[l],u=Xn(Ao.getWest(c)),p=Xn(Ao.getEast(c));Ao.crossesAntimeridian(c)?(s.push([u,180]),s.push([-180,p])):s.push([u,p])}s.sort((function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}));var h=[],d=s[0];for(l=1;l<s.length;){var f=s[l];d[1]>=f[0]?d[1]=Math.max(d[1],f[1]):(h.push(d),d=f),l++}h.push(d);var m=h.length,g=h[0][0]+360-h[m-1][1],y=[h[m-1][1],h[0][0]];for(l=1;l<m;l++){var v=h[l][0]-h[l-1][1];g<v&&(g=v,y=[h[l-1][1],h[l][0]])}return new Ao([y[1],o],[y[0],n])},Ao.fromPositions=function(t){for(var e,r=NaN,i=NaN,n=NaN,o=NaN,a=t.length,s=new Array(a),l=0;a--;)if((e=t[a])&&2<=e.length){var c=Kn(e[1]);r=isNaN(r)?c:Math.max(r,c),i=isNaN(i)?c:Math.min(i,c),s[l++]=Xn(e[0])}if(l){s.length=l,s.sort((function(t,e){return t-e}));var u=s[0]+360-s[l-1],p=0;for(a=1;a<l;a++){var h=s[a]-s[a-1];u<h&&(u=h,p=a)}n=s[p],o=s[(p||l)-1]}return isNaN(n)||isNaN(i)||isNaN(o)||isNaN(r)?null:new Ao([n,i,o,r])},Ao.fromLatLngs=function(t){return Ao.fromPositions(ho.fromLatLngs(t))},Ao.fromData=function(t){var e,r=null;if(Array.isArray(t)&&0<t.length){for(var i=0,n=t;i<n.length;i++){var o=n[i];null!=(e=Ao.fromData(o))&&(r=null===r?e:Ao.merge(r,e))}return r}if(t instanceof To)return t.getBounds();if(t&&t.type){var a=t;if(a.bbox&&4===a.bbox.length)return a.bbox;switch(a.type){case"FeatureCollection":return Ao.fromData(a.features);case"Feature":return To._isCircle(a)?Ao.fromPositions(To._getCirclePositions(a)):Ao.fromData(a.geometry);case"GeometryCollection":return Ao.fromData(a.geometries);case"Point":var s=a.coordinates;if(s&&2<=s.length)return[s[0],s[1],s[0],s[1]];break;case"LineString":case"MultiPoint":return Ao.fromPositions(a.coordinates);case"Polygon":case"MultiLineString":var l=a.coordinates;if(l&&0<l.length){for(var c=0,u=l.length;c<u;c++)null!=(e=Ao.fromPositions(l[c]))&&(r=null===r?e:Ao.merge(r,e));if(null!=r)return r}break;case"MultiPolygon":var p=a.coordinates;if(p&&0<p.length){for(c=0,u=p.length;c<u;c++)for(var h=0,d=p[c].length;h<d;h++)null!=(e=Ao.fromPositions(p[c][h]))&&(r=null===r?e:Ao.merge(r,e));return r}}}return null},Ao.splitOnAntimeridian=function(t){var e=[];if(Ao.crossesAntimeridian(t)){var r=void 0,i=void 0,n=Xn(Ao.getWest(t)),o=Xn(Ao.getEast(t)),a=Kn(Ao.getNorth(t)),s=Kn(Ao.getSouth(t));i=6<=t.length?(r=new Ao([n,s,t[2],180,a,t[5]]),new Ao([-180,s,t[2],o,a,t[5]])):(r=new Ao([n,s,180,a]),new Ao([-180,s,o,a])),e.push(r,i)}else e.push(new Ao(t));return e},Ao);function Ao(t,e){var r=this;if(t&&e){var i=t;r=i[2]&&e[2]?Io.call(this,i[0],i[1],i[2]||0,e[0],e[1],e[2]||0)||this:Io.call(this,i[0],i[1],e[0],e[1])||this}else if(t){var n=t;n&&(4===n.length?r=Io.call(this,n[0],n[1],n[2],n[3])||this:6<=n.length&&(r=Io.call(this,n[0],n[1],n[2],n[3],n[4],n[5])||this))}return r}var ko=(Po.TYPE="FeatureCollection",Po);function Po(t,e){this.type="FeatureCollection",this.type=Po.TYPE,this.features=t,this.bbox=e}var Oo=(Mo.TYPE="GeometryCollection",Mo);function Mo(t){this.type="GeometryCollection",this.type=Mo.TYPE,this.geometries=t}var Lo=(Do.TYPE="LineString",Do);function Do(t,e){this.type="LineString",this.type=Do.TYPE,this.coordinates=t,this.bbox=e}var Ro=(zo.TYPE="MultiLineString",zo);function zo(t,e){this.type="MultiLineString",this.type=zo.TYPE,this.coordinates=t,this.bbox=e}var No=(Bo.TYPE="MultiPoint",Bo);function Bo(t,e){this.type="MultiPoint",this.type=Bo.TYPE,this.coordinates=t,this.bbox=e}var Fo=(jo.TYPE="MultiPolygon",jo);function jo(t,e){this.type="MultiPolygon",this.type=jo.TYPE,this.coordinates=t,this.bbox=e}var Uo,Vo=Object.freeze({__proto__:null,Feature:nn,FeatureCollection:ko,LineString:Lo,Point:cn,Polygon:mo,Position:ho,BoundingBox:Co,MultiLineString:Ro,MultiPoint:No,MultiPolygon:Fo,GeometryCollection:Oo}),qo=function(t,e){return ui(t,5,e="function"==typeof e?e:void 0)},Go=(w(Zo,Uo=I),Zo);function Zo(){var t=null!==Uo&&Uo.apply(this,arguments)||this;return t.buffer=128,t.maxZoom=18,t.cluster=!1,t.clusterRadius=50,t.clusterMaxZoom=void 0,t.clusterProperties=void 0,t.lineMetrics=!1,t.tolerance=.375,t}var Ho,Wo=(w(Ko,Ho=yo),Ko.prototype.getId=function(){return this.id},Ko.prototype._setMap=function(t){if(null==t||void 0===t){var e=this.map;delete this.map,this._invokeEvent("sourceremoved",this),e&&e.events.invoke("sourceremoved",this)}else this.map=t,this._invokeEvent("sourceadded",this),this.map.events.invoke("sourceadded",this)},Ko);function Ko(t){var e=Ho.call(this)||this;return e.id=t||rn(),e}var Xo,Yo=(w(Jo,Xo=Wo),Jo.prototype.add=function(t,e){this._addNoUpdate(t,e),this._updateSource()},Jo.prototype.clear=function(){this._clearNoUpdate(),this._updateSource()},Jo.prototype.dispose=function(){this.options=null,this.shapes=null,this.shapesMap=null,this.map=null},Jo.prototype.getClusterExpansionZoom=function(t){var e=this;return new Promise((function(r,i){if(e.map){var n=e.map._getMap().getSource(e.getId());n&&"geojson"===n.type&&n.getClusterExpansionZoom(t,(function(t,e){t?i(t):"number"!=typeof e||r(e)}))}else i("The DataSource hasn't been added to a map.")}))},Jo.prototype.getClusterChildren=function(t){var e=this;return new Promise((function(r,i){if(e.map){var n=e.map._getMap().getSource(e.getId());n&&"geojson"===n.type&&n.getClusterChildren(t,(function(t,n){t?i(t):n&&r(e.map.sources._mapFeaturesToShapes(n,!1,e))}))}else i("The DataSource hasn't been added to a map.")}))},Jo.prototype.getClusterLeaves=function(t,e,r){var i=this;return new Promise((function(n,o){if(i.map){var a=i.map._getMap().getSource(i.getId());a&&"geojson"===a.type&&a.getClusterLeaves(t,e,r,(function(t,e){t?o(t):e&&n(i.map.sources._mapFeaturesToShapes(e,!1,i))}))}else o("The DataSource hasn't been added to a map.")}))},Jo.prototype.getOptions=function(){return pi(this.options)},Jo.prototype.getShapes=function(){return Array.from(this.shapes)},Jo.prototype.importDataFromUrl=function(t){var e=this;return fetch(t,{method:"GET",mode:"cors"}).then((function(t){if(t.ok)return t.json();throw new Error("HTTP "+t.status+": "+t.statusText)})).then((function(t){e.add(t)}))},Jo.prototype.getShapeById=function(t){return this.shapes[this.shapesMap.get(t)]||null},Jo.prototype.remove=function(t){for(var e=0,r=Array.isArray(t)?t:[t];e<r.length;e++){var i=r[e];"number"==typeof i?this._removeByIndex(i):this._removeById(i)}this._updateSource()},Jo.prototype.removeById=function(t){for(var e=0,r=Array.isArray(t)?t:[t];e<r.length;e++){var i=r[e];this._removeById(i)}this._updateSource()},Jo.prototype.setOptions=function(t){var e=(new Go).merge(this.options,pi(t));tn(this.options,e)||(this._invokeEvent("datasourceupdated",this),this.options=e,this.map&&this.map._rebuildStyle())},Jo.prototype.setShapes=function(t){this._clearNoUpdate(),this.add(t)},Jo.prototype.toJson=function(){return new ko(this.shapes.map((function(t){return t.toJson()})))},Jo.prototype._toJson=function(){return new ko(this.shapes.map((function(t){return t._toJson()})))},Jo.prototype._buildSource=function(){var t={type:"geojson",data:this._toJson(),maxzoom:this.options.maxZoom,cluster:this.options.cluster,clusterRadius:this.options.clusterRadius,tolerance:this.options.tolerance,lineMetrics:this.options.lineMetrics,clusterProperties:this.options.clusterProperties,buffer:this.options.buffer};return"number"==typeof this.options.clusterMaxZoom&&(t.clusterMaxZoom=this.options.clusterMaxZoom),t},Jo.prototype._addNoUpdate=function(t,e){var r;if(t instanceof To)this._addToSources(t,e),r=[t];else if(Array.isArray(t))r=t.map((function(t){return t instanceof To?t:new To(t)})),this._addToSources(r,e);else if("FeatureCollection"===t.type)r=t.features.map((function(t){return new To(t)})),this._addToSources(r,e);else if("GeometryCollection"===t.type)r=t.geometries.map((function(t){return new To(t)})),this._addToSources(r,e);else{var i=new To(t);this._addToSources(i,e),r=[i]}this._invokeEvent("dataadded",r)},Jo.prototype._clearNoUpdate=function(){var t=this.shapes;this.shapes=[],this.shapesMap=new hi,t&&0<t.length&&this._invokeEvent("dataremoved",t)},Jo.prototype._updateSource=function(){var t=this;void 0===this.requestId&&(this.requestId=requestAnimationFrame((function(){t._updateMboxSource(),t.requestId=void 0})))},Jo.prototype._addToSources=function(t,e){if(t=Array.isArray(t)?t:[t],"number"!=typeof e)for(var r=0,i=t;r<i.length;r++){var n=i[r];this.shapes.push(n),this.shapesMap.set(n.getId(),this.shapes.length-1)}else for(var o=t.length-1;0<=o;o--)this.shapes.splice(e,0,t[o]),this._updateShapesMap(e);for(var a=0,s=t;a<s.length;a++)(n=s[a])._setDataSource(this)},Jo.prototype._removeById=function(t){var e,r=t instanceof To?t.getId():"string"==typeof t||"number"==typeof t?t:t.id;(e=this.shapes[this.shapesMap.get(r)])&&(e._setDataSource(null),this.shapes.splice(this.shapesMap.get(r),1),this._updateShapesMap(this.shapesMap.get(r)),this.shapesMap.delete(r),this._invokeEvent("dataremoved",[e]))},Jo.prototype._removeByIndex=function(t){var e;if(t>=this.shapes.length)throw new Error("The specified remove index '"+t+"' is greater than the maximum possible index '"+(this.shapes.length-1)+"'");e=this.shapes[t],this.shapesMap.delete(e.getId()),e._setDataSource(null),this.shapes.splice(t,1),this._updateShapesMap(t),this._invokeEvent("dataremoved",[e])},Jo.prototype._updateShapesMap=function(t){for(var e=t;e<this.shapes.length;e++)this.shapesMap.set(this.shapes[e].getId(),e)},Jo.prototype._updateMboxSource=function(){if(this.map&&this.map._getMap()){var t=this.map._getMap().getSource(this.getId());t&&"geojson"===t.type&&t.setData(this._toJson())}},Jo);function Jo(t,e){var r=Xo.call(this,t)||this;return r.requestId=void 0,r.options=(new Go).merge(pi(e)),r.shapes=[],r.shapesMap=new hi,r}var $o,Qo=(w(ta,$o=I),ta);function ta(){var t=null!==$o&&$o.apply(this,arguments)||this;return t.bounds=void 0,t.minZoom=0,t.maxZoom=22,t.isTMS=!1,t.tiles=void 0,t.tileSize=512,t.url=void 0,t}var ea,ra=(w(ia,ea=Wo),ia.prototype.getOptions=function(){return pi(this.options)},ia.prototype.getShape=function(t,e){return this.map._getMap().querySourceFeatures(this.getId(),{sourceLayer:t,filter:e})},ia.prototype._buildSource=function(){var t={type:"vector"};return this.options.bounds&&(t.bounds=this.options.bounds),this.options.tiles?(t.tiles=this.options.tiles,t.minzoom=this.options.minZoom,t.maxzoom=this.options.maxZoom):this.options.url&&(t.url=this.options.url),this.options.isTMS&&(t.scheme="tms"),this.options.tileSize&&(t.tileSize=this.options.tileSize),t},ia);function ia(t,e){var r=ea.call(this,t)||this;return r.options=(new Qo).merge(pi(e)),r}var na,oa=Object.freeze({__proto__:null,Source:Wo,DataSource:Yo,VectorTileSource:ra}),aa=(w(sa,na=yo),sa.prototype.getId=function(){return this.id},sa.prototype.getMap=function(){return this.map||null},sa.prototype.onAdd=function(t){this.map=t,this._invokeEvent("layeradded",this),this.map.events.invoke("layeradded",this)},sa.prototype.onRemove=function(){var t=this.map;delete this.map,this._invokeEvent("layerremoved",this),t&&t.events.invoke("layerremoved",this)},sa._isMBoxEvent=function(t){return!this.LayerEvents.hasOwnProperty(t)},sa.prototype._updateBaseProperties=function(t,e){this._updateFilter(t.filter,e.filter),this._updateZoomRange(t.minZoom,e.minZoom,t.maxZoom,e.maxZoom),this._updateLayoutProperty("visibility",t.visible,e.visible,t.visible?"visible":"none")},sa.prototype._updateFilter=function(t,e){tn(t,e)||this.map._getMap().setFilter(this.id,t)},sa.prototype._updatePaintProperty=function(t,e,r,i){tn(e,r)||this.map._getMap().setPaintProperty(this.id,t,i||e)},sa.prototype._updateLayoutProperty=function(t,e,r,i){tn(e,r)||this.map._getMap().setLayoutProperty(this.id,t,i||e)},sa.prototype._updateZoomRange=function(t,e,r,i){t===e&&i===r||this.map._getMap().setLayerZoomRange(this.id,t,r)},sa.LayerEvents={layeradded:void 0,layerremoved:void 0},sa);function sa(t){var e=na.call(this)||this;return e.id=t||rn(),e}var la,ca=(w(ua,la=I),ua._cloneCustomizer=function(t){if(t instanceof Wo)return t},ua);function ua(){var t=null!==la&&la.apply(this,arguments)||this;return t.filter=void 0,t.minZoom=0,t.maxZoom=24,t.visible=!0,t}var pa,ha=(w(da,pa=ca),da);function da(){var t=null!==pa&&pa.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.color="#1A73AA",t.blur=0,t.opacity=1,t.strokeColor="#FFFFFF",t.strokeOpacity=1,t.strokeWidth=2,t.pitchAlignment="viewport",t.radius=8,t}var fa,ma=(w(ga,fa=aa),ga.prototype.getOptions=function(){return qo(this.options,ha._cloneCustomizer)},ga.prototype.getSource=function(){return this.options.source},ga.prototype.setOptions=function(t){var e=(new ha).merge(this.options,qo(t,ha._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("circle-blur",e.blur,this.options.blur),this._updatePaintProperty("circle-color",e.color,this.options.color),this._updatePaintProperty("circle-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("circle-radius",e.radius,this.options.radius),this._updatePaintProperty("circle-stroke-color",e.strokeColor,this.options.strokeColor),this._updatePaintProperty("circle-stroke-opacity",e.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("circle-stroke-width",e.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("circle-pitch-alignment",e.pitchAlignment,this.options.pitchAlignment)}this.options=e},ga.prototype._buildLayers=function(){var t={id:this.id,type:"circle",source:this.options.source instanceof Wo?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"circle-color":this.options.color,"circle-blur":this.options.blur,"circle-opacity":this.options.opacity,"circle-stroke-color":this.options.strokeColor,"circle-stroke-opacity":this.options.strokeOpacity,"circle-stroke-width":this.options.strokeWidth,"circle-pitch-alignment":this.options.pitchAlignment,"circle-radius":this.options.radius},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),this.options.sourceLayer&&(t["source-layer"]=this.options.sourceLayer),[t]},ga.prototype._getLayerIds=function(){return[this.id]},ga.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof Wo?t.add(this.options.source.getId()):t.add(this.options.source),t},ga);function ga(t,e,r){var i=fa.call(this,e)||this;return i.options=(new ha).merge(qo(r,ha._cloneCustomizer)),i.options.source=t||i.options.source,i}var ya,va=(w(_a,ya=ca),_a._cloneCustomizer=function(t){if(t instanceof Wo)return t},_a);function _a(){var t=null!==ya&&ya.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.color=["interpolate",["linear"],["heatmap-density"],0,"rgba(0,0, 255,0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],t.intensity=1,t.opacity=1,t.radius=30,t.weight=1,t}var xa,ba=(w(wa,xa=aa),wa.prototype.getOptions=function(){return qo(this.options,va._cloneCustomizer)},wa.prototype.getSource=function(){return this.options.source},wa.prototype.setOptions=function(t){var e=(new va).merge(this.options,qo(t,va._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("heatmap-color",e.color,this.options.color),this._updatePaintProperty("heatmap-intensity",e.intensity,this.options.intensity),this._updatePaintProperty("heatmap-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("heatmap-radius",e.radius,this.options.radius),this._updatePaintProperty("heatmap-weight",e.weight,this.options.weight)}this.options=e},wa.prototype._buildLayers=function(){var t={id:this.id,type:"heatmap",source:this.options.source instanceof Wo?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"heatmap-color":this.options.color,"heatmap-intensity":this.options.intensity,"heatmap-opacity":this.options.opacity,"heatmap-radius":this.options.radius,"heatmap-weight":this.options.weight},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),this.options.sourceLayer&&(t["source-layer"]=this.options.sourceLayer),[t]},wa.prototype._getLayerIds=function(){return[this.id]},wa.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof Wo?t.add(this.options.source.getId()):t.add(this.options.source),t},wa);function wa(t,e,r){var i=xa.call(this,e)||this;return i.options=(new va).merge(qo(r,va._cloneCustomizer)),i.options.source=t||i.options.source,i}var Sa,Ta=(w(Ea,Sa=ca),Ea);function Ea(){var t=null!==Sa&&Sa.apply(this,arguments)||this;return t.contrast=0,t.fadeDuration=300,t.hueRotation=0,t.maxBrightness=1,t.minBrightness=0,t.opacity=1,t.saturation=0,t}var Ia,Ca=(w(Aa,Ia=Ta),Aa._cloneCustomizer=function(t){if(t instanceof Wo)return t},Aa);function Aa(){var t=null!==Ia&&Ia.apply(this,arguments)||this;return t.url=void 0,t.coordinates=void 0,t}var ka,Pa=(w(Oa,ka=aa),Oa.prototype._getSourceIds=function(){var t=new Set;return t.add(this._getSourceId()),t},Oa);function Oa(){return null!==ka&&ka.apply(this,arguments)||this}var Ma,La=(w(Da,Ma=Pa),Da.prototype.getOptions=function(){return qo(this.options,Ca._cloneCustomizer)},Da.prototype.setOptions=function(t){var e=(new Ca).merge(this.options,qo(t,Ca._cloneCustomizer)),r="string"==typeof t.url&&t.url!==this.getOptions().url,i=void 0!==t.coordinates&&t.coordinates!==this.getOptions().coordinates;if(this.map){this._updateBaseProperties(e,this.options),this._updatePaintProperty("raster-contrast",e.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",e.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",e.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",e.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",e.saturation,this.options.saturation);var n=this.map._getMap().getSource(this._getSourceId());n&&n.updateImage(e)}this.options=e,r?this.reloadImage():i&&this.updateTransform()},Da.prototype.getPositions=function(t){return this.transform.then((function(e){return e.toTarget(t)}))},Da.prototype.getPixels=function(t){return this.transform.then((function(e){return e.toSource(t)}))},Da.getCoordinatesFromRefPoints=function(t,e,r,i){return new xo(r,i).toTarget([[0,0],[t,0],[t,e],[0,e]])},Da.getCoordinatesFromEdges=function(t,e,r,i,n){"number"!=typeof n&&(n=0);var o=[Math.min(i,r),e,Math.max(i,r),t],a=Co.getCenter(o);return Yn([Co.getNorthWest(o),Co.getNorthEast(o),Co.getSouthEast(o),Co.getSouthWest(o)],a,n)},Da.prototype._buildLayers=function(){var t={id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-opacity":this.options.opacity,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-min":this.options.minBrightness,"raster-brightness-max":this.options.maxBrightness,"raster-saturation":this.options.saturation,"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),[t]},Da.prototype._getLayerIds=function(){return[this.id]},Da.prototype._buildSource=function(){return{type:"image",url:this.options.url,coordinates:this.options.coordinates}},Da.prototype._getSourceId=function(){return this.getId()+"-ImageSource"},Da.prototype.reloadImage=function(){var t=this;this.options.url&&(this.transform=new Promise((function(e,r){t.img.onload=function(){var r=[[0,0],[t.img.width,0],[t.img.width,t.img.height],[0,t.img.height]];e(new xo(r,t.options.coordinates)),t.isLoading=!1},t.img.onerror=t.img.onabort=function(){r("Failed to load image")},t.isLoading=!0,t.img.src=t.options.url})))},Da.prototype.updateTransform=function(){if(!this.isLoading){var t=[[0,0],[this.img.width,0],[this.img.width,this.img.height],[0,this.img.height]];this.transform=Promise.resolve(new xo(t,this.options.coordinates))}},Da);function Da(t,e){var r=Ma.call(this,e)||this;return r.isLoading=!1,r.options=(new Ca).merge(qo(t,Ca._cloneCustomizer)),r.img=new Image,r.reloadImage(),r}var Ra,za=(w(Na,Ra=ca),Na);function Na(){var t=null!==Ra&&Ra.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.lineCap="round",t.lineJoin="round",t.blur=0,t.strokeColor="#1E90FF",t.strokeDashArray=void 0,t.strokeGradient=void 0,t.offset=0,t.strokeOpacity=1,t.translate=new sn(0,0),t.translateAnchor="map",t.strokeWidth=2,t}var Ba,Fa=(w(ja,Ba=aa),ja.prototype.getOptions=function(){return qo(this.options,za._cloneCustomizer)},ja.prototype.getSource=function(){return this.options.source},ja.prototype.setOptions=function(t){var e=(new za).merge(this.options,qo(t,za._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("line-blur",e.blur,this.options.blur),this._updateLayoutProperty("line-cap",e.lineCap,this.options.lineCap),this._updateLayoutProperty("line-join",e.lineJoin,this.options.lineJoin),this._updatePaintProperty("line-offset",e.offset,this.options.offset),this._updatePaintProperty("line-color",e.strokeColor,this.options.strokeColor),this._updatePaintProperty("line-dasharray",e.strokeDashArray,this.options.strokeDashArray),this._updatePaintProperty("line-gradient",e.strokeGradient,this.options.strokeGradient),this._updatePaintProperty("line-opacity",e.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("line-width",e.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("line-translate",e.translate,this.options.translate),this._updatePaintProperty("line-translate-anchor",e.translateAnchor,this.options.translateAnchor)}this.options=e},ja.prototype._buildLayers=function(){return[S(S(S(S({id:this.id,type:"line"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof Wo?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none","line-cap":this.options.lineCap,"line-join":this.options.lineJoin},paint:S(S(S({"line-blur":this.options.blur,"line-color":this.options.strokeColor},this.options.strokeDashArray&&{"line-dasharray":this.options.strokeDashArray}),this.options.strokeGradient&&{"line-gradient":this.options.strokeGradient}),{"line-offset":this.options.offset,"line-opacity":this.options.strokeOpacity,"line-translate":this.options.translate,"line-translate-anchor":this.options.translateAnchor,"line-width":this.options.strokeWidth})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},ja.prototype._getLayerIds=function(){return[this.id]},ja.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof Wo?t.add(this.options.source.getId()):t.add(this.options.source),t},ja);function ja(t,e,r){var i=Ba.call(this,e)||this;return i.options=(new za).merge(qo(r,za._cloneCustomizer)),i.options.source=t||i.options.source,i}var Ua,Va=(w(qa,Ua=ca),qa);function qa(){var t=null!==Ua&&Ua.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.base=0,t.fillColor="#1E90FF",t.height=0,t.fillOpacity=1,t.fillPattern=void 0,t.translate=new sn(0,0),t.translateAnchor="map",t.verticalGradient=!0,t}var Ga,Za=(w(Ha,Ga=aa),Ha.prototype.getOptions=function(){return qo(this.options,Va._cloneCustomizer)},Ha.prototype.getSource=function(){return this.options.source},Ha.prototype.setOptions=function(t){var e=(new Va).merge(this.options,qo(t,Va._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("fill-extrusion-base",e.base,this.options.base),this._updatePaintProperty("fill-extrusion-color",e.fillColor,this.options.fillColor),this._updatePaintProperty("fill-extrusion-height",e.height,this.options.height),this._updatePaintProperty("fill-extrusion-opacity",e.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-extrusion-pattern",e.fillPattern,this.options.fillPattern),this._updatePaintProperty("fill-extrusion-translate",e.translate,this.options.translate),this._updatePaintProperty("fill-extrusion-translate-anchor",e.translateAnchor,this.options.translateAnchor),this._updatePaintProperty("fill-extrusion-vertical-gradient",e.verticalGradient,this.options.verticalGradient)}this.options=e},Ha.prototype._buildLayers=function(){return[S(S(S(S({id:this.id,type:"fill-extrusion"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof Wo?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:S(S({"fill-extrusion-base":this.options.base,"fill-extrusion-height":this.options.height,"fill-extrusion-opacity":this.options.fillOpacity},this.options.fillPattern?{"fill-extrusion-pattern":this.options.fillPattern}:{"fill-extrusion-color":this.options.fillColor}),{"fill-extrusion-translate":this.options.translate,"fill-extrusion-translate-anchor":this.options.translateAnchor,"fill-extrusion-vertical-gradient":this.options.verticalGradient})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},Ha.prototype._getLayerIds=function(){return[this.id]},Ha.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof Wo?t.add(this.options.source.getId()):t.add(this.options.source),t},Ha);function Ha(t,e,r){var i=Ga.call(this,e)||this;return i.options=(new Va).merge(qo(r,Va._cloneCustomizer)),i.options.source=t||i.options.source,i}var Wa,Ka=(w(Xa,Wa=ca),Xa.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=!1,i=!1,n=0,o=t;n<o.length;n++){var a=o[n];a&&(a.hasOwnProperty("fillColor")?i=!(r=!0):a.hasOwnProperty("fillPattern")&&(r=!(i=!0)))}var s=Wa.prototype.merge.apply(this,t);return r?s.fillPattern=void 0:i&&(s.fillColor=void 0),s},Xa);function Xa(){var t=null!==Wa&&Wa.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.fillColor="#1E90FF",t.fillOpacity=.5,t.fillPattern=void 0,t}var Ya,Ja=(w($a,Ya=aa),$a.prototype.getOptions=function(){return qo(this.options,Ka._cloneCustomizer)},$a.prototype.getSource=function(){return this.options.source},$a.prototype.setOptions=function(t){var e=(new Ka).merge(this.options,qo(t,Ka._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("fill-color",e.fillColor,this.options.fillColor),this._updatePaintProperty("fill-opacity",e.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-pattern",e.fillPattern,this.options.fillPattern)}this.options=e},$a.prototype._buildLayers=function(){var t={id:this.id,type:"fill",source:this.options.source instanceof Wo?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"fill-opacity":this.options.fillOpacity},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(t.filter=this.options.filter),this.options.sourceLayer&&(t["source-layer"]=this.options.sourceLayer),this.options.fillPattern?t.paint["fill-pattern"]=this.options.fillPattern:t.paint["fill-color"]=this.options.fillColor,[t]},$a.prototype._getLayerIds=function(){return[this.id]},$a.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof Wo?t.add(this.options.source.getId()):t.add(this.options.source),t},$a);function $a(t,e,r){var i=Ya.call(this,e)||this;return i.options=(new Ka).merge(qo(r,Ka._cloneCustomizer)),i.options.source=t||i.options.source,i}var Qa,ts=(w(es,Qa=I),es);function es(){var t=null!==Qa&&Qa.apply(this,arguments)||this;return t.allowOverlap=!1,t.anchor="bottom",t.ignorePlacement=!1,t.image="marker-blue",t.offset=new sn(0,0),t.optional=!1,t.pitchAlignment="auto",t.rotation=0,t.rotationAlignment="auto",t.size=1,t.opacity=1,t}var rs,is=(w(ns,rs=I),ns);function ns(){var t=null!==rs&&rs.apply(this,arguments)||this;return t.allowOverlap=!1,t.anchor="center",t.textField=void 0,t.font=["StandardFont-Regular"],t.ignorePlacement=!1,t.offset=new sn(0,0),t.optional=!1,t.pitchAlignment="auto",t.rotation=0,t.rotationAlignment="auto",t.size=16,t.color="#000000",t.haloBlur=0,t.haloColor="rgba(0,0,0,0)",t.haloWidth=0,t.opacity=1,t}var os,as=(w(ss,os=ca),ss);function ss(){var t=null!==os&&os.apply(this,arguments)||this;return t.source=void 0,t.sourceLayer=void 0,t.iconOptions=new ts,t.textOptions=new is,t.placement="point",t.lineSpacing=250,t}var ls,cs=(w(us,ls=aa),us.prototype.getOptions=function(){return qo(this.options,as._cloneCustomizer)},us.prototype.getSource=function(){return this.options.source},us.prototype.setOptions=function(t){var e=(new as).merge(this.options,qo(t,as._cloneCustomizer));if(this.map){if(e.source!==this.options.source||e.sourceLayer!==this.options.sourceLayer)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updateLayoutProperty("symbol-spacing",e.lineSpacing,this.options.lineSpacing),this._updateLayoutProperty("symbol-placement",e.placement,this.options.placement),this._updateLayoutProperty("icon-allow-overlap",e.iconOptions.allowOverlap,this.options.iconOptions.allowOverlap),this._updateLayoutProperty("icon-anchor",e.iconOptions.anchor,this.options.iconOptions.anchor),this._updateLayoutProperty("icon-ignore-placement",e.iconOptions.ignorePlacement,this.options.iconOptions.ignorePlacement),this._updateLayoutProperty("icon-image",e.iconOptions.image,this.options.iconOptions.image),this._updateLayoutProperty("icon-offset",e.iconOptions.offset,this.options.iconOptions.offset),this._updatePaintProperty("icon-opacity",e.iconOptions.opacity,this.options.iconOptions.opacity),this._updateLayoutProperty("icon-optional",e.iconOptions.optional,this.options.iconOptions.optional),this._updateLayoutProperty("icon-pitch-alignment",e.iconOptions.pitchAlignment,this.options.iconOptions.pitchAlignment),this._updateLayoutProperty("icon-rotate",e.iconOptions.rotation,this.options.iconOptions.rotation),this._updateLayoutProperty("icon-rotation-alignment",e.iconOptions.rotationAlignment,this.options.iconOptions.rotationAlignment),this._updateLayoutProperty("icon-size",e.iconOptions.size,this.options.iconOptions.size),this._updateLayoutProperty("text-allow-overlap",e.textOptions.allowOverlap,this.options.textOptions.allowOverlap),this._updateLayoutProperty("text-anchor",e.textOptions.anchor,this.options.textOptions.anchor),this._updatePaintProperty("text-color",e.textOptions.color,this.options.textOptions.color),this._updateLayoutProperty("text-font",e.textOptions.font,this.options.textOptions.font),this._updateLayoutProperty("text-ignore-placement",e.textOptions.ignorePlacement,this.options.textOptions.ignorePlacement),this._updatePaintProperty("text-halo-blur",e.textOptions.haloBlur,this.options.textOptions.haloBlur),this._updatePaintProperty("text-halo-color",e.textOptions.haloColor,this.options.textOptions.haloColor),this._updatePaintProperty("text-halo-width",e.textOptions.haloWidth,this.options.textOptions.haloWidth),this._updateLayoutProperty("text-offset",e.textOptions.offset,this.options.textOptions.offset),this._updatePaintProperty("text-opacity",e.textOptions.opacity,this.options.textOptions.opacity),this._updateLayoutProperty("text-optional",e.textOptions.optional,this.options.textOptions.optional),this._updateLayoutProperty("text-pitch-alignment",e.textOptions.pitchAlignment,this.options.textOptions.pitchAlignment),this._updateLayoutProperty("text-rotate",e.textOptions.rotation,this.options.textOptions.rotation),this._updateLayoutProperty("text-rotation-alignment",e.textOptions.rotationAlignment,this.options.textOptions.rotationAlignment),this._updateLayoutProperty("text-size",e.textOptions.size,this.options.textOptions.size),this._updateLayoutProperty("text-field",e.textOptions.textField,this.options.textOptions.textField)}this.options=e},us.prototype._buildLayers=function(){return[S(S(S(S({id:this.id,type:"symbol"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof Wo?this.options.source.getId():this.options.source,layout:S(S({visibility:this.options.visible?"visible":"none","symbol-placement":this.options.placement,"symbol-spacing":this.options.lineSpacing,"text-allow-overlap":this.options.textOptions.allowOverlap,"text-anchor":this.options.textOptions.anchor},this.options.textOptions.textField&&{"text-field":this.options.textOptions.textField}),{"text-font":this.options.textOptions.font,"text-ignore-placement":this.options.textOptions.ignorePlacement,"text-offset":this.options.textOptions.offset,"text-optional":this.options.textOptions.optional,"text-pitch-alignment":this.options.textOptions.pitchAlignment,"text-rotate":this.options.textOptions.rotation,"text-rotation-alignment":this.options.textOptions.rotationAlignment,"text-size":this.options.textOptions.size,"icon-allow-overlap":this.options.iconOptions.allowOverlap,"icon-anchor":this.options.iconOptions.anchor,"icon-ignore-placement":this.options.iconOptions.ignorePlacement,"icon-image":this.options.iconOptions.image,"icon-offset":this.options.iconOptions.offset,"icon-optional":this.options.iconOptions.optional,"icon-pitch-alignment":this.options.iconOptions.pitchAlignment,"icon-rotate":this.options.iconOptions.rotation,"icon-rotation-alignment":this.options.iconOptions.rotationAlignment,"icon-size":this.options.iconOptions.size}),paint:{"text-color":this.options.textOptions.color,"text-halo-blur":this.options.textOptions.haloBlur,"text-halo-color":this.options.textOptions.haloColor,"text-halo-width":this.options.textOptions.haloWidth,"text-opacity":this.options.textOptions.opacity,"icon-opacity":this.options.iconOptions.opacity}}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},us.prototype._getLayerIds=function(){return[this.id]},us.prototype._getSourceIds=function(){var t=new Set;return this.options.source instanceof Wo?t.add(this.options.source.getId()):t.add(this.options.source),t},us);function us(t,e,r){var i=ls.call(this,e)||this;return i.options=(new as).merge(qo(r,as._cloneCustomizer)),i.options.source=t||i.options.source,i}var ps,hs=(w(ds,ps=Ta),ds);function ds(){var t=null!==ps&&ps.apply(this,arguments)||this;return t.bounds=[-180,-85.0511,180,85.0511],t.minSourceZoom=0,t.maxSourceZoom=22,t.tileSize=512,t.isTMS=!1,t.subdomains=void 0,t.tileUrl=void 0,t}var fs,ms=(w(gs,fs=Pa),gs.prototype.getOptions=function(){return qo(this.options,hs._cloneCustomizer)},gs.prototype.setOptions=function(t){var e=(new hs).merge(this.options,qo(t,hs._cloneCustomizer));if(this.map){if(!tn(e.bounds,this.options.bounds)||e.isTMS!==this.options.isTMS||e.maxSourceZoom!==this.options.maxSourceZoom||e.minSourceZoom!==this.options.minSourceZoom||!tn(e.subdomains,this.options.subdomains)||e.tileSize!==this.options.tileSize||e.tileUrl!==this.options.tileUrl)return this.options=e,void this.map.layers.add(this);this._updateBaseProperties(e,this.options),this._updatePaintProperty("raster-contrast",e.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",e.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",e.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",e.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",e.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",e.saturation,this.options.saturation)}this.options=e},gs.prototype._setOptionsNoUpdate=function(t){this.options=(new hs).merge(this.options,qo(t,hs._cloneCustomizer))},gs.prototype._buildLayers=function(){return[S(S({id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-max":this.options.maxBrightness,"raster-brightness-min":this.options.minBrightness,"raster-opacity":this.options.opacity,"raster-saturation":this.options.saturation}},this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},gs.prototype._getLayerIds=function(){return[this.id]},gs.prototype._buildSource=function(){var t;if(this.options.tileUrl){if(-1===this.options.tileUrl.indexOf("{"))return{type:"raster",url:this.options.tileUrl};if(-1!==this.options.tileUrl.indexOf("{subdomain}")){if(!(this.options.subdomains&&0<this.options.subdomains.length))throw new Error("The {subdomain} placeholder was included in the tileUrl but no subdomains were specified");for(var e=[],r=0,i=this.options.subdomains;r<i.length;r++){var n=i[r];e.push(this.options.tileUrl.replace(/{subdomain}/g,n))}t=e}else t=[this.options.tileUrl]}return S({type:"raster",bounds:this.options.bounds,maxzoom:this.options.maxSourceZoom,minzoom:this.options.minSourceZoom,scheme:this.options.isTMS?"tms":"xyz",tileSize:this.options.tileSize},t&&{tiles:t})},gs.prototype._getSourceId=function(){return this.getId()+"-RasterSource"},gs);function gs(t,e){var r=fs.call(this,e)||this;return t&&r.setOptions(t),r}var ys=Object.freeze({__proto__:null,BubbleLayer:ma,Layer:aa,LineLayer:Fa,PolygonExtrusionLayer:Za,PolygonLayer:Ja,SymbolLayer:cs,TileLayer:ms,HeatMapLayer:ba,ImageLayer:La}),vs=(_s.convertHtmlString=function(t){if("string"!=typeof t)return t;var e=document.createElement("div");return e.innerHTML=t,e},_s);function _s(){}var xs,bs=Function.prototype,ws=Object.prototype,Ss=bs.toString,Ts=ws.hasOwnProperty,Es=Ss.call(Object),Is=function(t){if(!we(t)||"[object Object]"!=Pt(t))return!1;var e=pr(t);if(null===e)return!0;var r=Ts.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Ss.call(r)==Es},Cs=function(t){return we(t)&&1===t.nodeType&&!Is(t)},As=(w(ks,xs=I),ks._cloneCustomizer=function(t){if(Cs(t))return t},ks);function ks(){var t=null!==xs&&xs.apply(this,arguments)||this;return t.anchor="none",t.draggable=!1,t.closeButton=!0,t.content=document.createElement("span"),t.fillColor="#FFFFFF",t.pixelOffset=new sn(0,0),t.position=new ho(0,0),t.showPointer=!0,t}var Ps,Os=(w(Ms,Ps=yo),Ms.prototype.setPopupOptions=function(t){this.setOptions(t)},Ms.prototype.setOptions=function(t){var e=(new As).merge(this.options,qo(t,As._cloneCustomizer));e.content!==this.options.content?(this.htmlContent.remove(),this.htmlContent=this._createHtmlContent(e),this.contentDiv.prepend(this.htmlContent)):e.draggable!==this.options.draggable&&this._setDraggable(this.htmlContent,e.draggable),e.closeButton&&!this.closeBtn?(this.closeBtn=this._createCloseButton(),this.contentDiv.appendChild(this.closeBtn)):!e.closeButton&&this.closeBtn&&(this.contentDiv.removeChild(this.closeBtn),delete this.closeBtn),e.showPointer&&!this.arrowDiv?(this.arrowDiv=this._createArrowDiv(),this.containerDiv.appendChild(this.arrowDiv)):!e.showPointer&&this.arrowDiv&&(this.containerDiv.removeChild(this.arrowDiv),delete this.arrowDiv),e.fillColor!==this.options.fillColor&&(this.containerDiv.style.borderColor=e.fillColor,this.contentDiv.style.backgroundColor=e.fillColor),this.marker&&(e.anchor!==this.options.anchor?"none"===this.options.anchor?(this.autoAnchor!==e.anchor&&this._replaceMarker(this.map,e),this.map.events.remove("move",this._onMove),delete this.autoAnchor):(this._replaceMarker(this.map,e),"none"===e.anchor&&this.map.events.add("move",this._onMove)):(tn(e.position,this.options.position)||this.marker.setLngLat(e.position),tn(e.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(e.pixelOffset))),this.options=e},Ms.prototype.getPopupOptions=function(){return this.getOptions()},Ms.prototype.getOptions=function(){return qo(this.options,As._cloneCustomizer)},Ms.prototype._dragToPixel=function(t){this.dragging||(this.dragging=!0,this.contentDiv.style.pointerEvents="none",this._invokeEvent("dragstart",{type:"dragstart",target:this}));var e=[t[0]+this.dragOffset[0],t[1]+this.dragOffset[1]],r=this.map.pixelsToPositions([e])[0];this.options.position=r,this.marker.setLngLat(this.options.position),this._invokeEvent("drag",{type:"drag",target:this})},Ms.prototype._onUp=function(){this.dragging&&(this.contentDiv.style.pointerEvents="",this._invokeEvent("dragend",{type:"dragend",target:this}),"none"===this.options.anchor&&this._onMove()),delete this.dragOffset,delete this.dragging},Ms.prototype._createContainerDiv=function(t){var e=this,r=document.createElement("div");r.classList.add(Ms.Css.container),r.classList.add(Ms.Css.hidden),r.style.borderColor=t.fillColor,r.setAttribute("role","dialog"),r.setAttribute("aria-label","Map Information Window");var i=!1;return r.addEventListener("keydown",(function(t){"Tab"!==t.key&&"Escape"!==t.key&&"Esc"!==t.key||(i=!0)})),r.addEventListener("keyup",(function(t){"Tab"!==t.key&&"Escape"!==t.key&&"Esc"!==t.key||(i=!1)})),r.addEventListener("focusin",(function(t){e.map&&!e.isOpen()&&(e.open(e.map),t.target instanceof HTMLElement&&t.target.focus())})),r.addEventListener("focusout",(function(t){i&&t.relatedTarget instanceof Node&&!r.contains(t.relatedTarget)&&(i=!1,e.isOpen()&&e.close())})),r},Ms.prototype._createContentDiv=function(t){var e=document.createElement("div");return e.classList.add(Ms.Css.content),e.style.backgroundColor=t.fillColor,e.setAttribute("tabindex","0"),this.htmlContent=this._createHtmlContent(t),e.appendChild(this.htmlContent),e},Ms.prototype._createArrowDiv=function(){var t=document.createElement("div");return t.classList.add(Ms.Css.arrow),t},Ms.prototype._createCloseButton=function(){var t=document.createElement("button");return t.addEventListener("click",this.close),t.classList.add(Ms.Css.close),t.setAttribute("aria-label","close"),t.setAttribute("title","close"),t.setAttribute("tabindex","0"),t.innerHTML="&times;",t},Ms.prototype._createHtmlContent=function(t){var e=vs.convertHtmlString(t.content);return t.draggable&&this._setDraggable(e,t.draggable),e},Ms.prototype._createMarker=function(t,e){var r=this.marker?this.marker.getLngLat():t.position;return"none"===t.anchor?(this.autoAnchor=e||"bottom",this.containerDiv.classList.add(this.autoAnchor),new a({anchor:this.autoAnchor,element:this.containerDiv,offset:t.pixelOffset}).setLngLat(r)):(this.containerDiv.classList.add(t.anchor),new a({anchor:t.anchor,element:this.containerDiv,offset:t.pixelOffset}).setLngLat(r))},Ms.prototype._getAutoAnchor=function(t,e){var r,i,n=this.containerDiv.offsetWidth,o=this.containerDiv.offsetHeight;if(this.marker){var a=t._getMap().project(this.marker.getLngLat());r=a.x,i=a.y}else{var s=t.positionsToPixels([e.position])[0];r=s[0],i=s[1]}var l=[];return i<o?l.push("top"):i>t.getCanvas().offsetHeight-o&&l.push("bottom"),r<n/2?l.push("left"):r>t.getCanvas().offsetWidth-n/2&&l.push("right"),0<l.length?l.join("-"):"bottom"},Ms.prototype._replaceMarker=function(t,e,r){var i=this.containerDiv.nextElementSibling;this.marker.remove(),this.containerDiv.classList.remove(this.autoAnchor||this.options.anchor),this.marker=this._createMarker(e,r),this.marker.addTo(t._getMap()),t.popups._getCollectionDiv().insertBefore(this.containerDiv,i||null)},Ms.prototype._setDraggable=function(t,e){e?(t.addEventListener("mousedown",this._onDown),t.addEventListener("touchstart",this._onDown),t.addEventListener("dragstart",this._onDragStart)):(t.removeEventListener("mousedown",this._onDown),t.removeEventListener("touchstart",this._onDown),t.removeEventListener("dragstart",this._onDragStart))},Ms.Css={arrow:"popup-arrow",close:"popup-close",container:"popup-container",content:"popup-content-container",hidden:"hidden-accessible-element"},Ms);function Ms(t){var e=Ps.call(this)||this;return e.attach=function(t){e.map!==t&&(e.map&&e.remove(),e.map=t,e.marker=e._createMarker(e.options),e.marker.addTo(e.map._getMap()),e.map.popups._getCollectionDiv().appendChild(e.containerDiv),e.map.popups.add(e))},e.open=function(t){if(!t&&!e.map)throw new Error("Must specify a map to open on or attach to a map in advance");e.attach(t||e.map),e.containerDiv.classList.remove(Ms.Css.hidden),e.map.events.add("move",e._onMove),e._onMove(),e._invokeEvent("open",{target:e,type:"open"})},e.close=function(){e.map&&e.map.events.remove("move",e._onMove),e.containerDiv.classList.add(Ms.Css.hidden),e._invokeEvent("close",{target:e,type:"close"})},e.remove=function(){e.map&&(e.marker.remove(),e.containerDiv.classList.remove(e.autoAnchor||e.options.anchor),e.map.events.remove("move",e._onMove),e.map.popups.remove(e),delete e.map,delete e.marker,delete e.autoAnchor)},e.isOpen=function(){return e.map&&!e.containerDiv.classList.contains(Ms.Css.hidden)},e._onMove=function(){var t=e._getAutoAnchor(e.map,e.options);t!==e.autoAnchor&&(e._replaceMarker(e.map,e.options,t),e.map.events.add("move",e._onMove))},e._onDown=function(t){e.map.popups._addDraggedPopup(e);var r=e.map.positionsToPixels([e.options.position])[0];"mousedown"===t.type?(t=t,e.dragOffset=[r[0]-t.clientX,r[1]-t.clientY]):"touchstart"===t.type&&(t=t,e.dragOffset=[r[0]-t.touches[0].clientX,r[1]-t.touches[0].clientY])},e._onDragStart=function(t){t.preventDefault()},e.options=(new As).merge(qo(t,As._cloneCustomizer)),e.containerDiv=e._createContainerDiv(e.options),e.contentDiv=e._createContentDiv(e.options),e.containerDiv.appendChild(e.contentDiv),e.options.showPointer&&(e.arrowDiv=e._createArrowDiv(),e.containerDiv.appendChild(e.arrowDiv)),e.options.closeButton&&(e.closeBtn=e._createCloseButton(),e.contentDiv.appendChild(e.closeBtn)),e}var Ls,Ds=(w(Rs,Ls=I),Rs._cloneCustomizer=function(t){if(t instanceof Os||Cs(t))return t},Rs);function Rs(){var t=null!==Ls&&Ls.apply(this,arguments)||this;return t.anchor="bottom",t.color="#1A73AA",t.draggable=!1,t.htmlContent='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24.5 36.5" id="marker_'+rn()+'" width="24.5" height="36.5" display="block"><path d="M12.25.25a12.2543,12.2543,0,0,0-12,12.4937c0,6.4436,6.4879,12.1093,11.059,22.5641.5493,1.2563,1.3327,1.2563,1.882,0C17.7621,24.8529,24.25,19.1857,24.25,12.7437A12.2543,12.2543,0,0,0,12.25.25Z"   fill="{color}" stroke="{secondaryColor}" stroke-width="0.5"/><text style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; fill: white;" text-anchor="middle" x="12" y="18">{text}</text></svg>',t.pixelOffset=new sn(0,0),t.position=new ho(0,0),t.popup=void 0,t.secondaryColor="white",t.text=void 0,t.visible=!0,t}var zs,Ns=(w(Bs,zs=yo),Bs.prototype.getOptions=function(){return qo(this.options,Ds._cloneCustomizer)},Bs.prototype.setOptions=function(t){var e=(new Ds).merge(this.options,qo(t,Ds._cloneCustomizer));tn(e.htmlContent,this.options.htmlContent)&&e.anchor===this.options.anchor?("string"!=typeof e.htmlContent||e.color===this.options.color&&e.text===this.options.text&&e.secondaryColor===this.options.secondaryColor||(this.element.innerHTML=this._getSubbedHtmlString(e)),e.draggable!==this.options.draggable&&(this._setDraggable(e.draggable),this.marker.setDraggable(e.draggable)),tn(e.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(e.pixelOffset),tn(e.position,this.options.position)||this.marker.setLngLat(e.position),e.visible!==this.options.visible&&(e.visible?this.element.classList.remove(Bs.hiddenClass):this.element.classList.add(Bs.hiddenClass))):(this.marker.remove(),this._buildMarker(e),this.map&&(this.marker.addTo(this.map._getMap()),this._getCollectionContainer().appendChild(this.element))),this.options=e},Bs.prototype.togglePopup=function(){if(this.options.popup)if(this.options.popup.isOpen())this.options.popup.close();else{if(!this.map)throw new Error("The marker must be added to a map before calling togglePopup().");this.options.popup.setOptions({position:this.options.position}),this.options.popup.open(this.map)}},Bs.prototype._addToMap=function(t,e){this.map&&this.map!==t&&this._removeFromMap(),e&&(this.options.position=pi(e),this.marker.setLngLat(this.options.position)),this.map!==t&&(this.map=t,this.marker.addTo(t._getMap()),this._getCollectionContainer().appendChild(this.element))},Bs.prototype._removeFromMap=function(){this.map&&(this.marker.remove(),delete this.map)},Bs.prototype._getId=function(){if(this.element)return"string"==typeof this.options.htmlContent?this.element.firstChild.id:this.element.id},Bs.prototype._buildMarker=function(t){if("string"==typeof t.htmlContent){var e=this._getSubbedHtmlString(t);this.element=vs.convertHtmlString(e)}else this.element=t.htmlContent;this.element.classList.add(Bs.containerClass),t.draggable&&this._setDraggable(!0),t.visible||this.element.classList.add(Bs.hiddenClass),this.marker=new a({element:this.element,offset:t.pixelOffset,draggable:t.draggable,anchor:t.anchor}).setLngLat(t.position),this.marker.on("drag",this._onDrag),this.marker.on("dragstart",this._onDragStart),this.marker.on("dragend",this._onDragEnd),this.element.addEventListener("click",this._bubbleElementEvent),this.element.addEventListener("dblclick",this._bubbleElementEvent),this.element.addEventListener("contextmenu",this._bubbleElementEvent),this.element.addEventListener("keydown",this._bubbleElementEvent),this.element.addEventListener("keypress",this._bubbleElementEvent),this.element.addEventListener("keyup",this._bubbleElementEvent),this.element.addEventListener("mousedown",this._bubbleElementEvent),this.element.addEventListener("mouseenter",this._bubbleElementEvent),this.element.addEventListener("mouseleave",this._bubbleElementEvent),this.element.addEventListener("mousemove",this._bubbleElementEvent),this.element.addEventListener("mouseout",this._bubbleElementEvent),this.element.addEventListener("mouseover",this._bubbleElementEvent),this.element.addEventListener("mouseup",this._bubbleElementEvent)},Bs.prototype._getSubbedHtmlString=function(t){if("string"==typeof t.htmlContent)return t.htmlContent.replace(/{color}/gi,t.color||"").replace(/{secondaryColor}/gi,t.secondaryColor||"").replace(/{text}/gi,t.text||"")},Bs.prototype._getCollectionContainer=function(){var t=this.map.getCanvasContainer().querySelector("."+Bs.collectionContainerClass);return t||((t=document.createElement("div")).classList.add(Bs.collectionContainerClass),this.map.getCanvasContainer().appendChild(t)),t},Bs.prototype._setDraggable=function(t){t?this.element.addEventListener("dragstart",this._onEleDragStart):this.element.removeEventListener("dragstart",this._onEleDragStart)},Bs.collectionContainerClass="marker-collection-container",Bs.hiddenClass="hidden-accessible-element",Bs.containerClass="marker-container",Bs);function Bs(t){var e=zs.call(this)||this;return e._onDrag=function(){var t=e.marker.getLngLat().wrap();e.options.position=new ho(t.lng,t.lat),e._invokeEvent("drag",{type:"drag",target:e})},e._onDragStart=function(){e._invokeEvent("dragstart",{type:"dragstart",target:e})},e._onDragEnd=function(){e._invokeEvent("dragend",{type:"dragend",target:e})},e._bubbleElementEvent=function(t){e._invokeEvent(t.type,{type:t.type,target:e})},e._onEleDragStart=function(t){t.preventDefault()},e.options=(new Ds).merge(qo(t,Ds._cloneCustomizer)),e._buildMarker(e.options),e}var Fs=function(t,e,r){(void 0===r||nt(t[e],r))&&(void 0!==r||e in t)||ye(t,e,r)},js=function(t){return function(e,r,i){for(var n=-1,o=Object(e),a=i(e),s=a.length;s--;){var l=a[t?s:++n];if(!1===r(o[l],l,o))break}return e}}(),Us=function(t){return we(t)&&Ke(t)},Vs=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]},qs=function(t){return xe(t,tr(t))},Gs=function(t,e,r,i,n,o,a){var s=Vs(t,r),l=Vs(e,r),c=a.get(l);if(c)Fs(t,r,c);else{var u=o?o(s,l,r+"",t,e,a):void 0,p=void 0===u;if(p){var h=Ae(l),d=!h&&Pe(l),f=!h&&!d&&Fe(l);u=l,h||d||f?u=Ae(s)?s:Us(s)?ir(s):d?rr(l,!(p=!1)):f?qr(l,!(p=!1)):[]:Is(l)||Ce(l)?Ce(u=s)?u=qs(s):Ot(s)&&!Mt(s)||(u=Kr(l)):p=!1}p&&(a.set(l,u),n(u,l,i,o,a),a.delete(l)),Fs(t,r,u)}},Zs=function t(e,r,i,n,o){e!==r&&js(r,(function(a,s){if(o=o||new fe,Ot(a))Gs(e,r,s,i,t,n,o);else{var l=n?n(Vs(e,s),a,s+"",e,r,o):void 0;void 0===l&&(l=a),Fs(e,s,l)}}),tr)};function Hs(t){return t}var Ws=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},Ks=Math.max,Xs=function(t,e,r){return e=Ks(void 0===e?t.length-1:e,0),function(){for(var i=arguments,n=-1,o=Ks(i.length-e,0),a=Array(o);++n<o;)a[n]=i[e+n];n=-1;for(var s=Array(e+1);++n<e;)s[n]=i[n];return s[e]=r(a),Ws(t,this,s)}},Ys=function(t){return function(){return t}},Js=ge?function(t,e){return ge(t,"toString",{configurable:!0,enumerable:!1,value:Ys(e),writable:!0})}:Hs,$s=Date.now,Qs=function(t){var e=0,r=0;return function(){var i=$s(),n=16-(i-r);if(r=i,0<n){if(800<=++e)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Js),tl=function(t,e){return Qs(Xs(t,e,Hs),t+"")},el=function(t,e,r){if(!Ot(r))return!1;var i=typeof e;return!!("number"==i?Ke(r)&&Me(e,r.length):"string"==i&&e in r)&&nt(r[e],t)},rl=function(t){return tl((function(e,r){var i=-1,n=r.length,o=1<n?r[n-1]:void 0,a=2<n?r[2]:void 0;for(o=3<t.length&&"function"==typeof o?(n--,o):void 0,a&&el(r[0],r[1],a)&&(o=n<3?void 0:o,n=1),e=Object(e);++i<n;){var s=r[i];s&&t(e,s,i,o)}return e}))}((function(t,e,r){Zs(t,e,r)})),il=(nl.parse=function(t){var e=(t=t.toLowerCase()).lastIndexOf("-");return-1!==e?{code:t,language:t.substring(0,e),region:t.substring(e+1)}:{code:t,language:t}},nl);function nl(){}var ol={localizationsPath:"locs/mapcontrol/2019-3-12",sensitiveUserRegions:["il","kr","pk","in","cn","ar","bh","eg","jo","sa","kw","om","qa","ma","ae"],locales:{defaultLanguage:{defaultRegion:{code:"NGT",strings:"en/resource.json"}},ar:{defaultRegion:{code:"ar",strings:"ar-sa/resource.json"}},bg:{defaultRegion:{code:"bg-BG",strings:"bg-bg/resource.json"}},cs:{defaultRegion:{code:"cs-CZ",strings:"cs-cz/resource.json"}},da:{defaultRegion:{code:"da-DK",strings:"da-dk/resource.json"}},de:{defaultRegion:{code:"de-DE",strings:"de-de/resource.json"}},el:{defaultRegion:{code:"el-GR",strings:"el-gr/resource.json"}},en:{defaultRegion:{code:"en",strings:"en/resource.json"},us:{code:"en-US",strings:"en/resource.json"}},es:{defaultRegion:{code:"es-ES",strings:"es-es/resource.json"},mx:{code:"es-MX",strings:"es-mx/resource.json"}},fi:{defaultRegion:{code:"fi-FI",strings:"fi-fi/resource.json"}},fr:{defaultRegion:{code:"fr-FR",strings:"fr-fr/resource.json"}},hu:{defaultRegion:{code:"hu-HU",strings:"hu-hu/resource.json"}},id:{defaultRegion:{code:"id-ID",strings:"id-id/resource.json"}},it:{defaultRegion:{code:"it-IT",strings:"it-it/resource.json"}},ko:{defaultRegion:{code:"ko-KR",strings:"ko-kr/resource.json"}},lt:{defaultRegion:{code:"lt-LT",strings:"lt-lt/resource.json"}},ms:{defaultRegion:{code:"ms-MY",strings:"ms-my/resource.json"}},nb:{defaultRegion:{code:"nb-NO",strings:"nb-no/resource.json"}},nl:{defaultRegion:{code:"nl-NL",strings:"nl-nl/resource.json"}},pl:{defaultRegion:{code:"pl-PL",strings:"pl-pl/resource.json"}},pt:{defaultRegion:{code:"pt-PT",strings:"pt-pt/resource.json"},br:{code:"pt-BR",strings:"pt-br/resource.json"}},ru:{defaultRegion:{code:"ru-RU",strings:"ru-ru/resource.json"}},sk:{defaultRegion:{code:"sk-SK",strings:"sk-sk/resource.json"}},sl:{defaultRegion:{code:"sl-SL",strings:"sl-sl/resource.json"}},sv:{defaultRegion:{code:"sv-SE",strings:"sv-se/resource.json"}},th:{defaultRegion:{code:"th-TH",strings:"th-th/resource.json"}},tr:{defaultRegion:{code:"tr-TR",strings:"tr-tr/resource.json"}},zh:{defaultRegion:{code:"zh-Hant",strings:"zh-tw/resource.json"}},"zh-hant":{defaultRegion:{code:"zh-Hant",strings:"zh-tw/resource.json"}}}},al=function(){this.Unknown="Unknown",this.Accident="Accident",this.Fog="Fog",this.Danger="Danger",this.Rain="Rain",this.Ice="Ice",this.Jam="Jam",this.LaneClosed="Lane Closed",this.RoadClosed="Road Closed",this.RoadWorks="Road Works",this.Wind="Wind",this.Flood="Flood",this.Detour="Detour"},sl=(ll.getCode=function(t){var e=il.parse(t);return-1===ol.sensitiveUserRegions.indexOf(e.region)?this.getLocaleData(e).code:t},ll.getStrings=function(t){var e=this.getLocaleData(t);return new O({domain:l,path:ol.localizationsPath+"/"+e.strings}).get().then((function(t){return t}),(function(){return new al}))},ll.getLocaleData=function(t){if("string"==typeof t&&(t=il.parse(t)),ol.locales[t.code])return ol.locales[t.code].defaultRegion;var e;if(ol.locales[t.language])e=ol.locales[t.language];else{if(-1!==t.language.indexOf("-"))return this.getLocaleData(t.language);e=ol.locales.defaultLanguage}return t.region&&e[t.region]?e[t.region]:e.defaultRegion},ll);function ll(){}var cl,ul=(pl.getEdgeOrIEVersion=function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(0<e)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(0<t.indexOf("Trident/")){var r=t.indexOf("rv:");return parseInt(t.substring(r+3,t.indexOf(".",r)),10)}var i=t.indexOf("Edge/");return 0<i?parseInt(t.substring(i+5,t.indexOf(".",i)),10):-1},pl.isEdgeOrIE=function(){return-1!==this.getEdgeOrIEVersion()},pl.isIE=function(){var t=this.getEdgeOrIEVersion();return-1!==t&&t<=11},pl);function pl(){}(cl=e.AuthenticationType||(e.AuthenticationType={})).subscriptionKey="subscriptionKey",cl.aad="aad",cl.anonymous="anonymous";var hl,dl,fl=(w(ml,hl=I),ml.prototype.setSubscriptionKey=function(t){this.authType=e.AuthenticationType.subscriptionKey,this.subscriptionKey=t},ml.prototype.setAadProperties=function(t,r,i,n,o){this.authType=e.AuthenticationType.aad,this.authContext=o||this.authContext,this.aadInstance=n||this.aadInstance,this.clientId=t,this.aadAppId=r,this.aadTenant=i},ml.prototype.setTokenCallbackFunction=function(t){this.authType=e.AuthenticationType.anonymous,this.getToken=t},ml.prototype.merge=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=hl.prototype.merge.apply(this,t);return i.authType===e.AuthenticationType.subscriptionKey?i.authContext=i.aadAppId=i.getToken=void 0:i.authType===e.AuthenticationType.aad?i.subscriptionKey=i.getToken=void 0:i.authType===e.AuthenticationType.anonymous&&(i.subscriptionKey=i.authContext=i.aadAppId=void 0),i},ml);function ml(){var t=null!==hl&&hl.apply(this,arguments)||this;return t.authType=void 0,t.subscriptionKey=void 0,t.clientId=void 0,t.aadAppId=void 0,t.aadTenant=void 0,t.aadInstance=void 0,t.getToken=void 0,t.authContext=void 0,t}var gl="NGT",yl=rn(),vl=s,_l=c,xl=new fl,bl=!1,wl=!1,Sl=!1,Tl=!1,El=!1,Il=!1;function Cl(){return Object.assign({},xl)}function Al(){return vl}function kl(){return _l}function Pl(){return gl}function Ol(){return yl}function Ml(){return xl.authType===e.AuthenticationType.subscriptionKey?xl.subscriptionKey:void 0}function Ll(){return dl}function Dl(t){return!ul.isIE()&&n.supported({failIfMajorPerformanceCaveat:t})}function Rl(t){xl=(new fl).merge(xl,t),Il=!0}function zl(t){vl=t,wl=!0}function Nl(t){_l=t,Sl=!0}function Bl(t){gl=sl.getCode(t),Tl=!0}function Fl(t){yl=t,El=!0}function jl(t){xl.setSubscriptionKey(t),Il=!0}function Ul(t){dl=t,bl=!0}function Vl(t,e){if(e=Math.abs(e||1),"string"==typeof t&&ec[t.toLowerCase()]){for(var r=ec[t.toLowerCase()],i=/calc\(([0-9.]+)[px]*\s*\*\s*\{scale\}\)/gi,n=r,o=i.exec(r);o;)n=n.replace(o[0],parseFloat(o[1])*e+""),o=i.exec(r);return n.replace("{scale}",e+"")}throw new Error("Invalid templateName.")}function ql(){return Il}function Gl(){return wl}function Zl(){return Sl}function Hl(){return Tl}function Wl(){return El}function Kl(){return bl}var Xl,Yl,Jl,$l,Ql,tc,ec={marker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 26 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><text x="12.5" y="17.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:2"/><text x="12.5" y="18.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-circle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><circle cx="12.5" cy="12.5" r="9" fill="{secondaryColor}"/><text x="12" y="17.5" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(24 * {scale})" height="calc(28 * {scale})" viewBox="0 0 24 28"><path d="m11.988 16.615a5.15 5.15 0 0 1-2.268-.525 4.909 4.909 0 0 1-2.805-4.442 5.019 5.019 0 0 1 5.072-4.936h.012a5.03 5.03 0 0 1 5.085 4.961 4.907 4.907 0 0 1-.549 2.224 5.114 5.114 0 0 1-4.548 2.718zm0-8.06a3.173 3.173 0 0 0-3.226 3.099 3.081 3.081 0 0 0 1.77 2.782 3.299 3.299 0 0 0 4.365-1.386 3.049 3.049 0 0 0 .342-1.381 3.184 3.184 0 0 0-3.239-3.114h-.012z" fill="{secondaryColor}"/><path d="m11.999.922a10.908 10.908 0 0 0-11.076 10.732 10.639 10.639 0 0 0 4.418 8.598l6.658 6.464 6.658-6.463a10.537 10.537 0 0 0 2.198-15.041 11.182 11.182 0 0 0-8.856-4.289zm1.873 14.341a4.221 4.221 0 0 1-5.589-1.789 3.945 3.945 0 0 1-.445-1.8 4.164 4.164 0 0 1 8.323-.037 4.028 4.028 0 0 1-2.289 3.626Z" fill="{color}"/><path d="m11.999 28-7.256-7.044a11.611 11.611 0 0 1-4.743-9.303 11.844 11.844 0 0 1 11.988-11.652.102 .102 0 0 1 .02 0 12.164 12.164 0 0 1 9.577 4.647 11.357 11.357 0 0 1 2.299 8.614 11.521 11.521 0 0 1-4.63 7.695zm-.01-26.157a9.997 9.997 0 0 0-10.143 9.812 9.769 9.769 0 0 0 4.04 7.853l.099.083 6.014 5.838 6.113-5.922a9.7 9.7 0 0 0 3.945-6.505 9.533 9.533 0 0 0-1.933-7.229 10.305 10.305 0 0 0-8.116-3.931h-.021zm.021 14.772a5.11 5.11 0 0 1-4.547-2.718 4.868 4.868 0 0 1 .932-5.743 5.118 5.118 0 0 1 3.58-1.46h.024a5.031 5.031 0 0 1 5.084 4.938 4.92 4.92 0 0 1-2.805 4.457h0a5.152 5.152 0 0 1-2.269.525zm-.011-8.079h-.015a3.277 3.277 0 0 0-2.295.933 3.029 3.029 0 0 0-.587 3.58 3.297 3.297 0 0 0 4.364 1.386h0a3.092 3.092 0 0 0 1.772-2.795 3.185 3.185 0 0 0-3.239-3.105z" fill="{secondaryColor}"/><text x="12" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"pin-round":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25 * {scale})" height="calc(25 * {scale})" viewBox="0 0 25 25"><g transform="translate(0 1)"><circle cx="12.25" cy="11.5833" r="11" fill="{color}"/><path d="m12.25 23.583a12 12 0 1 1 12-12 12 12 0 0 1-12 12zm0-22a10 10 0 1 0 10 10 10 10 0 0 0-10-10z" fill="{secondaryColor}"/><circle cx="12.25" cy="11.5833" r="4.2386" fill="{secondaryColor}"/></g><text x="12.5" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-flat":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(42.8 * {scale})"  viewBox="0 0 1600 2570"><g fill="{color}"><path d="M691 2419c-409-575-641-1086-683-1504-10-106-10-136 5-224 31-188 105-330 241-458 129-124 270-190 453-214 69-9 113-10 182-1 373 46 655 326 703 698 40 308-120 801-424 1309-134 224-348 535-369 535-4 0-53-63-108-141z"/></g><g fill="rgba(0,0,0,0.15)" style="transform:scale(-1,1);transform-origin:center"><path d="M691 2419c-407-571-639-1083-682-1498-14-139-3-249 37-371 69-208 254-402 459-481 68-27 217-59 271-59h24v160 180 940 635c0 349-2 635-5 635-2 0-49-63-104-141z"/></g><circle cx="800" cy="800" r="600" fill="{secondaryColor}"/><text x="800" y="1100" style="font-size:800px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-arrow":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25.47 * {scale})" height="calc(35.18 * {scale})" viewBox="0 0 4330 5980"><g fill="{color}"><path d="m2080 5969c-49-20-93-63-115-113-25-55-1928-5486-1953-5573-40-138 67-282 210-283 36 0 246 73 987 345 518 190 947 345 955 345 8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29-33 0-71-5-85-10z"/></g><g fill="{secondaryColor}"><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z"/><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z" style="transform:scale(-1,1);transform-origin:center"/></g><g fill="rgba(0,0,0,0.2)" ><path d="m2165 685c8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29z"/></g><text x="2165" y="3300" style="font-size:2500px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-ball-pin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15.67 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 235 452"><g transform="translate(-135 10)"><path fill="{secondaryColor}" d="m256 442 0 0c-13 0-18-11-18-24l-6-323c0-13 11-24 24-24h0c13 0 24 11 24 24l-6 323c0 13-5 24-18 24z"/><circle style="fill:{color};stroke-width:10;stroke:{secondaryColor}" cx="256" cy="112" r="111"/><ellipse transform="matrix(0.834 0.5518 -0.5518 0.834 65.7916 -97.18)" fill="rgba(255,255,255,0.3)" cx="194.399" cy="60.749" rx="19.076" ry="32.428"/></g><text x="117.5" y="160" style="font-size:160px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.67 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2000 2420"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M845 2152c-22-37-58-95-80-129-22-35-62-99-90-143l-50-80-312 0-313 0 0-900 0-900 900 0 900 0 0 900 0 900-313 0-313 0-34 58c-19 31-38 59-42 60-5 2-8 8-8 12 0 9-69 123-88 145-5 6-11 15-13 21-16 39-77 123-89 124-8 0-33-31-55-68z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(38.8 * {scale})" viewBox="0 0 2500 2910"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m866 2652c-17-31-37-68-46-82-9-14-32-54-51-90-19-36-50-92-70-125l-36-60-332-3-331-2 0-905 0-905 660 0 660 0 0-38c0-71 50-196 102-258 71-85 189-164 244-164 12 0 26-4 29-10 8-13 222-13 230 0 3 6 17 10 30 10 25 0 117 45 154 76 130 107 191 232 191 392 0 155-63 284-190 386-36 29-129 76-150 76-11 0-22 5-25 10-3 6-31 10-61 10l-54 0 0 660 0 660-332 2-332 3-29 50c-17 28-48 84-70 125-22 41-47 86-56 100-9 14-30 51-46 83-17 32-36 57-45 57-8 0-28-25-44-58z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.8 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2010 2410"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M856 2155c-20-30-36-59-36-65 0-5-4-10-10-10-5 0-10-5-10-11 0-5-18-37-40-69-22-32-40-64-40-69 0-6-4-11-10-11-5 0-10-5-10-10 0-6-15-33-32-60l-33-50-127 0c-74 0-129-4-133-10-3-5-17-10-30-10-25 0-116-45-155-76-87-69-142-151-178-265-15-46-17-1075-2-1084 5-3 10-17 10-30 0-13 5-27 10-30 6-3 10-13 10-22 0-22 83-135 122-168 57-46 62-50 112-75l50-25 585 0 586 0 63 34c84 46 169 133 212 218l35 68 0 565 0 565-28 59c-32 69-100 157-139 180-15 9-33 22-40 29-23 22-99 57-123 57-13 0-27 5-30 10-4 6-60 10-135 10l-128 0-128 205c-84 136-133 205-144 205-10 0-33-24-54-55z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(32.13 * {scale})" viewBox="0 0 2500 2900"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m874 2669c-9-18-26-49-37-68-11-20-30-55-43-78-13-24-36-64-51-90-14-27-38-69-52-95l-26-48-142 0c-84 0-144-4-148-10-3-5-17-10-30-10-25 0-118-46-154-76-91-76-136-142-175-254-13-38-16-119-16-554 0-358 3-520 12-545 40-125 106-219 195-278 127-84 116-83 646-83l467 0 0-42c0-46 11-87 45-163 54-121 169-220 306-264 46-14 232-14 278 0 165 53 284 175 340 350 19 61 14 204-10 273-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-3 6-28 10-56 10l-49 0 0 462c0 446-1 464-21 522-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-4 6-65 10-149 10-138 0-143 1-154 23-12 23-62 114-112 202-16 28-44 79-63 115-42 77-67 88-93 39z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',flag:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(23.5 * {scale})" height="calc(40 * {scale})" viewBox="34 28 198 308"><path style="stroke:{secondaryColor};stroke-width:15;stroke-linecap:round;" d="M42 327l0 -291"/><path style="fill:{color};stroke:{secondaryColor};stroke-width:10;stroke-linejoin:round;" d="M49 50c70 30 104 28 178 2-21 42-21 74 0 116-72 25-101 25-178 0l0-118z"/><text x="130" y="165" style="font-size:100px;fill:#fff;text-anchor:middle">{text}</text></svg>',"flag-triangle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(35.33 * {scale})" viewBox="0 0 40.5 53"><g transform="translate(-31 -20)"><path fill="{secondaryColor}" d="M34.7,73.3V48.4l34.6-10.1c0.7-0.2,1.2-0.8,1.2-1.5s-0.4-1.4-1-1.7L33.7,20.5c-0.5-0.2-1.1-0.2-1.6,0.2 c-0.5,0.3-0.7,0.8-0.7,1.4v51.2H34.7z"/><polygon points="34.7,24.5 66,36.5 34.7,45 34.7,10" fill="{color}"/></g><text x="11" y="21" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(34 * {scale})" height="calc(34 * {scale})" viewBox="0 0 34 34"><g transform="translate(2 2)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17" y="22" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(38 * {scale})" height="calc(38 * {scale})" viewBox="0 0 38 38"><g transform="translate(4 4)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19" y="24" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',triangle:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(36 * {scale})" height="calc(36 * {scale})" viewBox="0 0 36 36"><g transform="translate(2 2)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="30" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><g transform="translate(4 4)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="32" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',hexagon:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(35 * {scale})" height="calc(40 * {scale})" viewBox="0 0 35 40"><g transform="translate(2 2)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="25" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(39 * {scale})" height="calc(44 * {scale})" viewBox="0 0 39 44"><g transform="translate(4 4)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="27" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1100 1100"><g transform="translate(50 50)"><path style="stroke:{secondaryColor};stroke-width:50;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="550" y="700" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1200 1200"><g transform="translate(100 100)"><path style="stroke:{secondaryColor};stroke-width:100;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="600" y="750" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="12,0 0,24 12,17 24,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="17" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-left":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="24,12 0,0 7,12 0,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="16.5" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(12.16 * {scale})" height="calc(30.1 * {scale})" viewBox="0 0 902 364"><g fill="{color}" transform="matrix(0,2.4,-2.4,0,897,-930)"><polygon points="902,222 233,222 233,364 0,182 233,0 233,141 902,141 902,222"/></g><text x="450" y="700" style="font-size:900px;fill:#000;text-anchor:middle">{text}</text></svg>',"arrow-up-thin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 12 25"><g transform="translate(-136.91823 -751.91998)"><path fill="{color}" d="m148.271 760.71c-1.641-.547-3.186-1.47-4.633-2.769l0 18.07-1.675 0 0-18.07c-1.447 1.299-2.986 2.222-4.616 2.769l0-1.231c2.325-1.596 4.006-3.812 5.043-6.65l.838 0c1.037 2.838 2.718 5.055 5.043 6.65l0 1.231z"/></g><text x="6" y="20" style="font-size:10px;fill:#000;text-anchor:middle">{text}</text></svg>',car:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(21.93 * {scale})" height="calc(40.9 * {scale})" viewBox="0 0 6580 12270"><g transform="translate(0 12270) rotate(-90)"><path fill="{secondaryColor}" d="M7045 6566c-42-13-105-44-105-51 0-2 23-105 50-228 28-123 50-230 50-236 0-8-241-11-907-11-855 0-1145 6-1513 30-85 6-189 13-230 15-41 3-133 10-205 15-286 21-430 32-705 50-953 63-1459 18-2335-205-304-77-746-209-799-238-131-72-221-408-285-1062-34-345-42-532-48-1130-16-1557 108-2532 336-2649 32-17 469-149 676-205 409-110 819-191 1205-238 116-14 224-18 540-18 395 1 494 5 1140 50 1124 79 1224 82 2496 78l641-3-53-237c-29-131-52-238-51-239 1-1 31-14 66-29 56-23 76-26 142-23 67 3 83 7 120 33 23 17 50 41 61 55 10 14 51 117 91 230l73 205 674 3 675 2 90-39c98-43 198-72 315-93 122-21 829-18 990 5 321 45 626 143 849 270 293 168 516 378 704 662 266 402 416 893 467 1527 15 174 8 882-9 998-6 41-18 127-27 190-69 502-253 969-523 1325-79 105-262 284-381 374-189 142-355 229-574 300-336 110-526 139-952 148-457 9-685-23-887-124l-47-24-678-6-678-6-64 179c-79 224-92 253-121 284-67 70-177 97-274 66zm-2752-5073c-23-2-64-2-90 0-26 2-7 3 42 3 50 0 71-1 48-3zm395 0c-21-2-55-2-75 0-21 2-4 4 37 4 41 0 58-2 38-4z"/><path fill="{color}" d="M7043 6498c-13-6-23-19-23-28 0-9 23-117 50-240 28-123 50-230 50-237 0-22-2126-13-2465 10-132 10-400 28-595 42-661 47-824 55-1160 62-435 7-656-8-1040-73-415-70-865-183-1447-365-168-53-272-556-325-1569-16-319-16-1311 0-1630 45-872 129-1366 257-1518 22-26 51-39 172-77 557-177 1122-310 1563-369 271-36 351-40 690-40 361 1 463 6 1165 54 1122 78 1288 83 2337 79 460-2 840-7 843-11 4-4-17-117-47-252l-55-245 39-16c76-30 180-8 224 47 10 13 54 124 98 246l79 222 709 0 709 0 47-24c74-37 219-83 322-101 122-22 606-32 802-16 374 29 658 102 933 238 124 62 271 155 361 230l61 51 6 100c19 278 103 497 247 643 88 89 173 136 278 152l70 11 41 131c116 369 159 673 168 1170 10 584-38 984-167 1397l-40 126-70 12c-193 33-348 175-441 405-56 139-89 302-89 445 0 43-3 47-58 91-290 235-644 384-1068 450-191 29-796 39-974 16-135-18-263-54-368-102l-75-35-701 0-701 0-79 223c-82 232-102 267-163 293-38 16-138 17-170 2zm-2023-820c332-15 1155-12 1835 6 308 8 563 12 566 8 4-4 10-21 13-38 7-30 6-31-92-77-518-244-1197-396-2112-474-295-25-1282-25-1579 0-231 20-473 46-479 51-6 7 49 110 93 171 160 226 416 335 855 365 142 10 539 5 900-12zm3304-263c525-111 899-887 934-1935 19-557-37-1023-172-1435-186-563-521-900-896-899-81 0-158 14-525 92-426 91-431 92-540 146-195 96-287 207-306 368-12 104-11 2985 1 3078 22 170 135 291 365 389 49 21 191 55 480 115 226 47 419 87 430 89 45 10 164 6 229-8zm-5570-485c112-43 197-156 216-291 12-83 13-2623 1-2706-23-158-125-273-270-304-44-9-100-1-542 75-272 47-514 91-539 98-266 68-487 424-594 958-56 280-70 548-40 800 56 484 207 878 414 1081 115 114 122 116 702 218 277 49 524 90 550 90 26 1 72-8 102-19zm2111-3440c1023-44 1884-213 2462-486l113-53-7-33c-3-18-8-35-10-37-2-3-236 1-521 7-993 24-1271 26-1708 11-541-18-1128-18-1249-1-377 56-588 181-734 437-32 55-41 79-32 84 12 8 246 32 491 51 356 28 815 36 1195 20z"/></g><text x="3250" y="8250" style="font-size:3000px;fill:#fff;text-anchor:middle">{text}</text></svg>',checker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 16 16"><pattern id="p" x="0" y="0" width="16" height="16" patternUnits="userSpaceOnUse"><rect fill="{color}" x="0" width="8" height="8" y="0"/><rect fill="{color}" x="8" width="8" height="8" y="8"/></pattern><rect x="0" y="0" width="16" height="16" fill="{secondaryColor}"/><rect x="0" y="0" width="16" height="16" fill="url(#p)"/></svg>',"checker-rotated":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 60 60"><rect width="60" height="60" fill="{secondaryColor}"/><rect width="42.42" height="42.42" transform="translate(30 0) rotate(45)" fill="{color}"/></svg>',"zig-zag":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 120 60 120 90 90 120 60 120 0 120 0 60 60 0 0 0 60 30 90 60 120 120 120"/></svg>',"zig-zag-vertical":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 0 120 60 90 30 60 0 0 0 0 0 60 60 0 120 60 120 90 90 120 60 120 0"/></svg>',"circles-spaced":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="2" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',circles:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(7 * {scale})" height="calc(7 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="6" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',"diagonal-lines-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-lines-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-stripes-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"diagonal-stripes-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(14 * {scale})" height="calc(14 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(45 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}" transform="rotate(-45 3 3)"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-stripes":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"x-fill":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="45.3" height="45.3" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z"/></g></svg>',dots:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(13 * {scale})" height="calc(13 * {scale})" viewBox="0 0 20 20"><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><g fill="{color}"><circle cx="3" cy="3" r="3"/><circle cx="13" cy="13" r="3"/></g></svg>'},rc=(ic.getHighContrastMode=function(){return matchMedia("(-ms-high-contrast: white-on-black)").matches?"dark":matchMedia("(-ms-high-contrast: black-on-white)").matches?"light":matchMedia("(-ms-high-contrast: active)").matches?"dark":matchMedia("(inverted-colors: inverted)").matches?"invert":null},ic);function ic(){}(Yl=Xl=Xl||{})[Yl.LocalStorage=0]="LocalStorage",Yl[Yl.SessionStorage=1]="SessionStorage",($l=Jl=Jl||{})[$l.Default=0]="Default",$l[$l.Required=1]="Required",$l[$l.Array=2]="Array",$l[$l.Hidden=4]="Hidden",(tc=Ql=Ql||{})[tc.AI=0]="AI",tc[tc.AI_AND_W3C=1]="AI_AND_W3C",tc[tc.W3C=2]="W3C";var nc=2,oc=(ac.isNullOrUndefined=function(t){return null==t},ac.disableCookies=function(){ac._canUseCookies=!1},ac.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(cc,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},ac);function ac(){}var sc,lc,cc=/[xy]/g,uc=(pc.prototype.addNotificationListener=function(t){this.listeners.push(t)},pc.prototype.removeNotificationListener=function(t){for(var e=this.listeners.indexOf(t);-1<e;)this.listeners.splice(e,1),e=this.listeners.indexOf(t)},pc.prototype.eventsSent=function(t){for(var e=this,r=function(r){i.listeners[r].eventsSent&&setTimeout((function(){return e.listeners[r].eventsSent(t)}),0)},i=this,n=0;n<this.listeners.length;++n)r(n)},pc.prototype.eventsDiscarded=function(t,e){for(var r=this,i=function(i){n.listeners[i].eventsDiscarded&&setTimeout((function(){return r.listeners[i].eventsDiscarded(t,e)}),0)},n=this,o=0;o<this.listeners.length;++o)i(o)},pc);function pc(){this.listeners=[]}(lc=sc=sc||{})[lc.CRITICAL=1]="CRITICAL",lc[lc.WARNING=2]="WARNING";var hc=0,dc=1,fc=2,mc=3,gc=4,yc=5,vc=6,_c=7,xc=8,bc=9,wc=10,Sc=11,Tc=12,Ec=13,Ic=14,Cc=15,Ac=16,kc=17,Pc=18,Oc=19,Mc=20,Lc=22,Dc=23,Rc=24,zc=25,Nc=26,Bc=27,Fc=28,jc=29,Uc=30,Vc=31,qc=32,Gc=33,Zc=35,Hc=36,Wc=37,Kc=38,Xc=39,Yc=40,Jc=41,$c=42,Qc=43,tu=45,eu=46,ru=47,iu=48,nu=49,ou=50,au=52,su=54,lu=55,cu=56,uu=57,pu=58,hu=60,du=61,fu=62,mu=63,gu=64,yu=66,vu=67,_u=68,xu=69,bu=70,wu=71,Su=(Tu.sanitizeDiagnosticText=function(t){return'"'+t.replace(/\"/g,"")+'"'},Tu.dataType="MessageData",Tu.AiNonUserActionablePrefix="AI (Internal): ",Tu.AiUserActionablePrefix="AI: ",Tu);function Tu(t,e,r,i){void 0===r&&(r=!1),this.messageId=t,this.message=(r?Tu.AiUserActionablePrefix:Tu.AiNonUserActionablePrefix)+t;var n=(e?" message:"+Tu.sanitizeDiagnosticText(e):"")+(i?" props:"+Tu.sanitizeDiagnosticText(JSON.stringify(i)):"");this.message+=n}var Eu=(Iu.prototype.throwInternal=function(t,e,r,i,n){void 0===n&&(n=!1);var o=new Su(e,r,n,i);if(this.enableDebugExceptions())throw o;if(void 0!==o&&o&&void 0!==o.message){if(n){var a=+o.messageId;(!this._messageLogged[a]||this.consoleLoggingLevel()>=sc.WARNING)&&(this.warnToConsole(o.message),this._messageLogged[a]=!0)}else this.consoleLoggingLevel()>=sc.WARNING&&this.warnToConsole(o.message);this.logInternalMessage(t,o)}},Iu.prototype.warnToConsole=function(t){"undefined"!=typeof console&&console&&("function"==typeof console.warn?console.warn(t):"function"==typeof console.log&&console.log(t))},Iu.prototype.resetInternalMessageCount=function(){this._messageCount=0,this._messageLogged={}},Iu.prototype.logInternalMessage=function(t,e){if(!this._areInternalMessagesThrottled()){var r=!0,i=this.AIInternalMessagePrefix+e.messageId;if(this._messageLogged[i]?r=!1:this._messageLogged[i]=!0,r&&(t<=this.telemetryLoggingLevel()&&(this.queue.push(e),this._messageCount++),this._messageCount==this.maxInternalMessageLimit())){var n="Internal events throttle limit per PageView reached for this app.",o=new Su(Dc,n,!1);this.queue.push(o),this.warnToConsole(n)}}},Iu.prototype._areInternalMessagesThrottled=function(){return this._messageCount>=this.maxInternalMessageLimit()},Iu);function Iu(t){this.AIInternalMessagePrefix="AITR_",this.enableDebugExceptions=function(){return!1},this.consoleLoggingLevel=function(){return 0},this.telemetryLoggingLevel=function(){return 1},this.maxInternalMessageLimit=function(){return 25},this.queue=[],this._messageCount=0,this._messageLogged={},oc.isNullOrUndefined(t)||(oc.isNullOrUndefined(t.loggingLevelConsole)||(this.consoleLoggingLevel=function(){return t.loggingLevelConsole}),oc.isNullOrUndefined(t.loggingLevelTelemetry)||(this.telemetryLoggingLevel=function(){return t.loggingLevelTelemetry}),oc.isNullOrUndefined(t.maxMessageLimit)||(this.maxInternalMessageLimit=function(){return t.maxMessageLimit}),oc.isNullOrUndefined(t.enableDebugExceptions)||(this.enableDebugExceptions=function(){return t.enableDebugExceptions}))}var Cu=(Au.prototype.processTelemetry=function(t){this.channelQueue.forEach((function(e){0<e.length&&e[0].processTelemetry(t)}))},Object.defineProperty(Au.prototype,"ChannelControls",{get:function(){return this.channelQueue},enumerable:!0,configurable:!0}),Au.prototype.initialize=function(t,e,r){var i=this;if(t.isCookieUseDisabled&&oc.disableCookies(),this.channelQueue=new Array,t.channels){var n=void 0;t.channels.forEach((function(o){if(o&&0<o.length){o=o.sort((function(t,e){return t.priority-e.priority}));for(var a=1;a<o.length;a++)o[a-1].setNextPlugin(o[a]);if(o.forEach((function(i){i.priority<500&&(n=i.identifier),i.initialize(t,e,r)})),n)throw Error("Channel has invalid priority"+n);i.channelQueue.push(o)}}))}for(var o=new Array,a=0;a<r.length;a++){var s=r[a];500<s.priority&&o.push(s)}if(0<o.length){for(o=o.sort((function(t,e){return t.priority-e.priority})),a=1;a<o.length;a++)o[a-1].setNextPlugin(o[a]);o.forEach((function(i){return i.initialize(t,e,r)})),this.channelQueue.push(o)}},Au);function Au(){this.identifier="ChannelControllerPlugin",this.priority=500}var ku=(Pu.prototype.initialize=function(t,e){var r=this;if(this._isInitialized)throw Error("Core should not be initialized more than once");if(!t||oc.isNullOrUndefined(t.instrumentationKey))throw Error("Please provide instrumentation key");this.config=t,this._notificationManager=new uc,this.config.extensions=oc.isNullOrUndefined(this.config.extensions)?[]:this.config.extensions,this.config.extensionConfig=oc.isNullOrUndefined(this.config.extensionConfig)?{}:this.config.extensionConfig,this.config.extensionConfig.NotificationManager=this._notificationManager,this.logger=new Eu(t),(n=this._extensions).push.apply(n,e.concat(this.config.extensions)),this._extensions.forEach((function(t){var e=!0;if((oc.isNullOrUndefined(t)||oc.isNullOrUndefined(t.initialize))&&(e=!1),!e)throw Error("Extensions must provide callback to initialize")})),this._extensions.push(this._channelController),this._extensions=this._extensions.sort((function(t,e){var r=typeof t.processTelemetry,i=typeof e.processTelemetry;return"function"==r&&"function"==i?t.priority-e.priority:"function"==r&&"function"!=i?1:"function"!=r&&"function"==i?-1:void 0}));var i={};this._extensions.forEach((function(t){var e=t;e&&e.priority&&(oc.isNullOrUndefined(i[e.priority])?i[e.priority]=e.identifier:r.logger.warnToConsole("Two extensions have same priority"+i[e.priority]+", "+e.identifier))}));for(var n,o=-1,a=0;a<this._extensions.length-1;a++){var s=this._extensions[a];if(!s||"function"==typeof s.processTelemetry){if(s.priority===this._channelController.priority){o=a+1;break}this._extensions[a].setNextPlugin(this._extensions[a+1])}}if(this._channelController.initialize(this.config,this,this._extensions),this._extensions.forEach((function(t){t&&t.priority<r._channelController.priority&&t.initialize(r.config,r,r._extensions)})),o<this._extensions.length&&this._extensions.splice(o),0===this.getTransmissionControls().length)throw new Error("No channels available");this._isInitialized=!0},Pu.prototype.getTransmissionControls=function(){return this._channelController.ChannelControls},Pu.prototype.track=function(t){if(null===t)throw this._notifyInvalidEvent(t),Error("Invalid telemetry item");t.iKey||(t.iKey=this.config.instrumentationKey),t.time||(t.time=(new Date).toISOString()),oc.isNullOrUndefined(t.ver)&&(t.ver="4.0"),this._validateTelmetryItem(t),0==this._extensions.length&&this._channelController.processTelemetry(t);for(var e=0;e<this._extensions.length;){if(this._extensions[e].processTelemetry){this._extensions[e].processTelemetry(t);break}e++}},Pu.prototype.addNotificationListener=function(t){this._notificationManager.addNotificationListener(t)},Pu.prototype.removeNotificationListener=function(t){this._notificationManager.removeNotificationListener(t)},Pu.prototype.pollInternalLogs=function(t){var e=this,r=this.config.diagnosticLogInterval;return 0<r||(r=1e4),setInterval((function(){var r=e.logger.queue;r.forEach((function(r){var i={name:t||"InternalMessageId: "+r.messageId,iKey:e.config.instrumentationKey,time:(new Date).toISOString(),baseType:Su.dataType,baseData:{message:r.message}};e.track(i)})),r.length=0}),r)},Pu.prototype._validateTelmetryItem=function(t){if(oc.isNullOrUndefined(t.name))throw this._notifyInvalidEvent(t),Error("telemetry name required");if(oc.isNullOrUndefined(t.time))throw this._notifyInvalidEvent(t),Error("telemetry timestamp required");if(oc.isNullOrUndefined(t.iKey))throw this._notifyInvalidEvent(t),Error("telemetry instrumentationKey required")},Pu.prototype._notifyInvalidEvent=function(t){this._notificationManager.eventsDiscarded([t],nc)},Pu);function Pu(){this._isInitialized=!1,this._extensions=new Array,this._channelController=new Cu}var Ou=(Mu.requestContextHeader="Request-Context",Mu.requestContextTargetKey="appId",Mu.requestContextAppIdFormat="appId=cid-v1:",Mu.requestIdHeader="Request-Id",Mu.traceParentHeader="traceparent",Mu.sdkContextHeader="Sdk-Context",Mu.sdkContextHeaderAppIdRequest="appId",Mu.requestContextHeaderLowerCase="request-context",Mu);function Mu(){}var Lu=(Du.sanitizeKeyAndAddUniqueness=function(t,e,r){var i=e.length,n=Du.sanitizeKey(t,e);if(n.length!==i){for(var o=0,a=n;void 0!==r[a];)o++,a=n.substring(0,Du.MAX_NAME_LENGTH-3)+Du.padNumber(o);n=a}return n},Du.sanitizeKey=function(t,e){var r;return e&&(e=Du.trim(e.toString())).length>Du.MAX_NAME_LENGTH&&(r=e.substring(0,Du.MAX_NAME_LENGTH),t.throwInternal(sc.WARNING,uu,"name is too long.  It has been truncated to "+Du.MAX_NAME_LENGTH+" characters.",{name:e},!0)),r||e},Du.sanitizeString=function(t,e,r){var i;return void 0===r&&(r=Du.MAX_STRING_LENGTH),e&&(r=r||Du.MAX_STRING_LENGTH,(e=Du.trim(e)).toString().length>r&&(i=e.toString().substring(0,r),t.throwInternal(sc.WARNING,du,"string value is too long. It has been truncated to "+r+" characters.",{value:e},!0))),i||e},Du.sanitizeUrl=function(t,e){return Du.sanitizeInput(t,e,Du.MAX_URL_LENGTH,yu)},Du.sanitizeMessage=function(t,e){var r;return e&&e.length>Du.MAX_MESSAGE_LENGTH&&(r=e.substring(0,Du.MAX_MESSAGE_LENGTH),t.throwInternal(sc.WARNING,cu,"message is too long, it has been truncated to "+Du.MAX_MESSAGE_LENGTH+" characters.",{message:e},!0)),r||e},Du.sanitizeException=function(t,e){var r;return e&&e.length>Du.MAX_EXCEPTION_LENGTH&&(r=e.substring(0,Du.MAX_EXCEPTION_LENGTH),t.throwInternal(sc.WARNING,au,"exception is too long, it has been truncated to "+Du.MAX_EXCEPTION_LENGTH+" characters.",{exception:e},!0)),r||e},Du.sanitizeProperties=function(t,e){if(e){var r={};for(var i in e){var n=e[i];if("object"==typeof n&&"undefined"!=typeof JSON)try{n=JSON.stringify(n)}catch(e){t.throwInternal(sc.WARNING,nu,"custom property is not valid",{exception:e},!0)}n=Du.sanitizeString(t,n,Du.MAX_PROPERTY_LENGTH),r[i=Du.sanitizeKeyAndAddUniqueness(t,i,r)]=n}e=r}return e},Du.sanitizeMeasurements=function(t,e){if(e){var r={};for(var i in e){var n=e[i];r[i=Du.sanitizeKeyAndAddUniqueness(t,i,r)]=n}e=r}return e},Du.sanitizeId=function(t,e){return e?Du.sanitizeInput(t,e,Du.MAX_ID_LENGTH,xu).toString():e},Du.sanitizeInput=function(t,e,r,i){var n;return e&&(e=Du.trim(e)).length>r&&(n=e.substring(0,r),t.throwInternal(sc.WARNING,i,"input is too long, it has been truncated to "+r+" characters.",{data:e},!0)),n||e},Du.padNumber=function(t){var e="00"+t;return e.substr(e.length-3)},Du.trim=function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"")},Du.MAX_NAME_LENGTH=150,Du.MAX_ID_LENGTH=128,Du.MAX_PROPERTY_LENGTH=8192,Du.MAX_STRING_LENGTH=1024,Du.MAX_URL_LENGTH=2048,Du.MAX_MESSAGE_LENGTH=32768,Du.MAX_EXCEPTION_LENGTH=32768,Du);function Du(){}var Ru=(zu.createDomEvent=function(t){var e=null;return"function"==typeof Event?e=new Event(t):(e=document.createEvent("Event")).initEvent(t,!0,!0),e},zu.disableStorage=function(){zu._canUseLocalStorage=!1,zu._canUseSessionStorage=!1},zu._getLocalStorageObject=function(){return zu.canUseLocalStorage()?zu._getVerifiedStorageObject(Xl.LocalStorage):null},zu._getVerifiedStorageObject=function(t){var e,r,i=null;try{if("undefined"==typeof window)return null;r=new Date,(i=t===Xl.LocalStorage?window.localStorage:window.sessionStorage).setItem(r,r),e=i.getItem(r)!=r,i.removeItem(r),e&&(i=null)}catch(t){i=null}return i},zu.isInternalApplicationInsightsEndpoint=function(t){return-1!==zu._internalEndpoints.indexOf(t.toLowerCase())},zu.canUseLocalStorage=function(){return void 0===zu._canUseLocalStorage&&(zu._canUseLocalStorage=!!zu._getVerifiedStorageObject(Xl.LocalStorage)),zu._canUseLocalStorage},zu.getStorage=function(t,e){var r=zu._getLocalStorageObject();if(null!==r)try{return r.getItem(e)}catch(e){zu._canUseLocalStorage=!1,t.throwInternal(sc.WARNING,dc,"Browser failed read of local storage. "+zu.getExceptionName(e),{exception:zu.dump(e)})}return null},zu.setStorage=function(t,e,r){var i=zu._getLocalStorageObject();if(null!==i)try{return i.setItem(e,r),!0}catch(e){zu._canUseLocalStorage=!1,t.throwInternal(sc.WARNING,mc,"Browser failed write to local storage. "+zu.getExceptionName(e),{exception:zu.dump(e)})}return!1},zu.removeStorage=function(t,e){var r=zu._getLocalStorageObject();if(null!==r)try{return r.removeItem(e),!0}catch(e){zu._canUseLocalStorage=!1,t.throwInternal(sc.WARNING,yc,"Browser failed removal of local storage item. "+zu.getExceptionName(e),{exception:zu.dump(e)})}return!1},zu._getSessionStorageObject=function(){return zu.canUseSessionStorage()?zu._getVerifiedStorageObject(Xl.SessionStorage):null},zu.canUseSessionStorage=function(){return void 0===zu._canUseSessionStorage&&(zu._canUseSessionStorage=!!zu._getVerifiedStorageObject(Xl.SessionStorage)),zu._canUseSessionStorage},zu.getSessionStorageKeys=function(){var t=[];if(zu.canUseSessionStorage())for(var e in window.sessionStorage)t.push(e);return t},zu.getSessionStorage=function(t,e){var r=zu._getSessionStorageObject();if(null!==r)try{return r.getItem(e)}catch(e){zu._canUseSessionStorage=!1,t.throwInternal(sc.WARNING,fc,"Browser failed read of session storage. "+zu.getExceptionName(e),{exception:zu.dump(e)})}return null},zu.setSessionStorage=function(t,e,r){var i=zu._getSessionStorageObject();if(null!==i)try{return i.setItem(e,r),!0}catch(e){zu._canUseSessionStorage=!1,t.throwInternal(sc.WARNING,gc,"Browser failed write to session storage. "+zu.getExceptionName(e),{exception:zu.dump(e)})}return!1},zu.removeSessionStorage=function(t,e){var r=zu._getSessionStorageObject();if(null!==r)try{return r.removeItem(e),!0}catch(e){zu._canUseSessionStorage=!1,t.throwInternal(sc.WARNING,vc,"Browser failed removal of session storage item. "+zu.getExceptionName(e),{exception:zu.dump(e)})}return!1},zu.disableCookies=function(){oc.disableCookies()},zu.canUseCookies=function(t){if(void 0===oc._canUseCookies){oc._canUseCookies=!1;try{oc._canUseCookies=void 0!==zu.document.cookie}catch(r){t.throwInternal(sc.WARNING,_u,"Cannot access document.cookie - "+zu.getExceptionName(r),{exception:zu.dump(r)})}}return oc._canUseCookies},zu.setCookie=function(t,e,r,i){var n="",o="";i&&(n=";domain="+i),zu.document.location&&"https:"===zu.document.location.protocol&&(o=";secure"),zu.canUseCookies(t)&&(zu.document.cookie=e+"="+r+n+";path=/"+o)},zu.stringToBoolOrDefault=function(t,e){return void 0===e&&(e=!1),null==t?e:"true"===t.toString().toLowerCase()},zu.getCookie=function(t,e){if(zu.canUseCookies(t)){var r="";if(e&&e.length)for(var i=e+"=",n=zu.document.cookie.split(";"),o=0;o<n.length;o++){var a=n[o];if((a=zu.trim(a))&&0===a.indexOf(i)){r=a.substring(i.length,n[o].length);break}}return r}},zu.deleteCookie=function(t,e){zu.canUseCookies(t)&&(zu.document.cookie=e+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},zu.trim=function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"")},zu.newId=function(){for(var t="",e=1073741824*Math.random();0<e;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e%64),e=Math.floor(e/64);return t},zu.random32=function(){return 4294967296*Math.random()|0},zu.generateW3CId=function(){for(var t,e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",i=0;i<4;i++)r+=e[15&(t=zu.random32())]+e[t>>4&15]+e[t>>8&15]+e[t>>12&15]+e[t>>16&15]+e[t>>20&15]+e[t>>24&15]+e[t>>28&15];var n=e[8+4*Math.random()|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+n+r.substr(16,3)+r.substr(19,12)},zu.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},zu.isError=function(t){return"[object Error]"===Object.prototype.toString.call(t)},zu.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},zu.toISOStringForIE8=function(t){if(zu.isDate(t)){if(Date.prototype.toISOString)return t.toISOString();var e=function(t){var e=String(t);return 1===e.length&&(e="0"+e),e};return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},zu.getIEVersion=function(t){void 0===t&&(t=null);var e=t?t.toLowerCase():navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")?parseInt(e.split("msie")[1]):null},zu.msToTimeSpan=function(t){(isNaN(t)||t<0)&&(t=0);var e=""+(t=Math.round(t))%1e3,r=""+Math.floor(t/1e3)%60,i=""+Math.floor(t/6e4)%60,n=""+Math.floor(t/36e5)%24,o=Math.floor(t/864e5);return e=1===e.length?"00"+e:2===e.length?"0"+e:e,r=r.length<2?"0"+r:r,i=i.length<2?"0"+i:i,(0<o?o+".":"")+(n=n.length<2?"0"+n:n)+":"+i+":"+r+"."+e},zu.isCrossOriginError=function(t,e,r,i,n){return("Script error."===t||"Script error"===t)&&!n},zu.dump=function(t){var e=Object.prototype.toString.call(t),r=JSON.stringify(t);return"[object Error]"===e&&(r="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t.name+"'"),e+r},zu.getExceptionName=function(t){return"[object Error]"===Object.prototype.toString.call(t)?t.name:""},zu.addEventHandler=function(t,e){if("undefined"==typeof window||!window||"string"!=typeof t||"function"!=typeof e)return!1;var r="on"+t;if(window.addEventListener)window.addEventListener(t,e,!1);else{if(!window.attachEvent)return!1;window.attachEvent(r,e)}return!0},zu.IsBeaconApiSupported=function(){return"sendBeacon"in navigator&&navigator.sendBeacon},zu.getExtension=function(t,e){for(var r=null,i=0;!r&&i<t.length;)t[i]&&t[i].identifier===e&&(r=t[i]),i++;return r},zu.document="undefined"!=typeof document?document:{},zu._canUseLocalStorage=void 0,zu._canUseSessionStorage=void 0,zu._internalEndpoints=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],zu.NotSpecified="not_specified",zu);function zu(){}var Nu=(Bu.parseUrl=function(t){return Bu.htmlAnchorElement||(Bu.htmlAnchorElement=Bu.document.createElement?Bu.document.createElement("a"):{host:Bu.parseHost(t)}),Bu.htmlAnchorElement.href=t,Bu.htmlAnchorElement},Bu.getAbsoluteUrl=function(t){var e,r=Bu.parseUrl(t);return r&&(e=r.href),e},Bu.getPathName=function(t){var e,r=Bu.parseUrl(t);return r&&(e=r.pathname),e},Bu.getCompleteUrl=function(t,e){return t?t.toUpperCase()+" "+e:e},Bu.parseHost=function(t){var e=t.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=e&&2<e.length&&"string"==typeof e[2]&&0<e[2].length?e[2]:null},Bu.document="undefined"!=typeof document?document:{},Bu);function Bu(){}var Fu=(ju.canIncludeCorrelationHeader=function(t,e,r){if(t&&t.disableCorrelationHeaders)return!1;if(!e)return!1;var i=Nu.parseUrl(e).host.toLowerCase();if(!(t&&t.enableCorsCorrelation||i===r))return!1;var n,o=t&&t.correlationHeaderDomains;if(o&&(o.forEach((function(t){var e=new RegExp(t.toLowerCase().replace(/\./g,".").replace(/\*/g,".*"));n=n||e.test(i)})),!n))return!1;var a=t&&t.correlationHeaderExcludedDomains;if(!a||0==a.length)return!0;for(var s=0;s<a.length;s++)if(new RegExp(a[s].toLowerCase().replace(/\./g,".").replace(/\*/g,".*")).test(i))return!1;return!0},ju.getCorrelationContext=function(t){if(t){var e=ju.getCorrelationContextValue(t,Ou.requestContextTargetKey);if(e&&e!==ju.correlationIdPrefix)return e}},ju.getCorrelationContextValue=function(t,e){if(t)for(var r=t.split(","),i=0;i<r.length;++i){var n=r[i].split("=");if(2==n.length&&n[0]==e)return n[1]}},ju.correlationIdPrefix="cid-v1:",ju);function ju(){}var Uu=(Vu.ParseDependencyPath=function(t,e,r,i){var n,o=i,a=i;if(e&&0<e.length){var s=Nu.parseUrl(e);if(n=s.host,!o)if(null!=s.pathname){var l=0===s.pathname.length?"/":s.pathname;"/"!==l.charAt(0)&&(l="/"+l),a=s.pathname,o=Lu.sanitizeString(t,r?r+" "+l:l)}else o=Lu.sanitizeString(t,e)}else o=n=i;return{target:n,name:o,data:a}},Vu);function Vu(){}var qu=(Gu.Now="undefined"!=typeof window&&window.performance&&window.performance.now&&window.performance.timing?function(){return window.performance.now()+window.performance.timing.navigationStart}:function(){return(new Date).getTime()},Gu.GetDuration=function(t,e){var r=null;return 0===t||0===e||oc.isNullOrUndefined(t)||oc.isNullOrUndefined(e)||(r=e-t),r},Gu);function Gu(){}var Zu,Hu="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Wu="ProcessLegacy",Ku="http.method",Xu=(w(Yu,Zu=function(){}),Yu);function Yu(){return Zu.call(this)||this}var Ju,$u=(w(Qu,Ju=function(){this.ver=1,this.sampleRate=100,this.tags={}}),Qu);function Qu(t,e,r){var i=Ju.call(this)||this;return i.name=Lu.sanitizeString(t,r)||Ru.NotSpecified,i.data=e,i.time=Ru.toISOStringForIE8(new Date),i.aiDataContract={time:Jl.Required,iKey:Jl.Required,name:Jl.Required,sampleRate:function(){return 100==i.sampleRate?Jl.Hidden:Jl.Required},tags:Jl.Required,data:Jl.Required},i}function tp(){}var ep,rp=(w(ip,ep=tp),ip);function ip(){var t=ep.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}var np,op=(w(ap,np=rp),ap.envelopeType="Microsoft.ApplicationInsights.{0}.Event",ap.dataType="EventData",ap);function ap(t,e,r,i){var n=np.call(this)||this;return n.aiDataContract={ver:Jl.Required,name:Jl.Required,properties:Jl.Default,measurements:Jl.Default},n.name=Lu.sanitizeString(t,e)||Ru.NotSpecified,n.properties=Lu.sanitizeProperties(t,r),n.measurements=Lu.sanitizeMeasurements(t,i),n}function sp(){}var lp,cp=(w(up,lp=tp),up);function up(){var t=lp.call(this)||this;return t.ver=2,t.exceptions=[],t.properties={},t.measurements={},t}function pp(){this.hasFullStack=!0,this.parsedStack=[]}var hp,dp=(w(fp,hp=cp),fp.CreateFromInterface=function(t,e){var r=e.exceptions&&e.exceptions.map((function(e){return gp.CreateFromInterface(t,e)}));return new fp(t,S({},e,{exceptions:r}))},fp.prototype.toInterface=function(){var t=this.exceptions,e=this.properties,r=this.measurements,i=this.severityLevel,n=this.ver,o=this.problemGroup,a=this.id,s=this.isManual;return{ver:n,exceptions:t instanceof Array&&t.map((function(t){return t.toInterface()}))||void 0,severityLevel:i,properties:e,measurements:r,problemGroup:o,id:a,isManual:s}},fp.CreateSimpleException=function(t,e,r,i,n,o){return{exceptions:[{hasFullStack:!0,message:t,stack:n,typeName:e}]}},fp.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",fp.dataType="ExceptionData",fp);function fp(t,e,r,i,n,o){var a=hp.call(this)||this;return a.aiDataContract={ver:Jl.Required,exceptions:Jl.Required,severityLevel:Jl.Default,properties:Jl.Default,measurements:Jl.Default},e instanceof Error?(a.exceptions=[new gp(t,e)],a.properties=Lu.sanitizeProperties(t,r),a.measurements=Lu.sanitizeMeasurements(t,i),n&&(a.severityLevel=n),o&&(a.id=o)):(a.exceptions=e.exceptions,a.properties=e.properties,a.measurements=e.measurements,e.severityLevel&&(a.severityLevel=e.severityLevel),e.id&&(a.id=e.id),e.problemGroup&&(a.problemGroup=e.problemGroup),oc.isNullOrUndefined(e.ver)||(a.ver=e.ver),oc.isNullOrUndefined(e.isManual)||(a.isManual=e.isManual)),a}var mp,gp=(w(yp,mp=pp),yp.prototype.toInterface=function(){var t=this.parsedStack instanceof Array&&this.parsedStack.map((function(t){return t.toInterface()}));return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:t||void 0}},yp.CreateFromInterface=function(t,e){var r=e.parsedStack instanceof Array&&e.parsedStack.map((function(t){return _p.CreateFromInterface(t)}))||e.parsedStack;return new yp(t,S({},e,{parsedStack:r}))},yp.parseStack=function(t){var e=void 0;if("string"==typeof t){var r=t.split("\n");e=[];for(var i=0,n=0,o=0;o<=r.length;o++){var a=r[o];if(_p.regex.test(a)){var s=new _p(r[o],i++);n+=s.sizeInBytes,e.push(s)}}if(32768<n)for(var l=0,c=e.length-1,u=0,p=l,h=c;l<c;){if(32768<(u+=e[l].sizeInBytes+e[c].sizeInBytes)){var d=h-p+1;e.splice(p,d);break}p=l,h=c,l++,c--}}return e},yp);function yp(t,e){var r=mp.call(this)||this;if(r.aiDataContract={id:Jl.Default,outerId:Jl.Default,typeName:Jl.Required,message:Jl.Required,hasFullStack:Jl.Default,stack:Jl.Default,parsedStack:Jl.Array},e instanceof Error){r.typeName=Lu.sanitizeString(t,e.name)||Ru.NotSpecified,r.message=Lu.sanitizeMessage(t,e.message)||Ru.NotSpecified;var i=e.stack;r.parsedStack=yp.parseStack(i),r.stack=Lu.sanitizeException(t,i),r.hasFullStack=Ru.isArray(r.parsedStack)&&0<r.parsedStack.length}else r.typeName=e.typeName,r.message=e.message,r.stack=e.stack,r.parsedStack=e.parsedStack,r.hasFullStack=e.hasFullStack;return r}var vp,_p=(w(xp,vp=sp),xp.CreateFromInterface=function(t){return new xp(t,null)},xp.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},xp.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,xp.baseSize=58,xp);function xp(t,e){var r=vp.call(this)||this;if(r.sizeInBytes=0,r.aiDataContract={level:Jl.Required,method:Jl.Required,assembly:Jl.Default,fileName:Jl.Default,line:Jl.Default},"string"==typeof t){var i=t;r.level=e,r.method="<no_method>",r.assembly=Ru.trim(i),r.fileName="",r.line=0;var n=i.match(xp.regex);n&&5<=n.length&&(r.method=Ru.trim(n[2])||r.method,r.fileName=Ru.trim(n[4]),r.line=parseInt(n[5])||0)}else r.level=t.level,r.method=t.method,r.assembly=t.assembly,r.fileName=t.fileName,r.line=t.line,r.sizeInBytes=0;return r.sizeInBytes+=r.method.length,r.sizeInBytes+=r.fileName.length,r.sizeInBytes+=r.assembly.length,r.sizeInBytes+=xp.baseSize,r.sizeInBytes+=r.level.toString().length,r.sizeInBytes+=r.line.toString().length,r}var bp,wp,Sp,Tp=(w(Ep,bp=tp),Ep);function Ep(){var t=bp.call(this)||this;return t.ver=2,t.metrics=[],t.properties={},t}(Sp=wp=wp||{})[Sp.Measurement=0]="Measurement",Sp[Sp.Aggregation=1]="Aggregation";var Ip,Cp=(w(Ap,Ip=function(){this.kind=wp.Measurement}),Ap);function Ap(){var t=null!==Ip&&Ip.apply(this,arguments)||this;return t.aiDataContract={name:Jl.Required,kind:Jl.Default,value:Jl.Required,count:Jl.Default,min:Jl.Default,max:Jl.Default,stdDev:Jl.Default},t}var kp,Pp=(w(Op,kp=Tp),Op.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",Op.dataType="MetricData",Op);function Op(t,e,r,i,n,o,a){var s=kp.call(this)||this;s.aiDataContract={ver:Jl.Required,metrics:Jl.Required,properties:Jl.Default};var l=new Cp;return l.count=0<i?i:void 0,l.max=isNaN(o)||null===o?void 0:o,l.min=isNaN(n)||null===n?void 0:n,l.name=Lu.sanitizeString(t,e)||Ru.NotSpecified,l.value=r,s.metrics=[l],s.properties=Lu.sanitizeProperties(t,a),s}var Mp,Lp=(w(Dp,Mp=rp),Dp);function Dp(){var t=Mp.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}var Rp,zp=(w(Np,Rp=Lp),Np.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",Np.dataType="PageviewData",Np);function Np(t,e,r,i,n,o,a){var s=Rp.call(this)||this;return s.aiDataContract={ver:Jl.Required,name:Jl.Default,url:Jl.Default,duration:Jl.Default,properties:Jl.Default,measurements:Jl.Default,id:Jl.Default},s.id=Lu.sanitizeId(t,a),s.url=Lu.sanitizeUrl(t,r),s.name=Lu.sanitizeString(t,e)||Ru.NotSpecified,isNaN(i)||(s.duration=Ru.msToTimeSpan(i)),s.properties=Lu.sanitizeProperties(t,n),s.measurements=Lu.sanitizeMeasurements(t,o),s}var Bp,Fp=(w(jp,Bp=tp),jp);function jp(){var t=Bp.call(this)||this;return t.ver=2,t.success=!0,t.properties={},t.measurements={},t}var Up,Vp=(w(qp,Up=Fp),qp.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",qp.dataType="RemoteDependencyData",qp);function qp(t,e,r,i,n,o,a,s,l,c,u,p){void 0===l&&(l="Ajax");var h=Up.call(this)||this;h.aiDataContract={id:Jl.Required,ver:Jl.Required,name:Jl.Default,resultCode:Jl.Default,duration:Jl.Default,success:Jl.Default,data:Jl.Default,target:Jl.Default,type:Jl.Default,properties:Jl.Default,measurements:Jl.Default,kind:Jl.Default,value:Jl.Default,count:Jl.Default,min:Jl.Default,max:Jl.Default,stdDev:Jl.Default,dependencyKind:Jl.Default,dependencySource:Jl.Default,commandName:Jl.Default,dependencyTypeName:Jl.Default},h.id=e,h.duration=Ru.msToTimeSpan(n),h.success=o,h.resultCode=a+"",h.type=Lu.sanitizeString(t,l);var d=Uu.ParseDependencyPath(t,r,s,i);return h.data=Lu.sanitizeUrl(t,i)||d.data,h.target=Lu.sanitizeString(t,d.target),c&&(h.target=h.target+" | "+c),h.name=Lu.sanitizeString(t,d.name),h.properties=Lu.sanitizeProperties(t,u),h.measurements=Lu.sanitizeMeasurements(t,p),h}var Gp,Zp=(w(Hp,Gp=tp),Hp);function Hp(){var t=Gp.call(this)||this;return t.ver=2,t.properties={},t}var Wp,Kp=(w(Xp,Wp=Zp),Xp.envelopeType="Microsoft.ApplicationInsights.{0}.Message",Xp.dataType="MessageData",Xp);function Xp(t,e,r,i){var n=Wp.call(this)||this;return n.aiDataContract={ver:Jl.Required,message:Jl.Required,severityLevel:Jl.Default,properties:Jl.Default},e=e||Ru.NotSpecified,n.message=Lu.sanitizeMessage(t,e),n.properties=Lu.sanitizeProperties(t,i),r&&(n.severityLevel=r),n}var Yp,Jp=(w($p,Yp=Lp),$p);function $p(){var t=Yp.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}var Qp,th=(w(eh,Qp=Jp),eh.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",eh.dataType="PageviewPerformanceData",eh);function eh(t,e,r,i,n,o,a){var s=Qp.call(this)||this;return s.aiDataContract={ver:Jl.Required,name:Jl.Default,url:Jl.Default,duration:Jl.Default,perfTotal:Jl.Default,networkConnect:Jl.Default,sentRequest:Jl.Default,receivedResponse:Jl.Default,domProcessing:Jl.Default,properties:Jl.Default,measurements:Jl.Default},s.url=Lu.sanitizeUrl(t,r),s.name=Lu.sanitizeString(t,e)||Ru.NotSpecified,s.properties=Lu.sanitizeProperties(t,n),s.measurements=Lu.sanitizeMeasurements(t,o),a&&(s.domProcessing=a.domProcessing,s.duration=a.duration,s.networkConnect=a.networkConnect,s.perfTotal=a.perfTotal,s.receivedResponse=a.receivedResponse,s.sentRequest=a.sentRequest),s}var rh,ih,nh,oh=(w(ah,rh=Xu),ah);function ah(t,e){var r=rh.call(this)||this;return r.aiDataContract={baseType:Jl.Required,baseData:Jl.Required},r.baseType=t,r.baseData=e,r}(nh=ih=ih||{})[nh.Verbose=0]="Verbose",nh[nh.Information=1]="Information",nh[nh.Warning=2]="Warning",nh[nh.Error=3]="Error",nh[nh.Critical=4]="Critical";var sh=(lh.getConfig=function(t,e,r,i){var n;return void 0===i&&(i=!1),n=r&&t.extensionConfig&&t.extensionConfig[r]&&!oc.isNullOrUndefined(t.extensionConfig[r][e])?t.extensionConfig[r][e]:t[e],oc.isNullOrUndefined(n)?i:n},lh);function lh(){}var ch=function(){this.applicationVersion="ai.application.ver",this.applicationBuild="ai.application.build",this.applicationTypeId="ai.application.typeId",this.applicationId="ai.application.applicationId",this.applicationLayer="ai.application.layer",this.deviceId="ai.device.id",this.deviceIp="ai.device.ip",this.deviceLanguage="ai.device.language",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceFriendlyName="ai.device.friendlyName",this.deviceNetwork="ai.device.network",this.deviceNetworkName="ai.device.networkName",this.deviceOEMName="ai.device.oemName",this.deviceOS="ai.device.os",this.deviceOSVersion="ai.device.osVersion",this.deviceRoleInstance="ai.device.roleInstance",this.deviceRoleName="ai.device.roleName",this.deviceScreenResolution="ai.device.screenResolution",this.deviceType="ai.device.type",this.deviceMachineName="ai.device.machineName",this.deviceVMName="ai.device.vmName",this.deviceBrowser="ai.device.browser",this.deviceBrowserVersion="ai.device.browserVersion",this.locationIp="ai.location.ip",this.locationCountry="ai.location.country",this.locationProvince="ai.location.province",this.locationCity="ai.location.city",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationRootId="ai.operation.rootId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.sessionIsNew="ai.session.isNew",this.userAccountAcquisitionDate="ai.user.accountAcquisitionDate",this.userAccountId="ai.user.accountId",this.userAgent="ai.user.userAgent",this.userId="ai.user.id",this.userStoreRegion="ai.user.storeRegion",this.userAuthUserId="ai.user.authUserId",this.userAnonymousUserAcquisitionDate="ai.user.anonUserAcquisitionDate",this.userAuthenticatedUserAcquisitionDate="ai.user.authUserAcquisitionDate",this.cloudName="ai.cloud.name",this.cloudRole="ai.cloud.role",this.cloudRoleVer="ai.cloud.roleVer",this.cloudRoleInstance="ai.cloud.roleInstance",this.cloudEnvironment="ai.cloud.environment",this.cloudLocation="ai.cloud.location",this.cloudDeploymentUnit="ai.cloud.deploymentUnit",this.internalNodeName="ai.internal.nodeName",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion"},uh=(ph.create=function(t,e,r,i,n,o){if(r=Lu.sanitizeString(i,r)||Ru.NotSpecified,oc.isNullOrUndefined(t)||oc.isNullOrUndefined(e)||oc.isNullOrUndefined(r))throw Error("Input doesn't contain all required fields");var a={name:r,time:(new Date).toISOString(),iKey:"",ext:o||{},tags:[],data:{},baseType:e,baseData:t};if(!oc.isNullOrUndefined(n))for(var s in n)n.hasOwnProperty(s)&&(a.data[s]=n[s]);return a},ph);function ph(){}var hh=(dh.UserExt="user",dh.DeviceExt="device",dh.TraceExt="trace",dh.WebExt="web",dh.AppExt="app",dh.OSExt="os",dh.SessionExt="ses",dh.SDKExt="sdk",dh);function dh(){}var fh=new ch,mh="AppInsightsPropertiesPlugin",gh="AppInsightsChannelPlugin",yh=(vh.prototype.trackPageView=function(t,e){var r=this,i=t.name;!oc.isNullOrUndefined(i)&&"string"==typeof i||(t.name=window.document&&window.document.title||"");var n=t.uri;if(!oc.isNullOrUndefined(n)&&"string"==typeof n||(t.uri=window.location&&window.location.href||""),!this._pageViewPerformanceManager.isPerformanceTimingSupported())return this.appInsights.sendPageViewInternal(t,e),this._channel().forEach((function(t){t.forEach((function(t){return t.flush(!0)}))})),void this._logger.throwInternal(sc.WARNING,zc,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var o=!1,a=void 0,s=this._pageViewPerformanceManager.getPerformanceTiming().navigationStart;a=qu.GetDuration(s,+new Date),this._pageViewPerformanceManager.shouldCollectDuration(a)||(a=void 0);var l=void 0;oc.isNullOrUndefined(e)||oc.isNullOrUndefined(e.duration)||(l=e.duration),!this.overridePageViewDuration&&isNaN(l)||(isNaN(l)&&((e=e||{}).duration=a),this.appInsights.sendPageViewInternal(t,e),this._channel().forEach((function(t){t.forEach((function(t){return t.flush(!0)}))})),o=!0),e=e||{};var c=setInterval((function(){try{if(r._pageViewPerformanceManager.isPerformanceTimingDataReady()){clearInterval(c);var l={name:i,uri:n};r._pageViewPerformanceManager.populatePageViewPerformanceEvent(l),l.isValid||o?(o||(e.duration=l.durationMs,r.appInsights.sendPageViewInternal(t,e)),r.pageViewPerformanceSent||(r.appInsights.sendPageViewPerformanceInternal(l,e),r.pageViewPerformanceSent=!0),r._channel().forEach((function(t){t.forEach((function(t){return t.flush(!0)}))}))):(e.duration=a,r.appInsights.sendPageViewInternal(t,e),r._channel().forEach((function(t){t.forEach((function(t){return t.flush(!0)}))})))}else 6e4<qu.GetDuration(s,+new Date)&&(clearInterval(c),o||(e.duration=6e4,r.appInsights.sendPageViewInternal(t,e),r._channel().forEach((function(t){t.forEach((function(t){return t.flush(!0)}))}))))}catch(l){r._logger.throwInternal(sc.CRITICAL,Kc,"trackPageView failed on page load calculation: "+Ru.getExceptionName(l),{exception:Ru.dump(l)})}}),100)},vh);function vh(t,e,r,i){this.pageViewPerformanceSent=!1,this.overridePageViewDuration=!1,this.overridePageViewDuration=e,this.appInsights=t,this._pageViewPerformanceManager=i,r&&(this._channel=function(){return r.getTransmissionControls()},this._logger=r.logger)}var _h=(xh.prototype.trackPreviousPageVisit=function(t,e){try{var r=this.restartPageVisitTimer(t,e);r&&this.pageVisitTimeTrackingHandler(r.pageName,r.pageUrl,r.pageVisitTime)}catch(t){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+Ru.dump(t))}},xh.prototype.restartPageVisitTimer=function(t,e){try{var r=this.stopPageVisitTimer();return this.startPageVisitTimer(t,e),r}catch(t){return this._logger.warnToConsole("Call to restart failed: "+Ru.dump(t)),null}},xh.prototype.startPageVisitTimer=function(t,e){try{if(Ru.canUseSessionStorage()){if(null!=Ru.getSessionStorage(this._logger,this.prevPageVisitDataKeyName))throw new Error("Cannot call startPageVisit consecutively without first calling stopPageVisit");var r=new bh(t,e),i=JSON.stringify(r);Ru.setSessionStorage(this._logger,this.prevPageVisitDataKeyName,i)}}catch(t){this._logger.warnToConsole("Call to start failed: "+Ru.dump(t))}},xh.prototype.stopPageVisitTimer=function(){try{if(Ru.canUseSessionStorage()){var t=Date.now(),e=Ru.getSessionStorage(this._logger,this.prevPageVisitDataKeyName);if(e){var r=JSON.parse(e);return r.pageVisitTime=t-r.pageVisitStartTime,Ru.removeSessionStorage(this._logger,this.prevPageVisitDataKeyName),r}return null}return null}catch(t){return this._logger.warnToConsole("Stop page visit timer failed: "+Ru.dump(t)),null}},xh);function xh(t,e){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=e,this._logger=t}var bh=function(t,e){this.pageVisitStartTime=Date.now(),this.pageName=t,this.pageUrl=e},wh=(Sh.prototype.populatePageViewPerformanceEvent=function(t){t.isValid=!1;var e=this.getPerformanceTiming();if(e){var r=qu.GetDuration(e.navigationStart,e.loadEventEnd),i=qu.GetDuration(e.navigationStart,e.connectEnd),n=qu.GetDuration(e.requestStart,e.responseStart),o=qu.GetDuration(e.responseStart,e.responseEnd),a=qu.GetDuration(e.responseEnd,e.loadEventEnd);0==r?this._logger.throwInternal(sc.WARNING,wc,"error calculating page view performance.",{total:r,network:i,request:n,response:o,dom:a}):this.shouldCollectDuration(r,i,n,o,a)?r<Math.floor(i)+Math.floor(n)+Math.floor(o)+Math.floor(a)?this._logger.throwInternal(sc.WARNING,xc,"client performance math error.",{total:r,network:i,request:n,response:o,dom:a}):(t.durationMs=r,t.perfTotal=t.duration=Ru.msToTimeSpan(r),t.networkConnect=Ru.msToTimeSpan(i),t.sentRequest=Ru.msToTimeSpan(n),t.receivedResponse=Ru.msToTimeSpan(o),t.domProcessing=Ru.msToTimeSpan(a),t.isValid=!0):this._logger.throwInternal(sc.WARNING,tu,"Invalid page load duration value. Browser perf data won't be sent.",{total:r,network:i,request:n,response:o,dom:a})}},Sh.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?window.performance.timing:null},Sh.prototype.isPerformanceTimingSupported=function(){return"undefined"!=typeof window&&window.performance&&window.performance.timing},Sh.prototype.isPerformanceTimingDataReady=function(){var t=window.performance.timing;return 0<t.domainLookupStart&&0<t.navigationStart&&0<t.responseStart&&0<t.requestStart&&0<t.loadEventEnd&&0<t.responseEnd&&0<t.connectEnd&&0<t.domLoading},Sh.prototype.shouldCollectDuration=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=["googlebot","adsbot-google","apis-google","mediapartners-google"],i=navigator.userAgent,n=!1;if(i)for(var o=0;o<r.length;o++)n=n||-1!==i.toLowerCase().indexOf(r[o]);if(n)return!1;for(var a=0;a<t.length;a++)if(t[a]>=this.MAX_DURATION_ALLOWED)return!1;return!0},Sh);function Sh(t){this.MAX_DURATION_ALLOWED=36e5,t&&(this._logger=t.logger)}var Th="duration",Eh=(Ih.getDefaultConfig=function(t){return(t=t||{}).sessionRenewalMs=18e5,t.sessionExpirationMs=864e5,t.disableExceptionTracking=Ru.stringToBoolOrDefault(t.disableExceptionTracking),t.autoTrackPageVisitTime=Ru.stringToBoolOrDefault(t.autoTrackPageVisitTime),t.overridePageViewDuration=Ru.stringToBoolOrDefault(t.overridePageViewDuration),(isNaN(t.samplingPercentage)||t.samplingPercentage<=0||100<=t.samplingPercentage)&&(t.samplingPercentage=100),t.isCookieUseDisabled=Ru.stringToBoolOrDefault(t.isCookieUseDisabled),t.isStorageUseDisabled=Ru.stringToBoolOrDefault(t.isStorageUseDisabled),t.isBrowserLinkTrackingEnabled=Ru.stringToBoolOrDefault(t.isBrowserLinkTrackingEnabled),t.enableAutoRouteTracking=Ru.stringToBoolOrDefault(t.enableAutoRouteTracking),t.namePrefix=t.namePrefix||"",t},Ih.prototype.processTelemetry=function(t){for(var e=!1,r=this._telemetryInitializers.length,i=0;i<r;++i){var n=this._telemetryInitializers[i];if(n)try{if(!1===n.apply(null,[t])){e=!0;break}}catch(t){this._logger.throwInternal(sc.CRITICAL,gu,"One of telemetry initializers failed, telemetry item will not be sent: "+Ru.getExceptionName(t),{exception:Ru.dump(t)},!0)}}e||oc.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(t)},Ih.prototype.setNextPlugin=function(t){this._nextPlugin=t},Ih.prototype.trackEvent=function(t,e){try{var r=uh.create(t,op.dataType,op.envelopeType,this._logger,e);this.core.track(r)}catch(t){this._logger.throwInternal(sc.WARNING,Xc,"trackTrace failed, trace will not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype.startTrackEvent=function(t){try{this._eventTracking.start(t)}catch(t){this._logger.throwInternal(sc.CRITICAL,jc,"startTrackEvent failed, event will not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype.stopTrackEvent=function(t,e,r){try{this._eventTracking.stop(t,void 0,e)}catch(t){this._logger.throwInternal(sc.CRITICAL,Uc,"stopTrackEvent failed, event will not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype.trackTrace=function(t,e){try{var r=uh.create(t,Kp.dataType,Kp.envelopeType,this._logger,e);this.core.track(r)}catch(t){this._logger.throwInternal(sc.WARNING,Xc,"trackTrace failed, trace will not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype.trackMetric=function(t,e){try{var r=uh.create(t,Pp.dataType,Pp.envelopeType,this._logger,e);this.core.track(r)}catch(t){this._logger.throwInternal(sc.CRITICAL,Hc,"trackMetric failed, metric will not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype.trackPageView=function(t,e){try{var r=t||{};this._pageViewManager.trackPageView(r,S({},r.properties,r.measurements,e)),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(r.name,r.uri)}catch(t){this._logger.throwInternal(sc.CRITICAL,Wc,"trackPageView failed, page view will not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype.sendPageViewInternal=function(t,e,r){"undefined"!=typeof document&&(t.refUri=void 0===t.refUri?document.referrer:t.refUri);var i=uh.create(t,zp.dataType,zp.envelopeType,this._logger,e,r);this.core.track(i),this._trackAjaxAttempts=0},Ih.prototype.sendPageViewPerformanceInternal=function(t,e,r){var i=uh.create(t,th.dataType,th.envelopeType,this._logger,e,r);this.core.track(i)},Ih.prototype.trackPageViewPerformance=function(t,e){try{this._pageViewPerformanceManager.populatePageViewPerformanceEvent(t),this.sendPageViewPerformanceInternal(t,e)}catch(t){this._logger.throwInternal(sc.CRITICAL,Wc,"trackPageViewPerformance failed, page view will not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype.startTrackPage=function(t){try{"string"!=typeof t&&(t=window.document&&window.document.title||""),this._pageTracking.start(t)}catch(t){this._logger.throwInternal(sc.CRITICAL,Vc,"startTrackPage failed, page view may not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype.stopTrackPage=function(t,e,r,i){try{"string"!=typeof t&&(t=window.document&&window.document.title||""),"string"!=typeof e&&(e=window.location&&window.location.href||""),this._pageTracking.stop(t,e,r,i),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(t,e)}catch(t){this._logger.throwInternal(sc.CRITICAL,qc,"stopTrackPage failed, page view will not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype.sendExceptionInternal=function(t,e,r){var i=new dp(this._logger,t.exception||new Error(Ru.NotSpecified),t.properties,t.measurements,t.severityLevel,t.id).toInterface(),n=uh.create(i,dp.dataType,dp.envelopeType,this._logger,e,r);this.core.track(n)},Ih.prototype.trackException=function(t,e){try{this.sendExceptionInternal(t,e)}catch(t){this._logger.throwInternal(sc.CRITICAL,Zc,"trackException failed, exception will not be collected: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},Ih.prototype._onerror=function(t){try{var e={url:t&&t.url||document.URL,lineNumber:t.lineNumber,columnNumber:t.columnNumber,message:t.message};if(Ru.isCrossOriginError(t.message,t.url,t.lineNumber,t.columnNumber,t.error))this._sendCORSException(e.url);else{if(!Ru.isError(t.error)){var r="window.onerror@"+e.url+":"+t.lineNumber+":"+(t.columnNumber||0);t.error=new Error(t.message),t.error.stack=r}this.trackException({exception:t.error,severityLevel:ih.Error},e)}}catch(e){var i=t.error?t.error.name+", "+t.error.message:"null";this._logger.throwInternal(sc.CRITICAL,Sc,"_onError threw exception while logging error, error will not be collected: "+Ru.getExceptionName(e),{exception:Ru.dump(e),errorString:i})}},Ih.prototype.addTelemetryInitializer=function(t){this._telemetryInitializers.push(t)},Ih.prototype._initialize=function(t,e,r){var i=this;if(!this._isInitialized){if(oc.isNullOrUndefined(e))throw Error("Error initializing");this.core=e,this._logger=e.logger,this._globalconfig={instrumentationKey:t.instrumentationKey,endpointUrl:t.endpointUrl||"https://dc.services.visualstudio.com/v2/track"},this.config=t.extensionConfig&&t.extensionConfig[this.identifier]?t.extensionConfig[this.identifier]:{};var n=Ih.getDefaultConfig();if(void 0!==n){for(var o in n)this.config[o]=sh.getConfig(t,o,this.identifier,n[o]);if(this._globalconfig)for(var o in n)void 0===this._globalconfig[o]&&(this._globalconfig[o]=n[o])}this.config.isCookieUseDisabled&&Ru.disableCookies(),this.config.isStorageUseDisabled&&Ru.disableStorage();var a={instrumentationKey:function(){return t.instrumentationKey},accountId:function(){return i.config.accountId||t.accountId},sessionRenewalMs:function(){return i.config.sessionRenewalMs||t.sessionRenewalMs},sessionExpirationMs:function(){return i.config.sessionExpirationMs||t.sessionExpirationMs},sampleRate:function(){return i.config.samplingPercentage||t.samplingPercentage},cookieDomain:function(){return i.config.cookieDomain||t.cookieDomain},sdkExtension:function(){return i.config.sdkExtension||t.sdkExtension},isBrowserLinkTrackingEnabled:function(){return i.config.isBrowserLinkTrackingEnabled||t.isBrowserLinkTrackingEnabled},appId:function(){return i.config.appId||t.appId}};this._pageViewPerformanceManager=new wh(this.core),this._pageViewManager=new yh(this,this.config.overridePageViewDuration,this.core,this._pageViewPerformanceManager),this._pageVisitTimeManager=new _h(this._logger,(function(t,e,r){return i.trackPageVisitTime(t,e,r)})),this._telemetryInitializers=[],this._addDefaultTelemetryInitializers(a),this._eventTracking=new Ch(this._logger,"trackEvent"),this._eventTracking.action=function(t,e,r,n){(n=n||{})[Th]=r.toString(),i.trackEvent({name:t,properties:n})},this._pageTracking=new Ch(this._logger,"trackPageView"),this._pageTracking.action=function(t,e,r,n,o){oc.isNullOrUndefined(n)&&(n={}),n[Th]=r.toString();var a={name:t,uri:e,properties:n,measurements:o};i.sendPageViewInternal(a)};var s,l,c=this;if(!1===this.config.disableExceptionTracking&&!this.config.autoExceptionInstrumented){var u=window.onerror;window.onerror=function(t,e,r,i,n){var o=u&&u(t,e,r,i,n);return!0!==o&&c._onerror({message:t,url:e,lineNumber:r,columnNumber:i,error:n}),o},this.config.autoExceptionInstrumented=!0}if(!0===this.config.enableAutoRouteTracking&&"object"==typeof history&&"function"==typeof history.pushState&&"function"==typeof history.replaceState&&"object"==typeof window&&"undefined"!=typeof Event){var p=this;r.forEach((function(t){t.identifier===mh&&(i._properties=t)})),history.pushState=(l=history.pushState,function(){var t=l.apply(this,arguments);return window.dispatchEvent(Ru.createDomEvent(p.config.namePrefix+"pushState")),window.dispatchEvent(Ru.createDomEvent(p.config.namePrefix+"locationchange")),t}),history.replaceState=(s=history.replaceState,function(){var t=s.apply(this,arguments);return window.dispatchEvent(Ru.createDomEvent(p.config.namePrefix+"replaceState")),window.dispatchEvent(Ru.createDomEvent(p.config.namePrefix+"locationchange")),t}),window.addEventListener(p.config.namePrefix+"popstate",(function(){window.dispatchEvent(Ru.createDomEvent(p.config.namePrefix+"locationchange"))})),window.addEventListener(p.config.namePrefix+"locationchange",(function(){p._properties&&p._properties.context&&p._properties.context.telemetryTrace&&(p._properties.context.telemetryTrace.traceID=Ru.generateW3CId(),p._properties.context.telemetryTrace.name=window.location&&window.location.pathname||"_unknown_"),i._currUri&&(i._prevUri=i._currUri),i._currUri=window.location&&window.location.href||"",setTimeout(function(t){p.trackPageView({refUri:t,properties:{duration:0}})}.bind(i,i._prevUri),p.autoRoutePVDelay)}))}this._isInitialized=!0}},Ih.prototype.trackPageVisitTime=function(t,e,r){var i={PageName:t,PageUrl:e};this.trackMetric({name:"PageVisitTime",average:r,max:r,min:r,sampleCount:1},i)},Ih.prototype._addDefaultTelemetryInitializers=function(t){if(!t.isBrowserLinkTrackingEnabled()){var e=["/browserLinkSignalR/","/__browserLink/"];this._addTelemetryInitializer((function(t){if(t.baseType===Vp.dataType){var r=t.baseData;if(r)for(var i=0;i<e.length;i++)if(r.target&&0<=r.target.indexOf(e[i]))return!1}return!0}))}},Ih.prototype._addTelemetryInitializer=function(t){this._telemetryInitializers.push(t)},Ih.prototype._sendCORSException=function(t){var e={message:"Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",url:t,lineNumber:0,columnNumber:0,error:void 0},r=uh.create(e,dp.dataType,dp.envelopeType,this._logger,{url:t});this.core.track(r)},Ih.Version="2.2.2",Ih);function Ih(){this.identifier="ApplicationInsightsAnalytics",this.priority=180,this.autoRoutePVDelay=500,this._isInitialized=!1,this._trackAjaxAttempts=0,this._prevUri="object"==typeof window&&window.location&&window.location.href||"",this.initialize=this._initialize.bind(this)}var Ch=(Ah.prototype.start=function(t){void 0!==this._events[t]&&this._logger.throwInternal(sc.WARNING,fu,"start was called more than once for this event without calling stop.",{name:this._name,key:t},!0),this._events[t]=+new Date},Ah.prototype.stop=function(t,e,r,i){var n=this._events[t];if(isNaN(n))this._logger.throwInternal(sc.WARNING,mu,"stop was called without a corresponding start.",{name:this._name,key:t},!0);else{var o=+new Date,a=qu.GetDuration(n,o);this.action(t,e,a,r,i)}delete this._events[t],this._events[t]=void 0},Ah);function Ah(t,e){this._name=e,this._events={},this._logger=t}var kh=(Ph.prototype.enqueue=function(t){this._buffer.push(t)},Ph.prototype.count=function(){return this._buffer.length},Ph.prototype.clear=function(){this._buffer.length=0},Ph.prototype.getItems=function(){return this._buffer.slice(0)},Ph.prototype.batchPayloads=function(t){return t&&0<t.length?this._config.emitLineDelimitedJson()?t.join("\n"):"["+t.join(",")+"]":null},Ph.prototype.markAsSent=function(t){this.clear()},Ph.prototype.clearSent=function(t){},Ph);function Ph(t){this._config=t,this._buffer=[]}var Oh=(Mh.prototype.enqueue=function(t){this._buffer.length>=Mh.MAX_BUFFER_SIZE?this._bufferFullMessageSent||(this._logger.throwInternal(sc.WARNING,vu,"Maximum buffer size reached: "+this._buffer.length,!0),this._bufferFullMessageSent=!0):(this._buffer.push(t),this.setBuffer(Mh.BUFFER_KEY,this._buffer))},Mh.prototype.count=function(){return this._buffer.length},Mh.prototype.clear=function(){this._buffer.length=0,this.setBuffer(Mh.BUFFER_KEY,[]),this.setBuffer(Mh.SENT_BUFFER_KEY,[]),this._bufferFullMessageSent=!1},Mh.prototype.getItems=function(){return this._buffer.slice(0)},Mh.prototype.batchPayloads=function(t){return t&&0<t.length?this._config.emitLineDelimitedJson()?t.join("\n"):"["+t.join(",")+"]":null},Mh.prototype.markAsSent=function(t){this._buffer=this.removePayloadsFromBuffer(t,this._buffer),this.setBuffer(Mh.BUFFER_KEY,this._buffer);var e=this.getBuffer(Mh.SENT_BUFFER_KEY);e instanceof Array&&t instanceof Array&&((e=e.concat(t)).length>Mh.MAX_BUFFER_SIZE&&(this._logger.throwInternal(sc.CRITICAL,vu,"Sent buffer reached its maximum size: "+e.length,!0),e.length=Mh.MAX_BUFFER_SIZE),this.setBuffer(Mh.SENT_BUFFER_KEY,e))},Mh.prototype.clearSent=function(t){var e=this.getBuffer(Mh.SENT_BUFFER_KEY);e=this.removePayloadsFromBuffer(t,e),this.setBuffer(Mh.SENT_BUFFER_KEY,e)},Mh.prototype.removePayloadsFromBuffer=function(t,e){var r=[];for(var i in e){var n=!1;for(var o in t)if(t[o]===e[i]){n=!0;break}n||r.push(e[i])}return r},Mh.prototype.getBuffer=function(t){var e=t;try{e=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+e:e;var r=Ru.getSessionStorage(this._logger,e);if(r){var i=JSON.parse(r);if(i)return i}}catch(t){this._logger.throwInternal(sc.CRITICAL,$c," storage key: "+e+", "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}return[]},Mh.prototype.setBuffer=function(t,e){var r=t;try{r=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+r:r;var i=JSON.stringify(e);Ru.setSessionStorage(this._logger,r,i)}catch(t){Ru.setSessionStorage(this._logger,r,JSON.stringify([])),this._logger.throwInternal(sc.WARNING,Jc," storage key: "+r+", "+Ru.getExceptionName(t)+". Buffer cleared",{exception:Ru.dump(t)})}},Mh.BUFFER_KEY="AI_buffer",Mh.SENT_BUFFER_KEY="AI_sentBuffer",Mh.MAX_BUFFER_SIZE=2e3,Mh);function Mh(t,e){this._bufferFullMessageSent=!1,this._logger=t,this._config=e;var r=this.getBuffer(Mh.BUFFER_KEY),i=this.getBuffer(Mh.SENT_BUFFER_KEY);this._buffer=r.concat(i),this._buffer.length>Mh.MAX_BUFFER_SIZE&&(this._buffer.length=Mh.MAX_BUFFER_SIZE),this.setBuffer(Mh.SENT_BUFFER_KEY,[]),this.setBuffer(Mh.BUFFER_KEY,this._buffer)}var Lh=(Dh.extractProperties=function(t){var e=null;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];"number"!=typeof i&&((e=e||{})[r]=i)}return e},Dh.extractPropsAndMeasurements=function(t,e,r){if(!oc.isNullOrUndefined(t))for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];"number"==typeof n?r[i]=n:e[i]="string"==typeof n?n:JSON.stringify(n)}},Dh.createEnvelope=function(t,e,r,i){var n=new $u(t,i,e);n.iKey=r.iKey;var o=r.iKey.replace(/-/g,"");return n.name=n.name.replace("{0}",o),Dh.extractPartAExtensions(r,n),r.tags||(r.tags=[]),n},Dh.extractPartAExtensions=function(t,e){if(e.tags||(e.tags={}),t.ext||(t.ext={}),t.tags||(t.tags=[]),t.ext.user){t.ext.user.authId&&(e.tags[fh.userAuthUserId]=t.ext.user.authId);var r=t.ext.user.id||t.ext.user.localId;r&&(e.tags[fh.userId]=r)}if(t.ext.app&&t.ext.app.sesId&&(e.tags[fh.sessionId]=t.ext.app.sesId),t.ext.device&&((t.ext.device.id||t.ext.device.localId)&&(e.tags[fh.deviceId]=t.ext.device.id||t.ext.device.localId),t.ext.device.deviceClass&&(e.tags[fh.deviceType]=t.ext.device.deviceClass),t.ext.device.ip&&(e.tags[fh.deviceIp]=t.ext.device.ip)),t.ext.web){var i=t.ext.web;i.browserLang&&(e.tags[fh.deviceLanguage]=i.browserLang),i.browserVer&&(e.tags[fh.deviceBrowserVersion]=i.browserVer),i.browser&&(e.tags[fh.deviceBrowser]=i.browser),e.data=e.data||{},e.data.baseData=e.data.baseData||{},e.data.baseData.properties=e.data.baseData.properties||{},i.domain&&(e.data.baseData.properties.domain=i.domain),i.isManual&&(e.data.baseData.properties.isManual=i.isManual.toString()),i.screenRes&&(e.data.baseData.properties.screenRes=i.screenRes),i.userConsent&&(e.data.baseData.properties.userConsent=i.userConsent.toString())}t.ext.device&&t.ext.device.model&&(e.tags[fh.deviceModel]=t.ext.device.model),t.ext.os&&t.ext.os.name&&(e.tags[fh.deviceOS]=t.ext.os.name),t.ext.device&&t.ext.device.deviceType&&(e.tags[fh.deviceType]=t.ext.device.deviceType),t.ext.trace&&(t.ext.trace.parentID&&(e.tags[fh.operationParentId]=t.ext.trace.parentID),t.ext.trace.name&&(e.tags[fh.operationName]=t.ext.trace.name),t.ext.trace.traceID&&(e.tags[fh.operationId]=t.ext.trace.traceID));for(var n={},o=function(e){var r=t.tags[e];Object.keys(r).forEach((function(t){n[t]=r[t]})),t.tags.splice(e,1)},a=t.tags.length-1;0<=a;a--)o(a);for(var s in t.tags)n[s]=t.tags[s];e.tags=S({},e.tags,n),e.tags[fh.internalSdkVersion]||(e.tags[fh.internalSdkVersion]="javascript:"+Dh.Version)},Dh.Version="2.2.2",Dh);function Dh(){}var Rh,zh=(w(Nh,Rh=Lh),Nh.prototype.Create=function(t,e){this._logger=t,oc.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(sc.CRITICAL,eu,"telemetryItem.baseData cannot be null.");var r=e.baseData.measurements||{},i=e.baseData.properties||{};Lh.extractPropsAndMeasurements(e.data,i,r);var n=e.baseData;if(oc.isNullOrUndefined(n))return t.warnToConsole("Invalid input for dependency data"),null;var o=n.id,a=n.target,s=n.name,l=n.duration,c=n.success,u=n.responseCode,p=n.type,h=n.correlationContext,d=n.properties&&n.properties[Ku]?n.properties[Ku]:"GET",f=new Vp(t,o,a,s,l,c,u,d,p,h,i,r),m=new oh(Vp.dataType,f);return Lh.createEnvelope(t,Vp.envelopeType,e,m)},Nh.DependencyEnvelopeCreator=new Nh,Nh);function Nh(){return null!==Rh&&Rh.apply(this,arguments)||this}var Bh,Fh=(w(jh,Bh=Lh),jh.prototype.Create=function(t,e){this._logger=t,oc.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(sc.CRITICAL,eu,"telemetryItem.baseData cannot be null.");var r={},i={};e.baseType!==op.dataType&&(r.baseTypeSource=e.baseType),e.baseType===op.dataType?(r=e.baseData.properties||{},i=e.baseData.measurements||{}):e.baseData&&Lh.extractPropsAndMeasurements(e.baseData,r,i),Lh.extractPropsAndMeasurements(e.data,r,i);var n=e.baseData.name,o=new op(t,n,r,i),a=new oh(op.dataType,o);return Lh.createEnvelope(t,op.envelopeType,e,a)},jh.EventEnvelopeCreator=new jh,jh);function jh(){return null!==Bh&&Bh.apply(this,arguments)||this}var Uh,Vh=(w(qh,Uh=Lh),qh.prototype.Create=function(t,e){this._logger=t,oc.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(sc.CRITICAL,eu,"telemetryItem.baseData cannot be null.");var r=e.baseData,i=dp.CreateFromInterface(t,r),n=new oh(dp.dataType,i);return Lh.createEnvelope(t,dp.envelopeType,e,n)},qh.ExceptionEnvelopeCreator=new qh,qh);function qh(){return null!==Uh&&Uh.apply(this,arguments)||this}var Gh,Zh=(w(Hh,Gh=Lh),Hh.prototype.Create=function(t,e){this._logger=t,oc.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(sc.CRITICAL,eu,"telemetryItem.baseData cannot be null.");var r=e.baseData.properties||{},i=Lh.extractProperties(e.data);i=S({},r,i);var n=e.baseData.name,o=e.baseData.average,a=e.baseData.sampleCount,s=e.baseData.min,l=e.baseData.max,c=new Pp(t,n,o,a,s,l,i),u=new oh(Pp.dataType,c);return Lh.createEnvelope(t,Pp.envelopeType,e,u)},Hh.MetricEnvelopeCreator=new Hh,Hh);function Hh(){return null!==Gh&&Gh.apply(this,arguments)||this}var Wh,Kh=(w(Xh,Wh=Lh),Xh.prototype.Create=function(t,e){this._logger=t,oc.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(sc.CRITICAL,eu,"telemetryItem.baseData cannot be null.");var r=void 0;oc.isNullOrUndefined(e.baseData)||oc.isNullOrUndefined(e.baseData.properties)||oc.isNullOrUndefined(e.baseData.properties.duration)?oc.isNullOrUndefined(e.data)||oc.isNullOrUndefined(e.data.duration)||(r=e.data.duration,delete e.data.duration):(r=e.baseData.properties.duration,delete e.baseData.properties.duration);var i,n=e.baseData;e.ext&&e.ext.trace&&e.ext.trace.traceID&&(i=e.ext.trace.traceID);var o=n.id||i,a=n.name,s=n.uri,l=n.properties||{},c=n.measurements||{};if(oc.isNullOrUndefined(n.refUri)||(l.refUri=n.refUri),oc.isNullOrUndefined(n.pageType)||(l.pageType=n.pageType),oc.isNullOrUndefined(n.isLoggedIn)||(l.isLoggedIn=n.isLoggedIn.toString()),!oc.isNullOrUndefined(n.properties)){var u=n.properties;for(var p in u)u.hasOwnProperty(p)&&(l[p]=u[p])}Lh.extractPropsAndMeasurements(e.data,l,c);var h=new zp(t,a,s,r,l,c,o),d=new oh(zp.dataType,h);return Lh.createEnvelope(t,zp.envelopeType,e,d)},Xh.PageViewEnvelopeCreator=new Xh,Xh);function Xh(){return null!==Wh&&Wh.apply(this,arguments)||this}var Yh,Jh=(w($h,Yh=Lh),$h.prototype.Create=function(t,e){this._logger=t,oc.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(sc.CRITICAL,eu,"telemetryItem.baseData cannot be null.");var r=e.baseData,i=r.name,n=r.uri||r.url,o=r.properties||{},a=r.measurements||{};Lh.extractPropsAndMeasurements(e.data,o,a);var s=new th(t,i,n,void 0,o,a,r),l=new oh(th.dataType,s);return Lh.createEnvelope(t,th.envelopeType,e,l)},$h.PageViewPerformanceEnvelopeCreator=new $h,$h);function $h(){return null!==Yh&&Yh.apply(this,arguments)||this}var Qh,td=(w(ed,Qh=Lh),ed.prototype.Create=function(t,e){this._logger=t,oc.isNullOrUndefined(e.baseData)&&this._logger.throwInternal(sc.CRITICAL,eu,"telemetryItem.baseData cannot be null.");var r=e.baseData.message,i=e.baseData.severityLevel,n=Lh.extractProperties(e.data),o=S({},n,e.baseData.properties),a=new Kp(t,r,i,o),s=new oh(Kp.dataType,a);return Lh.createEnvelope(t,Kp.envelopeType,e,s)},ed.TraceEnvelopeCreator=new ed,ed);function ed(){return null!==Qh&&Qh.apply(this,arguments)||this}var rd=(id.prototype.serialize=function(t){var e=this._serializeObject(t,"root");return JSON.stringify(e)},id.prototype._serializeObject=function(t,e){var r="__aiCircularRefCheck",i={};if(!t)return this._logger.throwInternal(sc.CRITICAL,iu,"cannot serialize object because it is null or undefined",{name:e},!0),i;if(t[r])return this._logger.throwInternal(sc.WARNING,ou,"Circular reference detected while serializing object",{name:e},!0),i;if(!t.aiDataContract){if("measurements"===e)i=this._serializeStringMap(t,"number",e);else if("properties"===e)i=this._serializeStringMap(t,"string",e);else if("tags"===e)i=this._serializeStringMap(t,"string",e);else if(Ru.isArray(t))i=this._serializeArray(t,e);else{this._logger.throwInternal(sc.WARNING,nu,"Attempting to serialize an object which does not implement ISerializable",{name:e},!0);try{JSON.stringify(t),i=t}catch(t){this._logger.throwInternal(sc.CRITICAL,iu,t&&"function"==typeof t.toString?t.toString():"Error serializing object",null,!0)}}return i}for(var n in t[r]=!0,t.aiDataContract){var o,a=t.aiDataContract[n],s="function"==typeof a?a()&Jl.Required:a&Jl.Required,l="function"==typeof a?a()&Jl.Hidden:a&Jl.Hidden,c=a&Jl.Array,u=void 0!==t[n],p="object"==typeof t[n]&&null!==t[n];!s||u||c?l||void 0!==(o=p?c?this._serializeArray(t[n],n):this._serializeObject(t[n],n):t[n])&&(i[n]=o):this._logger.throwInternal(sc.CRITICAL,Rc,"Missing required field specification. The field is required but not present on source",{field:n,name:e})}return delete t[r],i},id.prototype._serializeArray=function(t,e){var r=void 0;if(t)if(Ru.isArray(t)){r=[];for(var i=0;i<t.length;i++){var n=t[i],o=this._serializeObject(n,e+"["+i+"]");r.push(o)}}else this._logger.throwInternal(sc.CRITICAL,su,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:e},!0);return r},id.prototype._serializeStringMap=function(t,e,r){var i=void 0;if(t)for(var n in i={},t){var o=t[n];if("string"===e)void 0===o?i[n]="undefined":null===o?i[n]="null":o.toString?i[n]=o.toString():i[n]="invalid field: toString() is not defined.";else if("number"===e)if(void 0===o)i[n]="undefined";else if(null===o)i[n]="null";else{var a=parseFloat(o);isNaN(a)?i[n]="NaN":i[n]=a}else i[n]="invalid field: "+r+" is of unknown type.",this._logger.throwInternal(sc.CRITICAL,i[n],null,!0)}return i},id);function id(t){this._logger=t}function nd(){this._onlineStatus=!0;try{"undefined"==typeof window?this.isListening=!1:window&&window.addEventListener?(window.addEventListener("online",this._setOnline.bind(this),!1),window.addEventListener("offline",this._setOffline.bind(this),!1),this.isListening=!0):document&&document.body?(document.body.ononline=this._setOnline.bind(this),document.body.onoffline=this._setOffline.bind(this),this.isListening=!0):document?(document.ononline=this._setOnline.bind(this),document.onoffline=this._setOffline.bind(this),this.isListening=!0):this.isListening=!1}catch(r){this.isListening=!1}}var od=(nd.prototype._setOnline=function(){this._onlineStatus=!0},nd.prototype._setOffline=function(){this._onlineStatus=!1},nd.prototype.isOnline=function(){return this.isListening?this._onlineStatus:!(navigator&&!oc.isNullOrUndefined(navigator.onLine))||navigator.onLine},nd.prototype.isOffline=function(){return!this.isOnline()},nd.Offline=new nd,nd).Offline,ad=(sd.prototype.getHashCodeScore=function(t){return this.getHashCode(t)/sd.INT_MAX_VALUE*100},sd.prototype.getHashCode=function(t){if(""==t)return 0;for(;t.length<sd.MIN_INPUT_LENGTH;)t=t.concat(t);for(var e=5381,r=0;r<t.length;++r)e=(e<<5)+e+t.charCodeAt(r),e&=e;return Math.abs(e)},sd.INT_MAX_VALUE=2147483647,sd.MIN_INPUT_LENGTH=8,sd);function sd(){}var ld=(cd.prototype.getSamplingScore=function(t){return t.tags&&t.tags[this.keys.userId]?this.hashCodeGeneragor.getHashCodeScore(t.tags[this.keys.userId]):t.ext&&t.ext.user&&t.ext.user.id?this.hashCodeGeneragor.getHashCodeScore(t.ext.user.id):t.tags&&t.tags[this.keys.operationId]?this.hashCodeGeneragor.getHashCodeScore(t.tags[this.keys.operationId]):t.ext&&t.ext.telemetryTrace&&t.ext.telemetryTrace.traceID?this.hashCodeGeneragor.getHashCodeScore(t.ext.telemetryTrace.traceID):100*Math.random()},cd);function cd(){this.hashCodeGeneragor=new ad,this.keys=new ch}var ud=(pd.prototype.isSampledIn=function(t){var e=this.sampleRate;return null==e||100<=e||t.baseType===Pp.dataType||this.samplingScoreGenerator.getSamplingScore(t)<e},pd);function pd(t,e){this.INT_MAX_VALUE=2147483647,oc.isNullOrUndefined(e)?this._logger=new Eu:this._logger=e,(100<t||t<0)&&(this._logger.throwInternal(sc.WARNING,pu,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:t},!0),this.sampleRate=100),this.sampleRate=t,this.samplingScoreGenerator=new ld}var hd=(dd.prototype.pause=function(){throw new Error("Method not implemented.")},dd.prototype.resume=function(){throw new Error("Method not implemented.")},dd.prototype.flush=function(){try{this.triggerSend()}catch(r){this._logger.throwInternal(sc.CRITICAL,Lc,"flush failed, telemetry will not be collected: "+Ru.getExceptionName(r),{exception:Ru.dump(r)})}},dd.prototype.onunloadFlush=function(){if(!1!==this._config.onunloadDisableBeacon()&&!1!==this._config.isBeaconApiDisabled()||!Ru.IsBeaconApiSupported())this.flush();else try{this.triggerSend(!0,this._beaconSender)}catch(r){this._logger.throwInternal(sc.CRITICAL,Mc,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Ru.getExceptionName(r),{exception:Ru.dump(r)})}},dd.prototype.teardown=function(){throw new Error("Method not implemented.")},dd.prototype.initialize=function(t,e,r){var i=this;this._logger=e.logger,this._serializer=new rd(e.logger),this._consecutiveErrors=0,this._retryAt=null,this._lastSend=0,this._sender=null;var n=dd._getDefaultAppInsightsChannelConfig();function o(e){a._config[e]=function(){return sh.getConfig(t,e,i.identifier,n[e]())}}this._config=dd._getEmptyAppInsightsChannelConfig();var a=this;for(var s in n)o(s);this._buffer=this._config.enableSessionStorageBuffer&&Ru.canUseSessionStorage()?new Oh(this._logger,this._config):new kh(this._config),this._sample=new ud(this._config.samplingPercentage(),this._logger),!this._config.isBeaconApiDisabled()&&Ru.IsBeaconApiSupported()?this._sender=this._beaconSender:"undefined"!=typeof XMLHttpRequest&&("withCredentials"in new XMLHttpRequest?(this._sender=this._xhrSender,this._XMLHttpRequestSupported=!0):"undefined"!=typeof XDomainRequest&&(this._sender=this._xdrSender))},dd.prototype.processTelemetry=function(t){var e=this;try{if(this._config.disableTelemetry())return;if(!t)return void this._logger.throwInternal(sc.CRITICAL,_c,"Cannot send empty telemetry");if(t.baseData&&!t.baseType)return void this._logger.throwInternal(sc.CRITICAL,bu,"Cannot send telemetry without baseData and baseType");if(t.baseType||(t.baseType="EventData"),!this._sender)return void this._logger.throwInternal(sc.CRITICAL,Fc,"Sender was not initialized");if(!this._isSampledIn(t))return void this._logger.throwInternal(sc.WARNING,Gc,"Telemetry item was sampled out and not sent",{SampleRate:this._sample.sampleRate});t.tags=t.tags||{},t.tags.sampleRate=this._sample.sampleRate;var r=dd.constructEnvelope(t,this._config.instrumentationKey(),this._logger);if(!r)return void this._logger.throwInternal(sc.CRITICAL,ru,"Unable to create an AppInsights envelope");var i=!1;if(t.tags&&t.tags[Wu]&&(t.tags[Wu].forEach((function(t){try{t&&!1===t(r)&&(i=!0,e._logger.warnToConsole("Telemetry processor check returns false"))}catch(t){e._logger.throwInternal(sc.CRITICAL,gu,"One of telemetry initializers failed, telemetry item will not be sent: "+Ru.getExceptionName(t),{exception:Ru.dump(t)},!0)}})),delete t.tags[Wu]),i)return;var n=this._serializer.serialize(r),o=this._buffer.getItems(),a=this._buffer.batchPayloads(o);a&&a.length+n.length>this._config.maxBatchSizeInBytes()&&this.triggerSend(),this._buffer.enqueue(n),this._setupTimer()}catch(t){this._logger.throwInternal(sc.WARNING,Tc,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}oc.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(t)},dd.prototype.setNextPlugin=function(t){this._nextPlugin=t},dd.prototype._xhrReadyStateChange=function(t,e,r){if(4===t.readyState){var i=null;this._appId||(i=this._parseResponse(t.responseText||t.response))&&i.appId&&(this._appId=i.appId),(t.status<200||300<=t.status)&&0!==t.status?!this._config.isRetryDisabled()&&this._isRetriable(t.status)?(this._resendPayload(e),this._logger.throwInternal(sc.WARNING,Yc,". Response code "+t.status+". Will retry to send "+e.length+" items.")):this._onError(e,this._formatErrorMessageXhr(t)):od.isOffline()?this._config.isRetryDisabled()||(this._resendPayload(e,10),this._logger.throwInternal(sc.WARNING,Yc,". Offline - Response Code: "+t.status+". Offline status: "+od.isOffline()+". Will retry to send "+e.length+" items.")):206===t.status?(i=i||this._parseResponse(t.responseText||t.response))&&!this._config.isRetryDisabled()?this._onPartialSuccess(e,i):this._onError(e,this._formatErrorMessageXhr(t)):(this._consecutiveErrors=0,this._onSuccess(e,r))}},dd.prototype.triggerSend=function(t,e){void 0===t&&(t=!0);try{if(this._config.disableTelemetry())this._buffer.clear();else{if(0<this._buffer.count()){var r=this._buffer.getItems();e?e.call(this,r,t):this._sender(r,t)}this._lastSend=+new Date}clearTimeout(this._timeoutHandle),this._timeoutHandle=null,this._retryAt=null}catch(t){(!Ru.getIEVersion()||9<Ru.getIEVersion())&&this._logger.throwInternal(sc.CRITICAL,Yc,"Telemetry transmission failed, some telemetry will be lost: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}},dd.prototype._onError=function(t,e,r){this._logger.throwInternal(sc.WARNING,Nc,"Failed to send telemetry.",{message:e}),this._buffer.clearSent(t)},dd.prototype._onPartialSuccess=function(t,e){for(var r=[],i=[],n=0,o=e.errors.reverse();n<o.length;n++){var a=o[n],s=t.splice(a.index,1)[0];this._isRetriable(a.statusCode)?i.push(s):r.push(s)}0<t.length&&this._onSuccess(t,e.itemsAccepted),0<r.length&&this._onError(r,this._formatErrorMessageXhr(null,["partial success",e.itemsAccepted,"of",e.itemsReceived].join(" "))),0<i.length&&(this._resendPayload(i),this._logger.throwInternal(sc.WARNING,Yc,"Partial success. Delivered: "+t.length+", Failed: "+r.length+". Will retry to send "+i.length+" our of "+e.itemsReceived+" items"))},dd.prototype._onSuccess=function(t,e){this._buffer.clearSent(t)},dd.prototype._xdrOnLoad=function(t,e){if(!t||t.responseText+""!="200"&&""!==t.responseText){var r=this._parseResponse(t.responseText);r&&r.itemsReceived&&r.itemsReceived>r.itemsAccepted&&!this._config.isRetryDisabled()?this._onPartialSuccess(e,r):this._onError(e,this._formatErrorMessageXdr(t))}else this._consecutiveErrors=0,this._onSuccess(e,0)},dd.constructEnvelope=function(t,e,r){var i;switch((i=e===t.iKey||oc.isNullOrUndefined(e)?t:S({},t,{iKey:e})).baseType){case op.dataType:return Fh.EventEnvelopeCreator.Create(r,i);case Kp.dataType:return td.TraceEnvelopeCreator.Create(r,i);case zp.dataType:return Kh.PageViewEnvelopeCreator.Create(r,i);case th.dataType:return Jh.PageViewPerformanceEnvelopeCreator.Create(r,i);case dp.dataType:return Vh.ExceptionEnvelopeCreator.Create(r,i);case Pp.dataType:return Zh.MetricEnvelopeCreator.Create(r,i);case Vp.dataType:return zh.DependencyEnvelopeCreator.Create(r,i);default:return Fh.EventEnvelopeCreator.Create(r,i)}},dd._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100}}},dd._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0}},dd.prototype._isSampledIn=function(t){return this._sample.isSampledIn(t)},dd.prototype._beaconSender=function(t,e){var r=this._config.endpointUrl(),i=this._buffer.batchPayloads(t),n=new Blob([i],{type:"text/plain;charset=UTF-8"});navigator.sendBeacon(r,n)?(this._buffer.markAsSent(t),this._onSuccess(t,t.length)):(this._xhrSender(t,!0),this._logger.throwInternal(sc.WARNING,Yc,". Failed to send telemetry with Beacon API, retried with xhrSender."))},dd.prototype._xhrSender=function(t,e){var r=this,i=new XMLHttpRequest;i[Hu]=!0,i.open("POST",this._config.endpointUrl(),e),i.setRequestHeader("Content-type","application/json"),Ru.isInternalApplicationInsightsEndpoint(this._config.endpointUrl())&&i.setRequestHeader(Ou.sdkContextHeader,Ou.sdkContextHeaderAppIdRequest),i.onreadystatechange=function(){return r._xhrReadyStateChange(i,t,t.length)},i.onerror=function(e){return r._onError(t,r._formatErrorMessageXhr(i),e)};var n=this._buffer.batchPayloads(t);i.send(n),this._buffer.markAsSent(t)},dd.prototype._parseResponse=function(t){try{if(t&&""!==t){var e=JSON.parse(t);if(e&&e.itemsReceived&&e.itemsReceived>=e.itemsAccepted&&e.itemsReceived-e.itemsAccepted==e.errors.length)return e}}catch(e){this._logger.throwInternal(sc.CRITICAL,Qc,"Cannot parse the response. "+Ru.getExceptionName(e),{response:t})}return null},dd.prototype._resendPayload=function(t,e){if(void 0===e&&(e=1),t&&0!==t.length){this._buffer.clearSent(t),this._consecutiveErrors++;for(var r=0,i=t;r<i.length;r++){var n=i[r];this._buffer.enqueue(n)}this._setRetryTime(e),this._setupTimer()}},dd.prototype._setRetryTime=function(t){var e;if(this._consecutiveErrors<=1)e=10;else{var r=(Math.pow(2,this._consecutiveErrors)-1)/2,i=Math.floor(Math.random()*r*10)+1;i*=t,e=Math.max(Math.min(i,3600),10)}var n=Date.now()+1e3*e;this._retryAt=n},dd.prototype._setupTimer=function(){var t=this;if(!this._timeoutHandle){var e=this._retryAt?Math.max(0,this._retryAt-Date.now()):0,r=Math.max(this._config.maxBatchInterval(),e);this._timeoutHandle=setTimeout((function(){t.triggerSend()}),r)}},dd.prototype._isRetriable=function(t){return 408==t||429==t||500==t||503==t},dd.prototype._formatErrorMessageXhr=function(t,e){return t?"XMLHttpRequest,Status:"+t.status+",Response:"+t.responseText||!1:e},dd.prototype._xdrSender=function(t,e){var r=this,i=new XDomainRequest;i.onload=function(){return r._xdrOnLoad(i,t)},i.onerror=function(e){return r._onError(t,r._formatErrorMessageXdr(i),e)};var n=window.location&&window.location.protocol;if(0!==this._config.endpointUrl().lastIndexOf(n,0))return this._logger.throwInternal(sc.WARNING,Yc,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void this._buffer.clear();var o=this._config.endpointUrl().replace(/^(https?:)/,"");i.open("POST",o);var a=this._buffer.batchPayloads(t);i.send(a),this._buffer.markAsSent(t)},dd.prototype._formatErrorMessageXdr=function(t,e){return t?"XDomainRequest,Response:"+t.responseText||!1:e},dd);function dd(){this.priority=1001,this.identifier=gh,this._XMLHttpRequestSupported=!1}var fd=function(){},md=(gd.prototype.update=function(){this.automaticSession.id||this.initializeAutomaticSession();var t=qu.Now(),e=t-this.automaticSession.acquisitionDate>this.config.sessionExpirationMs(),r=t-this.automaticSession.renewalDate>this.config.sessionRenewalMs();e||r?this.renew():(!this.cookieUpdatedTimestamp||t-this.cookieUpdatedTimestamp>gd.cookieUpdateInterval)&&(this.automaticSession.renewalDate=t,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate))},gd.prototype.backup=function(){this.setStorage(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate)},gd.prototype.initializeAutomaticSession=function(){var t=Ru.getCookie(this._logger,this._storageNamePrefix());if(t&&"function"==typeof t.split)this.initializeAutomaticSessionWithData(t);else{var e=Ru.getStorage(this._logger,this._storageNamePrefix());e&&this.initializeAutomaticSessionWithData(e)}this.automaticSession.id||this.renew()},gd.prototype.initializeAutomaticSessionWithData=function(t){var e=t.split("|");0<e.length&&(this.automaticSession.id=e[0]);try{if(1<e.length){var r=+e[1];this.automaticSession.acquisitionDate=+new Date(r),this.automaticSession.acquisitionDate=0<this.automaticSession.acquisitionDate?this.automaticSession.acquisitionDate:0}if(2<e.length){var i=+e[2];this.automaticSession.renewalDate=+new Date(i),this.automaticSession.renewalDate=0<this.automaticSession.renewalDate?this.automaticSession.renewalDate:0}}catch(t){this._logger.throwInternal(sc.CRITICAL,bc,"Error parsing ai_session cookie, session will be reset: "+Ru.getExceptionName(t),{exception:Ru.dump(t)})}0==this.automaticSession.renewalDate&&this._logger.throwInternal(sc.WARNING,Bc,"AI session renewal date is 0, session will be reset.")},gd.prototype.renew=function(){var t=qu.Now();this.automaticSession.id=Ru.newId(),this.automaticSession.acquisitionDate=t,this.automaticSession.renewalDate=t,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate),Ru.canUseLocalStorage()||this._logger.throwInternal(sc.WARNING,hc,"Browser does not support local storage. Session durations will be inaccurate.")},gd.prototype.setCookie=function(t,e,r){var i=e+this.config.sessionExpirationMs(),n=r+this.config.sessionRenewalMs(),o=new Date,a=[t,e,r];i<n?o.setTime(i):o.setTime(n);var s=this.config.cookieDomain?this.config.cookieDomain():null;Ru.setCookie(this._logger,this._storageNamePrefix(),a.join("|")+";expires="+o.toUTCString(),s),this.cookieUpdatedTimestamp=qu.Now()},gd.prototype.setStorage=function(t,e,r){Ru.setStorage(this._logger,this._storageNamePrefix(),[t,e,r].join("|"))},gd.acquisitionSpan=864e5,gd.renewalSpan=18e5,gd.cookieUpdateInterval=6e4,gd.cookieNameConst="ai_session",gd);function gd(t,e){var r=this;oc.isNullOrUndefined(e)?this._logger=new Eu:this._logger=e,"function"!=typeof(t=t||{}).sessionExpirationMs&&(t.sessionExpirationMs=function(){return gd.acquisitionSpan}),"function"!=typeof t.sessionRenewalMs&&(t.sessionRenewalMs=function(){return gd.renewalSpan}),this.config=t,this._storageNamePrefix=function(){return r.config.namePrefix&&r.config.namePrefix()?gd.cookieNameConst+r.config.namePrefix():gd.cookieNameConst},this.automaticSession=new fd}var yd=function(){},vd=function(){this.id="browser",this.deviceClass="Browser"},_d=function(t){this.sdkVersion=(t.sdkExtension&&t.sdkExtension()?t.sdkExtension()+"_":"")+"javascript:2.2.2"},xd=(bd.prototype.setAuthenticatedUserContext=function(t,e,r){if(void 0===r&&(r=!1),!this.validateUserInput(t)||e&&!this.validateUserInput(e))this._logger.throwInternal(sc.WARNING,hu,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{this.authenticatedId=t;var i=this.authenticatedId;e&&(this.accountId=e,i=[this.authenticatedId,this.accountId].join(bd.cookieSeparator)),r&&Ru.setCookie(this._logger,bd.authUserCookieName,encodeURI(i),this.config.cookieDomain())}},bd.prototype.clearAuthenticatedUserContext=function(){this.authenticatedId=null,this.accountId=null,Ru.deleteCookie(this._logger,bd.authUserCookieName)},bd.prototype.validateUserInput=function(t){return!("string"!=typeof t||!t||t.match(/,|;|=| |\|/))},bd.cookieSeparator="|",bd.userCookieName="ai_user",bd.authUserCookieName="ai_authUser",bd);function bd(t,e){this._logger=e;var r=Ru.getCookie(this._logger,bd.userCookieName);if(r){var i=r.split(bd.cookieSeparator);0<i.length&&(this.id=i[0])}if(this.config=t,!this.id){this.id=Ru.newId();var n=new Date,o=Ru.toISOStringForIE8(n);this.accountAcquisitionDate=o,n.setTime(n.getTime()+31536e6);var a=[this.id,o],s=this.config.cookieDomain?this.config.cookieDomain():void 0;Ru.setCookie(this._logger,bd.userCookieName,a.join(bd.cookieSeparator)+";expires="+n.toUTCString(),s);var l=t.namePrefix&&t.namePrefix()?t.namePrefix()+"ai_session":"ai_session";Ru.removeStorage(this._logger,l)}this.accountId=t.accountId?t.accountId():void 0;var c=Ru.getCookie(this._logger,bd.authUserCookieName);if(c){var u=(c=decodeURI(c)).split(bd.cookieSeparator);u[0]&&(this.authenticatedId=u[0]),1<u.length&&u[1]&&(this.accountId=u[1])}}var wd=function(){},Sd=function(t,e,r){this.traceID=t||Ru.generateW3CId(),this.parentID=e,this.name=r,window&&window.location&&window.location.pathname&&(this.name=window.location.pathname)},Td=(Ed.prototype.applySessionContext=function(t){var e=this.session||this.sessionManager.automaticSession;e&&"string"==typeof e.id&&(t.ext.app.sesId=e.id),this.session&&("string"==typeof this.session.id?t.ext.app.sesId=this.session.id:t.ext.app.sesId=this.sessionManager.automaticSession.id)},Ed.prototype.applyOperatingSystemContxt=function(t){this.os&&this.os.name&&(t.ext.os=this.os)},Ed.prototype.applyApplicationContext=function(t){this.application&&("string"==typeof this.application.ver&&(t.tags[fh.applicationVersion]=this.application.ver),"string"==typeof this.application.build&&(t.tags[fh.applicationBuild]=this.application.build))},Ed.prototype.applyDeviceContext=function(t){this.device&&("string"==typeof this.device.id&&(t.ext.device.localId=this.device.id),"string"==typeof this.device.ip&&(t.ext.device.ip=this.device.ip),"string"==typeof this.device.model&&(t.ext.device.model=this.device.model),"string"==typeof this.device.deviceClass&&(t.ext.device.deviceClass=this.device.deviceClass))},Ed.prototype.applyInternalContext=function(t){this.internal&&("string"==typeof this.internal.agentVersion&&(t.tags[fh.internalAgentVersion]=this.internal.agentVersion),"string"==typeof this.internal.sdkVersion&&(t.tags[fh.internalSdkVersion]=this.internal.sdkVersion))},Ed.prototype.applyLocationContext=function(t){this.location&&"string"==typeof this.location.ip&&(t.tags[fh.locationIp]=this.location.ip)},Ed.prototype.applyOperationContext=function(t){if(this.telemetryTrace){var e=t.ext.trace||{traceID:void 0,parentID:void 0};"string"==typeof this.telemetryTrace.traceID&&(e.traceID=this.telemetryTrace.traceID),"string"==typeof this.telemetryTrace.name&&(e.name=this.telemetryTrace.name),"string"==typeof this.telemetryTrace.parentID&&(e.parentID=this.telemetryTrace.parentID),t.ext.trace=e}},Ed.prototype.applyWebContext=function(t){this.web&&(t.ext.web=t.ext.web||{},t.ext.web=this.web)},Ed.prototype.applyUserContext=function(t){this.user&&(t.tags||(t.tags=[]),"string"==typeof this.user.accountId&&(t.tags[fh.userAccountId]=this.user.accountId),"string"==typeof this.user.id&&(t.ext.user.id=this.user.id),"string"==typeof this.user.authenticatedId&&(t.ext.user.authId=this.user.authenticatedId))},Ed.prototype.cleanUp=function(t){t.ext[hh.DeviceExt]&&0===Object.keys(t.ext[hh.DeviceExt]).length&&delete t.ext[hh.DeviceExt],t.ext[hh.UserExt]&&0===Object.keys(t.ext[hh.UserExt]).length&&delete t.ext[hh.UserExt],t.ext[hh.WebExt]&&0===Object.keys(t.ext[hh.WebExt]).length&&delete t.ext[hh.WebExt],t.ext[hh.OSExt]&&0===Object.keys(t.ext[hh.OSExt]).length&&delete t.ext[hh.OSExt],t.ext[hh.AppExt]&&0===Object.keys(t.ext[hh.AppExt]).length&&delete t.ext[hh.AppExt],t.ext[hh.TraceExt]&&0===Object.keys(t.ext[hh.TraceExt]).length&&delete t.ext[hh.TraceExt]},Ed);function Ed(t,e){"undefined"!=typeof window&&(this.sessionManager=new md(e,t),this.application=new yd,this.device=new vd,this.internal=new _d(e),this.location=new wd,this.user=new xd(e,t),this.telemetryTrace=new Sd,this.session=new fd),this.appId=function(){return null}}var Id=(Cd.getDefaultConfig=function(){return{instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){}}},Cd.prototype.initialize=function(t,e,r){var i=this,n=Cd.getDefaultConfig();function o(e){a._extensionConfig[e]=function(){return sh.getConfig(t,e,i.identifier,n[e]())}}this._extensionConfig=this._extensionConfig||Cd.getDefaultConfig();var a=this;for(var s in n)o(s);this._logger=e.logger,this.context=new Td(e.logger,this._extensionConfig),this._breezeChannel=Ru.getExtension(r,gh),this.context.appId=function(){return i._breezeChannel?i._breezeChannel._appId:null}},Cd.prototype.processTelemetry=function(t){oc.isNullOrUndefined(t)||(t.name===zp.envelopeType&&this._logger.resetInternalMessageCount(),this.context.session&&"string"!=typeof this.context.session.id&&this.context.sessionManager.update(),this._processTelemetryInternal(t),oc.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(t))},Cd.prototype.setNextPlugin=function(t){this._nextPlugin=t},Cd.prototype._processTelemetryInternal=function(t){t.tags||(t.tags=[]),t.ext||(t.ext={}),t.ext[hh.DeviceExt]=t.ext[hh.DeviceExt]||{},t.ext[hh.WebExt]=t.ext[hh.WebExt]||{},t.ext[hh.UserExt]=t.ext[hh.UserExt]||{},t.ext[hh.OSExt]=t.ext[hh.OSExt]||{},t.ext[hh.AppExt]=t.ext[hh.AppExt]||{},t.ext[hh.TraceExt]=t.ext[hh.TraceExt]||{},this.context.applySessionContext(t),this.context.applyApplicationContext(t),this.context.applyDeviceContext(t),this.context.applyOperationContext(t),this.context.applyUserContext(t),this.context.applyOperatingSystemContxt(t),this.context.applyWebContext(t),this.context.applyLocationContext(t),this.context.applyInternalContext(t),this.context.cleanUp(t)},Cd);function Cd(){this.priority=110,this.identifier=mh}var Ad=function(){this.openDone=!1,this.setRequestHeaderDone=!1,this.sendDone=!1,this.abortDone=!1,this.onreadystatechangeCallbackAttached=!1},kd=(Pd.prototype.getAbsoluteUrl=function(){return this.requestUrl?Nu.getAbsoluteUrl(this.requestUrl):null},Pd.prototype.getPathName=function(){return this.requestUrl?Lu.sanitizeUrl(this._logger,Nu.getCompleteUrl(this.method,this.requestUrl)):null},Pd);function Pd(t,e,r){this.completed=!1,this.requestHeadersSize=null,this.requestHeaders=null,this.ttfb=null,this.responseReceivingDuration=null,this.callbackDuration=null,this.ajaxTotalDuration=null,this.aborted=null,this.pageUrl=null,this.requestUrl=null,this.requestSize=0,this.method=null,this.status=null,this.requestSentTime=null,this.responseStartedTime=null,this.responseFinishedTime=null,this.callbackFinishedTime=null,this.endTime=null,this.originalOnreadystatechage=null,this.xhrMonitoringState=new Ad,this.clientFailure=0,this.CalculateMetrics=function(){this.ajaxTotalDuration=Math.round(1e3*qu.GetDuration(this.requestSentTime,this.responseFinishedTime))/1e3},this.traceID=t,this.spanID=e,this._logger=r}var Od=(Md.AttachEvent=function(t,e,r){var i=!1;return oc.isNullOrUndefined(t)||(oc.isNullOrUndefined(t.attachEvent)?oc.isNullOrUndefined(t.addEventListener)||(t.addEventListener(e,r,!1),i=!0):(t.attachEvent("on"+e,r),i=!0)),i},Md.DetachEvent=function(t,e,r){oc.isNullOrUndefined(t)||(oc.isNullOrUndefined(t.detachEvent)?oc.isNullOrUndefined(t.removeEventListener)||t.removeEventListener(e,r,!1):t.detachEvent("on"+e,r))},Md);function Md(){}var Ld=(Dd.isValidTraceId=function(t){return t.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==t},Dd.isValidSpanId=function(t){return t.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==t},Dd.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},Dd.DEFAULT_TRACE_FLAG="00",Dd.DEFAULT_VERSION="00",Dd);function Dd(t,e){this.traceFlag=Dd.DEFAULT_TRACE_FLAG,this.version=Dd.DEFAULT_VERSION,t&&Dd.isValidTraceId(t)?this.traceId=t:this.traceId=Ru.generateW3CId(),e&&Dd.isValidSpanId(e)?this.spanId=e:this.spanId=Ru.generateW3CId().substr(0,16)}var Rd=(zd.prototype.isMonitoredInstance=function(t,e,r,i){var n=!1,o=!0,a=!1;return void 0!==r?(a=this._fetchInitialized,n="object"==typeof r&&!0===r[Hu]||!!i&&!0===i[Hu]):void 0!==t&&(a=this.initialized,n=!0===t[Hu],o=!0===e||!oc.isNullOrUndefined(t.ajaxData)),a&&o&&!n},zd.prototype.supportsAjaxMonitoring=function(){var t=!0;(oc.isNullOrUndefined(XMLHttpRequest)||oc.isNullOrUndefined(XMLHttpRequest.prototype)||oc.isNullOrUndefined(XMLHttpRequest.prototype.open)||oc.isNullOrUndefined(XMLHttpRequest.prototype.send)||oc.isNullOrUndefined(XMLHttpRequest.prototype.abort))&&(t=!1);try{" a ".trim()}catch(r){t=!1}return t},zd.prototype.instrumentOpen=function(){var t=XMLHttpRequest.prototype.open,e=this;XMLHttpRequest.prototype.open=function(r,i,n){try{!e.isMonitoredInstance(this,!0)||this.ajaxData&&this.ajaxData.xhrMonitoringState.openDone||e.openHandler(this,r,i,n)}catch(r){e._core.logger.throwInternal(sc.CRITICAL,Cc,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:zd.getFailedAjaxDiagnosticsMessage(this),exception:Ru.dump(r)})}return t.apply(this,arguments)}},zd.prototype.openHandler=function(t,e,r,i){var n=this._context&&this._context.telemetryTrace&&this._context.telemetryTrace.traceID||Ru.generateW3CId(),o=Ru.generateW3CId().substr(0,16),a=new kd(n,o,this._core.logger);a.method=e,a.requestUrl=r,a.xhrMonitoringState.openDone=!0,a.requestHeaders={},t.ajaxData=a,this.attachToOnReadyStateChange(t)},zd.getFailedAjaxDiagnosticsMessage=function(t){var e="";try{oc.isNullOrUndefined(t)||oc.isNullOrUndefined(t.ajaxData)||oc.isNullOrUndefined(t.ajaxData.requestUrl)||(e+="(url: '"+t.ajaxData.requestUrl+"')")}catch(t){}return e},zd.prototype.instrumentSend=function(){var t=XMLHttpRequest.prototype.send,e=this;XMLHttpRequest.prototype.send=function(r){try{e.isMonitoredInstance(this)&&!this.ajaxData.xhrMonitoringState.sendDone&&e.sendHandler(this,r)}catch(r){e._core.logger.throwInternal(sc.CRITICAL,kc,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:zd.getFailedAjaxDiagnosticsMessage(this),exception:Ru.dump(r)})}return t.apply(this,arguments)}},zd.prototype.sendHandler=function(t,e){t.ajaxData.requestSentTime=qu.Now(),(t=this.includeCorrelationHeaders(t.ajaxData,void 0,void 0,t)).ajaxData.xhrMonitoringState.sendDone=!0},zd.prototype.instrumentAbort=function(){var t=XMLHttpRequest.prototype.abort,e=this;XMLHttpRequest.prototype.abort=function(){try{e.isMonitoredInstance(this)&&!this.ajaxData.xhrMonitoringState.abortDone&&(this.ajaxData.aborted=1,this.ajaxData.xhrMonitoringState.abortDone=!0)}catch(t){e._core.logger.throwInternal(sc.CRITICAL,Ec,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:zd.getFailedAjaxDiagnosticsMessage(this),exception:Ru.dump(t)})}return t.apply(this,arguments)}},zd.prototype.instrumentSetRequestHeader=function(){if(this._config.enableRequestHeaderTracking){var t=XMLHttpRequest.prototype.setRequestHeader,e=this;XMLHttpRequest.prototype.setRequestHeader=function(r,i){try{e.isMonitoredInstance(this)&&(this.ajaxData.requestHeaders[r]=i)}catch(r){e._core.logger.throwInternal(sc.CRITICAL,wu,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:zd.getFailedAjaxDiagnosticsMessage(this),exception:Ru.dump(r)})}return t.apply(this,arguments)}}},zd.prototype.attachToOnReadyStateChange=function(t){var e=this;t.ajaxData.xhrMonitoringState.onreadystatechangeCallbackAttached=Od.AttachEvent(t,"readystatechange",(function(){try{e.isMonitoredInstance(t)&&4===t.readyState&&e.onAjaxComplete(t)}catch(r){var i=Ru.dump(r);i&&-1!=i.toLowerCase().indexOf("c00c023f")||e._core.logger.throwInternal(sc.CRITICAL,Ac,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:zd.getFailedAjaxDiagnosticsMessage(t),exception:Ru.dump(r)})}}))},zd.prototype.onAjaxComplete=function(t){if(t.ajaxData.responseFinishedTime=qu.Now(),t.ajaxData.status=t.status,t.ajaxData.CalculateMetrics(),t.ajaxData.ajaxTotalDuration<0)this._core.logger.throwInternal(sc.WARNING,Ic,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",{ajaxDiagnosticsMessage:zd.getFailedAjaxDiagnosticsMessage(t),requestSentTime:t.ajaxData.requestSentTime,responseFinishedTime:t.ajaxData.responseFinishedTime});else{var e={id:"|"+t.ajaxData.traceID+"."+t.ajaxData.spanID,target:t.ajaxData.getAbsoluteUrl(),name:t.ajaxData.getPathName(),type:"Ajax",duration:t.ajaxData.ajaxTotalDuration,success:200<=+t.ajaxData.status&&+t.ajaxData.status<400,responseCode:+t.ajaxData.status,method:t.ajaxData.method},r=this.getAjaxCorrelationContext(t);if(r&&(e.correlationContext=r),this._config.enableRequestHeaderTracking&&0<Object.keys(t.ajaxData.requestHeaders).length&&(e.properties=e.properties||{},e.properties.requestHeaders={},e.properties.requestHeaders=t.ajaxData.requestHeaders),this._config.enableResponseHeaderTracking){var i=t.getAllResponseHeaders();if(i){var n=i.trim().split(/[\r\n]+/),o={};n.forEach((function(t){var e=t.split(": "),r=e.shift(),i=e.join(": ");o[r]=i})),0<Object.keys(o).length&&(e.properties=e.properties||{},e.properties.responseHeaders={},e.properties.responseHeaders=o)}}this.trackDependencyDataInternal(e),t.ajaxData=null}},zd.prototype.getAjaxCorrelationContext=function(t){try{var e=t.getAllResponseHeaders();if(null!==e&&-1!==e.toLowerCase().indexOf(Ou.requestContextHeaderLowerCase)){var r=t.getResponseHeader(Ou.requestContextHeader);return Fu.getCorrelationContext(r)}}catch(e){this._core.logger.throwInternal(sc.WARNING,Pc,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:zd.getFailedAjaxDiagnosticsMessage(t),exception:Ru.dump(e)})}},zd.prototype.trackDependencyDataInternal=function(t,e,r){if(-1===this._config.maxAjaxCallsPerView||this._trackAjaxAttempts<this._config.maxAjaxCallsPerView){var i=uh.create(t,Vp.dataType,Vp.envelopeType,this._core.logger,e,r);this._core.track(i)}else this._trackAjaxAttempts===this._config.maxAjaxCallsPerView&&this._core.logger.throwInternal(sc.CRITICAL,lu,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++this._trackAjaxAttempts},zd.prototype.trackDependencyData=function(t,e){this.trackDependencyDataInternal(t,e)},zd.prototype.processTelemetry=function(t){this._nextPlugin&&this._nextPlugin.processTelemetry&&this._nextPlugin.processTelemetry(t)},zd.prototype.setNextPlugin=function(t){t&&(this._nextPlugin=t)},zd.prototype.instrumentFetch=function(){if(this.supportsFetch()&&!this._fetchInitialized){var t=window.fetch,e=this;window.fetch=function(r,i){var n;if(e.isFetchInstrumented(r)&&e.isMonitoredInstance(void 0,void 0,r,i))try{n=e.createFetchRecord(r,i),i=e.includeCorrelationHeaders(n,r,i)}catch(i){e._core.logger.throwInternal(sc.CRITICAL,Cc,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.",{ajaxDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(r),exception:Ru.dump(i)})}return t(r,i).then((function(t){return e.onFetchComplete(t,n),t})).catch((function(t){throw e.onFetchFailed(r,n,t),t}))},this._fetchInitialized=!0}},zd.prototype.isFetchInstrumented=function(t){return this._fetchInitialized&&!0!==t[Hu]},zd.prototype.supportsFetch=function(){var t=!0;return(!window||oc.isNullOrUndefined(window.Request)||oc.isNullOrUndefined(window.Request.prototype)||oc.isNullOrUndefined(window.fetch))&&(t=!1),t},zd.prototype.createFetchRecord=function(t,e){var r=this._context&&this._context.telemetryTrace&&this._context.telemetryTrace.traceID||Ru.generateW3CId(),i=Ru.generateW3CId().substr(0,16),n=new kd(r,i,this._core.logger);return n.requestSentTime=qu.Now(),t instanceof Request?n.requestUrl=t?t.url:"":n.requestUrl=t,e&&e.method?n.method=e.method:t&&t instanceof Request?n.method=t.method:n.method="GET",e&&e.headers&&this._config.enableRequestHeaderTracking?n.requestHeaders=e.headers:n.requestHeaders={},n},zd.prototype.includeCorrelationHeaders=function(t,e,r,i){if(e){if(Fu.canIncludeCorrelationHeader(this._config,t.getAbsoluteUrl(),this.currentWindowHost)){if((r=r||{}).headers=new Headers(r.headers||e instanceof Request&&e.headers||{}),this._isUsingAIHeaders){var n="|"+t.traceID+"."+t.spanID;r.headers.set(Ou.requestIdHeader,n),this._config.enableRequestHeaderTracking&&(t.requestHeaders[Ou.requestIdHeader]=n)}var o=this._config.appId||this._context.appId();if(o&&(r.headers.set(Ou.requestContextHeader,Ou.requestContextAppIdFormat+o),this._config.enableRequestHeaderTracking&&(t.requestHeaders[Ou.requestContextHeader]=Ou.requestContextAppIdFormat+o)),this._isUsingW3CHeaders){var a=new Ld(t.traceID,t.spanID);r.headers.set(Ou.traceParentHeader,a.toString()),this._config.enableRequestHeaderTracking&&(t.requestHeaders[Ou.traceParentHeader]=a.toString())}return r}return r}if(i){if(this.currentWindowHost&&Fu.canIncludeCorrelationHeader(this._config,i.ajaxData.getAbsoluteUrl(),this.currentWindowHost)){this._isUsingAIHeaders&&(n="|"+i.ajaxData.traceID+"."+i.ajaxData.spanID,i.setRequestHeader(Ou.requestIdHeader,n),this._config.enableRequestHeaderTracking&&(i.ajaxData.requestHeaders[Ou.requestIdHeader]=n));var s=this._config.appId||this._context.appId();s&&(i.setRequestHeader(Ou.requestContextHeader,Ou.requestContextAppIdFormat+s),this._config.enableRequestHeaderTracking&&(i.ajaxData.requestHeaders[Ou.requestContextHeader]=Ou.requestContextAppIdFormat+s)),this._isUsingW3CHeaders&&(a=new Ld(i.ajaxData.traceID,i.ajaxData.spanID),i.setRequestHeader(Ou.traceParentHeader,a.toString()),this._config.enableRequestHeaderTracking&&(i.ajaxData.requestHeaders[Ou.traceParentHeader]=a.toString()))}return i}},zd.prototype.getFailedFetchDiagnosticsMessage=function(t){var e="";try{oc.isNullOrUndefined(t)||(e+="string"==typeof t?"(url: '"+t+"')":"(url: '"+t.url+"')")}catch(t){this._core.logger.throwInternal(sc.CRITICAL,Cc,"Failed to grab failed fetch diagnostics message",{exception:Ru.dump(t)})}return e},zd.prototype.onFetchComplete=function(t,e){if(e)try{if(e.responseFinishedTime=qu.Now(),e.CalculateMetrics(),e.ajaxTotalDuration<0)this._core.logger.throwInternal(sc.WARNING,Ic,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(t),requestSentTime:e.requestSentTime,responseFinishedTime:e.responseFinishedTime});else{var r={id:"|"+e.traceID+"."+e.spanID,target:e.getAbsoluteUrl(),name:e.getPathName(),type:"Fetch",duration:e.ajaxTotalDuration,success:200<=t.status&&t.status<400,responseCode:t.status,properties:{HttpMethod:e.method}},i=this.getFetchCorrelationContext(t);if(i&&(r.correlationContext=i),this._config.enableRequestHeaderTracking&&0<Object.keys(e.requestHeaders).length&&(r.properties=r.properties||{},r.properties.requestHeaders=e.requestHeaders),this._config.enableResponseHeaderTracking){var n={};t.headers.forEach((function(t,e){n[e]=t})),0<Object.keys(n).length&&(r.properties=r.properties||{},r.properties.responseHeaders=n)}this.trackDependencyDataInternal(r)}}catch(e){this._core.logger.throwInternal(sc.WARNING,Pc,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(t),exception:Ru.dump(e)})}},zd.prototype.onFetchFailed=function(t,e,r){if(e)try{if(e.responseFinishedTime=qu.Now(),e.CalculateMetrics(),e.ajaxTotalDuration<0)this._core.logger.throwInternal(sc.WARNING,Ic,"Failed to calculate the duration of the failed fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(t),requestSentTime:e.requestSentTime,responseFinishedTime:e.responseFinishedTime});else{var i={id:"|"+e.traceID+"."+e.spanID,target:e.getAbsoluteUrl(),name:e.getPathName(),type:"Fetch",duration:e.ajaxTotalDuration,success:!1,responseCode:0,properties:{HttpMethod:e.method}};this.trackDependencyDataInternal(i,{error:r.message})}}catch(e){this._core.logger.throwInternal(sc.WARNING,Pc,"Failed to calculate the duration of the failed fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(t),exception:Ru.dump(e)})}},zd.prototype.getFetchCorrelationContext=function(t){try{var e=t.headers.get(Ou.requestContextHeader);return Fu.getCorrelationContext(e)}catch(e){this._core.logger.throwInternal(sc.WARNING,Pc,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(t),exception:Ru.dump(e)})}},zd.prototype.instrumentXhr=function(){this.supportsAjaxMonitoring()&&!this.initialized&&(this.instrumentOpen(),this.instrumentSend(),this.instrumentAbort(),this.instrumentSetRequestHeader(),this.initialized=!0)},zd.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,disableCorrelationHeaders:!1,distributedTracingMode:Ql.AI,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1}},zd.getEmptyConfig=function(){return{maxAjaxCallsPerView:void 0,disableAjaxTracking:void 0,disableFetchTracking:void 0,disableCorrelationHeaders:void 0,distributedTracingMode:void 0,correlationHeaderExcludedDomains:void 0,appId:void 0,enableCorsCorrelation:void 0,correlationHeaderDomains:void 0,enableRequestHeaderTracking:void 0,enableResponseHeaderTracking:void 0}},zd.prototype.initialize=function(t,e,r){if(!this.initialized&&!this._fetchInitialized){this._core=e;var i=zd.getDefaultConfig();for(var n in this._config=zd.getEmptyConfig(),i)this._config[n]=sh.getConfig(t,n,zd.identifier,i[n]);if(this._isUsingAIHeaders=this._config.distributedTracingMode===Ql.AI||this._config.distributedTracingMode===Ql.AI_AND_W3C,this._isUsingW3CHeaders=this._config.distributedTracingMode===Ql.AI_AND_W3C||this._config.distributedTracingMode===Ql.W3C,!1===this._config.disableAjaxTracking&&this.instrumentXhr(),!1===this._config.disableFetchTracking&&this.instrumentFetch(),0<r.length&&r){for(var o=void 0,a=0;!o&&a<r.length;)r[a]&&r[a].identifier===mh&&(o=r[a]),a++;o&&(this._context=o.context)}}},zd.identifier="AjaxDependencyPlugin",zd);function zd(){this._trackAjaxAttempts=0,this.identifier=zd.identifier,this.priority=120,this.currentWindowHost=window&&window.location&&window.location.host&&window.location.host.toLowerCase(),this.initialized=!1,this._fetchInitialized=!1}var Nd=(Bd.prototype.trackEvent=function(t,e){this.appInsights.trackEvent(t,e)},Bd.prototype.trackPageView=function(t){var e=t||{};this.appInsights.trackPageView(e)},Bd.prototype.trackPageViewPerformance=function(t){var e=t||{};this.appInsights.trackPageViewPerformance(e)},Bd.prototype.trackException=function(t){!t.exception&&t.error&&(t.exception=t.error),this.appInsights.trackException(t)},Bd.prototype._onerror=function(t){this.appInsights._onerror(t)},Bd.prototype.trackTrace=function(t,e){this.appInsights.trackTrace(t,e)},Bd.prototype.trackMetric=function(t,e){this.appInsights.trackMetric(t,e)},Bd.prototype.startTrackPage=function(t){this.appInsights.startTrackPage(t)},Bd.prototype.stopTrackPage=function(t,e,r,i){this.appInsights.stopTrackPage(t,e,r,i)},Bd.prototype.startTrackEvent=function(t){this.appInsights.startTrackEvent(t)},Bd.prototype.stopTrackEvent=function(t,e,r){this.appInsights.stopTrackEvent(t,e,r)},Bd.prototype.addTelemetryInitializer=function(t){return this.appInsights.addTelemetryInitializer(t)},Bd.prototype.setAuthenticatedUserContext=function(t,e,r){void 0===r&&(r=!1),this.properties.context.user.setAuthenticatedUserContext(t,e,r)},Bd.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},Bd.prototype.trackDependencyData=function(t){this.dependencies.trackDependencyData(t)},Bd.prototype.flush=function(t){void 0===t&&(t=!0),this.core.getTransmissionControls().forEach((function(e){e.forEach((function(e){e.flush(t)}))}))},Bd.prototype.onunloadFlush=function(t){void 0===t&&(t=!0),this.core.getTransmissionControls().forEach((function(e){e.forEach((function(e){e.onunloadFlush?e.onunloadFlush():e.flush(t)}))}))},Bd.prototype.loadAppInsights=function(t){if(void 0===t&&(t=!1),t&&this.config.extensions&&0<this.config.extensions.length)throw new Error("Extensions not allowed in legacy mode");var e=[],r=new hd;return e.push(r),e.push(this.properties),e.push(this.dependencies),e.push(this.appInsights),this.core.initialize(this.config,e),this.emptyQueue(),this.pollInternalLogs(),this.addHousekeepingBeforeUnload(this),this.context=this.properties.context,this},Bd.prototype.updateSnippetDefinitions=function(t){for(var e in this)"string"==typeof e&&(t[e]=this[e])},Bd.prototype.emptyQueue=function(){try{if(Ru.isArray(this.snippet.queue)){for(var t=this.snippet.queue.length,e=0;e<t;e++)(0,this.snippet.queue[e])();this.snippet.queue=void 0,delete this.snippet.queue}}catch(t){var r={};t&&"function"==typeof t.toString&&(r.exception=t.toString())}},Bd.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},Bd.prototype.addHousekeepingBeforeUnload=function(t){!t.appInsights.config.disableFlushOnBeforeUnload&&"onbeforeunload"in window&&(Ru.addEventHandler("beforeunload",(function(){t.onunloadFlush(!1);var e=t.appInsights.core._extensions[mh];e&&e.context&&e.context._sessionManager&&e.context._sessionManager.backup()}))||t.appInsights.core.logger.throwInternal(sc.CRITICAL,Oc,"Could not add handler for beforeunload"))},Bd.prototype.getSKUDefaults=function(){this.config.diagnosticLogInterval=this.config.diagnosticLogInterval&&0<this.config.diagnosticLogInterval?this.config.diagnosticLogInterval:1e4},Bd);function Bd(t){t.queue=t.queue||[],t.version=t.version||2;var e=t.config||{};e&&!e.instrumentationKey&&(e=t,Eh.Version="2.2.2"),this.appInsights=new Eh,this.properties=new Id,this.dependencies=new Rd,this.core=new ku,this.snippet=t,this.config=e,this.getSKUDefaults()}var Fd=(jd.prototype.trackEvent=function(t,e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackEvent(t,e)},jd.prototype.setAuthenticatedUserContext=function(t,e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.setAuthenticatedUserContext(t,e)},jd.prototype.trackException=function(t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackException(t)},jd.prototype.flush=function(t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.flush(t)},jd);function jd(t){this.options=t,!this.options.disableTelemetry&&u&&(this.appInsights=new Nd({config:{instrumentationKey:u,disableExceptionTracking:!0,disableAjaxTracking:!0,isCookieUseDisabled:!0,maxBatchInterval:5e3}}),this.appInsights.loadAppInsights(),this.appInsights.addTelemetryInitializer((function(t){t.tags[fh.applicationVersion]=R.getFullVersion()})))}var Ud=(Vd.prototype.onAdd=function(t){return this.container=document.createElement("div"),this.container.className="azure-map-logo",this.container},Vd.prototype.onRemove=function(){this.container.remove()},Vd);function Vd(){}var qd,Gd=(w(Zd,qd=I),Zd);function Zd(){var t=null!==qd&&qd.apply(this,arguments)||this;return t.copyrightMessage=void 0,t.showFeedbackLink=!0,t}var Hd,Wd=(w(Kd,Hd=q),Kd.prototype.onAdd=function(t){return this.container=this.buildContainer(t,e.ControlStyle.auto),this.container.className="map-copyright",this.copyrightDiv=this.buildCopyrightDiv(),this.container.appendChild(this.copyrightDiv),this.options.showFeedbackLink&&(this.feedbackLink=this.buildFeedbackLink(),this.container.appendChild(this.feedbackLink)),this.container},Kd.prototype.onRemove=function(){Hd.prototype.onRemove.call(this),delete this.container},Kd.prototype.setOptions=function(t){var e=(new Gd).merge(this.options,t);e.copyrightMessage!==this.options.copyrightMessage&&(this.copyrightDiv.innerText=e.copyrightMessage),!e.showFeedbackLink&&this.feedbackLink?(this.feedbackLink.remove(),delete this.feedbackLink):e.showFeedbackLink&&!this.feedbackLink&&(this.feedbackLink=this.buildFeedbackLink(),this.container.appendChild(this.feedbackLink)),this.options=e},Kd.prototype.buildCopyrightDiv=function(){var t=document.createElement("div");return t.innerText=this.options.copyrightMessage||"",t},Kd.prototype.buildFeedbackLink=function(){var t=document.createElement("a");return t.textContent="Improve this map",t.href="https://feedback.azuremaps.com",t.target="_blank",t.rel="noopener",t},Kd);function Kd(t){var e=Hd.call(this)||this;return e.options=(new Gd).merge(t),e}var Xd=(Yd.throwOnError=function(t,e){var r=t instanceof Qm?t._getMap():t,i=function(t){throw r.off("error",i),t.error};r.on("error",i);var n=e();return r.off("error",i),n},Yd.tryCatch=function(t,e,r,i){try{return this.throwOnError(t,e)}catch(t){return r(t)}finally{"function"==typeof i&&i()}},Yd.tryFinally=function(t,e,r){try{return this.throwOnError(t,e)}finally{r()}},Yd);function Yd(){}var Jd=($d.prototype.request=function(t){var e={domain:this.map.getServiceOptions().domain,path:"search/address/reverse/json",queryParams:S({"api-version":"1.0",language:t.style.language,limit:1,query:Kn(t.position[1])+","+Xn(t.position[0])},t.style.view&&{view:t.style.view})};return new O(this.map.authentication.signRequest(e)).get()},$d);function $d(t){this.map=t}var Qd=(tf.prototype.cache=function(t,e,r,i){var n=t+"_"+r[0]+"_"+r[1]+"_"+i;this._labelIdx[e.labelType]||(this._labelIdx[e.labelType]=[],this._labelCache[e.labelType]=[]),-1===this._labelIdx[e.labelType].indexOf(n)&&(this._labelCache[e.labelType].push({name:t,radius:e.radius,minZoom:e.minZoom,maxZoom:e.maxZoom||24,position:r}),this._labelIdx[e.labelType].push(n))},tf.prototype.getNearestLabel=function(t,e,r){var i=null,n=this._labelCache[t];if(n)for(var o=1/0,a=0,s=n.length;a<s;a++)if(r>=n[a].minZoom&&r<=n[a].maxZoom){var l=Vn(n[a].position,e);l<=n[a].radius&&l<=o&&(o=l,i=n[a])}return i},tf.prototype._preloadCache=function(t){if(!this._preloadedCache.has(t)){this._preloadedCache.add(t);var e={source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},r=t,i=r.indexOf("-");switch(-1!==i&&(r=r.substr(0,i)),r){case"fr":this.cache("Océan Pacifique",e,[-170,32],t),this.cache("Océan Pacifique",e,[-138,-27],t),this.cache("Océan Atlantique",e,[-40,32],t),this.cache("Océan Atlantique",e,[-17,-29],t);break;case"es":this.cache("Océan Pacifique",e,[-170,32],t),this.cache("Océan Pacifique",e,[-138,-27],t),this.cache("Océano Atlántico",e,[-40,32],t),this.cache("Océano Atlántico",e,[-17,-29],t);break;case"pt":this.cache("Oceano Pacífico",e,[-170,32],t),this.cache("Oceano Pacífico",e,[-138,-27],t),this.cache("Oceano Atlântico",e,[-40,32],t),this.cache("Oceano Atlântico",e,[-17,-29],t);break;case"ja":this.cache("太平洋",e,[-170,32],t),this.cache("太平洋",e,[-138,-27],t);break;case"en":this.cache("Pacific Ocean",e,[-170,32],t),this.cache("Pacific Ocean",e,[-138,-27],t),this.cache("Atlantic Ocean",e,[-40,32],t),this.cache("Atlantic Ocean",e,[-17,-29],t),this.cache("Indian Ocean",e,[77,-26],t)}}},tf);function tf(){this._labelCache={},this._labelIdx={},this._preloadedCache=new Set}var ef=(rf.prototype.dispose=function(){this._disposed=!0,this._map._getMap().off("move",this._onMove),this._map._getMap().off("moveend",this._onMoveEnd),this._map._getMap().off("styledata",this._onStyleData),this._map._getMap().off("rotate",this._onRotate),this._map.getCanvas().removeEventListener("mousedown",this._onPointerDown),this._map.getCanvas().removeEventListener("touchstart",this._onPointerDown),this._map.getMapContainer().removeEventListener("keydown",this._shortcutListener)},rf.prototype._getEventPos=function(t){if("touches"in t){var e=t.touches[0],r=t.target.getBoundingClientRect();return[e.pageX-r.left,e.pageY-r.top]}return[t.offsetX,t.offsetY]},rf.prototype._checkThresholds=function(t,e){return this._checkZoomThreshold(t.zoom,e.zoom)||this._checkPitchThreshold(t.pitch,e.pitch)||this._checkLocThreshold(t.center,e.center)||this._checkHeadingThreshold(t.bearing,e.bearing)},rf.prototype._checkZoomThreshold=function(t,e){return this._round(t)!==this._round(e)},rf.prototype._checkPitchThreshold=function(t,e){return Math.abs(t-e)>=this._pitchThreshold},rf.prototype._checkLocThreshold=function(t,e){var r=this._map.positionsToPixels([e,t]),i=r[0],n=r[1];return sn.getDistance(i,n)>=this._moveThreshold},rf.prototype._checkHeadingThreshold=function(t,e){t<0&&(t+=360),e<0&&(e+=360);var r=Math.abs(t-e);return 180<r&&(r=360-r),r>=this._headingThreshold},rf.prototype._getLocDesc=function(t,e,r){return T(this,void 0,void 0,(function(){var i,n,o,a,s,l,c,u,p,h=this;return E(this,(function(d){switch(d.label){case 0:return"blank"===r?[3,3]:this._map._getMap().loaded()?[3,2]:[4,new Promise((function(t){return h._map._getMap().once("idle",t)}))];case 1:d.sent(),d.label=2;case 2:for(i={},n=this._map.positionsToPixels([t.center])[0],Xd.tryCatch(this._map,(function(){o=h._map._getMap().queryRenderedFeatures(n,{layers:h._polygonStyleLayer,filter:["==",["geometry-type"],"Polygon"]})}),(function(){})),a=null,o&&0<o.length&&(a=o[0]),s=null,l=0,c=this._lableConfig.length;l<c;l++)u=this._lableConfig[l],t.zoom>=u.minZoom?u.polygonSources?a&&-1!==u.polygonSources.indexOf(a.layer["source-layer"])?(s=u.labelType,this._getClosestLabel(u,t,e,i,!1)):this._getClosestLabel(u,t,e,i,!0):this._getClosestLabel(u,t,e,i,!1):this._getClosestLabel(u,t,e,i,!0);return 8<=t.zoom&&this._processRoads(i,t,e),this._labelCache.forEach((function(e){i[e]||(p=null,("water"!==e&&"majorPoi"!==e||e===s)&&(p=rf._labelCache.getNearestLabel(e,t.center,t.zoom)),p&&(i[e]=p.name))})),[2,this._processLocInfo(t,s,i,!0,this._restFallback)];case 3:return[2,this._processLocInfo(t,null,null,!1,!1)]}}))}))},rf.prototype._getHeadingDesc=function(t){var e=t.bearing;switch(e<0&&(e+=360),e=this._round(e,this._headingThreshold)){case 0:case 360:return"north";case 45:return"north east";case 90:return"east";case 135:return"south east";case 180:return"south";case 225:return"south west";case 270:return"west";case 315:return"north west";default:return e+" degrees"}},rf.prototype._getClosestLabel=function(t,e,r,i,n){for(var o=t.radius,a=0,s=t.source.length;a<s;a++){var l={sourceLayer:t.source[a]},c=this._map._getMap().querySourceFeatures(this._baseVectorTileSourceId,l),u=null,p=1/0,h=this._labelCache.has(t.labelType);if(!n||n&&h)for(var d=0,f=c.length;d<f;d++){var m="Point"===c[d].geometry.type?c[d]:uo(e.center,c[d].geometry);if(!n){var g="Point"===c[d].geometry.type?Vn(e.center,m.geometry.coordinates):m.properties.distance;g<p&&(p=g,u=c[d])}h&&rf._labelCache.cache(c[d].properties.name,t,m.geometry.coordinates,r)}if(!n){var y=t.labelType+"Dis";u&&p<=o&&("number"!=typeof i[y]||p<=i[y])&&(i[t.labelType]=u.properties.name,i[y]=p)}}},rf.prototype._processRoads=function(t,e,r,i){var n=this._map._getMap().queryRenderedFeatures(i,{filter:["==",["geometry-type"],"LineString"]});if(n){for(var o=void 0,a=void 0,s=void 0,l=void 0,c=0,u=n.length;c<u;c++)if(this._roadLayers.has(n[c].layer["source-layer"])&&n[c].properties.name&&""!==n[c].properties.name){var p=uo(e.center,n[c]);(!s||p.properties.distance<s.properties.distance)&&(o&&n[c].properties.name===o.properties.name?s=p:o&&n[c].properties.name===o.properties.name?(!l||p.properties.distance<l.properties.distance)&&(l=p,a=n[c]):(l=s,a=o,s=p,o=n[c]))}if(o&&(t.country||(t.country=o.properties.country_code,t.countryDis=0,rf._labelCache.cache(t.country,{source:["Country name"],labelType:"country",radius:5e3,minZoom:0},s.geometry.coordinates,r)),t.state||(t.state=o.properties.country_subdivision,t.stateDis=0,rf._labelCache.cache(t.state,{source:["State name"],labelType:"state",radius:5e3,minZoom:4},s.geometry.coordinates,r)),15<=e.zoom)){var h=this._map.positionsToPixels([e.center,s.geometry.coordinates]),d=sn.getDistance(h[0],h[1]);if((d<this._roadPixelRadius||s.properties.distance<this._minRoadDistance)&&(t.road=o.properties.name),a){var f=this._map.positionsToPixels([l.geometry.coordinates]);((d=sn.getDistance(h[0],f[0]))<this._minIntersectionPixelDistance||l.properties.distance<this._minRoadDistance)&&(t.secondRoad=a.properties.name,t.secondRoadDis=l.properties.distance)}}}},rf.prototype._getActionDesc=function(t){if(this._lastCam){var e=[];if(this._checkLocThreshold(t.center,this._lastCam.center)){var r=["panned"],i=Math.round(Gn(this._lastCam.center,t.center));0===i||360===i?r.push("north"):i<90?r.push("north east"):90===i?r.push("east"):i<180?r.push("south east"):180===i?r.push("south"):i<270?r.push("south west"):270===i?r.push("west"):i<360&&r.push("north west");var n=Vn(this._lastCam.center,t.center,dn.meters);r.push(1e3<n?Fn(n/1e3,2)+" kilometers":Fn(n,2)+" meters"),e.push(r.join(" "))}if(this._checkZoomThreshold(t.zoom,this._lastCam.zoom)){(r=["zoomed"]).push(this._lastCam.zoom<t.zoom?"in":"out");var o=Math.abs(this._lastCam.zoom-t.zoom);1<=o&&(o=Math.ceil(o),r.push(1<o?o+" levels":o+" level")),this._getCanonicalZoom(this._lastCam.zoom)!==this._getCanonicalZoom(t.zoom)&&r.push("to "+this._getCanonicalZoom(t.zoom)+" level"),e.push(r.join(" "))}if(this._checkPitchThreshold(t.pitch,this._lastCam.pitch)){var a=this._round(t.pitch,this._pitchThreshold);if(e.push("pitched to "+a+" degrees"),60===t.pitch||0===t.pitch){var s=60===t.pitch?"maximum":"minimum";e.push("reached "+s+" of "+t.pitch+" degrees")}}return this._checkHeadingThreshold(this._lastCam.bearing,t.bearing)&&e.push("rotated to "+this._getHeadingDesc(t)),e.join(" and ")||null}return null},rf.prototype._getCanonicalZoom=function(t){return(t=this._round(t))<2?"world":t<5?"country":t<11?"state province":t<15?"city":"street"},rf.prototype._processLocInfo=function(t,e,r,i,n){var o=this;return new Promise((function(a,s){var l=[];if(i){var c=[];if(r&&(e&&("water"===e&&r.water?c.push(r.water):"majorPoi"===e&&r.majorPoi&&c.push(r.majorPoi)),0===c.length&&(r.majorPoi&&8<=t.zoom?c.push(r.majorPoi):(r.poi&&14<=t.zoom?c.push(r.poi):r.road&&15<=t.zoom&&(r.secondRoad?c.push(r.road+" & "+r.secondRoad):c.push(r.road)),r.neighbourhood&&12<=t.zoom&&c.push(r.neighbourhood),r.city&&6<=t.zoom&&c.push(r.city)),r.state&&4<=t.zoom&&c.push(r.state),0===c.length?r.water?c.push(r.water):r.country&&c.push(r.country):1===c.length&&r.state&&4<=t.zoom&&r.country&&c.push(r.country))),0<c.length)l.push("<p>Location: ",c.join(", "),".</p>");else if(n&&"water"!==e)return void o._reverseGeocodeDescription(t).then((function(t){a(t)}),(function(){s("<p>Location: unknown</p>")}))}o._returnDetailedDescriptions&&(l.push("<p>Zoom: ",Fn(t.zoom,2),".</p>"),l.push("<p>Latitude: ",Fn(t.center[1],5),".</p>"),l.push("<p>Longitude: ",Fn(t.center[0],5),".</p>")),a(l.join(""))}))},rf.prototype._reverseGeocodeDescription=function(t){var e=this;return new Promise((function(r){var i=e._map.getStyle();e._reverseSearch.request({position:t.center,style:i}).then((function(n){var o={};if(n&&n.addresses&&0<n.addresses.length&&n.addresses[0].address){var a=n.addresses[0].address;a.country&&(o.country=a.country,rf._labelCache.cache(o.country,{source:["Country name"],labelType:"country",radius:5e3,minZoom:0},t.center,i.language)),a.countrySubdivision&&(o.state=a.countrySubdivision,rf._labelCache.cache(o.state,{source:["State name"],labelType:"state",radius:5e3,minZoom:4},t.center,i.language)),a.municipality&&(o.city=a.municipality,rf._labelCache.cache(o.state,{source:["Small city"],labelType:"city",radius:1e3,minZoom:10},t.center,i.language)),a.streetNameAndNumber?o.road=a.streetNameAndNumber:a.street&&(o.road=a.street)}e._processLocInfo(t,null,o,!0,!1).then((function(t){r(t)}))}),(function(i){e._processLocInfo(t,null,null,!0,!1).then((function(t){r(t)}))})).catch((function(i){e._processLocInfo(t,null,null,!0,!1).then((function(t){r(t)}))}))}))},rf.prototype._round=function(t,e){return void 0===e&&(e=1),Math.round(t/e)*e},rf);function rf(t,e){var r=this;this._restFallback=!0,this._disposed=!1,this._lastHeadingTime=0,this._actionQueue=[],this._pointerUpdateDelay=3e3,this._camUpdateDelay=1e3,this._headUpdateLimit=1e3,this._controlEventDelay=500,this._moveThreshold=25,this._headingThreshold=5,this._pitchThreshold=5,this._roadPixelRadius=120,this._minRoadDistance=25,this._minIntersectionPixelDistance=50,this._baseVectorTileSourceId="vectorTiles",this._lableConfig=[{source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},{source:["Sea label"],labelType:"water",minZoom:3,radius:1e6,polygonSources:["Sea","Ocean or sea"]},{source:["Country name"],labelType:"country",minZoom:0,maxZoom:5,radius:3e5},{source:["State name","State name short"],labelType:"state",minZoom:4,maxZoom:7,radius:3e5},{source:["Capital city","Large city"],labelType:"city",minZoom:8,radius:4e4},{source:["Medium city"],labelType:"city",minZoom:8,radius:3e4},{source:["Small city"],labelType:"city",minZoom:8,radius:2e4},{source:["Island label"],labelType:"city",minZoom:8,radius:1e4},{source:["Town"],labelType:"city",minZoom:10,radius:1e4},{source:["Village"],labelType:"neighbourhood",minZoom:12,radius:6e3},{source:["Amusement area label"],labelType:"poi",minZoom:14,radius:2e3,polygonSources:["Amusement park"]},{source:["Hospital label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Hospital"]},{source:["Shopping centre label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Shopping"]},{source:["Stadium label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Stadium"]},{source:["University/School label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["University"]},{source:["Zoo label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Zoo"]},{source:["Airport Label","Airport name","Airport POI"],labelType:"majorPoi",minZoom:11,radius:3e3,polygonSources:["Airport","Runway"]},{source:["National park label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["National or state park","National park","Forest"]},{source:["Reservation label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["Reservation"]}],this._polygonStyleLayer=["National or state park","National park","Reservation","Airport","Runway","Stadium","University","Zoo","Shopping","Hospital","Amusement park","Ocean","Sea","Ocean or sea"],this._labelCache=new Set(["city","state","country","water","majorPoi"]),this._roadLayers=new Set(["Connecting road","Connecting road tunnel","International road","International road tunnel","Local road","Local road tunnel","Major local road","Major local road tunnel","Major road","Major road tunnel","Minor local road","Minor local road tunnel","Motorway","Motorway tunnel","Secondary road","Secondary road tunnel","Toll connecting road","Toll connecting road tunnel","Toll international road","Toll international road tunnel","Toll local road","Toll local road tunnel","Toll major local road","Toll major local road tunnel","Toll major road","Toll major road tunnel","Toll minor local road","Toll minor local road tunnel","Toll motorway","Toll motorway tunnel","Toll secondary road","Toll secondary road tunnel"]),this._returnDetailedDescriptions=!1,this._shortcutListener=function(t){return T(r,void 0,void 0,(function(){var e,r,i,n,o;return E(this,(function(a){switch(a.label){case 0:return t.altKey&&t.ctrlKey&&68===t.keyCode?(this._returnDetailedDescriptions=!this._returnDetailedDescriptions,e=this._map.getCamera(),r=this._map.getStyle(),i=r.language.toLowerCase(),n=r.style.toLowerCase(),[4,this._getLocDesc(e,i,n)]):[3,2];case 1:o=a.sent(),this._descCallback(o),a.label=2;case 2:return[2]}}))}))},this._onRotate=function(){r._rotateTimeout||(Date.now()-r._lastHeadingTime>=r._headUpdateLimit?r._rotateTimeout=setTimeout(r._updateHeading,X.RotationDuration+25):r._rotateTimeout=setTimeout(r._updateHeading,r._headUpdateLimit-(Date.now()-r._lastHeadingTime)))},this._onMove=function(){r._moveTimeout&&(clearTimeout(r._moveTimeout),delete r._moveTimeout),r._controlTimeout&&(clearTimeout(r._controlTimeout),delete r._controlTimeout)},this._onMoveEnd=function(t){t.fromControl?r._controlTimeout=setTimeout(r._updateCam,r._controlEventDelay):r._updateCam()},this._onStyleData=function(){setTimeout(r._updateStyle)},this._onPointerDown=function(t){r._lastPointerPos=r._getEventPos(t),r._pointerTimeout=setTimeout((function(){return T(r,void 0,void 0,(function(){var t,e,r,i,n;return E(this,(function(o){switch(o.label){case 0:return t=this._map.getStyle(),e=t.language.toLowerCase(),r=t.style.toLowerCase(),(i=this._map.getCamera()).center=this._map.pixelsToPositions([this._lastPointerPos])[0],[4,this._getLocDesc(i,e,r)];case 1:return n=o.sent(),this._descCallback(n),this._onPointerUp(),[2]}}))}))}),r._pointerUpdateDelay),r._map.getCanvas().addEventListener("mousemove",r._onPointerMove),r._map.getCanvas().addEventListener("touchmove",r._onPointerMove),r._map.getCanvas().addEventListener("mouseup",r._onPointerUp),r._map.getCanvas().addEventListener("touchend",r._onPointerUp)},this._onPointerMove=function(t){var e=r._getEventPos(t),i=r._lastPointerPos[0]-e[0],n=r._lastPointerPos[1]-e[1];Math.sqrt(i*i+n*n)>r._moveThreshold&&r._onPointerUp()},this._onPointerUp=function(){clearTimeout(r._pointerTimeout),delete r._pointerTimeout,r._map.getCanvas().removeEventListener("mousemove",r._onPointerMove),r._map.getCanvas().removeEventListener("touchmove",r._onPointerMove),r._map.getCanvas().removeEventListener("mouseup",r._onPointerUp),r._map.getCanvas().removeEventListener("touchend",r._onPointerUp)},this._updateHeading=function(){var t=r._map.getCamera();if(!r._lastHead||r._checkHeadingThreshold(t.bearing,r._lastHead)){var e=r._getHeadingDesc(t);r._lastHead=t.bearing,r._descCallback("<p>Map heading "+e+".</p>"),r._lastHeadingTime=Date.now()}delete r._rotateTimeout},this._updateStyle=function(){return T(r,void 0,void 0,(function(){var t,e,r,i,n;return E(this,(function(o){switch(o.label){case 0:return t=this._map.getCamera(),e=this._map.getStyle(),r=e.language.toLowerCase(),i=e.style.toLowerCase(),this._lastLang===r?[3,2]:(rf._labelCache._preloadCache(r),[4,this._getLocDesc(t,r,i)]);case 1:return n=o.sent(),[3,4];case 2:return this._lastStyle===i||"blank"!==this._lastStyle?[3,4]:[4,this._getLocDesc(t,r,i)];case 3:n=o.sent(),o.label=4;case 4:return this._lastLang=r,this._lastStyle=i,n&&this._descCallback(n),[2]}}))}))},this._updateCam=function(t){void 0===t&&(t=!1);var e=r._map.getCamera();if(!r._lastCam||0<r._actionQueue.length||r._checkThresholds(e,r._lastCam)){var i=r._map.getStyle(),n=i.language.toLowerCase(),o=i.style.toLowerCase(),a=r._getActionDesc(e);a&&r._actionQueue.push(a),r._lastCam=e,r._moveTimeout&&(clearTimeout(r._moveTimeout),delete r._moveTimeout),r._moveTimeout=setTimeout((function(){return T(r,void 0,void 0,(function(){var t;return E(this,(function(r){switch(r.label){case 0:return clearTimeout(this._rotateTimeout),delete this._rotateTimeout,[4,this._getLocDesc(e,n,o)];case 1:return t=r.sent(),0<this._actionQueue.length?(this._descCallback("<p>Map "+this._actionQueue.join(", then ")+".</p>"+t),this._actionQueue=[]):this._descCallback(t),[2]}}))}))}),t?0:r._camUpdateDelay)}},this._map=t,this._descCallback=e,this._reverseSearch=new Jd(t),rf._labelCache||(rf._labelCache=new Qd),this._lastLang=this._map.getStyle().language.toLowerCase(),rf._labelCache._preloadCache(this._lastLang),this._map.events.addOnce("load",(function(){r._disposed||(r._updateCam(!0),r._map._getMap().on("move",r._onMove),r._map._getMap().on("moveend",r._onMoveEnd),r._map._getMap().on("styledata",r._onStyleData),r._map._getMap().on("rotate",r._onRotate),r._map.getCanvas().addEventListener("mousedown",r._onPointerDown),r._map.getCanvas().addEventListener("touchstart",r._onPointerDown))})),this._map.getMapContainer().addEventListener("keydown",this._shortcutListener)}var nf,of=function(t){var e=this;this.addToMap=function(){e.initializeMapLiveStateInfo(),e.initializeMapStyleInfo(),e.createMapKeyBindingInfo(),e.map.getMapContainer().setAttribute("role","application"),e.map.getMapContainer().setAttribute("aria-label","Map Application"),e.map.getCanvas().setAttribute("aria-label","Interactive Map"),e.map.getCanvas().setAttribute("aria-describedby","atlas-map-state atlas-map-style atlas-map-shortcuts"),e.map.getCanvas().setAttribute("alt","Interactive Map")},this.removeFromMap=function(){null!=e.mapViewDesc&&e.mapViewDesc.dispose(),delete e.mapViewDesc,null!=e.atlasMapKeyBindings&&e.map.getCanvasContainer().removeChild(e.atlasMapKeyBindings),delete e.atlasMapKeyBindings,null!=e.atlasMapLiveStateInfo&&e.map.getCanvasContainer().removeChild(e.atlasMapLiveStateInfo),delete e.atlasMapLiveStateInfo,null!=e.atlasMapStyleInfo&&e.map.getCanvasContainer().removeChild(e.atlasMapStyleInfo),delete e.atlasMapStyleInfo,e.map.getMapContainer().removeAttribute("role"),e.map.getMapContainer().removeAttribute("aria-label"),e.map.getCanvas().removeAttribute("aria-label"),e.map.getCanvas().removeAttribute("aria-describedby"),e.map.getCanvas().removeAttribute("alt"),e.map.events.remove("styledata",e.updateMapStyle)},this.createMapKeyBindingInfo=function(){e.atlasMapKeyBindings=document.createElement("div"),e.atlasMapKeyBindings.setAttribute("tabindex","-1"),e.atlasMapKeyBindings.setAttribute("aria-hidden","true"),e.atlasMapKeyBindings.id="atlas-map-shortcuts",e.atlasMapKeyBindings.classList.add("hidden-accessible-element"),e.atlasMapKeyBindings.innerHTML=["Map shortcuts:","Zoom out: hyphen.","Zoom in: plus.","Pan right 100 pixels: right arrow.","Pan left 100 pixels: left arrow.","Pan up 100 pixels: up arrow.","Pan down 100 pixels: down arrow.","Rotate 15 degrees clockwise: shift + right arrow.","Rotate 15 degrees counter clockwise: shift + left arrow.","Increase pitch 10 degrees: shift + up arrow.","Decrease pitch 10 degrees: shift + down arrow.","Toggle verbose map state: control + alt + D.","Jump focus to the map: Escape."].join("\n"),e.map.getCanvasContainer().appendChild(e.atlasMapKeyBindings),e.atlasMapKeyBindings.setAttribute("aria-live","polite")},this.initializeMapLiveStateInfo=function(){e.mapViewDesc=new ef(e.map,e.updateMapState),e.atlasMapLiveStateInfo=document.createElement("div"),e.atlasMapLiveStateInfo.setAttribute("tabindex","-1"),e.atlasMapLiveStateInfo.setAttribute("aria-hidden","true"),e.atlasMapLiveStateInfo.id="atlas-map-state",e.atlasMapLiveStateInfo.classList.add("hidden-accessible-element"),e.map.getCanvasContainer().appendChild(e.atlasMapLiveStateInfo),e.atlasMapLiveStateInfo.setAttribute("aria-live","polite")},this.initializeMapStyleInfo=function(){e.atlasMapStyleInfo=document.createElement("div"),e.atlasMapStyleInfo.setAttribute("tabindex","-1"),e.atlasMapStyleInfo.setAttribute("aria-hidden","true"),e.atlasMapStyleInfo.id="atlas-map-style",e.atlasMapStyleInfo.classList.add("hidden-accessible-element"),e.updateMapStyle(),e.map.events.add("styledata",e.updateMapStyle),e.map.getCanvasContainer().appendChild(e.atlasMapStyleInfo),e.atlasMapStyleInfo.setAttribute("aria-live","polite")},this.updateMapStyle=function(){e.atlasMapStyleInfo.innerHTML="<p>Map style: "+e.map.getStyle().style+".</p>"},this.updateMapState=function(t){e.atlasMapLiveStateInfo.innerHTML=t},this.map=t},af=function(t){var e=this;this.callCounter=0,this.listenerEnabled=!1,this.flowComponent=void 0,this.flowPath=void 0,this.addToMap=function(){if(!e.map._isReady())throw new Error("Traffic flow could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before enabling traffic flow.");e.listenerEnabled||(e.map.events.add("styledata",e.addToMap),e.listenerEnabled=!0);var t=e.map.getStyle(),r=e.map.getTraffic(),i=e.map.styles.getFlowPath(t,r);if(i&&e.flowPath!==i){e.callCounter++;var n=e.callCounter;e.map.styles.getFlowComponent(t,r).then((function(t){if(e.callCounter===n){e.flowComponent&&(e.map.layers.remove(e.flowComponent.layer),e.map.sources.remove(e.flowComponent.sources),delete e.flowComponent);var r=e.map.layers.getLayers(),o=r.findIndex((function(t){return"transit"===t.getId()})),a=-1!==o?r[o+1]:void 0;e.map.sources.add(t.sources),e.map.layers.add(t.layer,a),e.flowComponent=t,e.flowPath=i}}))}},this.removeFromMap=function(){e.callCounter++,e.listenerEnabled&&(e.map.events.remove("styledata",e.addToMap),e.listenerEnabled=!1),e.flowPath&&delete e.flowPath,e.flowComponent&&(e.map.layers.remove(e.flowComponent.layer),e.map.sources.remove(e.flowComponent.sources),delete e.flowComponent)},this.map=t},sf=(w(lf,nf=I),lf);function lf(){var t=null!==nf&&nf.apply(this,arguments)||this;return t.version="1.0",t.bbox=void 0,t.zoom=void 0,t.params={},t}var cf=(uf.prototype.request=function(t){var e,r=(new sf).merge(t),i=this.map.getServiceOptions().domain;e=Co.getWest(r.bbox)<-180&&180<Co.getEast(r.bbox)?Co.getSouth(r.bbox)+",-180,"+Co.getNorth(r.bbox)+",180":Co.getSouth(r.bbox)+","+Xn(Co.getWest(r.bbox))+","+Co.getNorth(r.bbox)+","+Xn(Co.getEast(r.bbox));var n={domain:i,path:"traffic/incident/detail/json",queryParams:S({"api-version":r.version,projection:"EPSG4326",style:"s3",boundingbox:e,boundingzoom:r.zoom,trafficmodelid:-1},r.params)};return new O(this.map.authentication.signRequest(n)).get()},uf);function uf(t){this.map=t}var pf,hf,df,ff=(w(mf,pf=nn),mf.getIncidentTypeName=function(t,e){switch(t){case 0:return e.Unknown;case 1:return e.Accident;case 2:return e.Fog;case 3:return e.Danger;case 4:return e.Rain;case 5:return e.Ice;case 6:return e.Jam;case 7:return e.LaneClosed;case 8:return e.RoadClosed;case 9:return e.RoadWorks;case 10:return e.Wind;case 11:return e.Flood;case 12:return e.Detour;default:return e.Unknown}},mf.getIncidentTypeIconName=function(t){switch(t){case 0:return"unknown";case 1:return"accident";case 2:return"fog";case 3:return"danger";case 4:return"rain";case 5:return"ice";case 6:return"jam";case 7:return"lane-closed";case 8:return"road-closed";case 9:return"road-work";case 10:return"wind";case 11:return"flood";case 12:return"detour";default:return"unknown"}},mf.getSeverityColorName=function(t){switch(t){case 0:return"grey";case 1:return"yellow";case 2:return"orange";case 3:return"red";case 4:default:return"grey"}},mf.getSeverityColorHexCode=function(t){switch(t){case 0:return"#B5B6B7";case 1:return"#F4C951";case 2:return"#F4873F";case 3:return"#F04F4E";case 4:default:return"#B5B6B7"}},mf);function mf(t,e){var r=new cn(new ho(t.op.x,t.op.y)),i={icon:mf.getSeverityColorName(t.ty)+"-"+mf.getIncidentTypeIconName(t.ic),incidentType:mf.getIncidentTypeName(t.ic,e),description:t.d,length:t.l,delay:t.dl,from:t.f,color:mf.getSeverityColorHexCode(t.ty),to:t.t,id:t.id};return pf.call(this,r,i)||this}(df=hf=hf||{}).DELAY="delay",df.LENGTH="length",df.FROM="from",df.TO="to";var gf=(yf.build=function(t,e){void 0===e&&(e="en-US");var r=document.createElement("div");r.classList.add("incident-popup-title"),r.classList.add("font-segoeui-b"),r.setAttribute("tabindex","0"),r.innerText=t.properties.incidentType,r.setAttribute("aria-label","Incident Type "+t.properties.incidentType);var i=document.createElement("div");i.classList.add("incident-popup-subtitle"),i.classList.add("font-segoeui-b"),i.setAttribute("aria-label","Incident Description "+t.properties.description),i.setAttribute("tabindex","0"),i.innerText=t.properties.description;var n=document.createElement("div");n.classList.add("incident-popup-header"),n.style.backgroundColor=t.properties.color,n.appendChild(r),n.appendChild(i);var o=document.createElement("div");if(o.classList.add("incident-popup-body"),t.properties.delay){var a=Math.floor(t.properties.delay/60)+" min",s=this.createInfoSection(a,hf.DELAY);o.appendChild(s)}if(t.properties.length){var l=new Intl.NumberFormat([e,"en-US"],{maximumFractionDigits:2}),c=void 0;if("en-US"===e){var u=jn(t.properties.length,"meters","miles");c=l.format(u)+" miles"}else{var p=jn(t.properties.length,"meters","kilometers");c=l.format(p)+" km"}var h=this.createInfoSection(c,hf.LENGTH);o.appendChild(h)}if(t.properties.from){var d=this.createInfoSection(t.properties.from,hf.FROM);o.appendChild(d)}if(t.properties.to){var f=this.createInfoSection(t.properties.to,hf.TO);o.appendChild(f)}var m=document.createElement("div");return m.classList.add("incident-popup-content"),m.appendChild(n),m.appendChild(o),new Os({content:m,position:t.geometry.coordinates})},yf.createInfoSection=function(t,e){var r=document.createElement("div");r.classList.add("incident-popup-info");var i=document.createElement("div");i.classList.add("icon"),i.classList.add(e);var n=document.createElement("span");return n.classList.add("message"),n.classList.add("font-segoeui"),n.setAttribute("aria-label","Incident "+e+" "+t),n.setAttribute("tabindex","0"),n.innerText=t,r.appendChild(i),r.appendChild(n),r},yf);function yf(){}var vf,_f=function(t){var e=this;this.incidentLayerName="incidents",this.popups=new hi,this.addToMap=function(){e.map.addPins([],{name:e.incidentLayerName,cluster:!1}),e.map.addEventListener("mouseenter",e.incidentLayerName,e.cursorToPointer),e.map.addEventListener("mouseleave",e.incidentLayerName,e.cursorToDefault),e.map.addEventListener("click",e.incidentLayerName,e.openIncidentPopup),e.map.events.add("moveend",e.updateIncidents),e.map.events.add("styledata",e.updateLanguage),e.updateIncidents()},this.removeFromMap=function(){e.map.removeLayers([e.incidentLayerName]),e.map.removeEventListener("click",e.incidentLayerName,e.openIncidentPopup),e.map.removeEventListener("mouseenter",e.incidentLayerName,e.cursorToPointer),e.map.removeEventListener("mouseleave",e.incidentLayerName,e.cursorToDefault),e.map.events.remove("moveend",e.updateIncidents),e.map.events.remove("styledata",e.updateLanguage),e.cleanUpPopups()},this.updateIncidents=function(){var t=Math.ceil(e.map.getCamera().zoom),r=e.map.getCamera().bounds;e.incidentLanguage=e.map.getStyle().language;var i=e.map._getLocalizedStrings(),n=e.incidentService.request({bbox:r,zoom:t,params:{expandCluster:!0,originalPosition:!0,language:e.incidentLanguage}});Promise.all([n,i]).then((function(t){var i=t[0],n=t[1];if(e.map.getTraffic().incidents){var o=[];e.cleanUpPopups();for(var a=0,s=i.tm.poi||[];a<s.length;a++)for(var l=s[a],c=function(t){if(Co.containsPosition(r,[t.op.x,t.op.y])){var i=new ff(t,n);o.push(i);var a=gf.build(i,e.incidentLanguage);e.popups.set(i.properties.id,a),e.map.events.add("open",a,(function(){e.openPopupId=i.properties.id,e.popups.forEach((function(t,r){e.openPopupId!==r&&t.close()}))})),e.map.events.add("close",a,(function(){e.openPopupId===i.properties.id&&delete e.openPopupId})),e.openPopupId===i.properties.id?e.popups.get(i.properties.id).open(e.map):e.popups.get(i.properties.id).attach(e.map)}},u=0,p=l.cpoi||[l];u<p.length;u++)c(p[u]);e.map.addPins(o,{overwrite:!0,name:e.incidentLayerName})}}))},this.cursorToPointer=function(t){e.map.getCanvas().style.cursor="pointer"},this.cursorToDefault=function(t){e.map.getCanvas().style.cursor=""},this.openIncidentPopup=function(t){var r=t.features[0].properties.id;e.popups.has(r)&&e.popups.get(r).open(e.map)},this.cleanUpPopups=function(){e.popups.forEach((function(t){t.remove()})),e.popups.clear()},this.updateLanguage=function(){e.map.getStyle().language!==e.incidentLanguage&&e.updateIncidents()},this.map=t,this.incidentService=new cf(this.map)},xf=(w(bf,vf=I),bf);function bf(){var t=null!==vf&&vf.apply(this,arguments)||this;return t.interactive=!0,t.scrollZoomInteraction=!0,t.boxZoomInteraction=!0,t.dragRotateInteraction=!0,t.dragPanInteraction=!0,t.keyboardInteraction=!0,t.dblClickZoomInteraction=!0,t.touchInteraction=!0,t.wheelZoomRate=1/450,t}var wf=(Sf.prototype.enable=function(){this.map.getMapContainer().addEventListener("keydown",this._onKeyDown)},Sf.prototype.disable=function(){this.map.getMapContainer().removeEventListener("keydown",this._onKeyDown)},Sf);function Sf(t){var e=this;this._onKeyDown=function(t){27===t.keyCode&&e.map.getCanvas().focus()},this.map=t}var Tf=(Ef.prototype.enable=function(){this.map._getMap().on("touchstart",this._onTouchStart),this.map._getMap().on("touchmove",this._onTouchMove),this.map._getMap().on("touchend",this._onTouchEnd),this.map._getMap().on("touchcancel",this._onTouchCancel)},Ef.prototype.disable=function(){this.map._getMap().off("touchstart",this._onTouchStart),this.map._getMap().off("touchmove",this._onTouchMove),this.map._getMap().off("touchend",this._onTouchEnd),this.map._getMap().off("touchcancel",this._onTouchCancel)},Ef);function Ef(t){var e=this;this.minDiffX=70,this.maxDiffY=100,this.minDiff=30,this.delay=160,this._onTouchStart=function(t){if(2===t.points.length){var r=t.points[0].y-t.points[1].y,i=t.points[0].x-t.points[1].x;Math.abs(i)>=e.minDiffX&&Math.abs(r)<=e.maxDiffY&&(t.originalEvent.preventDefault(),e.map._getMap().touchZoomRotate.disable(),e.map._getMap().dragPan.disable(),e.dpPoint=t.point,e.dpPitch=e.map._getMap().getPitch(),e.startTiming=Date.now(),e.startDistance=Math.hypot(i,r),e.startEventData=t)}},this._onTouchMove=function(t){if(void 0!==e.dpPoint&&void 0!==e.dpPitch){t.preventDefault(),t.originalEvent.preventDefault();var r=t.points[0].y-t.points[1].y,i=t.points[0].x-t.points[1].x,n=Math.hypot(i,r);if(Math.abs(n-e.startDistance)>=e.minDiff)return e.dpPoint&&(e.map._getMap().touchZoomRotate.enable(),e.map._getMap().dragPan.enable(),e.map._getMap().touchZoomRotate.onStart(Date.now()-e.startTiming>=e.delay?t.originalEvent:e.startEventData.originalEvent)),void(e.dpPoint=void 0);if(Date.now()-e.startTiming>=e.delay){var o=.5*(e.dpPoint.y-t.point.y);e.map._getMap().setPitch(e.dpPitch+o)}}},this._onTouchEnd=function(){e.dpPoint&&(e.map._getMap().touchZoomRotate.enable(),e.map._getMap().dragPan.enable()),e.dpPoint=void 0},this._onTouchCancel=function(){e.dpPoint&&(e.map._getMap().touchZoomRotate.enable(),e.map._getMap().dragPan.enable()),e.dpPoint=void 0},this.map=t}var If=(Cf.prototype.enable=function(){this.map.getCanvasContainer().addEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().addEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().addEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().addEventListener("touchend",this._onTouchEnd)},Cf.prototype.disable=function(){this.map.getCanvasContainer().removeEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().removeEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().removeEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().removeEventListener("touchend",this._onTouchEnd)},Cf);function Cf(t){var e=this;this._onGestureStart=function(t){e.hasTouch||(t.preventDefault(),e.initZoom=e.map.getCamera().zoom)},this._onGestureChange=function(t){e.hasTouch||(t.preventDefault(),e.map.setCamera({zoom:e.initZoom+t.scale-1}))},this._onTouchStart=function(t){e.hasTouch=!0},this._onTouchEnd=function(t){0===t.touches.length&&(e.hasTouch=!1)},this.map=t}var Af=(kf.prototype.addToMap=function(){this.added||(this.added=!0,this._setInteractions(this.options))},kf.prototype.removeFromMap=function(){this.added&&(this.added=!1,this._setInteractions({interactive:!1}))},kf.prototype.setOptions=function(t){this.options=(new xf).merge(this.options,t),this.added&&this._setInteractions(this.options)},kf.prototype.getOptions=function(){return Object.assign({},this.options)},kf.prototype._setInteractions=function(t){t.interactive?(t.boxZoomInteraction?this.map._getMap().boxZoom.enable():this.map._getMap().boxZoom.disable(),t.dblClickZoomInteraction?this.map._getMap().doubleClickZoom.enable():this.map._getMap().doubleClickZoom.disable(),t.dragPanInteraction?this.map._getMap().dragPan.enable():this.map._getMap().dragPan.disable(),t.dragRotateInteraction?this.map._getMap().dragRotate.enable():this.map._getMap().dragRotate.disable(),t.keyboardInteraction?(this.map._getMap().keyboard.enable(),this.focusShortcut.enable()):(this.map._getMap().keyboard.disable(),this.focusShortcut.disable()),t.scrollZoomInteraction?(this.map._getMap().scrollZoom.enable(),this.map._getMap().scrollZoom.setWheelZoomRate(t.wheelZoomRate)):this.map._getMap().scrollZoom.disable(),t.touchInteraction?(this.map._getMap().touchZoomRotate.enable(),this.mobilePitch.enable()):(this.map._getMap().touchZoomRotate.disable(),this.mobilePitch.disable()),this.pinchZoom.enable()):(this.map._getMap().boxZoom.disable(),this.map._getMap().doubleClickZoom.disable(),this.map._getMap().dragPan.disable(),this.map._getMap().dragRotate.disable(),this.map._getMap().keyboard.disable(),this.focusShortcut.disable(),this.map._getMap().scrollZoom.disable(),this.map._getMap().touchZoomRotate.disable(),this.mobilePitch.disable(),this.pinchZoom.disable())},kf);function kf(t,e){this.added=!1,this.map=t,this.mobilePitch=new Tf(t),this.focusShortcut=new wf(t),this.pinchZoom=new If(t),this.options=(new xf).merge(e)}var Pf=i((function(t){var e=(e=function(t){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},e.prototype._singletonInstance)return e.prototype._singletonInstance;if((e.prototype._singletonInstance=this).instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,t.displayCall&&"function"!=typeof t.displayCall)throw new Error("displayCall is not a function");if(!t.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(t),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(t){}}),e.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var t=this._guid();this.config.state=t,this._idTokenNonce=this._guid();var e=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);e&&""!==e?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):e=window.location.href,this.verbose("Expected state: "+t+" startPage:"+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,t,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var r=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(r):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(t),this.registerCallback(t,this.config.clientId,this.callback),this._loginPopup(r)):this.promptUser(r)}},e.prototype._openPopup=function(t,e,r,i){try{var n=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=a/2-r/2+n,c=s/2-i/2+o,u=window.open(t,e,"width="+r+", height="+i+", top="+c+", left="+l);return u.focus&&u.focus(),u}catch(t){return this.warn("Error opening popup, "+t.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},e.prototype._handlePopupError=function(t,e,r,i,n){this.warn(i),this._saveItem(this.CONSTANTS.STORAGE.ERROR,r),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,i),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,n),e&&this._activeRenewals[e]&&(this._activeRenewals[e]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,t&&t(i,null,r)},e.prototype._loginPopup=function(t,e,r){var i=this._openPopup(t,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),n=r||this.callback;if(null!=i){if(this._openedWindows.push(i),-1!=this.config.redirectUri.indexOf("#"))var o=this.config.redirectUri.split("#")[0];else o=this.config.redirectUri;var a=this,s=window.setInterval((function(){if(!i||i.closed||void 0===i.closed){var t="Popup Window closed",r="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return a.isAngular&&a._broadcast("adal:popUpClosed",r+a.CONSTANTS.RESOURCE_DELIMETER+t),a._handlePopupError(n,e,t,r,r),void window.clearInterval(s)}try{var l=i.location;if(-1!=encodeURI(l.href).indexOf(encodeURI(o)))return a.isAngular?a._broadcast("adal:popUpHashChanged",l.hash):a.handleWindowCallback(l.hash),window.clearInterval(s),a._loginInProgress=!1,a._acquireTokenInProgress=!1,a.info("Closing popup window"),a._openedWindows=[],void i.close()}catch(t){}}),1)}else{var l="Popup Window is null. This can happen if you are using IE";this._handlePopupError(n,e,"Error opening popup",l,l)}},e.prototype._broadcast=function(t,e){function r(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r}"function"!=typeof window.CustomEvent&&(r.prototype=window.Event.prototype,window.CustomEvent=r);var i=new CustomEvent(t,{detail:e});window.dispatchEvent(i)},e.prototype.loginInProgress=function(){return this._loginInProgress},e.prototype._hasResource=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return e&&!this._isEmpty(e)&&-1<e.indexOf(t+this.CONSTANTS.RESOURCE_DELIMETER)},e.prototype.getCachedToken=function(t){if(!this._hasResource(t))return null;var e=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t),r=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t),i=this.config.expireOffsetSeconds||300;return r&&r>this._now()+i?e:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0),null)},e.prototype.getCachedUser=function(){if(this._user)return this._user;var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(t),this._user},e.prototype.registerCallback=function(t,e,r){this._activeRenewals[e]=t,this._callBacksMappedToRenewStates[t]||(this._callBacksMappedToRenewStates[t]=[]);var i=this;this._callBacksMappedToRenewStates[t].push(r),this._callBackMappedToRenewStates[t]||(this._callBackMappedToRenewStates[t]=function(r,n,o,a){i._activeRenewals[e]=null;for(var s=0;s<i._callBacksMappedToRenewStates[t].length;++s)try{i._callBacksMappedToRenewStates[t][s](r,n,o,a)}catch(o){i.warn(o)}i._callBacksMappedToRenewStates[t]=null,i._callBackMappedToRenewStates[t]=null})},e.prototype._renewToken=function(t,e,r){this.info("renewToken is called for resource:"+t);var i=this._addAdalFrame("adalRenewFrame"+t),n=this._guid()+"|"+t;this.config.state=n,this._renewStates.push(n),this.verbose("Renew token Expected state: "+n),r=r||"token";var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(r,t),"prompt");r===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o+="&prompt=none",o=this._addHintParameters(o),this.registerCallback(n,t,e),this.verbosePii("Navigate to:"+o),i.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+t,t)},e.prototype._renewIdToken=function(t,e){this.info("renewIdToken is called");var r=this._addAdalFrame("adalIdTokenFrame"),i=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=i,this._renewStates.push(i),this.verbose("Renew Idtoken Expected state: "+i);var n=null==e?null:this.config.clientId,o=(e=e||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(e,n),"prompt"));o+="&prompt=none",o=this._addHintParameters(o),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(i,this.config.clientId,t),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},e.prototype._urlContainsQueryStringParameter=function(t,e){return new RegExp("[\\?&]"+t+"=").test(e)},e.prototype._urlRemoveQueryStringParameter=function(t,e){var r=new RegExp("(\\&"+e+"=)[^&]+");return t=t.replace(r,""),r=new RegExp("("+e+"=)[^&]+&"),t=t.replace(r,""),r=new RegExp("("+e+"=)[^&]+"),t.replace(r,"")},e.prototype._loadFrameTimeout=function(t,e,r){this.verbose("Set loading state to pending for: "+r),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+r,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(t,e);var i=this;setTimeout((function(){if(i._getItem(i.CONSTANTS.STORAGE.RENEW_STATUS+r)===i.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){i.verbose("Loading frame has timed out after: "+i.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+r);var t=i._activeRenewals[r];t&&i._callBackMappedToRenewStates[t]&&i._callBackMappedToRenewStates[t]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),i._saveItem(i.CONSTANTS.STORAGE.RENEW_STATUS+r,i.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}}),i.CONSTANTS.LOADFRAME_TIMEOUT)},e.prototype._loadFrame=function(t,e){var r=this;r.info("LoadFrame: "+e);var i=e;setTimeout((function(){var e=r._addAdalFrame(i);""!==e.src&&"about:blank"!==e.src||(e.src=t,r._loadFrame(t,i))}),500)},e.prototype.acquireToken=function(t,e){if(this._isEmpty(t))return this.warn("resource is required"),void e("resource is required",null,"resource is required");var r=this.getCachedToken(t);return r?(this.info("Token is already in cache for resource:"+t),void e(null,r,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[t]?this.registerCallback(this._activeRenewals[t],t,e):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,t===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(e)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(e,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(t,e)):(this.verbose("renewing idtoken and access_token"),this._renewToken(t,e,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void e("User login is required",null,"login required"))},e.prototype.acquireTokenPopup=function(t,e,r,i){if(this._isEmpty(t))return this.warn("resource is required"),void i("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void i("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void i("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var n=this._guid()+"|"+t;this.config.state=n,this._renewStates.push(n),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+n);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(o+="&prompt=select_account",e&&(o+=e),r&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(r);else if(r&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this.registerCallback(n,t,i),this._loginPopup(o,t,i)},e.prototype.acquireTokenRedirect=function(t,e,r){if(this._isEmpty(t))return this.warn("resource is required"),void i("resource is required",null,"resource is required");var i=this.callback;if(!this._user)return this.warn("User login is required"),void i("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void i("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var n=this._guid()+"|"+t;this.config.state=n,this.verbose("Renew token Expected state: "+n);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(o+="&prompt=select_account",e&&(o+=e),r&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(r);else if(r&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,n,!0),this.promptUser(o)},e.prototype.promptUser=function(t){t?(this.infoPii("Navigate to:"+t),window.location.replace(t)):this.info("Navigate url is empty")},e.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(t)){t=t.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var e=0;e<t.length&&""!==t[e];e++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t[e],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t[e],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},e.prototype.clearCacheForResource=function(t){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(t)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0))},e.prototype.logOut=function(){var t;if(this.clearCache(),this._user=null,this.config.logOutUri)t=this.config.logOutUri;else{var e="common",r="";this.config.tenant&&(e=this.config.tenant),this.config.postLogoutRedirectUri&&(r="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),t=this.instance+e+"/oauth2/logout?"+r}this.infoPii("Logout navigate to: "+t),this.promptUser(t)},e.prototype._isEmpty=function(t){return void 0===t||!t||0===t.length},e.prototype.getUser=function(t){if("function"!=typeof t)throw new Error("callback is not a function");if(this._user)t(null,this._user);else{var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(e)?(this.warn("User information is not available"),t("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(e),t(null,this._user))}},e.prototype._addHintParameters=function(t){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==t.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",t)||(t+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",t)||(t+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",t)&&-1<this._user.profile.upn.indexOf("@"))){var e=this._user.profile.upn.split("@");t+="&domain_hint="+encodeURIComponent(e[e.length-1])}return t},e.prototype._createUser=function(t){var e=null,r=this._extractIdToken(t);return r&&r.hasOwnProperty("aud")&&(r.aud.toLowerCase()===this.config.clientId.toLowerCase()?(e={userName:"",profile:r},r.hasOwnProperty("upn")?e.userName=r.upn:r.hasOwnProperty("email")&&(e.userName=r.email)):this.warn("IdToken has invalid aud field")),e},e.prototype._getHash=function(t){return-1<t.indexOf("#/")?t=t.substring(t.indexOf("#/")+2):-1<t.indexOf("#")&&(t=t.substring(1)),t},e.prototype.isCallback=function(t){t=this._getHash(t);var e=this._deserialize(t);return e.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},e.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},e.prototype.getRequestInfo=function(t){t=this._getHash(t);var e=this._deserialize(t),r={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(e&&((r.parameters=e).hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){r.valid=!0;var i="";if(!e.hasOwnProperty("state"))return this.warn("No state returned"),r;if(this.verbose("State: "+e.state),i=e.state,r.stateResponse=i,this._matchState(r))return r;if(!r.stateMatch&&window.parent){r.requestType=this._requestType;for(var n=this._renewStates,o=0;o<n.length;o++)if(n[o]===r.stateResponse){r.stateMatch=!0;break}}}return r},e.prototype._matchNonce=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(e){e=e.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<e.length;r++)if(e[r]===t.profile.nonce)return!0}return!1},e.prototype._matchState=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(e){e=e.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<e.length;r++)if(e[r]===t.stateResponse)return t.requestType=this.REQUEST_TYPE.LOGIN,t.stateMatch=!0}var i=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(i)for(i=i.split(this.CONSTANTS.CACHE_DELIMETER),r=0;r<i.length;r++)if(i[r]===t.stateResponse)return t.requestType=this.REQUEST_TYPE.RENEW_TOKEN,t.stateMatch=!0;return!1},e.prototype._getResourceFromState=function(t){if(t){var e=t.indexOf("|");if(-1<e&&e+1<t.length)return t.substring(e+1)}return""},e.prototype.saveTokenFromHash=function(t){this.info("State status:"+t.stateMatch+"; Request type:"+t.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var e,r=this._getResourceFromState(t.stateResponse);t.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+t.parameters.error+"; Error description:"+t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,t.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),t.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,t.parameters.error_description))):t.stateMatch?(this.info("State is right"),t.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,t.parameters[this.CONSTANTS.SESSION_STATE]),t.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(r)||(e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,e+r+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+r,t.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+r,this._expiresIn(t.parameters[this.CONSTANTS.EXPIRES_IN]))),t.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(t.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,t.parameters[this.CONSTANTS.ID_TOKEN]),r=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(r)||(e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,e+r+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+r,t.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+r,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(t.parameters.error="invalid id_token",t.parameters.error_description="Invalid id_token. id_token: "+t.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+t.parameters[this.CONSTANTS.ID_TOKEN])))):(t.parameters.error="Invalid_state",t.parameters.error_description="Invalid_state. state: "+t.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+t.stateResponse)),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+r,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},e.prototype.getResourceForEndpoint=function(t){if(this.config&&this.config.anonymousEndpoints)for(var e=0;e<this.config.anonymousEndpoints.length;e++)if(-1<t.indexOf(this.config.anonymousEndpoints[e]))return null;if(this.config&&this.config.endpoints)for(var r in this.config.endpoints)if(-1<t.indexOf(r))return this.config.endpoints[r];return(-1<t.indexOf("http://")||-1<t.indexOf("https://"))&&this._getHostFromUri(t)!==this._getHostFromUri(this.config.redirectUri)?null:this.config.loginResource},e.prototype._getHostFromUri=function(t){var e=String(t).replace(/^(https?:)\/\//,"");return e.split("/")[0]},e.prototype.handleWindowCallback=function(t){if(null==t&&(t=window.location.hash),this.isCallback(t)){var e=null,r=!1;0<this._openedWindows.length&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(e=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,r=!0):window.parent&&window.parent._adalInstance&&(e=window.parent._adalInstance);var i,n,o=e.getRequestInfo(t),a=null;n=r||window.parent!==window?e._callBackMappedToRenewStates[o.stateResponse]:e.callback,e.info("Returned from redirect url"),e.saveTokenFromHash(o),o.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?e.verbose("Window is in iframe, acquiring token silently"):e.verbose("acquiring token interactive in progress"),i=o.parameters[e.CONSTANTS.ACCESS_TOKEN]||o.parameters[e.CONSTANTS.ID_TOKEN],a=e.CONSTANTS.ACCESS_TOKEN):o.requestType===this.REQUEST_TYPE.LOGIN&&(i=o.parameters[e.CONSTANTS.ID_TOKEN],a=e.CONSTANTS.ID_TOKEN);var s=o.parameters[e.CONSTANTS.ERROR_DESCRIPTION],l=o.parameters[e.CONSTANTS.ERROR];try{n&&n(s,i,l,a)}catch(t){e.error("Error occurred in user defined callback function: "+t)}window.parent!==window||r||(e.config.navigateToLoginRequestUrl?window.location.href=e._getItem(e.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},e.prototype._getNavigateUrl=function(t,e){var r="common";this.config.tenant&&(r=this.config.tenant);var i=this.instance+r+"/oauth2/authorize"+this._serialize(t,this.config,e)+this._addLibMetadata();return this.info("Navigate url:"+i),i},e.prototype._extractIdToken=function(t){var e=this._decodeJwt(t);if(!e)return null;try{var r=e.JWSPayload,i=this._base64DecodeStringUrlSafe(r);return i?JSON.parse(i):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(t){this.error("The returned id_token could not be decoded",t)}return null},e.prototype._base64DecodeStringUrlSafe=function(t){return t=t.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(t))):decodeURIComponent(escape(this._decode(t)))},e.prototype._decode=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=(t=String(t).replace(/=+$/,"")).length;if(r%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var i,n,o,a,s,l,c,u,p="",h=0;h<r;h+=4){if(i=e.indexOf(t.charAt(h)),n=e.indexOf(t.charAt(h+1)),o=e.indexOf(t.charAt(h+2)),a=e.indexOf(t.charAt(h+3)),h+2===r-1){l=(s=i<<18|n<<12|o<<6)>>16&255,c=s>>8&255,p+=String.fromCharCode(l,c);break}if(h+1===r-1){l=(s=i<<18|n<<12)>>16&255,p+=String.fromCharCode(l);break}l=(s=i<<18|n<<12|o<<6|a)>>16&255,c=s>>8&255,u=255&s,p+=String.fromCharCode(l,c,u)}return p},e.prototype._decodeJwt=function(t){if(this._isEmpty(t))return null;var e=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);return!e||e.length<4?(this.warn("The returned id_token is not parseable."),null):{header:e[1],JWSPayload:e[2],JWSSig:e[3]}},e.prototype._convertUrlSafeToRegularBase64EncodedString=function(t){return t.replace("-","+").replace("_","/")},e.prototype._serialize=function(t,e,r){var i=[];if(null!==e){i.push("?response_type="+t),i.push("client_id="+encodeURIComponent(e.clientId)),r&&i.push("resource="+encodeURIComponent(r)),i.push("redirect_uri="+encodeURIComponent(e.redirectUri)),i.push("state="+encodeURIComponent(e.state)),e.hasOwnProperty("slice")&&i.push("slice="+encodeURIComponent(e.slice)),e.hasOwnProperty("extraQueryParameter")&&i.push(e.extraQueryParameter);var n=e.correlationId?e.correlationId:this._guid();i.push("client-request-id="+encodeURIComponent(n))}return i.join("&")},e.prototype._deserialize=function(t){function e(t){return decodeURIComponent(t.replace(i," "))}var r,i=/\+/g,n=/([^&=]+)=([^&]*)/g,o={};for(r=n.exec(t);r;)o[e(r[1])]=e(r[2]),r=n.exec(t);return o},e.prototype._decimalToHex=function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e},e.prototype._guid=function(){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues){var e=new Uint8Array(16);return t.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,this._decimalToHex(e[0])+this._decimalToHex(e[1])+this._decimalToHex(e[2])+this._decimalToHex(e[3])+"-"+this._decimalToHex(e[4])+this._decimalToHex(e[5])+"-"+this._decimalToHex(e[6])+this._decimalToHex(e[7])+"-"+this._decimalToHex(e[8])+this._decimalToHex(e[9])+"-"+this._decimalToHex(e[10])+this._decimalToHex(e[11])+this._decimalToHex(e[12])+this._decimalToHex(e[13])+this._decimalToHex(e[14])+this._decimalToHex(e[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef",n=0,o="",a=0;a<36;a++)"-"!==r[a]&&"4"!==r[a]&&(n=16*Math.random()|0),"x"===r[a]?o+=i[n]:"y"===r[a]?(n&=3,o+=i[n|=8]):o+=r[a];return o},e.prototype._expiresIn=function(t){return t=t||3599,this._now()+parseInt(t,10)},e.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},e.prototype._addAdalFrame=function(t){if(void 0!==t){this.info("Add adal frame to document:"+t);var e=document.getElementById(t);if(!e){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var r=document.createElement("iframe");r.setAttribute("id",t),r.setAttribute("aria-hidden","true"),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height=r.borderWidth="0px",e=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+t+'" id="'+t+'" style="display:none"></iframe>');window.frames&&window.frames[t]&&(e=window.frames[t])}return e}},e.prototype._saveItem=function(t,e,r){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(r){var i=this._getItem(t)||"";localStorage.setItem(t,i+e+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(t,e);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(t,e),!0):(this.info("Session storage is not supported"),!1)},e.prototype._getItem=function(t){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(t):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(t):(this.info("Session storage is not supported"),null)},e.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(t){return!1}},e.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(t){return!1}},e.prototype._cloneConfig=function(t){if(null===t||"object"!=typeof t)return t;var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},e.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},e.prototype.log=function(t,e,r,i){if(t<=Logging.level){if(!Logging.piiLoggingEnabled&&i)return;var n=(new Date).toUTCString(),o="";o=this.config.correlationId?n+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[t]+" "+e:n+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[t]+" "+e,r&&(o+="\nstack:\n"+r.stack),Logging.log(o)}},e.prototype.error=function(t,e){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,t,e)},e.prototype.warn=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,t,null)},e.prototype.info=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,t,null)},e.prototype.verbose=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,t,null)},e.prototype.errorPii=function(t,e){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,t,e,!0)},e.prototype.warnPii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,t,null,!0)},e.prototype.infoPii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,t,null,!0)},e.prototype.verbosePii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,t,null,!0)},e.prototype._libVersion=function(){return"1.0.17"},t.exports&&(t.exports=e,t.exports.inject=function(t){return new e(t)}),e)}));function Of(t){this.message=t}Pf.inject,(Of.prototype=new Error).name="InvalidCharacterError";var Mf="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Of("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,n=0,o=0,a="";i=e.charAt(o++);~i&&(r=n%4?64*r+i:i,n++%4)&&(a+=String.fromCharCode(255&r>>(-2*n&6))))i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return a};function Lf(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(Mf(e).replace(/(.)/g,(function(t,e){var r=e.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}catch(t){return Mf(e)}}function Df(t){this.message=t}function Rf(t,e){if("string"!=typeof t)throw new Df("Invalid token specified");var r=!0===(e=e||{}).header?0:1;try{return JSON.parse(Lf(t.split(".")[r]))}catch(t){throw new Df("Invalid token specified: "+t.message)}}(Df.prototype=new Error).name="InvalidTokenError",Rf.InvalidTokenError=Df;var zf=(Nf.prototype.initialize=function(){var t=this;return this.initPromise||(this.initPromise=new Promise((function(r,i){if(t.options.authType===e.AuthenticationType.subscriptionKey)r();else if(t.options.authType===e.AuthenticationType.aad){if(t.options.authContext=t.options.authContext||Nf.getDefaultAuthContext(t.options),t.options.authContext.handleWindowCallback(),t.options.authContext.getLoginError())return void i(new Error("Error logging in the AAD users: "+t.options.authContext.getLoginError()));if(t.options.authContext.isCallback(window.location.hash))return void t.map.dispose();setTimeout((function(){return t._loginAndAcquire(r,i)}))}else t.options.authType===e.AuthenticationType.anonymous?r(t._triggerTokenFetch()):i(new Error("An invalid authentication type was specified."))}))),this.initPromise},Nf.getDefaultAuthContext=function(t){if(!t.aadAppId)throw new Error("No AAD app ID was specified.");if(!t.aadTenant)throw new Error("No AAD tenant was specified.");return this.defaultAuthContext||(this.defaultAuthContext=new Pf({instance:t.aadInstance||p,tenant:t.aadTenant,clientId:t.aadAppId,cacheLocation:this.constants.preferredCacheLocation})),this.defaultAuthContext},Nf.prototype._loginAndAcquire=function(t,e){function r(){i.options.authContext.acquireToken(_,(function(r){if(r)e(new Error(r));else{var n={map:i.map,type:Nf.constants.events.tokenAcquired};i.map.events.invoke(Nf.constants.events.tokenAcquired,n),t()}}))}var i=this,n=this.options.authContext.getCachedToken(this.options.aadAppId),o=this.options.authContext.getCachedUser();if(n&&o)r();else{this.options.authContext.loginInProgress()||this.options.authContext.login();var a=setInterval((function(){i.options.authContext.loginInProgress()||(clearInterval(a),i.options.authContext.getCachedToken(i.options.aadAppId)?r():e(new Error(i.options.authContext.getLoginError()||"The AAD authentication context is not logged-in for the specified app ID: "+i.options.aadAppId)))}),25)}},Nf.prototype.getAuthType=function(){return this.options.authType},Nf.prototype.getClientId=function(){return this.options.clientId},Nf.prototype.getToken=function(){var t=this;if(this.options.authType===e.AuthenticationType.aad){var r=this.options.authContext.getCachedToken(_);return r||(this.options.authContext.getCachedUser()||this.options.authContext.login(),this.options.authContext.acquireToken(_,(function(e,i){if(!e){r=i;var n={map:t.map,type:Nf.constants.events.tokenAcquired};t.map.events.invoke(Nf.constants.events.tokenAcquired,n)}}))),r}if(this.options.authType===e.AuthenticationType.anonymous){var i=this._getItem(Nf.constants.storage.accessTokenKey);if(i){var n=this._getTokenExpiry(i);if(n<300&&0<n)this._triggerTokenFetch();else if(n<=0)throw this._saveItem(Nf.constants.storage.accessTokenKey,""),new Error(Nf.constants.errors.tokenExpired)}else this._triggerTokenFetch();return i}if(this.options.authType===e.AuthenticationType.subscriptionKey)return this.options.subscriptionKey},Nf.prototype._getTokenExpiry=function(t){var e=Rf(t).exp,r=this._getCurrentTime();return 0<e-r?e-r:-1},Nf.prototype._storeAccessToken=function(t){this._saveItem(Nf.constants.storage.accessTokenKey,t);var e={map:this.map,type:Nf.constants.events.tokenAcquired};this.map.events.invoke(Nf.constants.events.tokenAcquired,e)},Nf.prototype._saveItem=function(t,e){return this._supportsLocalStorage()?(localStorage.setItem(t,e),!0):!!this._supportsSessionStorage()&&(sessionStorage.setItem(t,e),!0)},Nf.prototype._getItem=function(t){return this._supportsLocalStorage()?localStorage.getItem(t):this._supportsSessionStorage()?sessionStorage.getItem(t):null},Nf.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem(Nf.constants.storage.testStorageKey,"A"),"A"===window.localStorage.getItem(Nf.constants.storage.testStorageKey)&&(window.localStorage.removeItem(Nf.constants.storage.testStorageKey),!window.localStorage.getItem(Nf.constants.storage.testStorageKey)))}catch(r){return!1}},Nf.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(Nf.constants.storage.testStorageKey,"A"),"A"===window.sessionStorage.getItem(Nf.constants.storage.testStorageKey)&&(window.sessionStorage.removeItem(Nf.constants.storage.testStorageKey),!window.sessionStorage.getItem(Nf.constants.storage.testStorageKey)))}catch(r){return!1}},Nf.prototype._getCurrentTime=function(){return Math.round((new Date).getTime()/1e3)},Nf.prototype.signRequest=function(t){t.headers=t.headers||{},t.headers[x]=this.sessionId,t.headers[y]=v,t.headers[m]="MapControl/"+D+" (Web)";var r=this.getToken();switch(this.options.authType){case e.AuthenticationType.aad:case e.AuthenticationType.anonymous:t.headers[g]=this.options.clientId,t.headers[h]=d+r;break;case e.AuthenticationType.subscriptionKey:if("url"in t)-1!==t.url.indexOf("?")?t.url+="&subscription-key="+r:t.url+="?&subscription-key="+r;else{if(!("domain"in t))throw new Error("Could not determine if the provided object was UrlOptions or RequestParameters");t.queryParams=t.queryParams||{},t.queryParams["subscription-key"]=r}break;default:throw new Error("An invalid authentication type was specified")}return t},Nf.constants={preferredCacheLocation:"localStorage",storage:{accessTokenKey:"access.token.key",testStorageKey:"testStorage"},events:{tokenAcquired:"tokenacquired"},tokenExpiresIn:3599,tokenRefreshClockSkew:300,errors:{tokenExpired:"Token Expired, Try again"}},Nf);function Nf(t){var e=this;this._triggerTokenFetch=function(){return new Promise((function(t,r){e.options.getToken((function(i){try{var n=e._getTokenExpiry(i)-Nf.constants.tokenRefreshClockSkew;e._storeAccessToken(i),clearTimeout(e.tokenTimeOutHandle),e.tokenTimeOutHandle=setTimeout(e._triggerTokenFetch,1e3*n),t()}catch(i){r(new Error("Invalid token returned by getToken function"))}}),(function(t){r(t)}),e.map)}))};var r=t.getServiceOptions();this.options=r.authOptions,this.sessionId=r.sessionId,this.map=t}var Bf=(Ff.prototype.add=function(t,e){if(Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._add(n,e)}else this._add(t,e)},Ff.prototype.getControls=function(){return Array.from(this.controls)},Ff.prototype.remove=function(t){if(Array.isArray(t))for(var e=0,r=t;e<r.length;e++){var i=r[e];this._remove(i)}else this._remove(t)},Ff.prototype._add=function(t,e){this.controls.add(t);var r=(new B).merge(e),i=t.onAdd(this.map,e),n=this.controlContainer.getElementsByClassName(r.position);if(!(0<n.length))throw new Error("Control position "+r.position+" does not exist.");n.item(0).appendChild(i)},Ff.prototype._remove=function(t){t.onRemove(),this.controls.delete(t)},Ff);function Ff(t){for(var r in this.map=t,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("atlas-control-container"),e.ControlPosition)if(e.ControlPosition.hasOwnProperty(r)){var i=document.createElement("div");i.classList.add(e.ControlPosition[r]),i.classList.add("subcontrol-container"),this.controlContainer.appendChild(i)}this.map.getMapContainer().appendChild(this.controlContainer),this.controls=new Set}var jf=(Uf.prototype.addCallback=function(t,e,r,i,n){var o,a,s=this;if(i)o=function(t){var e=t.lngLat?new ho(t.lngLat.lng,t.lngLat.lat):void 0,i=t.point?[t.point.x,t.point.y]:void 0,n=t.features?t.features.map((function(t){return new nn(t.geometry,t.properties,t.id)})):[],o={type:t.type,originalEvent:t.originalEvent,position:e,coordinate:i,features:n};r(o)};else switch(t){case"data":case"sourcedata":case"styledata":o=function(i){var o=S(S({dataType:i.dataType},"source"===i.dataType&&S(S(S({isSourceLoaded:i.isSourceLoaded},i.sourceDataType&&{sourceDataType:i.sourceDataType}),{source:s.map.sources.getById(i.sourceId)}),i.tile&&{tile:{id:{x:i.tile.tileID.canonical.x,y:i.tile.tileID.canonical.y,z:i.tile.tileID.canonical.z},size:i.tile.tileSize,state:i.tile.state}})),{map:s.map,type:i.type});n&&s.map.events._removeListener(t,e,r),r(o)};break;case"error":o=function(i){var o={error:i.error,map:s.map,type:i.type};n&&s.map.events._removeListener(t,e,r),r(o)};break;case"touchstart":case"touchend":case"touchmove":case"touchcancel":o=function(i){if(i.originalEvent){if(i.originalEvent===a)return;a=i.originalEvent}var o=i.point?new sn(i.point.x,i.point.y):void 0,l=i.points?i.points.map((function(t){return new sn(t.x,t.y)})):[],c=i.lngLat?new ho(i.lngLat.lng,i.lngLat.lat):void 0,u=i.lngLats?i.lngLats.map((function(t){return new ho(t.lng,t.lat)})):[],p=c?s.map.layers.getRenderedShapes(new cn(c),e?[e]:void 0):[],h={map:s.map,originalEvent:i.originalEvent,pixel:o,pixels:l,position:c,positions:u,shapes:p,layerId:e||void 0,preventDefault:function(){return i.preventDefault()},type:i.type};n&&s.map.events._removeListener(t,e,r),r(h)};break;case"mousedown":case"mouseup":case"mouseover":case"mousemove":case"click":case"dblclick":case"mouseout":case"mouseenter":case"mouseleave":case"contextmenu":o=function(i){if(i.originalEvent){if(i.originalEvent===a)return;a=i.originalEvent}var o=i.lngLat?new ho(i.lngLat.lng,i.lngLat.lat):void 0,l=i.point?new sn(i.point.x,i.point.y):void 0,c=o?s.map.layers.getRenderedShapes(new cn(o),e?[e]:void 0):[],u={map:s.map,originalEvent:i.originalEvent,position:o,pixel:l,preventDefault:function(){return i.preventDefault()},shapes:c,layerId:e||void 0,type:i.type};n&&s.map.events._removeListener(t,e,r),r(u)};break;case"styleimagemissing":o=function(i){n&&s.map.events._removeListener(t,e,r),r(i.id)};break;case"wheel":o=function(i){if(i.originalEvent){if(i.originalEvent===a)return;a=i.originalEvent}var o={map:s.map,originalEvent:i.originalEvent,preventDefault:function(){return i.preventDefault()},type:i.type};n&&s.map.events._removeListener(t,e,r),r(o)};break;case"resize":o=function(i){var o={map:s.map,type:i.type};for(var a in i)"type"!==a&&"target"!==a&&(o[a]=i[a]);n&&s.map.events._removeListener(t,e,r),r(o)};break;default:o=function(i){var o={map:s.map,type:i.type};i.originalEvent&&(o.originalEvent=i.originalEvent),n&&s.map.events._removeListener(t,e,r),r(o)}}this.callbacks.has(e)||this.callbacks.set(e,new hi),this.callbacks.get(e).has(t)||this.callbacks.get(e).set(t,new hi),this.callbacks.get(e).get(t).set(r,[o,n])},Uf.prototype.removeCallback=function(t,e,r){this.callbacks.has(e)&&this.callbacks.get(e).has(t)&&this.callbacks.get(e).get(t).has(r)&&this.callbacks.get(e).get(t).delete(r)},Uf.prototype.getModifiedCallback=function(t,e,r){if(this.callbacks.has(e)&&this.callbacks.get(e).has(t)&&this.callbacks.get(e).get(t).has(r))return this.callbacks.get(e).get(t).get(r)[0]},Uf.prototype.getLayerCallbacks=function(t){if(this.callbacks.has(t))return this.callbacks.get(t)},Uf.prototype.getEventCallbacks=function(t,e){if(this.callbacks.has(e)){var r=this.callbacks.get(e);if(r.has(t))return r.get(t)}},Uf);function Uf(t){this.callbacks=new hi,this.map=t}var Vf=(qf.prototype.add=function(t,e,r){if("function"==typeof e)this._addGlobalListener(t,e,!1,!1);else for(var i=0,n=e=Array.isArray(e)?e:[e];i<n.length;i++){var o=n[i];o instanceof aa&&aa._isMBoxEvent(t)?this._addLayerListener(t,o,r,!1,!1):o._addEventListener(t,r,!1)}},qf.prototype.addOnce=function(t,e,r){"function"==typeof e?this._addGlobalListener(t,e,!1,!0):e instanceof aa&&aa._isMBoxEvent(t)?this._addLayerListener(t,e,r,!1,!0):e._addEventListener(t,r,!0)},qf.prototype._addLegacy=function(t,e,r){"function"==typeof e?this._addGlobalListener(t,e,!0,!1):this._addLayerListener(t,e,r,!0,!1)},qf.prototype._addLayerListener=function(t,e,r,i,n){var o=e instanceof aa?e.getId():e,a=this.map.layers.getLayerById(o),s=this.mapCallbackHandler.getModifiedCallback(t,o,r);if(s&&a)for(var l=0,c=a._getLayerIds();l<c.length;l++){var u=c[l];this.map._getMap().off(t,u,s)}if(this.mapCallbackHandler.addCallback(t,o,r,i,n),a){s=this.mapCallbackHandler.getModifiedCallback(t,o,r);for(var p=0,h=a._getLayerIds();p<h.length;p++)u=h[p],this.map._getMap().on(t,u,s)}},qf.prototype._addGlobalListener=function(t,e,r,i){var n=this.mapCallbackHandler.getModifiedCallback(t,"",e);if(n&&this.map._getMap().off(t,n),this.mapCallbackHandler.addCallback(t,"",e,r,i),n=this.mapCallbackHandler.getModifiedCallback(t,"",e),"load"===t&&this.map._isLoaded()){var o={type:"load",map:this.map};setTimeout((function(){return n(o)}))}else if("ready"===t){if(this.map._isReady()){var a={type:"ready",map:this.map};setTimeout((function(){return n(a)}))}}else this.map._getMap().on(t,n)},qf.prototype.invoke=function(t,e,r){if(void 0===r)this._invokeListeners(t,"",e);else if(e instanceof aa&&aa._isMBoxEvent(t))this._invokeListeners(t,e.getId(),r);else{if(!(e instanceof yo))throw new Error("The invoke target is invalid.");e._invokeEvent(t,r)}},qf.prototype._invokeListeners=function(t,e,r){var i=this,n=this.mapCallbackHandler.getEventCallbacks(t,e);n?n.forEach((function(n,o){n[0],n[1]&&i._removeListener(t,e,o),o(r)})):"error"===t&&console.error("error"in r?r.error:r)},qf.prototype.remove=function(t,e,r){if("function"==typeof e)this._removeListener(t,"",e);else for(var i=0,n=e=Array.isArray(e)?e:[e];i<n.length;i++){var o=n[i];o instanceof aa&&aa._isMBoxEvent(t)?this._removeListener(t,o,r):o._removeEventListener(t,r)}},qf.prototype._removeLegacy=function(t,e,r){"function"==typeof e?this._removeListener(t,"",e):this._removeListener(t,e,r)},qf.prototype._removeListener=function(t,e,r){var i=e instanceof aa?e.getId():e,n=this.mapCallbackHandler.getModifiedCallback(t,i,r);if(n)if(i){var o=this.map.layers.getLayerById(i);if(o)for(var a=0,s=o._getLayerIds();a<s.length;a++){var l=s[a];this.map._getMap().off(t,l,n)}}else this.map._getMap().off(t,n);this.mapCallbackHandler.removeCallback(t,i,r)},qf.prototype._enableLayerEvents=function(t){var e=this,r=this.mapCallbackHandler.getLayerCallbacks(t.getId());r&&r.forEach((function(r,i){r.forEach((function(r){for(var n=r[0],o=0,a=t._getLayerIds();o<a.length;o++){var s=a[o];e.map._getMap().on(i,s,n)}}))}))},qf.prototype._disableLayerEvents=function(t){var e=this,r=this.mapCallbackHandler.getLayerCallbacks(t.getId());r&&r.forEach((function(r,i){r.forEach((function(r){for(var n=r[0],o=0,a=t._getLayerIds();o<a.length;o++){var s=a[o];e.map._getMap().off(i,s,n)}}))}))},qf);function qf(t){this.map=t,this.mapCallbackHandler=new jf(this.map)}var Gf=(Zf.prototype.add=function(t,e){if(Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._addMarker(n,e)}else this._addMarker(t,e)},Zf.prototype._addMarker=function(t,e){t._addToMap(this.map,e),this.markers.add(t)},Zf.prototype.getMarkers=function(){return Array.from(this.markers)},Zf.prototype.remove=function(t){if(Array.isArray(t))for(var e=0,r=t;e<r.length;e++){var i=r[e];this._removeMarker(i)}else this._removeMarker(t)},Zf.prototype._removeMarker=function(t){var e=this;t instanceof Ns?(t._removeFromMap(),this.markers.delete(t)):this.markers.forEach((function(r){r._getId()===t&&(r._removeFromMap(),e.markers.delete(r))}))},Zf.prototype.clear=function(){var t=this;this.markers.forEach((function(e){e._removeFromMap(),t.markers.delete(e)}))},Zf);function Zf(t){this.markers=new Set,this.map=t}var Hf=(Wf.prototype.add=function(t,e){var r=this;return new Promise((function(i,n){if(r.userImages.has(t))i();else if(e instanceof HTMLImageElement||e instanceof ImageData)r.map._getMap().addImage(t,e),r.userImages.set(t,e),i();else if("string"==typeof e){var o,a=void 0;a=/<svg/i.test(e)&&!/^data:/i.test(e)?"data:image/svg+xml;base64,"+window.btoa(e):e;var s=!1;r.map._sendRequest(a,"Image").then((function(t){if(!s)return t.blob()})).then((function(e){if(!s){clearTimeout(o);var a=new Image;a.onload=function(){r.map._getMap().addImage(t,a),r.userImages.set(t,a),i()},a.onerror=a.onabort=function(){n("Failed to load image into HTML element.")},a.src=URL.createObjectURL(e)}})).catch((function(){s||(clearTimeout(o),n("Failed to load image into HTML element."))})),o=setTimeout((function(){s=!0,n("Failed to load image within specified timeout: "+r.imageLoadTimeout+" ms.")}),r.imageLoadTimeout)}}))},Wf.prototype.clear=function(){var t=this;this.userImages.forEach((function(e,r){t.map._getMap().removeImage(r)})),this.userImages.clear()},Wf.prototype.getImageIds=function(){var t=[];return this.userImages.forEach((function(e,r){t.push(r)})),t},Wf.prototype.createFromTemplate=function(t,e,r,i,n){r=r||"#1A73AA",i=i||"#fff";var o=Vl(e,n);return o=o.replace(/{color}/g,r).replace(/{secondaryColor}/g,i).replace(/{text}/g,""),this.add(t,o)},Wf.prototype.hasImage=function(t){return this.userImages.has(t)},Wf.prototype.remove=function(t){this.map._getMap().removeImage(t),this.userImages.delete(t)},Wf.prototype._restoreImages=function(){var t=this;this.userImages.forEach((function(e,r){t.map._getMap().hasImage(r)||t.map._getMap().addImage(r,e)}))},Wf);function Wf(t){this.userImages=new hi,this.imageLoadTimeout=5e3,this.map=t}var Kf=(Xf.prototype.add=function(t,e,r){void 0===r&&(r=!0);var i=e instanceof aa?e.getId():e;if(Array.isArray(t))for(var n=0,o=t;n<o.length;n++){var a=o[n];this._addLayer(a,i,r)}else this._addLayer(t,i,r)},Xf.prototype._addLayer=function(t,e,r){if(e!==t.getId()&&this.layersById.has(e))if(this.layersById.has(t.getId())){var i=this.layers.findIndex((function(e){return e.getId()===t.getId()})),n=this.layers[i];r&&(this._removeMapboxLayers(n),this._addMapboxLayers(t,e)),this.map.events._disableLayerEvents(n),this.map.events._enableLayerEvents(t),this.layersById.set(t.getId(),t),this.layers.splice(i,1);var o=this.layers.findIndex((function(t){return t.getId()===e}));this.layers.splice(o,0,t),n.onRemove(),t.onAdd(this.map)}else r&&this._addMapboxLayers(t,e),o=this.layers.findIndex((function(t){return t.getId()===e})),this.layers.splice(o,0,t),this.layersById.set(t.getId(),t),this.map.events._enableLayerEvents(t),t.onAdd(this.map);else this.layersById.has(t.getId())?(i=this.layers.findIndex((function(e){return e.getId()===t.getId()})),n=this.layers[i],r&&(this._removeMapboxLayers(n),this._addMapboxLayers(t,i+1)),this.map.events._disableLayerEvents(n),this.map.events._enableLayerEvents(t),this.layersById.set(t.getId(),t),this.layers[i]=t,n.onRemove()):(r&&this._addMapboxLayers(t),this.layersById.set(t.getId(),t),this.layers.push(t),this.map.events._enableLayerEvents(t)),t.onAdd(this.map)},Xf.prototype._addMapboxLayers=function(t,e){if(!this.map._isReady())throw new Error("The layer '"+t.getId()+"' could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a layer to it.");if(!(t instanceof ms)||t.getOptions().tileUrl){t instanceof Pa&&this.map._getMap().addSource(t._getSourceId(),t._buildSource());for(var r=this._getMapboxBefore(e),i=0,n=t._buildLayers();i<n.length;i++){var o=n[i];this.map._getMap().addLayer(o,r)}}},Xf.prototype._removeMapboxLayers=function(t){for(var e=0,r=t._getLayerIds();e<r.length;e++){var i=r[e];this.map._getMap().getLayer(i)&&this.map._getMap().removeLayer(i)}t instanceof Pa&&this.map._getMap().getSource(t._getSourceId())&&this.map._getMap().removeSource(t._getSourceId())},Xf.prototype._getMapboxBefore=function(t){if("string"==typeof t){var e=this.layersById.get(t);if(!e)return;for(var r=0,i=e._getLayerIds();r<i.length;r++){var n=i[r];if(this.map._getMap().getLayer(n))return n}t=this.layers.findIndex((function(e){return e.getId()===t}))+1}for(var o=t;o<this.layers.length;o++)for(var a=0,s=this.layers[o]._getLayerIds();a<s.length;a++)if(n=s[a],this.map._getMap().getLayer(n))return n},Xf.prototype.clear=function(){for(var t=this.layers.length-1;0<=t;t--){var e=this.layers[t];this._removeMapboxLayers(e),this.map.events._disableLayerEvents(e),this.layersById.delete(e.getId()),this.layers.splice(t,1),e.onRemove()}},Xf.prototype.getLayerById=function(t){return this.layersById.get(t)},Xf.prototype.getLayers=function(){return this.layers.slice(0)},Xf.prototype._getSourceIds=function(){for(var t=new Set,e=0,r=this.layers;e<r.length;e++)r[e]._getSourceIds().forEach((function(e){return t.add(e)}));return t},Xf.prototype.move=function(t,e){var r=t instanceof aa?t.getId():t,i=e instanceof aa?e.getId():e;if(!this.layersById.has(r))throw new Error("The layer '"+r+"' has not been added to the map and cannot be moved.");var n=this.layers.findIndex((function(t){return t.getId()===r}));if(this._moveMapboxLayers(this.layers[n],i),t=this.layers[n],this.layers.splice(n,1),this.layersById.has(i)){var o=this.layers.findIndex((function(t){return t.getId()===i}));this.layers.splice(o,0,t)}else this.layers.push(t)},Xf.prototype._moveMapboxLayers=function(t,e){for(var r=this._getMapboxBefore(e),i=0,n=t._getLayerIds();i<n.length;i++){var o=n[i];this.map._getMap().moveLayer(o,r)}},Xf.prototype.getRenderedShapes=function(t,e,r){var i,n,o=this;if(t=t||[-180,-85.0511,180,85.0511],Array.isArray(t)?4===t.length||6===t.length?i=this.map.positionsToPixels([Co.getSouthWest(t),Co.getNorthEast(t)]):2!==t.length&&3!==t.length||(i=this.map.positionsToPixels([t])[0]):i=this.map.positionsToPixels([t.coordinates])[0],e){n=[];for(var a=0,s=e=Array.isArray(e)?e:[e];a<s.length;a++){var l=s[a],c=l instanceof aa?l.getId():l;if(!this.layersById.has(c))throw new Error("The layer '"+c+"' has not been added to the map and its rendered features cannot be retrieved.");n.push.apply(n,this.layersById.get(c)._getLayerIds().filter((function(t){return!!o.map._getMap().getLayer(t)})))}}var u=this.map._getMap().queryRenderedFeatures(i,{layers:n,filter:r});return this.map.sources._mapFeaturesToShapes(u)},Xf.prototype.remove=function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._removeLayer(n,e)}else this._removeLayer(t,e)},Xf.prototype._removeLayer=function(t,e){var r=t instanceof aa?t.getId():t;if(!this.layersById.has(r))throw new Error("The layer '"+r+"' has not been added to the map and cannot be removed.");var i=this.layers.findIndex((function(t){return t.getId()===r})),n=this.layers[i];e&&this._removeMapboxLayers(n),this.layersById.delete(r),this.layers.splice(i,1),this.map.events._disableLayerEvents(n),n.onRemove()},Xf);function Xf(t){this.layersById=new hi,this.layers=[],this.map=t}var Yf=(Jf.prototype.add=function(t){for(var e=0,r=t=Array.isArray(t)?t:[t];e<r.length;e++){var i=r[e];this.popups.has(i)||(this.popups.add(i),i.attach(this.map))}},Jf.prototype.clear=function(){var t=this;this.popups.forEach((function(e){t.popups.delete(e),e.remove()}))},Jf.prototype.remove=function(t){for(var e=0,r=t=Array.isArray(t)?t:[t];e<r.length;e++){var i=r[e];this.popups.has(i)&&(this.popups.delete(i),i.remove())}},Jf.prototype.getPopups=function(){return Array.from(this.popups)},Jf.prototype._getCollectionDiv=function(){var t=this.map.getMapContainer().querySelector("."+Jf.Css.collection);return t||((t=document.createElement("div")).classList.add(Jf.Css.collection),t.setAttribute("aria-label","Map Information"),this.map.getMapContainer().appendChild(t)),t},Jf.prototype._addDraggedPopup=function(t){0===this.draggedPopups.size&&(this.map.getMapContainer().addEventListener("mousemove",this._onDrag),this.map.getMapContainer().addEventListener("touchmove",this._onDrag),this.map.getMapContainer().addEventListener("mouseup",this._onUp),this.map.getMapContainer().addEventListener("touchend",this._onUp)),this.draggedPopups.add(t)},Jf.Css={collection:"popup-collection-container"},Jf);function Jf(t){var e=this;this._onDrag=function(t){var r,i;"mousemove"===t.type?(r=(t=t).clientX,i=t.clientY):"touchmove"===t.type&&(r=(t=t).touches[0].clientX,i=t.touches[0].clientY),e.draggedPopups.forEach((function(t){t._dragToPixel([r,i])}))},this._onUp=function(){e.map.getMapContainer().removeEventListener("mousemove",e._onDrag),e.map.getMapContainer().removeEventListener("touchmove",e._onDrag),e.map.getMapContainer().removeEventListener("mouseup",e._onUp),e.map.getMapContainer().removeEventListener("touchend",e._onUp),e.draggedPopups.forEach((function(t){e.draggedPopups.delete(t),t._onUp()}))},this.map=t,this.popups=new Set,this.draggedPopups=new Set}var $f=(Qf.prototype.add=function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._addSource(n,e)}else this._addSource(t,e)},Qf.prototype.getRenderedShapes=function(t,e,r){var i="string"==typeof t?t:t.getId(),n=this.map._getMap().querySourceFeatures(i,{sourceLayer:r,filter:e});return this.map.sources._mapFeaturesToShapes(n,!0,this.sources.get(i))},Qf.prototype._buildSources=function(){var t={};return this.sources.forEach((function(e){t[e.getId()]=e._buildSource()})),t},Qf.prototype.clear=function(){var t=this;this.sources.forEach((function(e){t.remove(e)}))},Qf.prototype.getById=function(t){return this.sources.get(t)},Qf.prototype.getSources=function(){return Array.from(this.sources.values())},Qf.prototype.isSourceLoaded=function(t){var e=t instanceof Wo?t.getId():t;return this.map._getMap().isSourceLoaded(e)},Qf.prototype.remove=function(t,e){if(void 0===e&&(e=!0),Array.isArray(t))for(var r=0,i=t;r<i.length;r++){var n=i[r];this._removeSource(n,e)}else this._removeSource(t,e)},Qf.prototype._removeSource=function(t,e){var r=t instanceof Wo?t.getId():t;if(this.sources.has(r)){if(this.map._getMap().getSource(r)&&e&&this.map._getMap().removeSource(r),this.map._getMap().getSource(r)&&e)throw new Error("One or more layers have a dependency on the source '"+r+"'");return this.sources.get(r)._setMap(null),void this.sources.delete(r)}throw new Error("'"+r+"' is not added to the map")},Qf.prototype._addSource=function(t,e){if(this.sources.has(t.getId())){if(e)throw new Error("'"+t.getId()+"' is already added to the map");this.sources.get(t.getId())._setMap(null),this.sources.delete(t.getId())}if(e){if(!this.map._isReady())throw new Error("The source '"+t.getId()+"' could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a source to it.");this.map._getMap().addSource(t.getId(),t._buildSource())}this.sources.set(t.getId(),t),t._setMap(this.map)},Qf.prototype._mapFeaturesToShapes=function(t,e,r){for(var i=[],n=0,o=t;n<o.length;n++){var a=o[n];if((r||"string"==typeof a.source)&&"string"==typeof a.properties[To._shapeIdPropName]){var s=r||this.sources.get(a.source);if(s instanceof Yo){var l=s.getShapeById(a.properties[To._shapeIdPropName]);if(l instanceof To){i.push(l);continue}}}e||i.push(a)}return i},Qf);function Qf(t){this.map=t,this.sources=new hi}var tm,em=(w(rm,tm=I),rm);function rm(){var t=null!==tm&&tm.apply(this,arguments)||this;return t.duration=1e3,t.type="jump",t}var im,nm=(w(om,im=I),om);function om(){var t=null!==im&&im.apply(this,arguments)||this;return t.bottom=0,t.left=0,t.right=0,t.top=0,t}var am,sm=(w(lm,am=I),lm.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=t;r<i.length;r++){var n=i[r];n&&"number"==typeof n.padding&&(n.padding={top:n.padding,bottom:n.padding,left:n.padding,right:n.padding})}return am.prototype.merge.apply(this,t)},lm);function lm(){var t=null!==am&&am.apply(this,arguments)||this;return t.bounds=[-180,-89,180,90],t.maxBounds=void 0,t.maxZoom=20,t.offset=new sn(0,0),t.padding=new nm,t}var cm,um=(w(pm,cm=I),pm);function pm(){var t=null!==cm&&cm.apply(this,arguments)||this;return t.zoom=1,t.center=new ho(0,0),t.centerOffset=new sn(0,0),t.bearing=0,t.pitch=0,t.minZoom=1,t.maxZoom=20,t.maxBounds=void 0,t}var hm,dm=(w(fm,hm=I),fm);function fm(){var t=null!==hm&&hm.apply(this,arguments)||this;return t.name=void 0,t.before=void 0,t.minZoom=1,t.maxZoom=20,t.overwrite=!1,t.defer=!1,t.opacity=1,t}var mm,gm=(w(ym,mm=dm),ym);function ym(){var t=null!==mm&&mm.apply(this,arguments)||this;return t.color="rgba(0,0,0,.5)",t.outlineColor="#000",t.radius=1,t.outlineWidth=5,t.name="default-circles",t}var vm,_m=(w(xm,vm=dm),xm);function xm(){var t=null!==vm&&vm.apply(this,arguments)||this;return t.cap="butt",t.join="miter",t.name="default-linestrings",t.color="#000",t.width=1,t}var bm,wm=(w(Sm,bm=dm),Sm);function Sm(){var t=null!==bm&&bm.apply(this,arguments)||this;return t.iconSize=1,t.fontSize=14,t.fontColor="#000",t.textFont="SegoeUi-Regular",t.cluster=!0,t.clusterIcon=void 0,t.textOffset=[0,0],t.name="default-pins",t.icon="pin-darkblue",t.title="",t}var Tm,Em=(w(Im,Tm=dm),Im);function Im(){var t=null!==Tm&&Tm.apply(this,arguments)||this;return t.color="rgba(0,0,0,.5)",t.outlineColor="#000",t.name="default-polygons",t}var Cm,Am=(w(km,Cm=dm),km);function km(){var t=null!==Cm&&Cm.apply(this,arguments)||this;return t.name="default-raster",t}var Pm,Om=(w(Mm,Pm=I),Mm);function Mm(){var t=null!==Pm&&Pm.apply(this,arguments)||this;return t.anchor="map",t.color="#FFFFFF",t.intensity=.5,t.position=[1.15,210,30],t}var Lm,Dm=(w(Rm,Lm=I),Rm.prototype.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=t;r<i.length;r++){var n=i[r];n&&(n.hasOwnProperty("view")?n.userRegion=n.view:n.hasOwnProperty("userRegion")&&(n.view=n.userRegion),"string"==typeof n.language&&(n.language=sl.getCode(n.language)))}return Lm.prototype.merge.apply(this,t)},Rm);function Rm(){var t=null!==Lm&&Lm.apply(this,arguments)||this;return t.autoResize=!0,t.language=Pl(),t.light=new Om,t.preserveDrawingBuffer=!1,t.renderWorldCopies=!0,t.showBuildingModels=!1,t.showFeedbackLink=!0,t.showLogo=!0,t.showTileBoundaries=!1,t.style="road",t.view=Ll(),t.userRegion=t.view,t}var zm,Nm=(w(Bm,zm=I),Bm);function Bm(){var t=null!==zm&&zm.apply(this,arguments)||this;return t.flow="none",t.incidents=!1,t}var Fm,jm=(w(Um,Fm=I),Um.prototype.merge=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var i=0,n=t;i<n.length;i++){var o=n[i];o&&(o.authOptions?"string"==typeof o.authOptions.subscriptionKey&&(o.subscriptionKey=o["subscription-key"]=o.authOptions.subscriptionKey):"string"==typeof o.subscriptionKey?(o["subscription-key"]=o.subscriptionKey,o.authOptions={authType:e.AuthenticationType.subscriptionKey,subscriptionKey:o.subscriptionKey}):"string"==typeof o["subscription-key"]&&(o.subscriptionKey=o["subscription-key"],o.authOptions={authType:e.AuthenticationType.subscriptionKey,subscriptionKey:o["subscription-key"]}),"string"==typeof o.sessionId?o["session-id"]=o.sessionId:"string"==typeof o["session-id"]&&(o.sessionId=o["session-id"]),"boolean"==typeof o.disableTelemetry?o["disable-telemetry"]=o.disableTelemetry:"boolean"==typeof o["disable-telemetry"]&&(o.disableTelemetry=o["disable-telemetry"]),"boolean"==typeof o.enableAccessibility?o["enable-accessibility"]=o.enableAccessibility:"boolean"==typeof o["enable-accessibility"]&&(o.enableAccessibility=o["enable-accessibility"]))}var a=Fm.prototype.merge.apply(this,t);return a.authOptions.authType!==e.AuthenticationType.subscriptionKey&&(a["subscription-key"]=a.subscriptionKey=void 0),a},Um._cloneCustomizer=function(t){if("object"==typeof t)return Object.assign({},t)},Um);function Um(){var t=null!==Fm&&Fm.apply(this,arguments)||this;return t.authOptions=Cl(),t.disableTelemetry=!1,t["disable-telemetry"]=t.disableTelemetry,t.domain=Al(),t.styleDefinitionsPath=kl(),t.enableAccessibility=!0,t["enable-accessibility"]=t.enableAccessibility,t.refreshExpiredTiles=!0,t.subscriptionKey=Ml(),t["subscription-key"]=t.subscriptionKey,t.sessionId=Ol(),t["session-id"]=t.sessionId,t.transformRequest=void 0,t}var Vm=function(){this.version=8,this.sprite="",this.glyphs="",this.light={},this.sources={},this.layers=[]},qm=(Gm.prototype.build=function(t){var e=new Vm;if(null!=this.glyphs&&(e.glyphs=this.glyphs),null!=this.sprite&&(e.sprite=this.sprite),null!=t.light&&Object.assign(e.light,t.light),null!=this.map.sources&&(e.sources=this.map.sources._buildSources()),null!=this.map.layers)for(var r=0,i=this.map.layers.getLayers();r<i.length;r++){var n=i[r];e.layers=e.layers.concat(n._buildLayers()),n instanceof Pa&&(e.sources[n._getSourceId()]=n._buildSource())}return e},Gm.prototype.setGlyphs=function(t){this.glyphs=t},Gm.prototype.setSprite=function(t){this.sprite=t},Gm);function Gm(t){this.sprite="",this.glyphs="{fontstack}/{range}",this.map=t}var Zm,Hm=(w(Wm,Zm=aa),Wm.prototype._buildLayers=function(){return this.layers},Wm.prototype._getLayerIds=function(){return this.layers.map((function(t){return t.id}))},Wm.prototype._getSourceIds=function(){for(var t=new Set,e=0,r=this.layers;e<r.length;e++){var i=r[e];"string"==typeof i.source?t.add(i.source):i.source&&t.add(i.id)}return t},Wm);function Wm(t,e){var r=Zm.call(this,e)||this;return r.layers=t,r}var Km,Xm=(w(Ym,Km=Wo),Ym.prototype._buildSource=function(){return this.source},Ym.prototype._modifySource=function(t,e){var r=t.tiles.map((function(t){return"string"==typeof t?t:new O({domain:f,path:t.path,queryParams:S(S({},e),t.queryParams)}).toString()}));return t.tiles=r,t},Ym);function Ym(t,e,r){var i=Km.call(this,t)||this;return i.source=i._modifySource(e,r),i}var Jm=($m.prototype.initialize=function(){var t=this;return this.initPromise||(this.initPromise=this.request(l,this._serviceOptions.styleDefinitionsPath).then((function(e){t.definitions=e})).catch((function(t){throw new Error("Failed to retrieve the style definitions: "+t)}))),this.initPromise},$m.prototype.getStyleComponents=function(t){return T(this,void 0,void 0,(function(){var e,r,i,n=this;return E(this,(function(o){return e=new Set,r=this.lookUp(t),i=r.layerGroups.map((function(r){return T(n,void 0,void 0,(function(){var i,n,o,a,s,l,c;return E(this,(function(u){switch(u.label){case 0:return i=r.layerPath,n=r.name,o={language:t.language},t.view&&(o.view=encodeURIComponent(t.view)),[4,this.buildComponent(n,i,o,e)];case 1:for(a=u.sent(),s=0,l=a.layer.layers;s<l.length;s++)"fill-extrusion"===(c=l[s]).type&&(c.layout=c.layout||{},c.layout.visibility=t.showBuildingModels?"visible":"none");return[2,a]}}))}))})),[2,Promise.all(i)]}))}))},$m.prototype.getFlowComponent=function(t,e){return T(this,void 0,void 0,(function(){var r;return E(this,(function(i){return r=this.getFlowPath(t,e),[2,this.buildComponent("flow",r)]}))}))},$m.prototype.getCopyrightCaption=function(t){var e=this.lookUp(t).copyright.join(" ");return t.showLogo||(e+=" ©2019 Microsoft"),e},$m.prototype.getSprite=function(t){var e=this.lookUp(t);return new O({domain:this.definitions.domain,path:e.spritePath}).toString()},$m.prototype.getGlyphs=function(t){var e=this.lookUp(t);return new O({domain:this.definitions.domain,path:e.glyphsPath}).toString()},$m.prototype.getFlowPath=function(t,e){return this.lookUp(t).flowPaths[e.flow]},$m.prototype.getTheme=function(t){return this.lookUp(t).theme.toLowerCase()||"light"},$m.prototype.getDef=function(){return this.definitions},$m.prototype.lookUp=function(t){for(var e,r=t.style||this.definitions.defaultStyle,i=0,n=this.definitions.styles;i<n.length;i++){var o=n[i];if(o.name===r)return o;o.name===this.definitions.defaultStyle&&(e=o)}return e},$m.prototype.request=function(t,e){return T(this,void 0,void 0,(function(){return E(this,(function(r){return[2,new O({domain:t,path:e}).get()]}))}))},$m.prototype.buildComponent=function(t,e,r,i){return T(this,void 0,void 0,(function(){return E(this,(function(n){return[2,this.request(this.definitions.domain,e).then((function(e){var n=new Hm(e.layers,t),o=[],a=e.sources;for(var s in a)if(a.hasOwnProperty(s)){var l=a[s],c=l.name||s;if(i){if(i.has(c))continue;i.add(c)}o.push(new Xm(c,l,r))}return{layer:n,sources:o}}))]}))}))},$m);function $m(t){this._serviceOptions=t}var Qm=(tg.prototype.getCanvas=function(){return this.map.getCanvas()},tg.prototype.getCanvasContainer=function(){return this.map.getCanvasContainer()},tg.prototype.getMapContainer=function(){return this.map.getContainer()},tg.prototype.getServiceOptions=function(){return qo(this.serviceOptions,jm._cloneCustomizer)},tg.prototype.setServiceOptions=function(t){this.serviceOptions=(new jm).merge(this.serviceOptions,t),this.serviceOptions["enable-accessibility"]?this.accessibleMapDelegate.addToMap():this.accessibleMapDelegate.removeFromMap()},tg.prototype.setCamera=function(t,e){var r,i;if(void 0===e&&(e=!1),"padding"in t||"offset"in t||"bounds"in t){var n=(new sm).merge({maxZoom:this.getCamera().maxZoom},t),o=this._generateSafeBounds(n.bounds);if(!(r=this.map.cameraForBounds(o,{padding:n.padding,offset:n.offset,maxZoom:n.maxZoom})))throw new Error("The map cannot be fit to the current canvas with the given CameraBoundsOptions.");this.map.setMaxZoom(n.maxZoom),i=this._generateSafeBounds(n.maxBounds)}else{var a=(new um).merge(this.getCamera(),t);if(a.centerOffset&&2<=a.centerOffset.length){var s=a.centerOffset,l=$n([a.center],a.zoom);l[0][0]+=s[0],l[0][1]+=s[1],a.center=Jn(l,a.zoom)[0]}r={center:a.center,zoom:a.zoom,bearing:a.bearing,pitch:a.pitch,around:void 0},this.map.setMinZoom(a.minZoom),this.map.setMaxZoom(a.maxZoom),i=this._generateSafeBounds(a.maxBounds)}i?this.map.setMaxBounds(i):this.map.setMaxBounds(null);var c=(new em).merge(t),u={duration:c.duration,easing:function(t){return t},offset:[0,0],animate:!0},p={fromControl:e};"jump"===c.type?this.map.jumpTo(r,p):"ease"===c.type?this.map.easeTo(S(S({},r),u),p):"fly"===c.type&&this.map.flyTo(S(S({},r),u),p)},tg.prototype.setCameraBounds=function(t){this.setCamera(t)},tg.prototype.getCamera=function(){var t=this.map.getBounds().getSouthWest().toArray(),e=this.map.getBounds().getNorthEast().toArray();return{zoom:this.map.getZoom(),center:this.map.getCenter().toArray(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),bounds:new Co(t,e),minZoom:this.map.getMinZoom(),maxZoom:this.map.getMaxZoom()}},tg.prototype.setStyle=function(t){delete t.preserveDrawingBuffer;var r=(new Dm).merge(this.styleOptions,t);r.autoResize!==this.styleOptions.autoResize&&this._setAutoResize(r.autoResize),r.language!==this.styleOptions.language&&(this.localizedStringsPromise=sl.getStrings(r.language)),r.renderWorldCopies!==this.styleOptions.renderWorldCopies&&this.map.setRenderWorldCopies(r.renderWorldCopies),r.showFeedbackLink!==this.styleOptions.showFeedbackLink&&this.copyrightControl.setOptions({showFeedbackLink:r.showFeedbackLink}),r.showLogo&&!this.logoControl?(this.logoControl=new Ud,this.controls.add(this.logoControl,{position:e.ControlPosition.NonFixed})):!r.showLogo&&this.logoControl&&(this.controls.remove(this.logoControl),delete this.logoControl),r.showTileBoundaries!==this.styleOptions.showTileBoundaries&&(this.map.showTileBoundaries=r.showTileBoundaries),this._setStyleComponents(r),this.styleOptions=r},tg.prototype.getStyle=function(){return pi(this.styleOptions)},tg.prototype.addIcon=function(t,e){this.imageSprite.add(t,e)},tg.prototype.addPins=function(t,e){var r,i=(new wm).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new cs(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,iconOptions:{anchor:"center",size:i.iconSize,image:["case",["has","icon"],["get","icon"],i.icon],ignorePlacement:!i.cluster,opacity:i.opacity},textOptions:{anchor:"center",textField:["case",["has","point_count"],["to-string",["get","point_count"]],["has","title"],["to-string",["get","title"]],i.title],font:["case",["has","point_count"],["literal",["StandardFontCondensed-Bold"]],["literal",[i.textFont]]],size:["case",["has","point_count"],20,i.fontSize],ignorePlacement:!i.cluster,opacity:i.opacity,offset:["case",["has","point_count"],["literal",[.5,-.45]],["literal",[i.textOffset[0]/16,i.textOffset[1]/16]]],color:i.fontColor}})),!(n instanceof cs))throw new Error("A layer with name '"+i.name+"' already exists but it is not a SymbolLayer.A SymbolLayer should be used for rendering pins.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new Yo(r,{cluster:i.cluster})),!(a instanceof Yo))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new ko(t);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},tg.prototype.addCircles=function(t,e){var r,i=(new gm).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new ma(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,opacity:i.opacity,radius:["case",["has","radius"],["get","radius"],i.radius],color:["case",["has","color"],["get","color"],i.color],strokeColor:["case",["has","outlineColor"],["get","outlineColor"],i.outlineColor],strokeWidth:["case",["has","outlineWidth"],["get","outlineWidth"],i.outlineWidth]})),!(n instanceof ma))throw new Error("A layer with name '"+i.name+"' already exists but it is not a BubbleLayer.A BubbleLayer should be used for rendering circles.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new Yo(r)),!(a instanceof Yo))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new ko(t);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},tg.prototype.addLinestrings=function(t,e){var r,i=(new _m).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new Fa(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,lineCap:i.cap,lineJoin:i.join,strokeOpacity:i.opacity,strokeColor:["case",["has","color"],["get","color"],i.color],strokeWidth:["case",["has","width"],["get","width"],i.width]})),!(n instanceof Fa))throw new Error("A layer with name '"+i.name+"' already exists but it is not a LineLayer.A LineLayer should be used for rendering linestrings.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new Yo(r)),!(a instanceof Yo))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new ko(t);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},tg.prototype.addPolygons=function(t,e){var r,i=(new Em).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new Ja(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,fillOpacity:i.opacity,fillColor:["case",["has","color"],["get","color"],i.color]})),!(n instanceof Ja))throw new Error("A layer with name '"+i.name+"' already exists but it is not a PolygonLayer.A PolygonLayer should be used for rendering linestrings.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new Yo(r)),!(a instanceof Yo))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new ko(t);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},tg.prototype.addRaster=function(t,e){var r,i=(new Am).merge(e),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new ms({maxZoom:i.maxZoom,minZoom:i.minZoom,opacity:i.opacity,tileSize:256,tileUrl:"{subdomain}"},i.name)),!(n instanceof ms))throw new Error("A layer with name '"+i.name+"' already exists but it is not a TileLayer.A TileLayer should be used for rendering raster images.");if("{subdomain}"!==n.getOptions().tileUrl)throw new Error("A TileLayer with name '"+i.name+"' already exists but was configured for a single tile url [default for new TileLayer(...)].");(r=!i.overwrite&&n.getOptions().subdomains||[]).push.apply(r,t),n._setOptionsNoUpdate({subdomains:r}),i.defer?o&&this.layers.add(n,i.before,!1):this.layers.add(n,i.before)},tg.prototype.getLayers=function(){return this.layers.getLayers().map((function(t){return t.getId()}))},tg.prototype.removeLayers=function(t){for(var e=0,r=t;e<r.length;e++){var i=r[e];if(this.layers.getLayerById(i)){this.layers.remove(i);var n=i+"-source";this.sources.getById(n)&&this.sources.remove(n)}}},tg.prototype.addHtml=function(t,e){t.id||(t.id="marker_"+rn());var r=new Ns({htmlContent:t});return this.markers.add(r,e),t.id},tg.prototype.removeHtml=function(t){this.markers.remove(t)},tg.prototype.addEventListener=function(t,e,r){this.events._addLegacy(t,e,r)},tg.prototype.removeEventListener=function(t,e,r){this.events._removeLegacy(t,e,r)},tg.prototype.setUserInteraction=function(t){this.userInteractionDelegate.setOptions(t)},tg.prototype.getUserInteraction=function(){return this.userInteractionDelegate.getOptions()},tg.prototype.addControl=function(t,e){this.controls.add(t,e)},tg.prototype.removeControl=function(t){this.controls.remove(t)},tg.prototype.setTraffic=function(t){var e=this.trafficOptions.incidents,r=this.trafficOptions.flow;if(this.trafficOptions=(new Nm).merge(this.trafficOptions,t),this.trafficOptions.incidents?e||this.incidentDelegate.addToMap():this.incidentDelegate.removeFromMap(),this.trafficOptions.flow&&"none"!==this.trafficOptions.flow)try{this.flowDelegate.addToMap()}catch(t){throw this.trafficOptions.flow=r,t}else this.flowDelegate.removeFromMap()},tg.prototype.getTraffic=function(){return pi(this.trafficOptions)},tg.prototype.remove=function(){this.dispose()},tg.prototype.clear=function(){this.popups.clear(),this.layers.clear(),this.sources.clear(),this.markers.clear()},tg.prototype.dispose=function(){for(this.clear(),this.map.remove(),this.removed=!0;this.getMapContainer().firstChild;){var t=this.getMapContainer().firstChild;this.getMapContainer().removeChild(t)}},tg.prototype.resize=function(t,e,r){if("number"!=typeof t&&"string"!=typeof t||"number"!=typeof e&&"string"!=typeof e)r=t;else{var i=t;this.getMapContainer().style.height="number"==typeof i?i+"px":i,this.getMapContainer().style.width="number"==typeof e?e+"px":e}var n=this.getMapContainer().style.overflow;this.getMapContainer().style.overflow="hidden",this.map.resize(r),this.getMapContainer().style.overflow=n},tg.prototype.pixelsToPositions=function(t){for(var e=[],r=0,i=t;r<i.length;r++){var n=i[r],o=this.map.unproject(n);e.push(new ho(o.lng,o.lat))}return e},tg.prototype.positionsToPixels=function(t){for(var e=[],r=0,i=t;r<i.length;r++){var n=i[r],o=this.map.project(n);e.push(new sn(o.x,o.y))}return e},tg.prototype.areTilesLoaded=function(){return this.map.areTilesLoaded()},tg.prototype.stop=function(){this.map.stop()},tg.prototype._getMap=function(){return this.map},tg.prototype._rebuildStyle=function(){this.map.setStyle(this.styleBuilder.build(this.styleOptions)),this.imageSprite._restoreImages()},tg.prototype._isLoaded=function(){return this.loaded},tg.prototype._isReady=function(){return this.ready},tg.prototype._getLocalizedStrings=function(){return this.localizedStringsPromise},tg.prototype._sendRequest=function(t,e,r){var i;return"function"==typeof this.serviceOptions.transformRequest&&(i=this.serviceOptions.transformRequest(t,e)),i?fetch(i.url||t,{credentials:i.credentials,headers:S(S({},r),i.headers),method:"GET",mode:"cors"}):fetch(t,{headers:r,method:"GET",mode:"cors"})},tg.prototype._setAutoResize=function(t){t?window.addEventListener("resize",this._windowResizeCallback):window.removeEventListener("resize",this._windowResizeCallback)},tg.prototype._setStyleComponents=function(t){var e=this;this.styles.getStyleComponents(t).then((function(r){if(!e.removed){e.copyrightControl.setOptions({copyrightMessage:e.styles.getCopyrightCaption(t)}),e.styleBuilder.setGlyphs(e.styles.getGlyphs(t)),e.styleBuilder.setSprite(e.styles.getSprite(t));for(var i=new Set,n=new Set,o=0,a=r;o<a.length;o++){var s=a[o];i.add(s.layer.getId());for(var l=0,c=s.sources;l<c.length;l++){var u=c[l];n.add(u.getId())}}e.styleLayerIds.forEach((function(t){i.has(t)||(e.layers.getLayerById(t)&&e.layers.remove(t,!1),e.styleLayerIds.delete(t))}));for(var p=function(t){var i=r[t].layer;if(e.styleLayerIds.add(i.getId()),e.layers.getLayerById(i.getId()))e.layers.add(i,void 0,!1);else if(0===t)e.layers.add(i,e.layers.getLayers()[0],!1);else{var n=r[t-1].layer,o=e.layers.getLayers(),a=o.findIndex((function(t){return t.getId()===n.getId()}));e.layers.add(i,o[a+1],!1)}},h=0;h<r.length;h++)p(h);var d=e.layers._getSourceIds();e.styleSourceIds.forEach((function(t){d.has(t)||n.has(t)||(e.sources.getById(t)&&e.sources.remove(t,!1),e.styleSourceIds.delete(t))}));for(var f=0,m=r;f<m.length;f++){s=m[f],e.sources.add(s.sources,!1);for(var g=0,y=s.sources;g<y.length;g++)u=y[g],e.styleSourceIds.add(u.getId())}e._rebuildStyle()}}))},tg.prototype._updateGlobalDefaults=function(t){t&&(t.authOptions&&!ql()&&Rl(t.authOptions),t.domain&&!Gl()&&zl(t.domain),t.styleDefinitionsPath&&!Zl()&&Nl(t.styleDefinitionsPath),!t.subscriptionKey&&!t["subscription-key"]||ql()||jl(t.subscriptionKey||t["subscription-key"]),!t.sessionId&&!t["session-id"]||Wl()||Fl(t.sessionId||t["session-id"]),t.language&&!Hl()&&Bl(t.language),!t.userRegion&&!t.view||Kl()||Ul(t.userRegion||t.view))},tg.prototype._generateSafeBounds=function(t){if(t){var e=Co.getSouth(t),r=Co.getWest(t),i=Co.getNorth(t),n=Co.getEast(t);if(isNaN(e)||isNaN(r)||isNaN(i)||isNaN(n))throw new Error("The bounds specified are invalid: ["+t+"]");for(;n<r;)n+=360;return new Co([r,e,n,i])}return t},tg.prototype._detectHighContrast=function(){var t,e;switch(rc.getHighContrastMode()){case"invert":t=tg.Css.hcLight,e="high_contrast_dark";break;case"light":t=tg.Css.hcLight,e="grayscale_light";break;case"dark":t=tg.Css.hcDark,e="high_contrast_dark"}t&&this.map.getContainer().classList.add(t),e&&"road"===this.styleOptions.style&&(this.styleOptions.style=e)},tg.Css={canvasContainer:"atlas-map-canvas-container",canvas:"atlas-map-canvas",container:"atlas-map",hcDark:"high-contrast-dark",hcLight:"high-contrast-light"},tg);function tg(t,r){var i=this;this.styleLayerIds=new Set,this.styleSourceIds=new Set,this.removed=!1,this.loaded=!1,this.ready=!1,this._windowResizeCallback=function(){return i.resize()};var o=!0;this._updateGlobalDefaults(r),this.serviceOptions=(new jm).merge(r),this.styleOptions=(new Dm).merge(r),this.trafficOptions=new Nm,this.styles=new Jm(this.serviceOptions),this.insights=new Fd(this.serviceOptions),this.serviceOptions.authOptions.subscriptionKey&&(this.serviceOptions.authOptions.subscriptionKey=encodeURIComponent(this.serviceOptions.authOptions.subscriptionKey));var a,s={attributionControl:!1,container:t,preserveDrawingBuffer:this.styleOptions.preserveDrawingBuffer,refreshExpiredTiles:this.serviceOptions.refreshExpiredTiles,renderWorldCopies:this.styleOptions.renderWorldCopies,trackResize:!1,transformRequest:function(t,e){var r={url:t};if("Tile"===e&&t.includes(f)){if(i.insights&&i.insights.trackEvent({name:"TileLoad"}),O.protoRegEx.test(i.serviceOptions.domain)){var n=t.indexOf(f);r.url=i.serviceOptions.domain+t.substring(n+f.length)}else r.url=t.replace(f,i.serviceOptions.domain);i.authentication.signRequest(r)}return i.serviceOptions.transformRequest&&rl(r,i.serviceOptions.transformRequest(r.url,e)),r}};a=this.serviceOptions.authOptions.clientId?this.serviceOptions.authOptions.clientId:this.serviceOptions.authOptions.subscriptionKey?this.serviceOptions.authOptions.subscriptionKey.replace(/.(?=.{3,}$)/g,"*"):"invalid-setting",this.insights&&this.insights.setAuthenticatedUserContext(this.serviceOptions.sessionId,a);try{var l=new n.Map(s);this.map=l,this.authentication=new zf(this),this.controls=new Bf(this),this.events=new Vf(this),this.imageSprite=new Hf(this),this.layers=new Kf(this),this.markers=new Gf(this),this.sources=new $f(this),this.popups=new Yf(this),this.styleBuilder=new qm(this),this.map.getContainer().classList.add(tg.Css.container),this.map.getCanvasContainer().classList.add(tg.Css.canvasContainer),this.map.getCanvas().classList.add(tg.Css.canvas),this._detectHighContrast(),this.copyrightControl=new Wd({showFeedbackLink:this.styleOptions.showFeedbackLink}),this.controls.add(this.copyrightControl,{position:e.ControlPosition.NonFixed}),this.styleOptions.showLogo&&(this.logoControl=new Ud,this.controls.add(this.logoControl,{position:e.ControlPosition.NonFixed}));var c=this.authentication.initialize();if(this.removed)return;var u=function(){i.loaded=!0,i.map.off("load",u)};this.map.on("load",u);var p=function(){i.ready=!0,i.map.off("styledata",p);var t={map:i,type:"ready"};i.events.invoke("ready",t)};this.map.on("styledata",p),this._setAutoResize(this.styleOptions.autoResize),this.map.showTileBoundaries=this.styleOptions.showTileBoundaries,this.localizedStringsPromise=sl.getStrings(this.styleOptions.language);var h=this.styles.initialize();Promise.all([c,h]).then((function(){if(!i.removed){if(!i.authentication.getToken())throw new Error("AuthenticationManager finished initializing, but no token is available");i.serviceOptions["enable-accessibility"]&&i.accessibleMapDelegate.addToMap(),i._setStyleComponents(i.styleOptions)}})).catch((function(t){var e=t instanceof Error?t:new Error(t);i.insights&&i.insights.trackException({error:e});var r={map:i,type:"error",error:e};i.events.invoke("error",r)})),this.setCamera(S(S({},r),{type:"jump",duration:0})),this.incidentDelegate=new _f(this),this.flowDelegate=new af(this),this.accessibleMapDelegate=new of(this),this.userInteractionDelegate=new Af(this,r),this.userInteractionDelegate.addToMap()}catch(t){throw o=!1,this.insights&&this.insights.trackException({error:t instanceof Error?t:new Error(t)}),t}finally{this.insights&&(this.insights.trackEvent({name:"MapLoad"},{success:o,supported:Dl(!1),supportedWithPerformance:Dl(!0)}),this.insights.flush())}}var eg=(rg.applyTemplate=function(t,e){var r=this,i=document.createElement("div");if(i.classList.add(rg.Css.template),t){"boolean"!=typeof(e=e||{}).singleDescription&&(e.singleDescription=!0),e.sandboxContent="boolean"!=typeof e.sandboxContent||e.sandboxContent,e.title&&"string"==typeof e.content&&(e.content.includes("{title}")||e.content.includes("{name}"))||(t.title?e.title="{title}":t.name&&(e.title="{name}")),"boolean"!=typeof e.detectHyperlinks&&(e.detectHyperlinks=!0),"boolean"!=typeof e.parsePropertyPaths&&(e.parsePropertyPaths=!0),e.textColor&&(i.style.color=e.textColor),e.fillColor&&(i.style.backgroundColor=e.fillColor),e.title&&((a=this._applyStringTemplate(t,e.title,e)).innerText=a.textContent||a.innerText||"",this._appendChild(i,a,rg.Css.title));var n=document.createElement("div");if(n.classList.add(rg.Css.content),Array.isArray(e.content))0<e.content.length&&e.content[0].propertyPath?this._appendChild(n,this._generateContent(t,e.content,e),rg.Css.item):e.content.forEach((function(i){r._appendChild(n,r._generateContent(t,i,e),rg.Css.item)}));else{var o=0;t.description&&Object.keys(t).forEach((function(e){r._ignoreProperty(e,t[e])||o++}));var a=void 0;1===o||e.singleDescription&&t.description||2===o&&t.Snippet?(a=document.createElement("div")).innerHTML=t.description:a=this._generateContent(t,e.content,e),this._appendChild(n,a,rg.Css.item)}""!==n.innerHTML&&(e.sandboxContent?i.appendChild(rg._createSandboxedIframe(n,e)):i.appendChild(n))}return i},rg._createSandboxedIframe=function(t,e){var r=document.createElement("iframe");r.sandbox.add("allow-popups");var i,n=t.innerHTML,o=!1,a=100,s=550,l=10;document.body.scrollWidth<=340&&(s=300,a=50);var c=n.split(/<(tr|div|br|li|h[0-9]|p>)/);i=Math.max.apply(Math,c.map((function(t){return t.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length})))-1;var u=Math.ceil(3.5*i);if(u<s&&(s=u,a=i),n.includes("<img")||n.includes("<video"))o=!0,r.width="550px";else{var p=-1<n.indexOf(rg.Css.table)?25:20;l+=Math.max(.5*c.length*p,Math.ceil(n.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length/a)*p)}r.width=s+"px",r.height=o||280<l?"280px":l+"px";var h=e.textColor?"color:"+e.textColor+";":"",d=e.fillColor?"background-color:"+e.fillColor+";":"",f='<html><head><title></title><meta charset="utf-8" /><meta http-equiv="x-ua-compatible" content="IE=Edge" /><link rel="stylesheet" href="'+rg._cssUrl+'" type="text/css"/><style>html, body{margin:0;padding:0;'+h+d+'}</style></head><body><div class="'+rg.Css.template+'" style="padding:0;width:'+(s-20)+'px">'+n+"</div></body></html>";return void 0===r.srcdoc?r.src="data:text/html;charset=utf-8,"+encodeURI(f):r.srcdoc=f,r},rg._appendChild=function(t,e,r){e&&(r&&(e.className=(e.className?e.className+" ":"")+r),t.appendChild(e))},rg._generateContent=function(t,e,r){if(e)return Array.isArray(e)?this._generatePropertyInfoTable(t,e,r):this._applyStringTemplate(t,e,r);var i=this._generateDynamicTableHtml(t,null,r);if(i){var n=document.createElement("div");return n.innerHTML=i,n}return null},rg._applyStringTemplate=function(t,e,r){if(e){for(var i=e,n=this._placeholderRx.exec(e);n;){if(2<=n.length){var o=this._getPropertyValue(t,n[1],r);i=i.replace(n[0],o)}n=this._placeholderRx.exec(e)}if(i){(i=i.trim()).includes("<")&&(i=i.replace(/[\r\n]+/g,"<br/>"));var a=document.createElement("div");return a.innerHTML=i,a}}return null},rg._getPropertyValue=function(t,e,r,i){var n=r.parsePropertyPaths?e.split("/"):[e],o=n.length;if(0<o&&t){var a=n[0],s=t[a];if(r.detectHyperlinks&&"link"===e&&(!i||i.hyperlinkFormat)){var l=[];if(Array.isArray(s)?s.forEach((function(t){t.href?l.push(t):"string"==typeof t&&l.push({href:t})})):s.href&&l.push(s),0<l.length){var c,u;i&&i.hyperlinkFormat?c=i.hyperlinkFormat:r&&r.hyperlinkFormat&&(c=r.hyperlinkFormat),u=c&&c.target?c.target:"_blank";var p=[];return l.forEach((function(t){t.title||c&&c.label||!t.rel||p.push(t.rel," - "),p.push('<a href="',t.href,'" target="',u,'">'),t.title?p.push(t.title):c&&c.label?p.push(c.label):p.push(t.href),p.push("</a>","<br/>")})),p.pop(),p.join("")}}if(null!=s){var h=void 0;for(h=1;h<o&&(s=s[n[h]],a=n[h],null!=s);h++);if(h===o&&null!=s){var d=void 0;if((d=void 0!==s.value?s.value:s)instanceof Date)return i&&i.dateFormat?d.toLocaleString(void 0,i.dateFormat):r.dateFormat?d.toLocaleString(void 0,r.dateFormat):d.toISOString();if("object"==typeof d)return(v=this._generateDynamicTableHtml(d,n.slice(1),r))||"";if("number"==typeof d){if(i){if(i.dateFormat)return new Date(d).toLocaleString(void 0,i.dateFormat);if(i.numberFormat)return d.toLocaleString(void 0,i.numberFormat)}else if(/(timestamp|date)/gi.test(a))return new Date(d).toISOString();return d.toLocaleString(void 0,r.numberFormat)}if("string"==typeof d&&""!==d&&!/[\n\r<>\s]/g.test(d)&&(r.detectHyperlinks||i&&i.hyperlinkFormat)){d=d.trim();var f=this._isUrlRx.test(d)||i&&i.hyperlinkFormat,m=this._isImageUrlRx.test(d)&&(f||d.startsWith("data:image")),g=this._emailRx.test(d);if(f||m||g){var y=void 0;i&&i.hyperlinkFormat?y=i.hyperlinkFormat:r&&r.hyperlinkFormat&&(y=r.hyperlinkFormat);var v=void 0;v=y&&y.target?' target="'+y.target+'"':' target="_blank"';var _=""+(y&&y.label?y.label:d);y&&y.scheme?d=y.scheme+d:g&&(d="mailto:"+d);var x=y&&y.label?' alt="'+y.label+'"':"";return(y&&y.isImage||m)&&(_='<img src="'+d+'" style="max-width:100%"'+x+'"/>'),'<a href="'+d+'"'+v+">"+_+"</a>"}}return d.toString()}}}return""},rg._generatePropertyInfoTable=function(t,e,r){if(t&&e&&0<e.length){var i=[],n=this;i.push('<table class="'+n.Css.table+'">'),e.forEach((function(e){var o=n._getPropertyValue(t,e.propertyPath,r,e);if(e.hideLabel)i.push('<tr><td colspan="2">',o,"</td></tr>");else{var a=e.label||e.propertyPath.split("/")[0];i.push("<tr><th>",a,"</th><td>",o,"</td></tr>")}})),i.push("</table>");var o=document.createElement("div");return o.innerHTML=i.join(""),o}return null},rg._generateDynamicTableHtml=function(t,e,r){var i=this;if(t){var n=[],o=this;n.push('<table class="'+o.Css.table+'">');var a=e&&0<e.length?e.join("/")+"/":"",s=0;return Object.keys(t).forEach((function(e){i._ignoreProperty(e,t[e])||(n.push("<tr><th>",e,"</th><td>",o._getPropertyValue(t,a+e,r),"</td></tr>"),s++)})),0===s?null:(n.push("</table>"),n.join(""))}return null},rg._ignoreProperty=function(t,e){switch(t){case"title":case"name":case"base":case"popupTemplate":case"anchor":case"icon":case"image":case"imageUrl":case"rotation":case"color":case"size":case"offset":case"strokeColor":case"strokeWidth":case"strokeOpacity":case"subType":case"fillColor":case"fillOpacity":case"visibility":case"visible":return!0;default:if(0===t.indexOf("_")||null==e||""===e)return!0}return!1},rg._placeholderRx=/\{([a-zA-Z0-9_\/\s]+)\}/gi,rg._isUrlRx=/^(http|https|ftp|tel|mailto):\/\//i,rg._isImageUrlRx=/(^data:image|.png$|.jpg$|.jpeg$|.gif$|.bmp$|.svg|.tif|.tiff$)/i,rg._emailRx=/^[^\.\s@:](?:[^\s@:]*[^\s@:\.])?@[^\.\s@]+(?:\.[^\.\s@]+)*$/,rg._cssUrl=new O({domain:l,path:"sdk/javascript/mapcontrol/"+R.getEndpointVersion()+"/atlas.min.css"}).toString(),rg.Css={template:"azure-maps-control-popup-template",title:"azure-maps-control-popup-template-title",content:"azure-maps-control-popup-template-content",item:"azure-maps-control-popup-template-content-item",table:"azure-maps-control-popup-template-table"},rg);function rg(){this.detectHyperlinks=!0,this.parsePropertyPaths=!0}o(new O({domain:l,path:"sdk/javascript/mapcontrol/"+R.getEndpointVersion()+"/mapbox-gl-rtl-text.min.js"}).toString(),(function(t){t&&console.warn(t)}),!0),e.HtmlMarker=Ns,e.Map=Qm,e.Pixel=sn,e.Popup=Os,e.PopupTemplate=eg,e.Shape=To,e._getAssetDomain=function(){return s},e._getDomain=function(){return Al()},e._hasSetAuthenticationOptions=ql,e._hasSetDomain=Gl,e._hasSetLanguage=Hl,e._hasSetSessionId=Wl,e._hasSetStyleDefinitionsPath=Zl,e._hasSetView=Kl,e.addImageTemplate=function(t,e,r){!r&&ec[t.toLowerCase()]||(ec[t.toLowerCase()]=e)},e.control=Li,e.data=Vo,e.getAllImageTemplateNames=function(){return Object.keys(ec)},e.getAuthenticationOptions=Cl,e.getDomain=Al,e.getImageTemplate=Vl,e.getLanguage=Pl,e.getSessionId=Ol,e.getStyleDefinitionsPath=kl,e.getSubscriptionKey=Ml,e.getUserRegion=function(){return dl},e.getVersion=function(){return R.getFullVersion()},e.getView=Ll,e.internal=_o,e.isSupported=Dl,e.layer=ys,e.math=So,e.setAuthenticationOptions=Rl,e.setDomain=zl,e.setLanguage=Bl,e.setSessionId=Fl,e.setStyleDefinitionsPath=Nl,e.setSubscriptionKey=jl,e.setUserRegion=Ul,e.setView=function(t){dl=t,bl=!0},e.source=oa,Object.defineProperty(e,"__esModule",{value:!0})}))}).call(this,r("c8ba"))}}]);
//# sourceMappingURL=chunk-vendors.605c4291.js.map